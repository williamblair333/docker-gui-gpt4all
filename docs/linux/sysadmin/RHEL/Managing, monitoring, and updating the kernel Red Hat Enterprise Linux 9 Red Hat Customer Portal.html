<!DOCTYPE html>
<html dir="ltr" prefix="og: https://ogp.me/ns#" class=" js supports cssanimations flexbox csstransforms csstransforms3d" style="" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style>body {transition: opacity ease-in 0.2s; } 
body[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } 
</style><style type="text/css">.truste_cursor_pointer {cursor: pointer;}.truste_border_none {border: none;}</style>
    <meta charset="utf-8">
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<meta property="og:site_name" content="Red Hat Customer Portal">
<meta property="og:type" content="article">
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<meta property="og:title" content="Managing, monitoring, and updating the kernel Red Hat Enterprise Linux 9 | Red Hat Customer Portal">
<meta property="og:description" content="As a system administrator, you can configure the Linux kernel to optimize the operating system. Changes to the Linux kernel can improve system performance, security, and stability, as well as your ability to audit the system and troubleshoot problems.">
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="As a system administrator, you can configure the Linux kernel to optimize the operating system. Changes to the Linux kernel can improve system performance, security, and stability, as well as your ability to audit the system and troubleshoot problems.">
<meta name="twitter:title" content="Managing, monitoring, and updating the kernel Red Hat Enterprise Linux 9 | Red Hat Customer Portal">
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<meta name="twitter:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png">
<meta name="title" content="Managing, monitoring, and updating the kernel Red Hat Enterprise Linux 9 | Red Hat Customer Portal">
<link rel="alternate" hreflang="en" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="ko" href="https://access.redhat.com/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="zh-hans" href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="ja" href="https://access.redhat.com/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="es" href="https://access.redhat.com/documentation/es-es/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="ru" href="https://access.redhat.com/documentation/ru-ru/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="pt-br" href="https://access.redhat.com/documentation/pt-br/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="it" href="https://access.redhat.com/documentation/it-it/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="de" href="https://access.redhat.com/documentation/de-de/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="fr" href="https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<link rel="alternate" hreflang="zh-hant" href="https://access.redhat.com/documentation/zh-tw/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index">
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)">
<meta name="MobileOptimized" content="width">
<meta name="HandheldFriendly" content="true">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="revision" product="0ad2e1c5-8cc7-4fb9-8e05-1c2d8c07d005" title="82114005-8fd3-4cf2-b6df-edf0ef51c321" page="40568c24-0fda-437e-9403-abe7bfd8ede8" revision="923326e3a934f912d248db07f4eebf448aa01cbc:en-us" body="d22f1e8c9363911421f2b845acb7c43a.html" toc="b7f1ff4cb80b1b5f5cab94e8748a5d26.json">

    <title>Managing, monitoring, and updating the kernel Red Hat Enterprise Linux 9 | Red Hat Customer Portal</title>
    <link rel="stylesheet" media="all" href="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css">
<link rel="stylesheet" media="all" href="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/css__Xq4GfgPDJw9K_yYJFmlRZGJeCENu3R3r4s0K7Tr_9g.css">

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"documentation\/en-us\/red_hat_enterprise_linux\/9\/html-single\/managing_monitoring_and_updating_the_kernel\/index","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"red_hat_jwt":{"client_id":"customer-portal","cookie_name":"rh_jwt","leeway":"0","realm":"redhat-external","sso_host":"https:\/\/sso.redhat.com\/","user_integration":1,"user_plugin":"drupal_user_auth","use_external_js":0,"use_internal_js":0,"use_in_admin":0},"user":{"uid":0,"permissionsHash":"e301988aec96403b7b03860ee81161237ee18c188536caa2bfab8701012b505e"}}</script>
<script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/js_EQWKo9EokWkWS99x_e1oM-NEM0zlKyTkp_83mGdm5Ks.js"></script>

    <!-- CP_PRIMER_HEAD -->  <!-- TrustArc & DTM -->
  <script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/trustarc.js"></script><script type="text/javascript" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/notice" id="truste_0.21320612271824257"></script><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/v1.7-920" async="async" crossorigin="" importance="high"></script>
  <script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/dtm.js"></script><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/AppMeasurement.min.js" async=""></script><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/AppMeasurement_Module_ActivityMap.min.js" async=""></script><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/AppMeasurement_Module_AudienceManagement.min.js" async=""></script><script id="mktgJS" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh.mktg.js"></script><script>_satellite["_runScript1"](function(event, target, Promise) {
var targetWaitAttempts = 0;

var awaitBody = function(offer){
	//mbox call has returned, ensure <body> exists, then add the mbox DIV
	var docBody  = document.getElementsByTagName("body"),
		int_mbox;
	if(docBody.length){
		int_mbox = document.createElement("div");
		docBody = docBody[0];
		int_mbox.id = "int_mbox";
		int_mbox.classList.add("mboxDefault");
		int_mbox.style.display = "none";
		//place mbox DIV as first tag within BODY
		docBody.insertBefore(int_mbox, docBody.firstChild);
	
		//now that receiving DIV is in place, inject the offer code
		adobe.target.applyOffer({
			"mbox": "int_mbox",
			"selector": "#int_mbox",
			"offer": offer
		});
	
		//and then un-hide the mbox DIV
		int_mbox.style.display = "block";
	}else{
		setTimeout(function(){awaitBody(offer)},100);
	}
}

var awaitTarget = function(){
	if (typeof adobe !== "undefined" && typeof adobe.target !== "undefined" && typeof adobe.target.getOffer !== "undefined") {
		//First get the mbox call going out
		adobe.target.getOffer({
			"mbox": "int_mbox",
			"success": function(offer) {
				awaitBody(offer);
			},
			// Handle errors gracefully
			"error": function(status, error) {}
		});
	}else{
		if(++targetWaitAttempts < 50){
			setTimeout(awaitTarget,100);
		}
	}
}
awaitTarget();
});</script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="dxp-kbase-prod-138-57cf79cd99-wkvtp">
<meta name="avalon-version" content="eb0593bd">
<meta name="cp-chrome-build-date" content="2023-09-01T18:06:20.591Z">

<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml">
<!-- title -->
<title>Red Hat Customer Portal - Access to 24x7 support and knowledge</title>
<!-- /title -->
<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en", 
        version   : "eb0593bd",
        builddate : "2023-09-01T18:06:20.591Z",        fetchdate : "2023-09-03T14:30:08-0400",        nrid      : "NOLONGERSUPPORTED",
        nrlk      : "NOLONGERSUPPORTED"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="https://access.redhat.com/webassets/avalon/g/favicon.ico"><link media="all" rel="stylesheet" type="text/css" href="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/bootstrap.css">
<link media="all" rel="stylesheet" type="text/css" href="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/bootstrap-grid.css">
<link media="all" rel="stylesheet" type="text/css" href="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/main.css">



<link href="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/chosen.css" rel="stylesheet" type="text/css">

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]--><noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>
<link media="all" rel="stylesheet" type="text/css" href="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-navigation--lightdom.min.css">
<!-- /cssInclude -->
<script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/ie-polyfills.js"></script>

<script async="">
  if (!HTMLScriptElement.supports || !HTMLScriptElement.supports('importmap')) {
    import("https://www.redhatstatic.com/dx/v1-alpha/es-module-shims@1.7.3.js");
  }
</script>
<script type="importmap">
{
  "imports": {
    "@patternfly/elements/" : "https://www.redhatstatic.com/dx/v1-alpha/@patternfly/elements@2.2.2/",
    "@rhds/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/elements/",
    "@rhds/elements/lib/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/lib/",
    "@cpelements/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@cpelements/elements@2.0.0-alpha.7/elements/"
  }
}
</script><script type="text/javascript" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/require.js" data-main="/webassets/avalon/j/"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
<script type="text/javascript" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/new-nav.js"></script>
<!-- /CP_PRIMER_HEAD -->

  <script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RC89cb5efc622a491caa02ca11adc4672f-source.min.js" async=""></script><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RC4291db99e867433ca8496d298dca09cb-source.min.js" async=""></script><link href="data:text/css,%5Bid*%3D'google_ads_iframe'%5D%2C%5Bid*%3D'taboola-'%5D%2C.taboolaHeight%2C.taboola-placeholder%2C%23credential_picker_container%2C%23credentials-picker-container%2C%23credential_picker_iframe%2C%5Bid*%3D'google-one-tap-iframe'%5D%2C%23google-one-tap-popup-container%2C.google-one-tap-modal-div%2C%23amp_floatingAdDiv%2C%23ez-content-blocker-container%2C%23notify-adblock%7Bdisplay%3Anone!important%3Bmin-height%3A0!important%3Bheight%3A0!important%3B%7D" rel="stylesheet" type="text/css"><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/prompt.js"></script><script charset="utf-8" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/12.2158c5447122fa995560.chunk.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="https://access.redhat.com/webassets/avalon/j/lib/require-css/require.css.min.js" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/require.css.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="rhn-modal" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rhn-modal.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="status-widget" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/status-widget.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="avatars" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/avatars.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="cookie-monster" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/cookie-monster.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="pfe" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="wc" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/wc.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nimbus/searchbar" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/searchbar.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="webcomponentsjs/custom-elements-es5-adapter" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/custom-elements-es5-adapter.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="webcomponentsjs/webcomponents-bundle" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/webcomponents-bundle.js"></script><link rel="stylesheet" media="all" href="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh-table--lightdom.min.css"><script charset="utf-8" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/7.41dc96447e48575a0cfd.chunk.js"></script><script charset="utf-8" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/1.e4bb9861ae9a0d936559.chunk.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="data-action" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/data-action.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nimbus/tour" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/tour.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="introjs" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/introjs.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="moment" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/moment.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-icon/dist/pfe-icon.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-icon.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-cta/dist/pfe-cta.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-cta.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-avatar/dist/pfe-avatar.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-avatar.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/cp-search-autocomplete/dist/cp-search-autocomplete.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/cp-search-autocomplete.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/rh-site-switcher/dist/site-switcher.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/site-switcher.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/pfe-navigation/dist/pfe-navigation.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-navigation.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-primary-detail/dist/pfe-primary-detail.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-primary-detail.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfelement/dist/pfelement.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfelement.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-autocomplete/dist/pfe-autocomplete.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-autocomplete.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-button/dist/pfe-button.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-button.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/rh-table/dist/rh-table.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh-table.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="ieSVGfix" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/ieSVGfix.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/rh-account-dropdown/dist/rh-account-dropdown.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh-account-dropdown.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-clipboard/dist/pfe-clipboard.umd.min" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-clipboard.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="prism" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/prism.js"></script><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RC1badf0bc400d462b892df3a5874c0bc4-source.min.js" async=""></script><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RCb1afac0346e94d81bf645b608336061e-source.min.js" async=""></script><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RCa65a5b793a1a4b4abe76ffa69f30f470-source.min.js" async=""></script></head>
  <body class="en loggedOut">
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas="">
      <!-- CP_PRIMER_HEADER -->
<div id="page-wrap" class="page-wrap">
    <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">

      <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
      <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden">Skip to navigation</a>
            <a href="#doc-wrapper" class="skip-link visually-hidden">Skip to main content</a>            <nav id="portal-utility-nav" class="utility-navigation utility-navigation--bar hidden-at-mobile" data-analytics-region="utility" aria-labelledby="nav__utility-nav--desktop">
                <h3 id="nav__utility-nav--desktop" class="element-invisible">Utilities
                </h3>
                <ul aria-labelledby="nav__utility-nav--desktop">
                    <li id="nav-subscription" data-portal-tour-1="1">
                        <a class="top-nav-subscriptions" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Subscription" href="https://access.redhat.com/management/">Subscriptions
                        </a>
                    </li>
                    <li id="nav-downloads" data-portal-tour-1="2">
                        <a class="top-nav-downloads" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/">Downloads
                        </a>
                    </li>
                    <li id="nav-containers">
                        <a class="top-nav-containers" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/">Containers
                        </a>
                    </li>
                    <li id="nav-support" data-portal-tour-1="3">
                        <a class="top-nav-support-cases" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/">Support Cases
                        </a>
                    </li>
                </ul>
            </nav>

            <pfe-navigation id="pfe-navigation" data-analytics-region="mega menu" pfelement="" class="PFElement pfe-navigation--processed pfe-navigation--has-search pfe-navigation--custom-dropdowns--processed" type="combo" has_search="" has_account="" breakpoint="desktop" lang="en">
                <div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper">
                    <a href="https://access.redhat.com/" class="pfe-navigation__logo-link" data-analytics-text="logo" data-analytics-category="MM|logo">
                        <img class="pfe-navigation__logo-image" alt="Red Hat Customer Portal" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/red-hat-customer-portal.svg">
                    </a>
                </div>

                <nav class="pfe-navigation" aria-label="Main Navigation" data-analytics-region="main nav">
                    <ul class="pfe-navigation__menu" id="pfe-navigation__menu">                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-subscription--mobile" data-portal-tour-1="1">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Subscription" href="https://access.redhat.com/management/">Subscriptions
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-downloads--mobile" data-portal-tour-1="2">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/">Downloads
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-containers--mobile">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/">Containers
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-support--mobile" data-portal-tour-1="3">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/">Support Cases
                            </a>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Products and Services">Products &amp; Services
                            </a>
                            <div class="pfe-navigation__dropdown has-primary-detail">                                <div class="desktop-col-span-2 tablet-col-span-all">
                                    <h3>
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Products" href="https://access.redhat.com/products/">Products
                                        </a>
                                    </h3>
                                    <slot name="main-menu__dropdown--product__product-listing"></slot>
                                </div>                                <div>
                                    <h3 id="nav__products__support">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Support" href="https://access.redhat.com/support">Support
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__support">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Production Support" href="https://access.redhat.com/support/offerings/production/">Production Support
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Development Support" href="https://access.redhat.com/support/offerings/developer/">Development Support
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Product Life Cycles" href="https://access.redhat.com/product-life-cycles/">Product Life Cycles
                                                    </a></li>
                                    </ul>

                                    <h3 id="nav__products__services">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Services" href="https://www.redhat.com/en/services">Services
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__services">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Consulting" href="https://www.redhat.com/en/services/consulting">Consulting
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Technical Account Management" href="https://access.redhat.com/support/offerings/tam/">Technical Account Management
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Training and Certifications" href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__products__documentation">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Documentation" href="https://access.redhat.com/documentation">Documentation
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__documentation">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform
                                                        </a></li>
                                    </ul>
                                    <pfe-cta pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="All Documentation" data-analytics-linktype="cta" href="https://access.redhat.com/documentation">All Documentation
                                        </a>
                                    </pfe-cta>

                                    <h3 id="nav__products__catalog"><a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Ecosystem Catalog" href="https://catalog.redhat.com/">Ecosystem Catalog
                                        </a></h3>
                                        <ul aria-labelledby="nav__products__catalog">
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Red Hat Partner Ecosystem" href="https://access.redhat.com/ecosystem/">Red Hat Partner Ecosystem
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Partner Resources" href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources
                                                    </a></li>
                                        </ul>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Tools" href="https://access.redhat.com/labs/">Tools
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__tools__tools" data-analytics-level="2" data-analytics-text="Tools" data-analytics-category="Tools">Tools
                                    </h3>
                                    <ul aria-labelledby="nav__tools__tools">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Solution Engine" href="https://access.redhat.com/support/cases/#/troubleshoot">Troubleshoot a product issue
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Packages" href="https://access.redhat.com/downloads/content/package-browser">Packages
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Errata" href="https://access.redhat.com/errata/">Errata
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__tools__labs">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Customer Portal Labs" href="https://access.redhat.com/labs/">Customer Portal Labs
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__tools__labs">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Configuration" href="https://access.redhat.com/labs/#!?type=config">Configuration
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Deployment" href="https://access.redhat.com/labs/#!?type=deploy">Deployment
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Security" href="https://access.redhat.com/labs/#!?type=security">Security
                                                    </a></li>                                                    <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Troubleshooting" href="https://access.redhat.com/labs/#!?type=troubleshoot">Troubleshoot
                                                        </a></li>
                                    </ul>
                                    <pfe-cta pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="All Labs" data-analytics-linktype="cta" href="https://access.redhat.com/labs/">All labs
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h4 id="nav__tools__red-hat-insights">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Red Hat Insights" href="https://www.redhat.com/en/technologies/management/insights">Red Hat Insights
                                        </a>
                                    </h4>
                                    <p>Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Learn more" href="https://www.redhat.com/en/technologies/management/insights">Learn More
                                    </a>
                                    <br>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Go to Insights" href="https://cloud.redhat.com/insights">Go to Insights
                                    </a>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Security" href="https://access.redhat.com/security/">Security
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="security__security-center">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Red Hat Product Security Center" href="https://access.redhat.com/security">Red Hat Product Security Center
                                        </a>
                                    </h3>
                                    <p>Engage with our Red Hat Product 
Security team, access security updates, and ensure your environments are
 not exposed to any known security vulnerabilities.
                                    </p>
                                    <pfe-cta pfe-priority="primary" priority="primary" pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Security|Red Hat Product Security Center" data-analytics-text="Product Security Center" data-analytics-linktype="cta" href="https://access.redhat.com/security/">Product Security Center
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__updates" data-analytics-level="2" data-analytics-text="Security Updates" data-analytics-category="Security">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Security Updates" href="https://access.redhat.com/security">Security Updates
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__updates">
                                        <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Advisories" href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Red Hat CVE Database" href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Labs" href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs
                                                    </a></li>
                                    </ul>
                                    <p class="margin-top-xl">Keep your systems secure with Red Hat's specialized responses to security vulnerabilities.
                                    </p>
                                    <pfe-cta pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="View Responses" data-analytics-linktype="cta" href="https://access.redhat.com/security/vulnerability">View Responses
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__resources">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Resources" href="https://access.redhat.com/security/overview">Resources
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__resources">                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Blog" href="https://redhat.com/en/blog/channel/security">Security Blog
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Measurement" href="https://www.redhat.com/security/data/metrics/">Security Measurement
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Severity Ratings" href="https://access.redhat.com/security/updates/classification/">Severity Ratings
                                                        </a></li>
                                                        <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Backporting Policies" href="https://access.redhat.com/security/updates/backporting/">Backporting Policies
                                                            </a></li>
                                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Product Signing (GPG) Keys" href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys
                                                                </a></li>
                                    </ul>
                                </div>

                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/community/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Community">Community
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__community__cp-community">
                                        <a href="https://access.redhat.com/community" data-analytics-level="2" data-analytics-text="Customer Portal Community" data-analytics-category="Community">Customer Portal Community
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__community__cp-community">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Discussions" href="https://access.redhat.com/discussions">Discussions
                                            </a></li>                                                <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Private Groups" href="https://access.redhat.com/groups/">Private Groups
                                                    </a></li>
                                    </ul>

                                    <pfe-cta pfe-priority="primary" priority="primary" pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Community Activity" data-analytics-linktype="cta" href="https://access.redhat.com/community/">Community Activity
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__community__events" data-analytics-level="2" data-analytics-text="Customer Events" data-analytics-category="Community">Customer Events
                                    </h3>
                                    <ul aria-labelledby="nav__community__events">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Convergence" href="https://access.redhat.com/convergence/">Red Hat Convergence
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Summit" href="http://www.redhat.com/summit/">Red Hat Summit
                                                </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__community__stories" data-analytics-level="2" data-analytics-text="Stories" data-analytics-category="Community">Stories
                                    </h3>
                                    <ul aria-labelledby="nav__community__stories">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Red Hat Subscription Value" href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-text="You Asked. We Acted." data-analytics-category="Community|Stories" href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Open Source Communities" href="http://www.redhat.com/en/open-source">Open Source Communities
                                                    </a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>                </nav>                <div id="site-search" slot="search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <cp-search-autocomplete class="push-bottom PFElement" path="/webassets/avalon/j/data.json" num-items="5" placeholder="Enter your search term" pfelement="" type="container"></cp-search-autocomplete>                            <div>Or <a href="https://access.redhat.com/support/cases/#/troubleshoot">troubleshoot an issue</a>.
                            </div>
                        </form>
                    </div>
                </div>


                <div slot="secondary-links" id="localesMenu" class="pfe-navigation__custom-dropdown__wrapper--single-column pfe-navigation__custom-dropdown__wrapper">
                    <button class="pfe-navigation__secondary-link" id="pfe-navigation__secondary-link--English" aria-controls="pfe-navigation__custom-dropdown--English" aria-expanded="false">
                        <pfe-icon icon="web-icon-globe" size="sm" aria-hidden="true" pfelement="" class="PFElement" on="light" type="content"></pfe-icon>English
                    </button>

                    
                <div id="pfe-navigation__custom-dropdown--English" class="pfe-navigation__dropdown-wrapper pfe-navigation__custom-dropdown--single-column pfe-navigation__dropdown-wrapper--invisible" aria-hidden="true" tabindex="-1"><pfe-navigation-dropdown dropdown-width="single" pfelement="" class="PFElement pfe-navigation__dropdown" type="container" data-id-suffix="English">
                        <h2 class="utility-header">Select Your Language
                        </h2>
                        <ul class="reset">
                            <li><a href="https://access.redhat.com/changeLanguage?language=en&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index" data-lang="en" id="en" data-analytics-text="English" class="selected">English</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ko&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index" data-lang="ko" id="ko" data-analytics-text="Korean"></a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ja&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index" data-lang="ja" id="ja" data-analytics-text="Japanese"></a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index" data-lang="zh_CN" id="zh_CN" data-analytics-text="Chinese"> ()</a></li>
                        </ul>

                    </pfe-navigation-dropdown></div></div>                <rh-account-dropdown slot="account" pfelement="" class="PFElement" type="content" login-link="https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/auth?client_id=customer-portal&amp;redirect_uri=https%3A%2F%2Faccess.redhat.com%2Fwebassets%2Favalon%2Fj%2Fincludes%2Fsession%2Fscribe%2F%3FredirectTo%3Dhttps%253A%252F%252Faccess.redhat.com%252Fdocumentation%252Fen-us%252Fred_hat_enterprise_linux%252F9%252Fhtml-single%252Fmanaging_monitoring_and_updating_the_kernel%252Findex&amp;state=847eefe0-667c-4613-8b19-6c065c1a1c3c&amp;nonce=c1eb6a40-463a-46a7-83d6-87f891e06a5d&amp;response_mode=fragment&amp;response_type=code&amp;scope=openid" lang="en"></rh-account-dropdown>                <pfe-primary-detail breakpoint-width="600" class="main-menu__dropdown--product__product-listing PFElement" slot="main-menu__dropdown--product__product-listing" consistent-height="" aria-orientation="vertical" role="tablist" pfelement="" on="&quot;light&quot;" type="container" has_details="" breakpoint="compact">
                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-wg294t9ov" data-index="0" aria-controls="pfe-detail-a484wafpk" aria-expanded="false">Infrastructure and Management                    </button>
                    <div slot="details" data-index="0" id="pfe-detail-a484wafpk" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-wg294t9ov" data-processed="true" aria-hidden="true" hidden="">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Satellite" href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Subscription Management" href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Insights" href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights
                                </a>
                            </li>
                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Ansible Automation Platform" href="https://access.redhat.com/products/red-hat-ansible-automation-platform/">Red Hat Ansible Automation Platform
                                </a></li>
                        </ul>
                    </div>

                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-q3qdv6ku1" data-index="1" aria-controls="pfe-detail-qfi5afab4" aria-expanded="false">Cloud Computing                    </button>
                    <div slot="details" data-index="1" id="pfe-detail-qfi5afab4" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-q3qdv6ku1" data-processed="true" aria-hidden="true" hidden="">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift" href="https://access.redhat.com/products/openshift">Red Hat OpenShift
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Data Science" href="https://access.redhat.com/products/red-hat-openshift-data-science/">Red Hat OpenShift Data Science
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Dedicated" href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat Advanced Cluster Security for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/">Red Hat Advanced Cluster Security for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Advanced Cluster Management for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Quay" href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat CodeReady Workspaces" href="https://access.redhat.com/products/red-hat-codeready-workspaces/">OpenShift Dev Spaces
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Service on AWS" href="https://access.redhat.com/products/red-hat-openshift-service-aws">Red Hat OpenShift Service on AWS
                                </a>
                            </li>
                        </ul>
                    </div>

                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-9nd3iwzmg" data-index="2" aria-controls="pfe-detail-yftl0jmf6" aria-expanded="false">Storage                    </button>
                    <div slot="details" data-index="2" id="pfe-detail-yftl0jmf6" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-9nd3iwzmg" data-processed="true" aria-hidden="true" hidden="">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Gluster Storage" href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Hyperconverged Infrastructure" href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Ceph Storage" href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Openshift Container Storage" href="https://access.redhat.com/products/red-hat-openshift-data-foundation">Red Hat OpenShift Data Foundation
                                </a>
                            </li>
                        </ul>
                    </div>

                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-ziv31wdm9" data-index="3" aria-controls="pfe-detail-yx3l3oxa4" aria-expanded="false">Runtimes                    </button>
                    <div slot="details" data-index="3" id="pfe-detail-yx3l3oxa4" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-ziv31wdm9" data-processed="true" aria-hidden="true" hidden="">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Runtimes" href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Data Grid" href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Web Server" href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Single Sign On" href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat support for Spring Boot" href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Node.js" href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js
                                </a>
                            </li>                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Quarkus" href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus
                                </a>
                            </li>
                        </ul>
                    </div>

                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-r3h1tt7aa" data-index="4" aria-controls="pfe-detail-62lnmesxo" aria-expanded="false">Integration and Automation                    </button>
                    <div slot="details" data-index="4" id="pfe-detail-62lnmesxo" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-r3h1tt7aa" data-processed="true" aria-hidden="true" hidden="">
                        <ul class="border-bottom" id="portal-menu-border-bottom">
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Application Foundations" href="https://access.redhat.com/products/red-hat-application-foundations/">Red Hat Application Foundations
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Fuse" href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat AMQ" href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat 3scale API Management" href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div slot="details-nav--footer">
                        <pfe-cta pfe-priority="primary" priority="primary" pfelement="" class="PFElement" on="&quot;light&quot;" has_link="">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="2" data-analytics-text="All Products" data-analytics-category="Products and Services|Products:" data-analytics-linktype="cta">All Products
                            </a>
                        </pfe-cta>
                    </div>
                </pfe-primary-detail>

            <div slot="secondary-links" class="pfe-navigation__site-switcher pfe-navigation__custom-dropdown__wrapper--full pfe-navigation__custom-dropdown__wrapper" mobile-slider=""><button class="pfe-navigation__secondary-link" id="pfe-navigation__secondary-link--All-Red-Hat" aria-controls="pfe-navigation__custom-dropdown--All-Red-Hat" aria-expanded="false"><pfe-icon icon="web-icon-grid-3x3" size="sm" aria-hidden="true" pfelement="" class="PFElement" on="light" type="content"></pfe-icon>All Red Hat</button> <div id="pfe-navigation__custom-dropdown--All-Red-Hat" class="pfe-navigation__dropdown-wrapper pfe-navigation__custom-dropdown--full pfe-navigation__dropdown-wrapper--invisible" aria-hidden="true" tabindex="-1"><pfe-navigation-dropdown dropdown-width="full" pfelement="" class="PFElement pfe-navigation__dropdown" type="container" data-id-suffix="All-Red-Hat"><div class="pfe-navigation__site-switcher__back-wrapper"><button class="pfe-navigation__site-switcher__back-button" aria-label="Close undefined and return to menu">Back to menu</button></div><site-switcher pfelement="" class="PFElement" type="content" lang="en"><article class="node-355871 node node-page clearfix">


    <div class="field field-name-body field-type-text-with-summary field-label-hidden">
        <div class="field-items">
            <div class="field-item even">
                <!--linking to stylesheets so /cms/ajax/site-switcher will load with styles -->
  <link type="text/css" rel="stylesheet" href="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/site-switcher.css" media="all">
  
  <!-- overriding css variables to get the redhat.com logo box and text to change style indicating you are on this site-->

                <style>
                    :root {
                        --rhdc--logo: var(--rhdc--logo--you-are-here);
                        --rhdc--backgroundColor: var(--background--you-are-here);
                        --rhdc--label: var(--label--you-are-here);
                        --rhdc--margin-top: 0px;
                    }
                </style>

                <section class="site-switcher-tray" data-analytics-region="site-switcher">
                    <div class="content">
                        <div class="container">
                            <section class="site-switcher-container">
                                <ul class="site-switcher-primary-list">
                                    <li class="rhdc">
                                        <a href="https://www.redhat.com/?intcmp=701f20000012k69AAA" data-analytics-category="Websites" data-analytics-text="redhat">
                                            <p class="location-label">You are here</p>
                                            <div class="tntLogo">
                                                <div class="image"></div>
                                            </div>
                                            <h3>Red Hat</h3>
                                            <p>Learn about our open source products, services, and company.</p>
                                        </a>
                                    </li>
                                    <li class="customer-portal">
                                        <a href="https://access.redhat.com/?intcmp=701f20000012k6EAAQ" data-analytics-category="Websites" data-analytics-text="access_redhat">
                                            <p class="location-label">You are here</p>
                                            <div class="tntLogo">
                                                <!-- Customer portal -->
                                                <div class="image"></div>
                                            </div>
                                            <h3>Red Hat Customer Portal</h3>
                                            <p>Get product support and knowledge from the open source experts.</p>
                                        </a>
                                    </li>
                                    <li class="developers">
                                        <a href="https://developers.redhat.com/?intcmp=701f20000012k6JAAQ" data-analytics-category="Websites" data-analytics-text="developers_redhat">
                                            <p class="location-label">You are here</p>
                                            <div class="tntLogo">
                                                <!-- Red Hat Developer -->
                                                <div class="image"></div>
                                            </div>
                                            <h3>Red Hat Developer</h3>
                                            <p>Read developer tutorials and download Red Hat software for cloud
                                                application development.</p>
                                        </a>
                                    </li>
                                    <li class="connect">
                                        <a href="https://connect.redhat.com/" data-analytics-category="Websites" data-analytics-text="connect_redhat">
                                            <p class="location-label">You are here</p>
                                            <div class="tntLogo">
                                                <!-- Red Hat Partner Connect -->
                                                <div class="image"></div>
                                            </div>
                                            <h3>Red Hat Partner Connect</h3>
                                            <p>Become a Red Hat partner and get support in building customer solutions.
                                            </p>
                                        </a>
                                    </li>
                                </ul>
                                <hr>

                                <ul class="site-switcher-secondary-list">
                                    <li>
                                        <h2>Products</h2>
                                        <ul>
                                            <li><a href="https://www.ansible.com/?intcmp=701f20000012k6TAAQ" data-analytics-category="Websites" data-analytics-text="ansible">
                                                    <h3>Ansible.com</h3>
                                                </a>Learn about and try our IT automation product.</li>

                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Try, Buy, Sell</h2>
                                        <ul>
                                            <li><a href="https://cloud.redhat.com/" data-analytics-category="Websites" data-analytics-text="hybrid-cloud">
                                                    <h3>Red Hat Hybrid Cloud</h3>
                                                </a>Access technical how-tos, tutorials, and learning paths focused on
                                                Red Hats hybrid cloud managed services.</li>

                                            <li><a href="https://www.redhat.com/store?intcmp=701f20000012k6nAAA" data-analytics-category="Websites" data-analytics-text="store">
                                                    <h3>Red Hat Store</h3>
                                                </a>Buy select Red Hat products and services online.</li>

                                            <li><a href="https://marketplace.redhat.com/" data-analytics-category="Websites" data-analytics-text="marketplace">
                                                    <h3>Red Hat Marketplace</h3>
                                                </a>Try, buy, sell, and manage certified enterprise software for
                                                container-based environments.</li>

                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Community &amp; Open Source</h2>
                                        <ul>
                                            <li><a href="https://enterprisersproject.com/?intcmp=701f20000012k6sAAA" data-analytics-category="Websites" data-analytics-text="enterprisersproject">
                                                    <h3>The Enterprisers Project</h3>
                                                </a>Read analysis and advice articles written by CIOs, for CIOs.</li>
                                            <li><a href="https://opensource.com/?intcmp=701f20000012k6OAAQ" data-analytics-category="Websites" data-analytics-text="opensource">
                                                    <h3>Opensource.com</h3>
                                                </a>Read articles on a range of topics about open source.</li>
                                        </ul>
                                    </li>
                                    <li>
                                        <h2>&nbsp;</h2>
                                        <ul>
                                            <li><a href="https://www.redhat.com/summit?intcmp=701f20000012k6xAAA" data-analytics-category="Websites" data-analytics-text="summit">
                                                    <h3>Red Hat Summit</h3>
                                                </a>Register for and learn about our annual open source IT industry
                                                event.</li>
                                            <li><a href="https://catalog.redhat.com/" data-analytics-category="Websites" data-analytics-text="catalog">
                                                    <h3>Red Hat Ecosystem Catalog</h3>
                                                </a>Find hardware, software, and cloud providersand download container
                                                imagescertified to perform with Red Hat technologies.</li>
                                        </ul>
                                    </li>
                                </ul>
                            </section>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>



</article></site-switcher></pfe-navigation-dropdown></div></div></pfe-navigation>

            <div id="scroll-anchor"></div>

            <!--[if IE 8]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>
                You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
                </div>
            <![endif]-->
            <!--[if IE 9]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
                </div>
            <![endif]-->
            <div id="site-section"></div>
        <div class="breadcrumbs"><div id="breadcrumbs" class="container"><ul><li><a href="https://access.redhat.com/products/">Products &amp; Services</a></li><li><a href="https://access.redhat.com/documentation">Product Documentation</a></li><li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red&nbsp;Hat Enterprise Linux</a></li><li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9">9</a></li><li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel">Managing, monitoring, and updating the kernel</a></li><li>Managing, monitoring, and updating the kernel</li></ul></div></div></header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">                            <!-- /CP_PRIMER_HEADER -->

      <div class="container">
        

                                                                                                        <script>breadcrumbs = [["Products & Services","\/products\/"],["Product Documentation","\/documentation"],["Red Hat Enterprise Linux","\/documentation\/en-us\/red_hat_enterprise_linux"],["9","\/documentation\/en-us\/red_hat_enterprise_linux\/9"],["Managing, monitoring, and updating the kernel","\/documentation\/en-us\/red_hat_enterprise_linux\/9\/html\/managing_monitoring_and_updating_the_kernel"],["Managing, monitoring, and updating the kernel","\/documentation\/en-us\/red_hat_enterprise_linux\/9\/html\/managing_monitoring_and_updating_the_kernel\/--single-page-document--"]]</script>

<div data-drupal-messages-fallback="" class="hidden"></div>


    </div>
        <div class="j-chrome-content-container">
        

  

  


  <article class="pvof-doc__content-wrapper__outer">
    <script>
      'use strict';

            var $outerWrapper = document.querySelector('.pvof-doc__content-wrapper__outer');
      if ($outerWrapper && $outerWrapper.closest) {
        var $containerWrapper = $outerWrapper.closest('.container');
        if ($containerWrapper) {
          $containerWrapper.classList.remove('container');
          $containerWrapper.classList.add('j-chrome-content-container');
        }
      }

            var cssRemoved = false;
      try {
        var $crapCss = document.querySelectorAll(
          'link[href*="/chrome_themes/nimbus/css/pages.css"], link[href*="/chrome_themes/nimbus/css/components.css"]'
        );
        if ($crapCss.length) {
          for (let index = 0; index < $crapCss.length; index++) {
            const $stylesheet = $crapCss[index];
            $stylesheet.remove();
          }
        }
        cssRemoved = true;
      }
      catch (error) {
        console.error('Ran into an issue while trying to retheme page', error);
        cssRemoved = false;
      }

            if (cssRemoved) {
        var $pvofOuterWrapper = document.querySelector('.pvof-doc__content-wrapper__outer--css-not-removed');
        if ($pvofOuterWrapper) {
          $pvofOuterWrapper.classList.remove('pvof-doc__content-wrapper__outer--css-not-removed');
        }
      }
    </script>
    <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
    <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
    <div class="pvof-doc__content-wrapper pvof-doc__content-wrapper--has-sidebar">
                                <div class="pvof-doc__content-wrapper__inner j-superdoc j-superdoc--has-nav j-reading-mode-initialized">
                            <div class="pvof-sidebar__wrapper j-doc-nav j-superdoc__nav">
            <div class="j-sidebar__menu-container j-sidebar__menu-container--processed">
              <button class="j-sidebar__menu-trigger content-expander__trigger content-expander__trigger--processed" aria-expanded="true" aria-controls="content-expander-33cs6nw">
                <span class="j-sidebar__menu-trigger__open-text">Jump To</span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>

              <div class="pvof-sidebar__inner-wrapper j-doc-nav__wrapper content-expander content-expander--processed" id="content-expander-33cs6nw" open="">
                <div class="j-sidebar__menu-details-container">
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--expand">
                    Expand all
                  </button>
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--collapse">
                    Collapse all
                  </button>
                </div>
                

  <nav id="pvof-doc__toc" class="pvof-doc__toc">
  <h2 class="j-doc-nav__title" id="j-doc-nav__title">
    Table of contents
  </h2>
  <div class="pvof-doc__toc-inner">
              <ol class="j-doc-nav__list" aria-labelledby="j-doc-nav__title">
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#doc-wrapper" class="j-doc-nav__link is-active">
    Managing, monitoring, and updating the kernel
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#making-open-source-more-inclusive" class="j-doc-nav__link ">
    Making open source more inclusive
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#proc_providing-feedback-on-red-hat-documentation_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link ">
    Providing feedback on Red Hat documentation
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_the-linux-kernel_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    1. The Linux kernel
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-1yjw18g">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "1. The Linux kernel"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "1. The Linux kernel"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-1yjw18g" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#what-the-kernel-is_assembly_the-linux-kernel" class="j-doc-nav__link ">
    1.1. What the kernel is
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#con_rpm-packages_assembly_the-linux-kernel" class="j-doc-nav__link ">
    1.2. RPM packages
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-linux-kernel-rpm-package-overview_assembly_the-linux-kernel" class="j-doc-nav__link ">
    1.3. The Linux kernel RPM package overview
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#displaying-contents-of-the-kernel-package_assembly_the-linux-kernel" class="j-doc-nav__link ">
    1.4. Displaying contents of the kernel package
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#installing-the-kernel_assembly_the-linux-kernel" class="j-doc-nav__link ">
    1.5. Installing specific kernel versions
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#updating-the-kernel_assembly_the-linux-kernel" class="j-doc-nav__link ">
    1.6. Updating the kernel
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#setting-a-kernel-as-default_assembly_the-linux-kernel" class="j-doc-nav__link ">
    1.7. Setting a kernel as default
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#what-is-kernel-64k_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link ">
    2. The 64k page size kernel
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#managing-kernel-modules_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    3. Managing kernel modules
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-11jnrmu">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3. Managing kernel modules"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3. Managing kernel modules"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-11jnrmu" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-kernel-modules_managing-kernel-modules" class="j-doc-nav__link ">
    3.1. Introduction to kernel modules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#kernel-module-dependencies_managing-kernel-modules" class="j-doc-nav__link ">
    3.2. Kernel module dependencies
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#listing-installed-kernel-modules_managing-kernel-modules" class="j-doc-nav__link ">
    3.3. Listing installed kernel modules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#listing-currently-loaded-kernel-modules_managing-kernel-modules" class="j-doc-nav__link ">
    3.4. Listing currently loaded kernel modules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#displaying-information-about-kernel-modules_managing-kernel-modules" class="j-doc-nav__link ">
    3.5. Displaying information about kernel modules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#loading-kernel-modules-at-system-runtime_managing-kernel-modules" class="j-doc-nav__link ">
    3.6. Loading kernel modules at system runtime
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#unloading-kernel-modules-at-system-runtime_managing-kernel-modules" class="j-doc-nav__link ">
    3.7. Unloading kernel modules at system runtime
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_unloading-kernel-modules-at-early-stages-of-the-boot-process_managing-kernel-modules" class="j-doc-nav__link ">
    3.8. Unloading kernel modules at early stages of the boot process
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#loading-kernel-modules-automatically-at-system-boot-time_managing-kernel-modules" class="j-doc-nav__link ">
    3.9. Loading kernel modules automatically at system boot time
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#preventing-kernel-modules-from-being-automatically-loaded-at-system-boot-time_managing-kernel-modules" class="j-doc-nav__link ">
    3.10. Preventing kernel modules from being automatically loaded at system boot time
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_compiling-custom-kernel-modules_managing-kernel-modules" class="j-doc-nav__link ">
    3.11. Compiling custom kernel modules
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-kernel-command-line-parameters_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    4. Configuring kernel command-line parameters
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-i78m1g9">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4. Configuring kernel command-line parameters"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4. Configuring kernel command-line parameters"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-i78m1g9" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#understanding-kernel-command-line-parameters_configuring-kernel-command-line-parameters" class="j-doc-nav__link ">
    4.1. What are kernel command-line parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#what-boot-entries-are_configuring-kernel-command-line-parameters" class="j-doc-nav__link ">
    4.2. Understanding boot entries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#changing-kernel-command-line-parameters-for-all-boot-entries_configuring-kernel-command-line-parameters" class="j-doc-nav__link ">
    4.3. Changing kernel command-line parameters for all boot entries
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#changing-kernel-command-line-parameters-for-a-single-boot-entry_configuring-kernel-command-line-parameters" class="j-doc-nav__link ">
    4.4. Changing kernel command-line parameters for a single boot entry
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#changing-kernel-command-line-parameters-temporarily-at-boot-time_configuring-kernel-command-line-parameters" class="j-doc-nav__link ">
    4.5. Changing kernel command-line parameters temporarily at boot time
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_configuring-grub-2-settings-to-enable-serial-console-connection_configuring-kernel-command-line-parameters" class="j-doc-nav__link ">
    4.6. Configuring GRUB settings to enable serial console connection
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-kernel-parameters-at-runtime_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    5. Configuring kernel parameters at runtime
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-1fg9j7g">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5. Configuring kernel parameters at runtime"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5. Configuring kernel parameters at runtime"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-1fg9j7g" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#what-are-kernel-parameters_configuring-kernel-parameters-at-runtime" class="j-doc-nav__link ">
    5.1. What are kernel parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-kernel-parameters-temporarily-with-sysctl_configuring-kernel-parameters-at-runtime" class="j-doc-nav__link ">
    5.2. Configuring kernel parameters temporarily with sysctl
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-kernel-parameters-permanently-with-sysctl_configuring-kernel-parameters-at-runtime" class="j-doc-nav__link ">
    5.3. Configuring kernel parameters permanently with sysctl
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-configuration-files-in-etc-sysctl-d-to-adjust-kernel-parameters_configuring-kernel-parameters-at-runtime" class="j-doc-nav__link ">
    5.4. Using configuration files in /etc/sysctl.d/ to adjust kernel parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-kernel-parameters-temporarily-through-proc-sys_configuring-kernel-parameters-at-runtime" class="j-doc-nav__link ">
    5.5. Configuring kernel parameters temporarily through /proc/sys/
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    6. Configuring kernel parameters permanently by using the kernel_settings RHEL System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-69ms7z3">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6. Configuring kernel parameters permanently by using the kernel_settings RHEL System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6. Configuring kernel parameters permanently by using the kernel_settings RHEL System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-69ms7z3" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role" class="j-doc-nav__link ">
    6.1. Introduction to the kernel_settings role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role" class="j-doc-nav__link ">
    6.2. Applying selected kernel parameters using the kernel_settings role
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#applying-patches-with-kernel-live-patching_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    7. Applying patches with kernel live patching
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-rire57d">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7. Applying patches with kernel live patching"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7. Applying patches with kernel live patching"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-rire57d" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#limitations-of-kpatch_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.1. Limitations of kpatch
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#support-for-third-party-live-patching_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.2. Support for third-party live patching
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#access-to-kernel-live-patches_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.3. Access to kernel live patches
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#components-of-kernel-live-patching_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.4. Components of kernel live patching
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#how-kernel-live-patching-works_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.5. How kernel live patching works
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#subscribing-the-currently-installed-kernels-to-the-live-patching-stream_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.6. Subscribing the currently installed kernels to the live patching stream
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#automatically-subscribing-any-future-kernel-to-the-live-patching-stream_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.7. Automatically subscribing any future kernel to the live patching stream
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_disabling-automatic-subscription-to-the-live-patching-stream.adoc_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.8. Disabling automatic subscription to the live patching stream
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#updating-kernel-patch-modules_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.9. Updating kernel patch modules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#removing-the-live-patching-package_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.10. Removing the live patching package
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#uninstalling-the-kernel-patch-module_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.11. Uninstalling the kernel patch module
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#disabling-kpatch-service_applying-patches-with-kernel-live-patching" class="j-doc-nav__link ">
    7.12. Disabling kpatch.service
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#keeping-kernel-panic-parameters-disabled-in-virtualized-environments_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    8. Keeping kernel panic parameters disabled in virtualized environments
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-maohu47">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8. Keeping kernel panic parameters disabled in virtualized environments"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8. Keeping kernel panic parameters disabled in virtualized environments"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-maohu47" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#what-is-a-soft-lockup_keeping-kernel-panic-parameters-disabled-in-virtualized-environments" class="j-doc-nav__link ">
    8.1. What is a soft lockup
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#parameters-controlling-kernel-panic_keeping-kernel-panic-parameters-disabled-in-virtualized-environments" class="j-doc-nav__link ">
    8.2. Parameters controlling kernel panic
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#spurious-soft-lockups-in-virtualized-environments_keeping-kernel-panic-parameters-disabled-in-virtualized-environments" class="j-doc-nav__link ">
    8.3. Spurious soft lockups in virtualized environments
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#adjusting-kernel-parameters-for-database-servers_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    9. Adjusting kernel parameters for database servers
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-05yux4h">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "9. Adjusting kernel parameters for database servers"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "9. Adjusting kernel parameters for database servers"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-05yux4h" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-databases_adjusting-kernel-parameters-for-database-servers" class="j-doc-nav__link ">
    9.1. Introduction to database servers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#parameters-affecting-performance-of-database-applications_adjusting-kernel-parameters-for-database-servers" class="j-doc-nav__link ">
    9.2. Parameters affecting performance of database applications
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#getting-started-with-kernel-logging_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    10. Getting started with kernel logging
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-or393ci">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10. Getting started with kernel logging"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10. Getting started with kernel logging"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-or393ci" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#what-is-the-kernel-ring-buffer_getting-started-with-kernel-logging" class="j-doc-nav__link ">
    10.1. What is the kernel ring buffer
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#role-of-printk-on-log-levels-and-kernel-logging_getting-started-with-kernel-logging" class="j-doc-nav__link ">
    10.2. Role of printk on log-levels and kernel logging
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#signing-a-kernel-and-modules-for-secure-boot_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    11. Signing a kernel and modules for Secure Boot
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-p64mbvk">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "11. Signing a kernel and modules for Secure Boot"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "11. Signing a kernel and modules for Secure Boot"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-p64mbvk" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#prerequisites" class="j-doc-nav__link ">
    11.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#con_what-is-uefi-secure-boot_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.2. What is UEFI Secure Boot
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#con_uefi-secure-boot-support_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.3. UEFI Secure Boot support
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#ref_requirements-for-authenticating-kernel-modules-with-x-509-keys_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.4. Requirements for authenticating kernel modules with X.509 keys
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#sources-for-public-keys_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.5. Sources for public keys
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#generating-a-public-and-private-key-pair_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.6. Generating a public and private key pair
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#example-output-of-system-keyrings_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.7. Example output of system keyrings
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#enrolling-public-key-on-target-system-by-adding-the-public-key-to-the-mok-list_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.8. Enrolling public key on target system by adding the public key to the MOK list
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#signing-a-kernel-with-the-private-key_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.9. Signing a kernel with the private key
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#signing-a-grub-build-with-the-private-key_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.10. Signing a GRUB build with the private key
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#signing-kernel-modules-with-the-private-key_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.11. Signing kernel modules with the private key
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#loading-signed-kernel-modules_signing-a-kernel-and-modules-for-secure-boot" class="j-doc-nav__link ">
    11.12. Loading signed kernel modules
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#updating-the-secure-boot-revocation-list_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    12. Updating the Secure Boot Revocation List
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-tjodxz7">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12. Updating the Secure Boot Revocation List"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12. Updating the Secure Boot Revocation List"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-tjodxz7" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#prerequisites_2" class="j-doc-nav__link ">
    12.1. Prerequisites
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#con_what-is-uefi-secure-boot_updating-the-secure-boot-revocation-list" class="j-doc-nav__link ">
    12.2. What is UEFI Secure Boot
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-secure-boot-revocation-list_updating-the-secure-boot-revocation-list" class="j-doc-nav__link ">
    12.3. The Secure Boot Revocation List
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#applying-an-online-revocation-list-update_updating-the-secure-boot-revocation-list" class="j-doc-nav__link ">
    12.4. Applying an online Revocation List update
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#applying-an-offline-revocation-list-update_updating-the-secure-boot-revocation-list" class="j-doc-nav__link ">
    12.5. Applying an offline Revocation List update
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    13. Enhancing security with the kernel integrity subsystem
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-66hf23t">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "13. Enhancing security with the kernel integrity subsystem"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "13. Enhancing security with the kernel integrity subsystem"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-66hf23t" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-kernel-integrity-subsystem_enhancing-security-with-the-kernel-integrity-subsystem" class="j-doc-nav__link ">
    13.1. The kernel integrity subsystem
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#trusted-and-encrypted-keys_enhancing-security-with-the-kernel-integrity-subsystem" class="j-doc-nav__link ">
    13.2. Trusted and encrypted keys
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#working-with-trusted-keys_enhancing-security-with-the-kernel-integrity-subsystem" class="j-doc-nav__link ">
    13.3. Working with trusted keys
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#working-with-encrypted-keys_enhancing-security-with-the-kernel-integrity-subsystem" class="j-doc-nav__link ">
    13.4. Working with encrypted keys
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#enabling-integrity-measurement-architecture-and-extended-verification-module_enhancing-security-with-the-kernel-integrity-subsystem" class="j-doc-nav__link ">
    13.5. Enabling IMA and EVM
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#collecting-file-hashes-with-integrity-measurement-architecture_enhancing-security-with-the-kernel-integrity-subsystem" class="j-doc-nav__link ">
    13.6. Collecting file hashes with integrity measurement architecture
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_using-systemd-to-manage-resources-used-by-applications_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    14. Using systemd to manage resources used by applications
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-gr0a0px">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "14. Using systemd to manage resources used by applications"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "14. Using systemd to manage resources used by applications"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-gr0a0px" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_allocating-system-resources-using-systemd_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.1. Allocating system resources using systemd
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#con_role-of-systemd-in-resource-management_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.2. Role of systemd in resource management
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#con_overview-of-systemd-hierarchy-for-cgroups_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.3. Overview of systemd hierarchy for cgroups
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#listing-systemd_units_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.4. Listing systemd units
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#viewing-systemd-control-group-hierarchy_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.5. Viewing systemd control group hierarchy
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_viewing-cgroups-of-processes_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.6. Viewing cgroups of processes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#monitoring-resource-consumption_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.7. Monitoring resource consumption
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_using-systemd-unit-files-to-set-limits-for-applications_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.8. Using systemd unit files to set limits for applications
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_using-systemctl-command-to-set-limits-to-applications_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.9. Using systemctl command to set limits to applications
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_setting-global-default-cpu-affinity-through-manager-configuration_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.10. Setting global default CPU affinity through manager configuration
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_configuring-numa-using-systemd_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.11. Configuring NUMA policies using systemd
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#ref_numa-policy-configuration-options-with-systemd_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.12. NUMA policy configuration options for systemd
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#creating-transient-control-groups_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.13. Creating transient cgroups using systemd-run command
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#removing-transient-control-groups_assembly_using-systemd-to-manage-resources-used-by-applications" class="j-doc-nav__link ">
    14.14. Removing transient control groups
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#setting-limits-for-applications_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    15. Understanding control groups
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-4ponc0k">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15. Understanding control groups"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15. Understanding control groups"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-4ponc0k" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#understanding-control-groups_setting-limits-for-applications" class="j-doc-nav__link ">
    15.1. Introducing control groups
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#what-kernel-resource-controllers-are_setting-limits-for-applications" class="j-doc-nav__link ">
    15.2. Introducing kernel resource controllers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#what-namespaces-are_setting-limits-for-applications" class="j-doc-nav__link ">
    15.3. Introducing namespaces
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_using-cgroupfs-to-manually-manage-cgroups_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    16. Using cgroupfs to manually manage cgroups
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-qfhb07a">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16. Using cgroupfs to manually manage cgroups"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16. Using cgroupfs to manually manage cgroups"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-qfhb07a" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_creating-cgroups-and-enabling-controllers-in-cgroups-v2-file-system_assembly_using-cgroupfs-to-manually-manage-cgroups" class="j-doc-nav__link ">
    16.1. Creating cgroups and enabling controllers in cgroups-v2 file system
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_controlling-distribution-of-cpu-time-for-applications-by-adjusting-cpu-weight_assembly_using-cgroupfs-to-manually-manage-cgroups" class="j-doc-nav__link ">
    16.2. Controlling distribution of CPU time for applications by adjusting CPU weight
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_mounting-cgroups-v1_assembly_using-cgroupfs-to-manually-manage-cgroups" class="j-doc-nav__link ">
    16.3. Mounting cgroups-v1
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#setting-cpu-limits-to-applications-using-cgroups-v1_assembly_using-cgroupfs-to-manually-manage-cgroups" class="j-doc-nav__link ">
    16.4. Setting CPU limits to applications using cgroups-v1
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#analyzing-system-performance-with-bpf-compiler_collection_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    17. Analyzing system performance with BPF Compiler Collection
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-5e2bvur">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "17. Analyzing system performance with BPF Compiler Collection"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "17. Analyzing system performance with BPF Compiler Collection"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-5e2bvur" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#installing-the-bcc-tools-package_analyzing-system-performance-with-bpf-compiler_collection" class="j-doc-nav__link ">
    17.1. Installing the bcc-tools package
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-selected-bcc-tools-for-performance-analyses_analyzing-system-performance-with-bpf-compiler_collection" class="j-doc-nav__link ">
    17.2. Using selected bcc-tools for performance analyses
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#installing-kdump_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    18. Installing kdump
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-fbgz1om">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "18. Installing kdump"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "18. Installing kdump"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-fbgz1om" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#what-is-kdumpinstalling-kdump" class="j-doc-nav__link ">
    18.1. What is kdump
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#installing-kdump-anacondainstalling-kdump" class="j-doc-nav__link ">
    18.2. Installing kdump using Anaconda
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#installing-kdump-command-lineinstalling-kdump" class="j-doc-nav__link ">
    18.3. Installing kdump on the command line
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-kdump-on-the-command-line_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    19. Configuring kdump on the command line
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-d4e5hck">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "19. Configuring kdump on the command line"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "19. Configuring kdump on the command line"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-d4e5hck" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#estimating-the-kdump-size_configuring-kdump-on-the-command-line" class="j-doc-nav__link ">
    19.1. Estimating the kdump size
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-kdump-memory-usage_configuring-kdump-on-the-command-line" class="j-doc-nav__link ">
    19.2. Configuring kdump memory usage
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-the-kdump-target_configuring-kdump-on-the-command-line" class="j-doc-nav__link ">
    19.3. Configuring the kdump target
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-the-kdump-core-collectorconfiguring-kdump-on-the-command-line" class="j-doc-nav__link ">
    19.4. Configuring the kdump core collector
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-the-kdump-default-failure-responses_configuring-kdump-on-the-command-line" class="j-doc-nav__link ">
    19.5. Configuring the kdump default failure responses
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuration-file-for-kdump_configuring-kdump-on-the-command-line" class="j-doc-nav__link ">
    19.6. Configuration file for kdump
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#testing-the-kdump-configuration_configuring-kdump-on-the-command-line" class="j-doc-nav__link ">
    19.7. Testing the kdump configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#enabling-kdumpmanaging-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    20. Enabling kdump
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-oaf9weg">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "20. Enabling kdump"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "20. Enabling kdump"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-oaf9weg" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#enabling-kdump-for-all-installed-kernels_enabling-kdump" class="j-doc-nav__link ">
    20.1. Enabling kdump for all installed kernels
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#enabling-kdump-for-a-specific-installed-kernel_enabling-kdump" class="j-doc-nav__link ">
    20.2. Enabling kdump for a specific installed kernel
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#disabling-the-kdump-service_enabling-kdump" class="j-doc-nav__link ">
    20.3. Disabling the kdump service
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#supported-kdump-configurations-and-targets_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    21. Supported kdump configurations and targets
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-o1kczfw">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "21. Supported kdump configurations and targets"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "21. Supported kdump configurations and targets"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-o1kczfw" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#memory-requirements-for-kdump_supported-kdump-configurations-and-targets" class="j-doc-nav__link ">
    21.1. Memory requirements for kdump
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#minimum-threshold-for-memory-reservation_supported-kdump-configurations-and-targets" class="j-doc-nav__link ">
    21.2. Minimum threshold for memory reservation
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#supported-kdump-targets_supported-kdump-configurations-and-targets" class="j-doc-nav__link ">
    21.3. Supported kdump targets
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#supported-kdump-filtering-levels_supported-kdump-configurations-and-targets" class="j-doc-nav__link ">
    21.4. Supported kdump filtering levels
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#supported-default-failure-responses_supported-kdump-configurations-and-targets" class="j-doc-nav__link ">
    21.5. Supported default failure responses
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-final_action-parameter_supported-kdump-configurations-and-targets" class="j-doc-nav__link ">
    21.6. Using final_action parameter
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_using-failure_action-parameter_supported-kdump-configurations-and-targets" class="j-doc-nav__link ">
    21.7. Using failure_action parameter
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#firmware-assisted-dump-mechanisms_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    22. Firmware assisted dump mechanisms
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-mzfpnqu">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "22. Firmware assisted dump mechanisms"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "22. Firmware assisted dump mechanisms"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-mzfpnqu" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#firmware-assisted-dump-on-ibm-powerpc-hardware_firmware-assisted-dump-mechanisms" class="j-doc-nav__link ">
    22.1. Firmware assisted dump on IBM PowerPC hardware
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#enabling-firmware-assisted-dump-mechanism_firmware-assisted-dump-mechanisms" class="j-doc-nav__link ">
    22.2. Enabling firmware assisted dump mechanism
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#firmware-assisted-dump-mechanisms-on-ibm-z-hardware_firmware-assisted-dump-mechanisms" class="j-doc-nav__link ">
    22.3. Firmware assisted dump mechanisms on IBM Z hardware
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-sadump-on-fujitsu-primequest-systems_firmware-assisted-dump-mechanisms" class="j-doc-nav__link ">
    22.4. Using sadump on Fujitsu PRIMEQUEST systems
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#analyzing-a-core-dump_managing-monitoring-and-updating-the-kernel" class="j-doc-nav__link j-doc-nav__link--has-children">
    23. Analyzing a core dump
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-eu2li7t">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "23. Analyzing a core dump"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "23. Analyzing a core dump"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-eu2li7t" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#installing-the-crash-utility_analyzing-a-core-dump" class="j-doc-nav__link ">
    23.1. Installing the crash utility
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#running-and-exiting-the-crash-utility_analyzing-a-core-dump" class="j-doc-nav__link ">
    23.2. Running and exiting the crash utility
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#displaying-various-indicators-in-the-crash-utility_analyzing-a-core-dump" class="j-doc-nav__link ">
    23.3. Displaying various indicators in the crash utility
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-kernel-oops-analyzer_analyzing-a-core-dump" class="j-doc-nav__link ">
    23.4. Using Kernel Oops Analyzer
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-kdump-helper-tool_analyzing-a-core-dump" class="j-doc-nav__link ">
    23.5. The Kdump Helper tool
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#idm139983853182880" class="j-doc-nav__link ">
    Legal Notice
  </a>
  
          </li>
              </ol>
    
  </div>
</nav>


              </div>
            </div>
            <div class="j-options-container j-options-container--mobile">
              <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--options content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-nqdi6dn">
                <span class="j-sidebar__menu-trigger__open-headline">
                  Settings
                </span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>
              

  <ul class="j-doc-options__list content-expander content-expander--processed" id="content-expander-nqdi6dn" aria-hidden="true">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language">
        Language:
      </label>
      <select id="j-doc-language" class="j-doc-option__select" data-ddg-inputtype="unknown">
                  <option value="/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">
            
          </option>
                  <option value="/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">
            
          </option>
                  <option value="/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">
            
          </option>
                  <option value="/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel" selected="selected">
            English
          </option>
                  <option value="/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">
            Franais
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel"></a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel"></a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel"></a>
            </li>
                      <li>
              <a href="/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">English</a>
            </li>
                      <li>
              <a href="/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">Franais</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode" class="j-doc-option__select" data-ddg-inputtype="unknown">
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel" class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel" selected="selected" class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/pdf/managing_monitoring_and_updating_the_kernel/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US.pdf" class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/red_hat_enterprise_linux/9/pdf/managing_monitoring_and_updating_the_kernel/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


              </div>
          </div>
                <div class="pvof-doc__tertiary-sidebar j-doc__tertiary-sidebar j-doc__tertiary-sidebar--sticky">
          <div class="pvof-doc__tertiary-sidebar__inner j-doc__tertiary-sidebar__inner"><div id="j-reading-mode-toggle" class="j-switch__wrapper j-reading-mode__toggle"><input type="checkbox" name="reading-mode" value="false" id="reading-mode-checkbox" class="j-reading-mode j-switch__input visually-hidden"><label for="reading-mode-checkbox" class="j-switch__label">Focus mode<span class="j-reading-mode__shortcut-hint" hidden=""><kbd>F</kbd></span><div class="j-switch"></div></label></div>
            <div class="j-doc__doc-options">
              <div class="j-options-container j-options-container--desktop j-options-container--desktop--processed">
                <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--tablet content-expander__trigger content-expander__trigger--processed" aria-expanded="true" aria-controls="content-expander-b4emf3u">
                  <span class="j-sidebar__menu-trigger-icon"></span>
                  <h2 class="visually-hidden">Language and Page Formatting Options</h2>
                </button>
                  

  <ul class="j-doc-options__list content-expander content-expander--processed" id="content-expander-b4emf3u" open="">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language--2">
        Language:
      </label>
      <select id="j-doc-language--2" class="j-doc-option__select" data-ddg-inputtype="unknown">
                  <option value="/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">
            
          </option>
                  <option value="/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">
            
          </option>
                  <option value="/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">
            
          </option>
                  <option value="/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel" selected="selected">
            English
          </option>
                  <option value="/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">
            Franais
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel"></a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel"></a>
            </li>
                      <li>
              <a href="/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel"></a>
            </li>
                      <li>
              <a href="/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">English</a>
            </li>
                      <li>
              <a href="/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">Franais</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode--2" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode--2" class="j-doc-option__select" data-ddg-inputtype="unknown">
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel" class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel" selected="selected" class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/pdf/managing_monitoring_and_updating_the_kernel/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US.pdf" class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/red_hat_enterprise_linux/9/pdf/managing_monitoring_and_updating_the_kernel/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


                </div>
              </div>
          </div>
        </div>

                  <div class="doc-wrapper pvof-doc__wrapper j-superdoc__content-wrapper" id="doc-wrapper">
            

  <div class="pane-page-title">
    <h1 class="title" itemprop="name">Managing, monitoring, and updating the kernel</h1>
  </div>


  <div xml:lang="en-US" class="book" id="idm139983845977424"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red&nbsp;Hat Enterprise&nbsp;Linux</span> <span class="productnumber">9</span></div><div><h2 class="subtitle">A guide to managing the Linux kernel on Red Hat Enterprise Linux 9</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red&nbsp;Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="#idm139983853182880">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				As a system administrator, you can configure the Linux kernel to 
optimize the operating system. Changes to the Linux kernel can improve 
system performance, security, and stability, as well as your ability to 
audit the system and troubleshoot problems.
			</div></div></div></div><hr></div><section class="preface" id="making-open-source-more-inclusive"><div class="titlepage"><div><div><h1 class="title">Making open source more inclusive</h1></div></div></div><p class="_abstract _abstract">
			Red Hat is committed to replacing problematic language in our code, 
documentation, and web properties. We are beginning with these four 
terms: master, slave, blacklist, and whitelist. Because of the enormity 
of this endeavor, these changes will be implemented gradually over 
several upcoming releases. For more details, see <a class="link" href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language">our CTO Chris Wrights message</a>.
		</p></section><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Providing feedback on Red Hat documentation</h1></div></div></div><p class="_abstract _abstract">
			We appreciate your feedback on our documentation. Let us know how we can improve it.
		</p><div class="orderedlist"><p class="title"><strong>Submitting comments on specific passages</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					View the documentation in the <span class="strong strong"><strong>Multi-page HTML</strong></span> format and ensure that you see the <span class="strong strong"><strong>Feedback</strong></span> button in the upper right corner after the page fully loads.
				</li><li class="listitem">
					Use your cursor to highlight the part of the text that you want to comment on.
				</li><li class="listitem">
					Click the <span class="strong strong"><strong>Add Feedback</strong></span> button that appears near the highlighted text.
				</li><li class="listitem">
					Add your feedback and click <span class="strong strong"><strong>Submit</strong></span>.
				</li></ol></div><div class="orderedlist"><p class="title"><strong>Submitting feedback through Bugzilla (account required)</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Log in to the <a class="link" href="https://bugzilla.redhat.com/enter_bug.cgi?product=Red%20Hat%20Enterprise%20Linux%209&amp;component=Documentation">Bugzilla</a> website.
				</li><li class="listitem">
					Select the correct version from the <span class="strong strong"><strong>Version</strong></span> menu.
				</li><li class="listitem">
					Enter a descriptive title in the <span class="strong strong"><strong>Summary</strong></span> field.
				</li><li class="listitem">
					Enter your suggestion for improvement in the <span class="strong strong"><strong>Description</strong></span> field. Include links to the relevant parts of the documentation.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Submit Bug</strong></span>.
				</li></ol></div></section><section class="chapter" id="assembly_the-linux-kernel_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 1. The Linux kernel</h1></div></div></div><p>
			Learn about the Linux kernel and the Linux kernel RPM package 
provided and maintained by Red Hat (Red&nbsp;Hat&nbsp;kernel). Keep the 
Red&nbsp;Hat&nbsp;kernel updated, which ensures the operating system has
 all the latest bug fixes, performance enhancements, and patches, and is
 compatible with new hardware.
		</p><section class="section" id="what-the-kernel-is_assembly_the-linux-kernel"><div class="titlepage"><div><div><h2 class="title">1.1. What the kernel is</h2></div></div></div><p class="_abstract _abstract">
				The kernel is a core part of a Linux operating system that manages 
the system resources and provides interface between hardware and 
software applications. The Red&nbsp;Hat&nbsp;kernel is a custom-built 
kernel based on the upstream Linux mainline kernel that 
Red&nbsp;Hat&nbsp;engineers further develop and harden with a focus on 
stability and compatibility with the latest technologies and hardware.
			</p><p>
				Before Red&nbsp;Hat releases a new kernel version, the kernel needs to pass a set of rigorous quality assurance tests.
			</p><p>
				The Red&nbsp;Hat kernels are packaged in the RPM format so that they are easily upgraded and verified by the <span class="strong strong"><strong><span class="application application">dnf</span></strong></span> package manager.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Kernels that have not been compiled by Red&nbsp;Hat are <span class="strong strong"><strong>not</strong></span> supported by Red&nbsp;Hat.
				</p></div></div></section><section class="section" id="con_rpm-packages_assembly_the-linux-kernel"><div class="titlepage"><div><div><h2 class="title">1.2. RPM packages</h2></div></div></div><p class="_abstract _abstract">
				An RPM package is a file containing other files and their metadata 
(information about the files that are needed by the system).
			</p><p>
				Specifically, an RPM package consists of the <code class="literal">cpio</code> archive.
			</p><p>
				The <code class="literal">cpio</code> archive contains:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Files
					</li><li class="listitem"><p class="simpara">
						RPM header (package metadata)
					</p><p class="simpara">
						The <code class="literal">rpm</code> package manager uses this metadata to determine dependencies, where to install files, and other information.
					</p></li></ul></div><h4 id="types_of_rpm_packages">Types of RPM packages</h4><p>
				There are two types of RPM packages. Both types share the file 
format and tooling, but have different contents and serve different 
purposes:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Source RPM (SRPM)
					</p><p class="simpara">
						An SRPM contains source code and a SPEC file, which describes how 
to build the source code into a binary RPM. Optionally, the patches to 
source code are included as well.
					</p></li><li class="listitem"><p class="simpara">
						Binary RPM
					</p><p class="simpara">
						A binary RPM contains the binaries built from the sources and patches.
					</p></li></ul></div></section><section class="section" id="the-linux-kernel-rpm-package-overview_assembly_the-linux-kernel"><div class="titlepage"><div><div><h2 class="title">1.3. The Linux kernel RPM package overview</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">kernel</code> RPM is a meta package that 
does not contain any files, but rather ensures that the following 
required sub-packages are properly installed:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal package">kernel-core</code> - contains the binary image of the Linux kernel (<code class="literal">vmlinuz</code>).
					</li><li class="listitem">
						<code class="literal package">kernel-modules-core</code> - 
contains the basic kernel modules to ensure core functionality. This 
includes the modules essential for the proper functioning of the most 
commonly used hardware.
					</li><li class="listitem">
						<code class="literal package">kernel-modules</code> - contains the remaining kernel modules that are not present in <code class="literal">kernel-core</code>.
					</li></ul></div><p>
				The <code class="literal">kernel-core</code> and <code class="literal">kernel-modules-core</code>
 sub-packages together can be used in virtualized and cloud environments
 to provide a RHEL 9 kernel with a quick boot time and a small disk size
 footprint. <code class="literal">kernel-modules</code> sub-package is usually unnecessary for such deployments.
			</p><p>
				Optional kernel packages are for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal package">kernel-modules-extra</code> - contains kernel modules for rare hardware and modules which loading is disabled by default.
					</li><li class="listitem">
						<code class="literal package">kernel-debug</code>  contains a kernel with numerous debugging options enabled for kernel diagnosis, at the expense of reduced performance.
					</li><li class="listitem">
						<code class="literal package">kernel-tools</code>  contains tools for manipulating the Linux kernel and supporting documentation.
					</li><li class="listitem">
						<code class="literal package">kernel-devel</code>  contains the kernel headers and makefiles sufficient to build modules against the <code class="literal package">kernel</code> package.
					</li><li class="listitem">
						<code class="literal package">kernel-abi-stablelists</code>  
contains information pertaining to the RHEL kernel ABI, including a list
 of kernel symbols that are needed by external Linux kernel modules and a
 <code class="literal package">dnf</code> plug-in to aid enforcement.
					</li><li class="listitem">
						<code class="literal package">kernel-headers</code>  includes the
 C header files that specify the interface between the Linux kernel and 
user-space libraries and programs. The header files define structures 
and constants that are needed for building most standard programs.
					</li><li class="listitem"><p class="simpara">
						<code class="literal package">kernel-uki-virt</code> - contains the Unified Kernel Image (UKI) of the RHEL kernel. UKI combines the Linux kernel, <code class="literal">initramfs</code>, and the kernel command line into a single signed binary which can be booted directly from the UEFI firmaware. <code class="literal">kernel-uki-virt</code> contains the required kernel modules to run in virtualized and cloud environments and can be used instead of the <code class="literal">kernel-core</code> sub-package.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							<code class="literal">kernel-uki-virt</code> is provided as Technology Preview in RHEL 9.2.
						</p></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/articles/3739611">What are the kernel-core, kernel-modules, and kernel-modules-extras packages?</a></span></em></span>
					</li></ul></div></section><section class="section" id="displaying-contents-of-the-kernel-package_assembly_the-linux-kernel"><div class="titlepage"><div><div><h2 class="title">1.4. Displaying contents of the kernel package</h2></div></div></div><p class="_abstract _abstract">
				View the contents of the kernel package and its sub-packages without installing them using the <code class="literal">rpm</code> command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Obtained <code class="literal package">kernel</code>, <code class="literal package">kernel-core</code>, <code class="literal package">kernel-modules</code>, <code class="literal package">kernel-modules-extra</code> RPM packages for your CPU architecture
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						List modules for <code class="literal packge">kernel</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--cbk0s31"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout codeblock codeblock--processed language-none" tabindex="0"><code class="literal command language-none">$ <span class="strong strong"><strong>rpm -qlp &lt;<span class="emphasis"><em>kernel_rpm</em></span>&gt;</strong></span></code>
(contains no files)
</pre></div></div></li><li class="listitem">
						List modules for <code class="literal package">kernel-core</code>:
					</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--luqkzq2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout codeblock codeblock--processed language-none" tabindex="0"><code class="literal command language-none">$ <span class="strong strong"><strong>rpm -qlp &lt;<span class="emphasis"><em>kernel-core_rpm</em></span>&gt;</strong></span></code>

/lib/modules/5.14.0-1.el9.x86_64/kernel/fs/udf/udf.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/kernel/fs/xfs
/lib/modules/5.14.0-1.el9.x86_64/kernel/fs/xfs/xfs.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/kernel/kernel
/lib/modules/5.14.0-1.el9.x86_64/kernel/kernel/trace
/lib/modules/5.14.0-1.el9.x86_64/kernel/kernel/trace/ring_buffer_benchmark.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/kernel/lib
/lib/modules/5.14.0-1.el9.x86_64/kernel/lib/cordic.ko.xz
</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						List modules for <code class="literal package">kernel-modules</code>:
					</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mualvex"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout codeblock codeblock--processed language-none" tabindex="0"><code class="literal command language-none">$ <span class="strong strong"><strong>rpm -qlp &lt;<span class="emphasis"><em>kernel-modules_rpm</em></span>&gt;</strong></span></code>

/lib/modules/5.14.0-1.el9.x86_64/kernel/drivers/infiniband/hw/mlx4/mlx4_ib.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/kernel/drivers/infiniband/hw/mlx5/mlx5_ib.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/kernel/drivers/infiniband/hw/qedr/qedr.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/kernel/drivers/infiniband/hw/usnic/usnic_verbs.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/kernel/drivers/infiniband/hw/vmw_pvrdma/vmw_pvrdma.ko.xz
</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						List modules for <code class="literal package">kernel-modules-extra</code>:
					</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--55g7duh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout codeblock codeblock--processed language-none" tabindex="0"><code class="literal command language-none">$ <span class="strong strong"><strong>rpm -qlp &lt;<span class="emphasis"><em>kernel-modules-extra_rpm</em></span>&gt;</strong></span></code>

/lib/modules/5.14.0-1.el9.x86_64/extra/net/sched/sch_cbq.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/extra/net/sched/sch_choke.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/extra/net/sched/sch_drr.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/extra/net/sched/sch_dsmark.ko.xz
/lib/modules/5.14.0-1.el9.x86_64/extra/net/sched/sch_gred.ko.xz
</pre></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">rpm(8)</code> manual page
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/packaging_and_distributing_software/index#con_rpm-packages_packaging-software">RPM packages</a>
					</li></ul></div></section><section class="section" id="installing-the-kernel_assembly_the-linux-kernel"><div class="titlepage"><div><div><h2 class="title">1.5. Installing specific kernel versions</h2></div></div></div><p class="_abstract _abstract">
				Install new kernels using the <span class="strong strong"><strong><span class="application application">dnf</span></strong></span> package manager.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To install a specific kernel version, enter the following command:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--j4sug03"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf install kernel-<span class="emphasis"><em>{version}</em></span></strong></span></pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/labs/rhcb/">Red Hat Code Browser</a></span></em></span>
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/articles/3078">Red Hat Enterprise Linux Release Dates </a></span></em></span>
					</li></ul></div></section><section class="section" id="updating-the-kernel_assembly_the-linux-kernel"><div class="titlepage"><div><div><h2 class="title">1.6. Updating the kernel</h2></div></div></div><p class="_abstract _abstract">
				Update the kernel using the <span class="strong strong"><strong><span class="application application">dnf</span></strong></span> package manager.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To update the kernel, enter the following command:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ovny40n"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf update kernel</strong></span></pre></div></div><p class="simpara">
						This command updates the kernel along with all dependencies to the latest available version.
					</p></li><li class="listitem">
						Reboot your system for the changes to take effect.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_software_with_the_dnf_tool/con_software-management-tools-in-red-hat-enterprise-linux-9_managing-software-with-the-dnf-tool">package manager</a>
					</li><li class="listitem">
						The <code class="literal">dnf(8)</code> manual page
					</li></ul></div></section><section class="section" id="setting-a-kernel-as-default_assembly_the-linux-kernel"><div class="titlepage"><div><div><h2 class="title">1.7. Setting a kernel as default</h2></div></div></div><p class="_abstract _abstract">
				Set a specific kernel as default using the <code class="literal">grubby</code> command-line tool and GRUB.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Setting the kernel as default, using the <code class="literal">grubby</code> tool
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								Enter the following command to set the kernel as default using the <code class="literal">grubby</code> tool:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--on5zas3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --set-default $kernel_path</strong></span></pre></div></div><p class="simpara">
								The command uses a machine ID without the <code class="literal">.conf</code> suffix as an argument.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The machine ID is located in the <code class="literal">/boot/loader/entries/</code> directory.
								</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Setting the kernel as default, using the <code class="literal">id</code> argument
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								List the boot entries using the <code class="literal">id</code> argument and then set an intended kernel as default:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rc0m3kn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --info ALL | grep id</strong></span>
# <span class="strong strong"><strong>grubby --set-default /boot/vmlinuz-&lt;version&gt;.&lt;architecture&gt;</strong></span></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									To list the boot entries using the <code class="literal">title</code> argument, execute the <code class="literal"># <span class="strong strong"><strong>grubby --info=ALL | grep title</strong></span></code> command.
								</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Setting the default kernel for only the next boot
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								Execute the following command to set the default kernel for only the next reboot using the <code class="literal">grub2-reboot</code> command:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--exg45nd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grub2-reboot &lt;index|title|id&gt;</strong></span></pre></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
									Set the default kernel for only the next boot with care. 
Installing new kernel RPMs, self-built kernels, and manually adding the
 entries to the <code class="literal">/boot/loader/entries/</code> directory may change the index values.
								</p></div></div></li></ul></div></li></ul></div></section></section><section class="chapter" id="what-is-kernel-64k_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 2. The 64k page size kernel</h1></div></div></div><p>
			<code class="literal">kernel-64k</code> is an additional, optional 
64-bit ARM architecture kernel package that supports 64k pages. This 
additional kernel exists alongside the RHEL 9 for ARM kernel which 
supports 4k pages.
		</p><p>
			Optimal system performance directly relates to different memory 
configuration requirements. These requirements are addressed by the two 
variants of kernel, each suitable for different workloads. RHEL 9 on 
64-bit ARM hardware thus offers two MMU page sizes:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					4k pages kernel for efficient memory usage in smaller environments,
				</li><li class="listitem">
					<code class="literal">kernel-64k</code> for workloads with large, contiguous memory working sets.
				</li></ul></div><p>
			The 4k pages kernel and <code class="literal">kernel-64k</code> do 
not differ in the user experience as the user space is the same. You can
 choose the variant that addresses your situation the best.
		</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">4k pages kernel</span></dt><dd><p class="simpara">
						Use 4k pages for more efficient memory usage in smaller 
environments, such as those in Edge and lower-cost, small cloud 
instances. In these environments, increasing the physical system memory 
amounts is not practical due to space, power, and cost constraints. 
Also, not all 64-bit ARM architecture processors support a 64k page 
size.
					</p><p class="simpara">
						The 4k pages kernel supports graphical installation using 
Anaconda, system or cloud image-based installations, as well as advanced
 installations using Kickstart.
					</p></dd><dt><span class="term"><code class="literal">kernel-64k</code></span></dt><dd><p class="simpara">
						The 64k page size kernel is a useful option for large datasets on ARM platforms. <code class="literal">kernel-64k</code>
 is suitable for memory-intensive workloads as it has significant gains 
in overall system performance, namely in large database, HPC, and high 
network performance.
					</p><p class="simpara">
						You must choose page size on 64-bit ARM architecture systems at the time of installation. You can install <code class="literal">kernel-64k</code> only by Kickstart by adding the <code class="literal">kernel-64k</code> package to the package list in the <code class="literal">Kickstart</code> file.
					</p></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/performing_an_advanced_rhel_9_installation/index#installing-rhel-on-arm-with-kernel-64k_installing-rhel-as-an-experienced-user">Installing RHEL on ARM with Kernel-64k</a>
				</li></ul></div></section><section class="chapter" id="managing-kernel-modules_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Managing kernel modules</h1></div></div></div><p class="_abstract _abstract">
			Learn about kernel modules, how to display their information, and how
 to perform basic administrative tasks with kernel modules.
		</p><section class="section" id="introduction-to-kernel-modules_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.1. Introduction to kernel modules</h2></div></div></div><p class="_abstract _abstract">
				The Red&nbsp;Hat Enterprise&nbsp;Linux kernel can be extended with 
optional, additional pieces of functionality, called kernel modules, 
without having to reboot the system. On Red&nbsp;Hat 
Enterprise&nbsp;Linux&nbsp;9, kernel modules are extra kernel code which
 is built into compressed <code class="literal file">&lt;KERNEL_MODULE_NAME&gt;.ko.xz</code> object files.
			</p><p>
				The most common functionality enabled by kernel modules are:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Device driver which adds support for new hardware
					</li><li class="listitem">
						Support for a file system such as <code class="literal">GFS2</code> or <code class="literal">NFS</code>
					</li><li class="listitem">
						System calls
					</li></ul></div><p>
				On modern systems, kernel modules are automatically loaded when 
needed. However, in some cases it is necessary to load or unload modules
 manually.
			</p><p>
				Like the kernel itself, the modules can take parameters that customize their behavior if needed.
			</p><p>
				Tooling is provided to inspect which modules are currently running, 
which modules are available to load into the kernel and which parameters
 a module accepts. The tooling also provides a mechanism to load and 
unload kernel modules into the running kernel.
			</p></section><section class="section" id="kernel-module-dependencies_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.2. Kernel module dependencies</h2></div></div></div><p class="_abstract _abstract">
				Certain kernel modules sometimes depend on one or more other kernel modules. The <code class="literal file">/lib/modules/&lt;KERNEL_VERSION&gt;/modules.dep</code> file contains a complete list of kernel module dependencies for the respective kernel version.
			</p><div class="formalpara"><p class="title"><strong><code class="literal">depmod</code></strong></p><p>
					The dependency file is generated by the <code class="literal utility">depmod</code> program, which is a part of the <code class="literal package">kmod</code> package. Many of the utilities provided by <code class="literal package">kmod</code> take module dependencies into account when performing operations so that <span class="strong strong"><strong>manual</strong></span> dependency-tracking is rarely necessary.
				</p></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The code of kernel modules is executed in kernel-space in the 
unrestricted mode. Because of this, you should be mindful of what 
modules you are loading.
				</p></div></div><div class="formalpara"><p class="title"><strong><code class="literal">weak-modules</code></strong></p><p>
					In addition to <code class="literal utility">depmod</code>, Red Hat Enterprise Linux provides the <code class="literal">weak-modules</code> script shipped also with the <code class="literal package">kmod</code> package. <code class="literal">weak-modules</code> determines which modules are kABI-compatible with installed kernels. While checking modules kernel compatibility, <code class="literal">weak-modules</code> processes modules symbol dependencies from higher to lower release of kernel for which they were built. This means that <code class="literal">weak-modules</code> processes each module independently of kernel release they were built against.
				</p></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">modules.dep(5)</code> manual page
					</li><li class="listitem">
						The <code class="literal">depmod(8)</code> manual page
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/9749">What is the purpose of weak-modules script shipped with Red Hat Enterprise Linux?</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/444773">What is Kernel Application Binary Interface (kABI)?</a>
					</li></ul></div></section><section class="section" id="listing-installed-kernel-modules_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.3. Listing installed kernel modules</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">grubby --info=ALL</code> command displays an indexed list of installed kernels on <code class="literal">!BLS</code> and <code class="literal">BLS</code> installs.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						List the installed kernels using the following command:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7yd7n6j"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --info=ALL | grep title</strong></span></pre></div></div><p class="simpara">
						The list of all installed kernels is displayed as follows:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sd658dl"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">title="Red Hat Enterprise Linux (5.14.0-1.el9.x86_64) 9.0 (Plow)"
title="Red Hat Enterprise Linux (0-rescue-0d772916a9724907a5d1350bcd39ac92) 9.0 (Plow)"</pre></div></div></li></ul></div><p>
				The above example displays the installed kernels list of grubby-8.40-17, from the GRUB menu.
			</p></section><section class="section" id="listing-currently-loaded-kernel-modules_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.4. Listing currently loaded kernel modules</h2></div></div></div><p class="_abstract _abstract">
				View the currently loaded kernel modules.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal package">kmod</code> package is installed.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To list all currently loaded kernel modules, enter:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zdinfg8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>lsmod</strong></span>

Module                  Size  Used by
fuse                  126976  3
uinput                 20480  1
xt_CHECKSUM            16384  1
ipt_MASQUERADE         16384  1
xt_conntrack           16384  1
ipt_REJECT             16384  1
nft_counter            16384  16
nf_nat_tftp            16384  0
nf_conntrack_tftp      16384  1 nf_nat_tftp
tun                    49152  1
bridge                192512  0
stp                    16384  1 bridge
llc                    16384  2 bridge,stp
nf_tables_set          32768  5
nft_fib_inet           16384  1
</pre></div></div><p class="simpara">
						In the example above:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The first column provides the <span class="strong strong"><strong>names</strong></span> of currently loaded modules.
							</li><li class="listitem">
								The second column displays the amount of <span class="strong strong"><strong>memory</strong></span> per module in kilobytes.
							</li><li class="listitem">
								The last column shows the number, and optionally the names of modules that are <span class="strong strong"><strong>dependent</strong></span> on a particular module.
							</li></ul></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/doc/kmod/README</code> file
					</li><li class="listitem">
						The <code class="literal">lsmod(8)</code> manual page
					</li></ul></div></section><section class="section" id="displaying-information-about-kernel-modules_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.5. Displaying information about kernel modules</h2></div></div></div><p class="_abstract _abstract">
				Use the <code class="literal command">modinfo</code> command to display some detailed information about the specified kernel module.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal package">kmod</code> package is installed.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To display information about any kernel module, enter:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mor2pdn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>modinfo &lt;<span class="emphasis"><em>KERNEL_MODULE_NAME</em></span>&gt;</strong></span></pre></div></div><p class="simpara">
						For example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8ohy80d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>modinfo virtio_net</strong></span>

filename:       /lib/modules/5.14.0-1.el9.x86_64/kernel/drivers/net/virtio_net.ko.xz
license:        GPL
description:    Virtio network driver
rhelversion:    9.0
srcversion:     8809CDDBE7202A1B00B9F1C
alias:          virtio:d00000001v*
depends:        net_failover
retpoline:      Y
intree:         Y
name:           virtio_net
vermagic:       5.14.0-1.el9.x86_64 SMP mod_unload modversions

parm:           napi_weight:int
parm:           csum:bool
parm:           gso:bool
parm:           napi_tx:bool</pre></div></div><p class="simpara">
						You can query information about all available modules, regardless of whether they are loaded or not. The <code class="literal">parm</code> entries show parameters the user is able to set for the module, and what type of value they expect.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When entering the name of a kernel module, do not append the <code class="literal">.ko.xz</code> extension to the end of the name. Kernel module names do not have extensions; their corresponding files do.
						</p></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">modinfo(8)</code> manual page
					</li></ul></div></section><section class="section" id="loading-kernel-modules-at-system-runtime_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.6. Loading kernel modules at system runtime</h2></div></div></div><p class="_abstract _abstract">
				The optimal way to expand the functionality of the Linux kernel is by loading kernel modules. Use the <code class="literal command">modprobe</code> command to find and load a kernel module into the currently running kernel.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li><li class="listitem">
						The <code class="literal package">kmod</code> package is installed.
					</li><li class="listitem">
						The respective kernel module is not loaded. To ensure this is the case, list the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#listing-currently-loaded-kernel-modules_managing-kernel-modules">loaded kernel modules</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Select a kernel module you want to load.
					</p><p class="simpara">
						The modules are located in the <code class="literal">/lib/modules/$(uname -r)/kernel/&lt;SUBSYSTEM&gt;/</code> directory.
					</p></li><li class="listitem"><p class="simpara">
						Load the relevant kernel module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jn16vhh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>modprobe &lt;<span class="emphasis"><em>MODULE_NAME</em></span>&gt;</strong></span></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When entering the name of a kernel module, do not append the <code class="literal">.ko.xz</code> extension to the end of the name. Kernel module names do not have extensions; their corresponding files do.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Optionally, verify the relevant module was loaded:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vfhn758"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>lsmod | grep &lt;<span class="emphasis"><em>MODULE_NAME</em></span>&gt;</strong></span></pre></div></div><p class="simpara">
						If the module was loaded correctly, this command displays the relevant kernel module. For example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sddkeef"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>lsmod | grep serio_raw</strong></span>
serio_raw              16384  0</pre></div></div></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The changes described in this procedure <span class="strong strong"><strong>will not persist</strong></span> after rebooting the system. For information about how to load kernel modules to <span class="strong strong"><strong>persist</strong></span> across system reboots, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#loading-kernel-modules-automatically-at-system-boot-time_managing-kernel-modules">Loading kernel modules automatically at system boot time</a>.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">modprobe(8)</code> manual page
					</li></ul></div></section><section class="section" id="unloading-kernel-modules-at-system-runtime_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.7. Unloading kernel modules at system runtime</h2></div></div></div><p class="_abstract _abstract">
				At times, you find that you need to unload certain kernel modules from the running kernel. Use the <code class="literal command">modprobe</code> command to find and unload a kernel module at system runtime from the currently loaded kernel.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li><li class="listitem">
						The <code class="literal package">kmod</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enter the <code class="literal command">lsmod</code> command and select a kernel module you want to unload.
					</p><p class="simpara">
						If a kernel module has dependencies, unload those prior to 
unloading the kernel module. For details on identifying modules with 
dependencies, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#listing-currently-loaded-kernel-modules_managing-kernel-modules">Listing currently loaded kernel modules</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#kernel-module-dependencies_managing-kernel-modules">Kernel module dependencies</a>.
					</p></li><li class="listitem"><p class="simpara">
						Unload the relevant kernel module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--o0pc30v"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>modprobe -r &lt;<span class="emphasis"><em>MODULE_NAME</em></span>&gt;</strong></span></pre></div></div><p class="simpara">
						When entering the name of a kernel module, do not append the <code class="literal">.ko.xz</code> extension to the end of the name. Kernel module names do not have extensions; their corresponding files do.
					</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Do not unload kernel modules when they are used by the running 
system. Doing so can lead to an unstable or non-operational system.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Optionally, verify the relevant module was unloaded:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--tmwue32"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>lsmod | grep &lt;<span class="emphasis"><em>MODULE_NAME</em></span>&gt;</strong></span></pre></div></div><p class="simpara">
						If the module was unloaded successfully, this command does not display any output.
					</p></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					After finishing this procedure, the kernel modules that are defined to be automatically loaded on boot, <span class="strong strong"><strong>will not stay unloaded</strong></span> after rebooting the system. For information about how to counter this outcome, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#preventing-kernel-modules-from-being-automatically-loaded-at-system-boot-time_managing-kernel-modules">Preventing kernel modules from being automatically loaded at system boot time</a>.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">modprobe(8)</code> manual page
					</li></ul></div></section><section class="section" id="proc_unloading-kernel-modules-at-early-stages-of-the-boot-process_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.8. Unloading kernel modules at early stages of the boot process</h2></div></div></div><p class="_abstract _abstract">
				In certain situations it is necessary to unload a kernel module very
 early in the booting process. For example, when the kernel module 
contains a code, which causes the system to become unresponsive, and the
 user is not able to reach the stage to permanently disable the rogue 
kernel module. In that case it is possible to temporarily block the 
loading of the kernel module using a boot loader.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The changes described in this procedure <span class="strong strong"><strong>will not persist</strong></span>
 after the next reboot. For information about how to add a kernel module
 to a denylist so that it will not be automatically loaded during the 
boot process, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#preventing-kernel-modules-from-being-automatically-loaded-at-system-boot-time_managing-kernel-modules">Preventing kernel modules from being automatically loaded at system boot time</a>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have a loadable kernel module, which you want to prevent from loading for some reason.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Edit the relevant boot loader entry to unload the desired kernel module before the booting sequence continues.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Use the cursor keys to highlight the relevant boot loader entry.
							</li><li class="listitem"><p class="simpara">
								Press <span class="guibutton">e</span> key to edit the entry.
							</p><div class="figure" id="managing-kernel-modules-figu-kernel-bootmenu"><p class="title">Figure 3.1. Kernel boot menu</p><div class="figure-contents"><div class="mediaobject"><a href="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US/images/a6fe4f013d8c0809c0c5a46999303518/kernel-bootmenu-rhel9.png" class="rh_docs--zoom" title="kernel bootmenu rhel9"><img src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/kernel-bootmenu-rhel9.png" alt="kernel bootmenu rhel9"></a></div></div></div></li><li class="listitem">
								Use the cursor keys to navigate to the line that starts with <span class="strong strong"><strong>linux</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Append <code class="literal">modprobe.blacklist=<span class="emphasis"><em>module_name</em></span></code> to the end of the line.
							</p><div class="figure" id="managing-kernel-modules-figu-kernel-boot-entry"><p class="title">Figure 3.2. Kernel boot entry</p><div class="figure-contents"><div class="mediaobject"><a href="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US/images/fac2da22603707549b86b01c72c16894/kernel-boot-entry-rhel9.png" class="rh_docs--zoom" title="kernel boot entry rhel9"><img src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/kernel-boot-entry-rhel9.png" alt="kernel boot entry rhel9"></a></div></div></div><p class="simpara">
								The <code class="literal">serio_raw</code> kernel module illustrates a rogue module to be unloaded early in the boot process.
							</p></li><li class="listitem">
								Press <span class="guibutton">CTRL+x</span> keys to boot using the modified configuration.
							</li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Once the system fully boots, verify that the relevant kernel module is not loaded.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ck1bbko"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>lsmod | grep <span class="emphasis"><em>serio_raw</em></span></strong></span></pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#managing-kernel-modules_managing-monitoring-and-updating-the-kernel">Managing kernel modules</a>
					</li></ul></div></section><section class="section" id="loading-kernel-modules-automatically-at-system-boot-time_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.9. Loading kernel modules automatically at system boot time</h2></div></div></div><p class="_abstract _abstract">
				Configure a kernel module so that it is loaded automatically during the boot process.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li><li class="listitem">
						The <code class="literal package">kmod</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Select a kernel module you want to load during the boot process.
					</p><p class="simpara">
						The modules are located in the <code class="literal">/lib/modules/$(uname -r)/kernel/&lt;SUBSYSTEM&gt;/</code> directory.
					</p></li><li class="listitem"><p class="simpara">
						Create a configuration file for the module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--x08ffet"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo &lt;<span class="emphasis"><em>MODULE_NAME</em></span>&gt; &gt; /etc/modules-load.d/&lt;<span class="emphasis"><em>MODULE_NAME</em></span>&gt;.conf</strong></span></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When entering the name of a kernel module, do not append the <code class="literal">.ko.xz</code> extension to the end of the name. Kernel module names do not have extensions; their corresponding files do.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Optionally, after reboot, verify the relevant module was loaded:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7anqq7j"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>lsmod | grep &lt;<span class="emphasis"><em>MODULE_NAME</em></span>&gt;</strong></span></pre></div></div><p class="simpara">
						The example command above should succeed and display the relevant kernel module.
					</p></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The changes described in this procedure <span class="strong strong"><strong>will persist</strong></span> after rebooting the system.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">modules-load.d(5)</code> manual page
					</li></ul></div></section><section class="section" id="preventing-kernel-modules-from-being-automatically-loaded-at-system-boot-time_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.10. Preventing kernel modules from being automatically loaded at system boot time</h2></div></div></div><p>
				You can prevent the system from loading a kernel module automatically during the boot process by listing the module in <code class="literal">modprobe</code> configuration file with a corresponding command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The commands in this procedure require root privileges. Either use <code class="literal">su -</code> to switch to the root user or preface the commands with <code class="literal">sudo</code>.
					</li><li class="listitem">
						The <code class="literal">kmod</code> package is installed.
					</li><li class="listitem">
						Ensure that your current system configuration does not require a kernel module you plan to deny.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List modules loaded to the currently running kernel by using the <code class="literal">lsmod</code> command:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--4swl59g"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>lsmod</strong></span>
Module                  Size  Used by
tls                   131072  0
uinput                 20480  1
snd_seq_dummy          16384  0
snd_hrtimer            16384  1
</pre></div></div><p class="simpara">
						In the output, identify the module you want to prevent from being loaded.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Alternatively, identify an unloaded kernel module you want to prevent from potentially loading in the <code class="literal">/lib/modules/<span class="emphasis"><em>&lt;KERNEL-VERSION&gt;</em></span>/kernel/<span class="emphasis"><em>&lt;SUBSYSTEM&gt;</em></span>/</code> directory, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--i3hirz0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>ls /lib/modules/4.18.0-477.20.1.el8_8.x86_64/kernel/crypto/</strong></span>
ansi_cprng.ko.xz        chacha20poly1305.ko.xz  md4.ko.xz               serpent_generic.ko.xz
anubis.ko.xz            cmac.ko.xz</pre></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Create a configuration file serving as a denylist:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--fwu4tar"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>touch /etc/modprobe.d/denylist.conf</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						In a text editor of your choice, combine the names of modules you 
want to exclude from automatic loading to the kernel with the <code class="literal">blacklist</code> configuration command, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sex5pxp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># Prevents <span class="emphasis"><em>&lt;KERNEL-MODULE-1&gt;</em></span> from being loaded
blacklist <span class="emphasis"><em>&lt;MODULE-NAME-1&gt;</em></span>
install <span class="emphasis"><em>&lt;MODULE-NAME-1&gt;</em></span> /bin/false

# Prevents <span class="emphasis"><em>&lt;KERNEL-MODULE-2&gt;</em></span> from being loaded
blacklist <span class="emphasis"><em>&lt;MODULE-NAME-2&gt;</em></span>
install <span class="emphasis"><em>&lt;MODULE-NAME-2&gt;</em></span> /bin/false
</pre></div></div><p class="simpara">
						Because the <code class="literal">blacklist</code> command does 
not prevent the module from being loaded as a dependency for another 
kernel module that is not in a denylist, you must also define the <code class="literal">install</code> line. In this case, the system runs <code class="literal">/bin/false</code> instead of installing the module. The lines starting with a hash sign are comments you can use to make the file more readable.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When entering the name of a kernel module, do not append the <code class="literal">.ko.xz</code> extension to the end of the name. Kernel module names do not have extensions; their corresponding files do.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Create a backup copy of the current initial RAM disk image before rebuilding:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jstnnxn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cp /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).bak.$(date +%m-%d-%H%M%S).img</strong></span></pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Alternatively, create a backup copy of an initial RAM disk image
 which corresponds to the kernel version for which you want to prevent 
kernel modules from automatic loading:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--x63kpk1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cp /boot/initramfs-<span class="emphasis"><em>&lt;VERSION&gt;</em></span>.img /boot/initramfs-<span class="emphasis"><em>&lt;VERSION&gt;</em></span>.img.bak.$(date +%m-%d-%H%M%S)</strong></span></pre></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Generate a new initial RAM disk image to apply the changes:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--4llme5p"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dracut -f -v</strong></span></pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If you build an initial RAM disk image for a different kernel 
version than your system currently uses, specify both target <code class="literal">initramfs</code> and kernel version:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--uuj8oa2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dracut -f -v /boot/initramfs-<span class="emphasis"><em>&lt;TARGET-VERSION&gt;</em></span>.img <span class="emphasis"><em>&lt;CORRESPONDING-TARGET-KERNEL-VERSION&gt;</em></span></strong></span></pre></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Restart the system:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ov7i7l9"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>reboot</strong></span></pre></div></div></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The changes described in this procedure <span class="strong strong"><strong>will take effect and persist</strong></span>
 after rebooting the system. If you incorrectly list a key kernel module
 in the denylist, you can switch the system to an unstable or 
non-operational state.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/41278">How do I prevent a kernel module from loading automatically?</a> solution article
					</li><li class="listitem">
						<code class="literal">modprobe.d(5)</code> and <code class="literal">dracut(8)</code> man pages
					</li></ul></div></section><section class="section" id="proc_compiling-custom-kernel-modules_managing-kernel-modules"><div class="titlepage"><div><div><h2 class="title">3.11. Compiling custom kernel modules</h2></div></div></div><p class="_abstract _abstract">
				You can build a sampling kernel module as requested by various configurations at hardware and software level.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You installed the <code class="literal">kernel-devel</code>, <code class="literal">gcc</code>, and <code class="literal">elfutils-libelf-devel</code> packages.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--co7hvn9"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># dnf install kernel-devel-$(uname -r) gcc elfutils-libelf-devel</pre></div></div></li><li class="listitem">
						You have root permissions.
					</li><li class="listitem">
						You created the <code class="literal">/root/testmodule/</code> directory where you compile the custom kernel module.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create the <code class="literal">/root/testmodule/test.c</code> file with the following content.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--osmpsls"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#include &lt;linux/module.h&gt;
#include &lt;linux/kernel.h&gt;

int init_module(void)
    { printk("Hello World\n This is a test\n"); return 0; }

void cleanup_module(void)
    { printk("Good Bye World"); }

MODULE_LICENSE("GPL");</pre></div></div><p class="simpara">
						The <code class="literal">test.c</code> file is a source file that provides the main functionality to the kernel module. The file has been created in a dedicated <code class="literal">/root/testmodule/</code> directory for organizational purposes. After the module compilation, the <code class="literal">/root/testmodule/</code> directory will contain multiple files.
					</p><p class="simpara">
						The <code class="literal">test.c</code> file includes from the system libraries:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">linux/kernel.h</code> header file is necessary for the <code class="literal">printk()</code> function in the example code.
							</li><li class="listitem"><p class="simpara">
								The <code class="literal">linux/module.h</code> file contains 
function declarations and macro definitions to be shared between several
 source files written in C programming language.
							</p><p class="simpara">
								Next follow the <code class="literal">init_module()</code> and <code class="literal">cleanup_module()</code> functions to start and end the kernel logging function <code class="literal">printk()</code>, which prints text.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Create the <code class="literal">/root/testmodule/Makefile</code> file with the following content.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--tmk2tiq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">obj-m := test.o</pre></div></div><p class="simpara">
						The Makefile contains instructions that the compiler has to produce an object file specifically named <code class="literal">test.o</code>. The <code class="literal">obj-m</code> directive specifies that the resulting <code class="literal">test.ko</code> file is going to be compiled as a loadable kernel module. Alternatively, the <code class="literal">obj-y</code> directive would instruct to build <code class="literal">test.ko</code> as a built-in kernel module.
					</p></li><li class="listitem"><p class="simpara">
						Compile the kernel module.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ucnu4rg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>make -C /lib/modules/$(uname -r)/build M=/root/testmodule modules</strong></span>
make: Entering directory '/usr/src/kernels/5.14.0-70.17.1.el9_0.x86_64'
  CC [M]  /root/testmodule/test.o
  MODPOST /root/testmodule/Module.symvers
  CC [M]  /root/testmodule/test.mod.o
  LD [M]  /root/testmodule/test.ko
  BTF [M] /root/testmodule/test.ko
Skipping BTF generation for /root/testmodule/test.ko due to unavailability of vmlinux
make: Leaving directory '/usr/src/kernels/5.14.0-70.17.1.el9_0.x86_64'</pre></div></div><p class="simpara">
						The compiler creates an object file (<code class="literal">test.o</code>) for each source file (<code class="literal">test.c</code>) as an intermediate step before linking them together into the final kernel module (<code class="literal">test.ko</code>).
					</p><p class="simpara">
						After a successful compilation, <code class="literal">/root/testmodule/</code> contains additional files that relate to the compiled custom kernel module. The compiled module itself is represented by the <code class="literal">test.ko</code> file.
					</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: check the contents of the <code class="literal">/root/testmodule/</code> directory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--keo5udo"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ls -l /root/testmodule/</strong></span>
total 152
-rw-rr--. 1 root root    16 Jul 26 08:19 Makefile
-rw-rr--. 1 root root    25 Jul 26 08:20 modules.order
-rw-rr--. 1 root root     0 Jul 26 08:20 Module.symvers
-rw-rr--. 1 root root   224 Jul 26 08:18 test.c
-rw-rr--. 1 root root 62176 Jul 26 08:20 test.ko
-rw-rr--. 1 root root    25 Jul 26 08:20 test.mod
-rw-rr--. 1 root root   849 Jul 26 08:20 test.mod.c
-rw-rr--. 1 root root 50936 Jul 26 08:20 test.mod.o
-rw-rr--. 1 root root 12912 Jul 26 08:20 test.o</pre></div></div></li><li class="listitem"><p class="simpara">
						Copy the kernel module to the <code class="literal">/lib/modules/$(uname -r)/</code> directory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--uvp9y4y"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cp /root/testmodule/test.ko /lib/modules/$(uname -r)/</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Update the modular dependency list:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ih682a0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>depmod -a</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Load the kernel module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--kf7g8z0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>modprobe -v test</strong></span>
insmod /lib/modules/<span class="emphasis"><em>5.14.0-1.el9.x86_64</em></span>/test.ko</pre></div></div></li><li class="listitem"><p class="simpara">
						Verify that the kernel module was successfully loaded:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pknstde"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>lsmod | grep test</strong></span>
test                   16384  0</pre></div></div></li><li class="listitem"><p class="simpara">
						Read the latest messages from the kernel ring buffer:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--4ao73ta"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dmesg</strong></span>
[<span class="emphasis"><em>74422.545004</em></span>] Hello World
                This is a test</pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#managing-kernel-modules_managing-monitoring-and-updating-the-kernel">Managing kernel modules</a>
					</li></ul></div></section></section><section class="chapter" id="configuring-kernel-command-line-parameters_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Configuring kernel command-line parameters</h1></div></div></div><p class="_abstract _abstract">
			With kernel command-line parameters, you can change the behavior of 
certain aspects of the Red Hat Enterprise Linux kernel at boot time. As a
 system administrator, you have full control over what options get set 
at boot. Certain kernel behaviors can only be set at boot time, so 
understanding how to make these changes is a key administration skill.
		</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				Changing the behavior of the system by modifying kernel command-line
 parameters may have negative effects on your system. Always test 
changes prior to deploying them in production. For further guidance, 
contact Red Hat Support.
			</p></div></div><section class="section" id="understanding-kernel-command-line-parameters_configuring-kernel-command-line-parameters"><div class="titlepage"><div><div><h2 class="title">4.1. What are kernel command-line parameters</h2></div></div></div><p class="_abstract _abstract">
				With kernel command-line parameters, you can overwrite default 
values and set specific hardware settings. At boot time, you can 
configure the following features:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The Red&nbsp;Hat Enterprise&nbsp;Linux kernel
					</li><li class="listitem">
						The initial RAM disk
					</li><li class="listitem">
						The user space features
					</li></ul></div><p>
				By default, the kernel command-line parameters for systems using the
 GRUB boot loader are defined in the boot entry configuration file for 
each kernel boot entry.
			</p><p>
				You can manipulate boot loader configuration files by using the <code class="literal">grubby</code> utility. With <code class="literal">grubby</code>, you can perform these actions:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Change the default boot entry.
					</li><li class="listitem">
						Add or remove arguments from a GRUB menu entry.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">kernel-command-line(7)</code>, <code class="literal">bootparam(7)</code> and <code class="literal">dracut.cmdline(7)</code> manual pages
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/3938081">How to install and boot custom kernels in Red Hat Enterprise Linux 8</a>
					</li><li class="listitem">
						The <code class="literal">grubby(8)</code> manual page
					</li></ul></div></section><section class="section" id="what-boot-entries-are_configuring-kernel-command-line-parameters"><div class="titlepage"><div><div><h2 class="title">4.2. Understanding boot entries</h2></div></div></div><p class="_abstract _abstract">
				A boot entry is a collection of options which are stored in a 
configuration file and tied to a particular kernel version. In practice,
 you have at least as many boot entries as your system has installed 
kernels. The boot entry configuration file is located in the <code class="literal">/boot/loader/entries/</code> directory and can look like this:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--thf7v3m"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">d8712ab6d4f14683c5625e87b52b6b6e-5.14.0-1.el9.x86_64.conf</pre></div></div><p>
				The file name above consists of a machine ID stored in the <code class="literal">/etc/machine-id</code> file, and a kernel version.
			</p><p>
				The boot entry configuration file contains information about the 
kernel version, the initial ramdisk image, and the kernel command-line 
parameters. The example contents of a boot entry config can be seen 
below:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pg77s4i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">title Red Hat Enterprise Linux (5.14.0-1.el9.x86_64) 9.0 (Plow)
version 5.14.0-1.el9.x86_64
linux /vmlinuz-5.14.0-1.el9.x86_64
initrd /initramfs-5.14.0-1.el9.x86_64.img
options root=/dev/mapper/rhel_kvm--02--guest08-root ro crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M resume=/dev/mapper/rhel_kvm--02--guest08-swap rd.lvm.lv=rhel_kvm-02-guest08/root rd.lvm.lv=rhel_kvm-02-guest08/swap console=ttyS0,115200
grub_users $grub_users
grub_arg --unrestricted
grub_class kernel</pre></div></div></section><section class="section" id="changing-kernel-command-line-parameters-for-all-boot-entries_configuring-kernel-command-line-parameters"><div class="titlepage"><div><div><h2 class="title">4.3. Changing kernel command-line parameters for all boot entries</h2></div></div></div><p class="_abstract _abstract">
				Change kernel command-line parameters for all boot entries on your system.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					When installing a newer version of the kernel in RHEL 9 systems, the <code class="literal">grubby</code> tool passes the kernel command-line arguments from the previous kernel version.
				</p><p>
					However, this does not apply to RHEL version 9.0 in which newly 
installed kernels lose previous command-line options. You must run the <code class="literal">grub2-mkconfig</code>
 command on the newly installed kernel to pass the parameters to your 
new kernel. For more information about this known issue, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/9.0_release_notes/index#known-issue_boot-loader">Boot loader</a>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Verify that the <code class="literal">grubby</code> utility is installed on your system.
					</li><li class="listitem">
						Verify that the <code class="literal">zipl</code> utility is installed on your IBM Z system.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To add a parameter:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--o5lb634"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=ALL --args="&lt;<span class="emphasis"><em>NEW_PARAMETER</em></span>&gt;"</strong></span></pre></div></div><p class="simpara">
						For systems that use the GRUB boot loader and, on IBM Z that use 
the zIPL boot loader, the command adds a new kernel parameter to each <code class="literal">/boot/loader/entries/&lt;<span class="emphasis"><em>ENTRY</em></span>&gt;.conf</code> file.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								On IBM Z, execute the <code class="literal">zipl</code> command with no options to update the boot menu.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						To remove a parameter:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6jdy7zj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=ALL --remove-args="&lt;<span class="emphasis"><em>PARAMETER_TO_REMOVE</em></span>&gt;"</strong></span></pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								On IBM Z, execute the <code class="literal">zipl</code> command with no options to update the boot menu.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						After each update of your kernel package, propagate the configured kernel options to the new kernels:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--y5cs74n"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grub2-mkconfig -o /etc/grub2.cfg</strong></span></pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#understanding-kernel-command-line-parameters_configuring-kernel-command-line-parameters" title="4.1.&nbsp;What are kernel command-line parameters">What are kernel command-line parameters</a>
					</li><li class="listitem">
						<code class="literal">grubby(8)</code> and <code class="literal">zipl(8)</code> manual pages
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-working_with_the_grub_2_boot_loader#sec-Making_Persistent_Changes_to_a_GRUB_2_Menu_Using_the_grubby_Tool">grubby tool</a></span></em></span>
					</li></ul></div></section><section class="section" id="changing-kernel-command-line-parameters-for-a-single-boot-entry_configuring-kernel-command-line-parameters"><div class="titlepage"><div><div><h2 class="title">4.4. Changing kernel command-line parameters for a single boot entry</h2></div></div></div><p class="_abstract _abstract">
				Make changes in kernel command-line parameters for a single boot entry on your system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Verify that the <code class="literal">grubby</code> and <code class="literal">zipl</code> utilities are installed on your system.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To add a parameter:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zqa6ck1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>grubby --update-kernel=/boot/vmlinuz-$(uname -r) --args="&lt;<span class="emphasis"><em>NEW_PARAMETER</em></span>&gt;"</strong></span></pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								On IBM Z, execute the <code class="literal">zipl</code> command with no options to update the boot menu.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						To remove a parameter use the following:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--oa2tb6t"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>grubby --update-kernel=/boot/vmlinuz-$(uname -r) --remove-args="&lt;<span class="emphasis"><em>PARAMETER_TO_REMOVE</em></span>&gt;"</strong></span></pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								On IBM Z, execute the <code class="literal">zipl</code> command with no options to update the boot menu.
							</li></ul></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">grubby</code> modifies and stores the kernel command-line parameters of an individual kernel boot entry in the <code class="literal">/boot/loader/entries/&lt;<span class="emphasis"><em>ENTRY</em></span>&gt;.conf</code> file.
						</li></ul></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#understanding-kernel-command-line-parameters_configuring-kernel-command-line-parameters" title="4.1.&nbsp;What are kernel command-line parameters">What are kernel command-line parameters</a>
					</li><li class="listitem">
						<code class="literal">grubby(8)</code> and <code class="literal">zipl(8)</code> manual pages
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-working_with_the_grub_2_boot_loader#sec-Making_Persistent_Changes_to_a_GRUB_2_Menu_Using_the_grubby_Tool">grubby tool</a></span></em></span>
					</li></ul></div></section><section class="section" id="changing-kernel-command-line-parameters-temporarily-at-boot-time_configuring-kernel-command-line-parameters"><div class="titlepage"><div><div><h2 class="title">4.5. Changing kernel command-line parameters temporarily at boot time</h2></div></div></div><p>
				Make temporary changes to a Kernel Menu Entry by changing the kernel parameters only during a single boot process.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Select the kernel you want to start when the GRUB 2 boot menu appears and press the <span class="keycap"><strong>e</strong></span> key to edit the kernel parameters.
					</li><li class="listitem">
						Find the kernel command line by moving the cursor down. The kernel command line starts with <code class="literal">linux</code> on 64-Bit IBM Power Series and x86-64 BIOS-based systems, or <code class="literal">linuxefi</code> on UEFI systems.
					</li><li class="listitem"><p class="simpara">
						Move the cursor to the end of the line.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Press <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>a</strong></span> to jump to the start of the line and <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>e</strong></span> to jump to the end of the line. On some systems, <span class="keycap"><strong>Home</strong></span> and <span class="keycap"><strong>End</strong></span> keys might also work.
						</p></div></div></li><li class="listitem">
						Edit the kernel parameters as required. For example, to run the system in emergency mode, add the <span class="emphasis"><em>emergency</em></span> parameter at the end of the <code class="literal">linux</code> line:
					</li></ol></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2g02oxc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">linux   ($root)/vmlinuz-5.14.0-63.el9.x86_64 root=/dev/mapper/rhel-root ro crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet pass:quotes[_emergency_]</pre></div></div><p>
				+ To enable the system messages, remove the <code class="literal">rhgb</code> and <code class="literal">quiet</code> parameters.
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Press <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>x</strong></span> to boot with the selected kernel and the modified command line parameters.
					</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Press <span class="keycap"><strong>Esc</strong></span> key to leave command line editing and it will drop all the user made changes.
				</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					This procedure applies only for a single boot and does not persistently make the changes.
				</p></div></div></section><section class="section" id="proc_configuring-grub-2-settings-to-enable-serial-console-connection_configuring-kernel-command-line-parameters"><div class="titlepage"><div><div><h2 class="title">4.6. Configuring GRUB settings to enable serial console connection</h2></div></div></div><p>
				The serial console is beneficial when you need to connect to a 
headless server or an embedded system and the network is down. Or when 
you need to avoid security rules and obtain login access on a different 
system.
			</p><p>
				You need to configure some default GRUB settings to use the serial console connection.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the following two lines to the <code class="literal">/etc/default/grub</code> file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5zbabk4"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">GRUB_TERMINAL="serial"
GRUB_SERIAL_COMMAND="serial --speed=9600 --unit=0 --word=8 --parity=no --stop=1"</pre></div></div><p class="simpara">
						The first line disables the graphical terminal. The <code class="literal">GRUB_TERMINAL</code> key overrides values of <code class="literal">GRUB_TERMINAL_INPUT</code> and <code class="literal">GRUB_TERMINAL_OUTPUT</code> keys.
					</p><p class="simpara">
						The second line adjusts the baud rate (<code class="literal">--speed</code>),
 parity and other values to fit your environment and hardware. Note that
 a much higher baud rate, for example 115200, is preferable for tasks 
such as following log files.
					</p></li><li class="listitem"><p class="simpara">
						Update the GRUB configuration file.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								On BIOS-based machines:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vuv5sqd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grub2-mkconfig -o /boot/grub2/grub.cfg</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								On UEFI-based machines:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--an4ekry"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grub2-mkconfig -o /boot/grub2/grub.cfg</strong></span></pre></div></div></li></ul></div></li><li class="listitem">
						Reboot the system for the changes to take effect.
					</li></ol></div></section></section><section class="chapter" id="configuring-kernel-parameters-at-runtime_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Configuring kernel parameters at runtime</h1></div></div></div><p class="_abstract _abstract">
			As a system administrator, you can modify many facets of the 
Red&nbsp;Hat Enterprise&nbsp;Linux kernels behavior at runtime. 
Configure kernel parameters at runtime by using the <code class="literal command">sysctl</code> command and by modifying the configuration files in the <code class="literal">/etc/sysctl.d/</code> and <code class="literal">/proc/sys/</code> directories.
		</p><section class="section" id="what-are-kernel-parameters_configuring-kernel-parameters-at-runtime"><div class="titlepage"><div><div><h2 class="title">5.1. What are kernel parameters</h2></div></div></div><p class="_abstract _abstract">
				Kernel parameters are tunable values which you can adjust while the 
system is running. There is no requirement to reboot or recompile the 
kernel for changes to take effect.
			</p><p>
				It is possible to address the kernel parameters through:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal command">sysctl</code> command
					</li><li class="listitem">
						The virtual file system mounted at the <code class="literal filename">/proc/sys/</code> directory
					</li><li class="listitem">
						The configuration files in the <code class="literal">/etc/sysctl.d/</code> directory
					</li></ul></div><p>
				Tunables are divided into classes by the kernel subsystem. 
Red&nbsp;Hat Enterprise&nbsp;Linux has the following tunable classes:
			</p><div class="table" id="idm139983851693104"><p class="title">Table 5.1. Table of sysctl classes</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="dfafmrh" id="rh-table--dfafmrh" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm139983850962112" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Tunable class</th><th id="idm139983850961024" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Subsystem</th></tr></thead><tbody><tr><td headers="idm139983850962112" data-row="2" data-col="1" class="content--sm" valign="top" align="left"> <p>
								abi
							</p>
							 </td><td headers="idm139983850961024" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								Execution domains and personalities
							</p>
							 </td></tr><tr><td headers="idm139983850962112" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								crypto
							</p>
							 </td><td headers="idm139983850961024" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								Cryptographic interfaces
							</p>
							 </td></tr><tr><td headers="idm139983850962112" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								debug
							</p>
							 </td><td headers="idm139983850961024" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								Kernel debugging interfaces
							</p>
							 </td></tr><tr><td headers="idm139983850962112" data-row="5" data-col="1" class="content--sm" valign="top" align="left"> <p>
								dev
							</p>
							 </td><td headers="idm139983850961024" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								Device-specific information
							</p>
							 </td></tr><tr><td headers="idm139983850962112" data-row="6" data-col="1" class="content--sm" valign="top" align="left"> <p>
								fs
							</p>
							 </td><td headers="idm139983850961024" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Global and specific file system tunables
							</p>
							 </td></tr><tr><td headers="idm139983850962112" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								kernel
							</p>
							 </td><td headers="idm139983850961024" data-row="7" data-col="2" class="content--md" valign="top" align="left"> <p>
								Global kernel tunables
							</p>
							 </td></tr><tr><td headers="idm139983850962112" data-row="8" data-col="1" class="content--sm" valign="top" align="left"> <p>
								net
							</p>
							 </td><td headers="idm139983850961024" data-row="8" data-col="2" class="content--md" valign="top" align="left"> <p>
								Network tunables
							</p>
							 </td></tr><tr><td headers="idm139983850962112" data-row="9" data-col="1" class="content--md" valign="top" align="left"> <p>
								sunrpc
							</p>
							 </td><td headers="idm139983850961024" data-row="9" data-col="2" class="content--md" valign="top" align="left"> <p>
								Sun Remote Procedure Call (NFS)
							</p>
							 </td></tr><tr><td headers="idm139983850962112" data-row="10" data-col="1" class="content--md" valign="top" align="left"> <p>
								user
							</p>
							 </td><td headers="idm139983850961024" data-row="10" data-col="2" class="content--md" valign="top" align="left"> <p>
								User Namespace limits
							</p>
							 </td></tr><tr><td headers="idm139983850962112" data-row="11" data-col="1" class="content--sm" valign="top" align="left"> <p>
								vm
							</p>
							 </td><td headers="idm139983850961024" data-row="11" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Tuning and management of memory, buffers, and cache
							</p>
							 </td></tr></tbody></table></rh-table></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Configuring kernel parameters on a production system requires 
careful planning. Unplanned changes may render the kernel unstable, 
requiring a system reboot. Verify that you are using valid options 
before changing any kernel values.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">sysctl(8)</code>, and <code class="literal">sysctl.d(5)</code> manual pages
					</li></ul></div></section><section class="section" id="configuring-kernel-parameters-temporarily-with-sysctl_configuring-kernel-parameters-at-runtime"><div class="titlepage"><div><div><h2 class="title">5.2. Configuring kernel parameters temporarily with sysctl</h2></div></div></div><p class="_abstract _abstract">
				Use the <code class="literal command">sysctl</code> command to temporarily set kernel parameters at runtime. The command is also useful for listing and filtering tunables.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List all parameters and their values.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--dqajz1c"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>sysctl -a</strong></span></code></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal command"># sysctl -a</code> command displays kernel parameters, which can be adjusted at runtime and at boot time.
						</p></div></div></li><li class="listitem"><p class="simpara">
						To configure a parameter temporarily, enter:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--g8upxc3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"><span class="strong strong"><strong># sysctl &lt;TUNABLE_CLASS&gt;.&lt;PARAMETER&gt;=&lt;TARGET_VALUE&gt;</strong></span></pre></div></div><p class="simpara">
						The sample command above changes the parameter value while the 
system is running. The changes take effect immediately, without a need 
for restart.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The changes return back to default after your system reboots.
						</p></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">sysctl(8)</code> manual page
					</li><li class="listitem">
						<a class="link" href="#configuring-kernel-parameters-permanently-with-sysctl_configuring-kernel-parameters-at-runtime" title="5.3.&nbsp;Configuring kernel parameters permanently with sysctl">Configuring kernel parameters permanently with sysctl</a>
					</li><li class="listitem">
						<a class="link" href="#using-configuration-files-in-etc-sysctl-d-to-adjust-kernel-parameters_configuring-kernel-parameters-at-runtime" title="5.4.&nbsp;Using configuration files in /etc/sysctl.d/ to adjust kernel parameters">Using configuration files in /etc/sysctl.d/ to adjust kernel parameters</a>
					</li></ul></div></section><section class="section" id="configuring-kernel-parameters-permanently-with-sysctl_configuring-kernel-parameters-at-runtime"><div class="titlepage"><div><div><h2 class="title">5.3. Configuring kernel parameters permanently with sysctl</h2></div></div></div><p class="_abstract _abstract">
				Use the <code class="literal command">sysctl</code> command to permanently set kernel parameters.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List all parameters.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--tngafju"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>sysctl -a</strong></span></code></pre></div></div><p class="simpara">
						The command displays all kernel parameters that can be configured at runtime.
					</p></li><li class="listitem"><p class="simpara">
						Configure a parameter permanently:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0dc7geh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>sysctl -w &lt;TUNABLE_CLASS&gt;.&lt;PARAMETER&gt;=&lt;TARGET_VALUE&gt; &gt;&gt; /etc/sysctl.conf</strong></span></pre></div></div><p class="simpara">
						The sample command changes the tunable value and writes it to the <code class="literal">/etc/sysctl.conf</code>
 file, which overrides the default values of kernel parameters. The 
changes take effect immediately and persistently, without a need for 
restart.
					</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					To permanently modify kernel parameters you can also make manual changes to the configuration files in the <code class="literal">/etc/sysctl.d/</code> directory.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">sysctl(8)</code> and <code class="literal">sysctl.conf(5)</code> manual pages
					</li><li class="listitem">
						<a class="link" href="#using-configuration-files-in-etc-sysctl-d-to-adjust-kernel-parameters_configuring-kernel-parameters-at-runtime" title="5.4.&nbsp;Using configuration files in /etc/sysctl.d/ to adjust kernel parameters">Using configuration files in /etc/sysctl.d/ to adjust kernel parameters</a>
					</li></ul></div></section><section class="section" id="using-configuration-files-in-etc-sysctl-d-to-adjust-kernel-parameters_configuring-kernel-parameters-at-runtime"><div class="titlepage"><div><div><h2 class="title">5.4. Using configuration files in /etc/sysctl.d/ to adjust kernel parameters</h2></div></div></div><p class="_abstract _abstract">
				Modify configuration files in the <code class="literal">/etc/sysctl.d/</code> directory manually to permanently set kernel parameters.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new configuration file in <code class="literal">/etc/sysctl.d/</code>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2qvhv36"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>vim /etc/sysctl.d/&lt;<span class="emphasis"><em>some_file.conf</em></span>&gt;</strong></span></code></pre></div></div></li><li class="listitem"><p class="simpara">
						Include kernel parameters, one per line.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ff8rbgg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><code class="literal command">&lt;<span class="emphasis"><em>TUNABLE_CLASS</em></span>&gt;.&lt;<span class="emphasis"><em>PARAMETER</em></span>&gt;=&lt;<span class="emphasis"><em>TARGET_VALUE</em></span>&gt;</code>
<code class="literal command">&lt;<span class="emphasis"><em>TUNABLE_CLASS</em></span>&gt;.&lt;<span class="emphasis"><em>PARAMETER</em></span>&gt;=&lt;<span class="emphasis"><em>TARGET_VALUE</em></span>&gt;</code></pre></div></div></li><li class="listitem">
						Save the configuration file.
					</li><li class="listitem"><p class="simpara">
						Reboot the machine for the changes to take effect.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Alternatively, to apply changes without rebooting, enter:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ehlmq38"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>sysctl -p /etc/sysctl.d/&lt;<span class="emphasis"><em>some_file.conf</em></span>&gt;</strong></span></code></pre></div></div><p class="simpara">
								The command enables you to read values from the configuration file, which you created earlier.
							</p></li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">sysctl(8)</code>, <code class="literal">sysctl.d(5)</code> manual pages
					</li></ul></div></section><section class="section" id="configuring-kernel-parameters-temporarily-through-proc-sys_configuring-kernel-parameters-at-runtime"><div class="titlepage"><div><div><h2 class="title">5.5. Configuring kernel parameters temporarily through /proc/sys/</h2></div></div></div><p class="_abstract _abstract">
				Set kernel parameters temporarily through the files in the <code class="literal">/proc/sys/</code> virtual file system directory.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Identify a kernel parameter you want to configure.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--hf7dr1g"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>ls -l /proc/sys/&lt;<span class="emphasis"><em>TUNABLE_CLASS</em></span>&gt;/</strong></span></code></pre></div></div><p class="simpara">
						The writable files returned by the command can be used to 
configure the kernel. The files with read-only permissions provide 
feedback on the current settings.
					</p></li><li class="listitem"><p class="simpara">
						Assign a target value to the kernel parameter.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--umgt9if"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>echo &lt;<span class="emphasis"><em>TARGET_VALUE</em></span>&gt; &gt; /proc/sys/&lt;<span class="emphasis"><em>TUNABLE_CLASS</em></span>&gt;/&lt;<span class="emphasis"><em>PARAMETER</em></span>&gt;</strong></span></code></pre></div></div><p class="simpara">
						The command makes configuration changes that will disappear once the system is restarted.
					</p></li><li class="listitem"><p class="simpara">
						Optionally, verify the value of the newly set kernel parameter.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wt3d3g6"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>cat /proc/sys/&lt;<span class="emphasis"><em>TUNABLE_CLASS</em></span>&gt;/&lt;<span class="emphasis"><em>PARAMETER</em></span>&gt;</strong></span></code></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#configuring-kernel-parameters-permanently-with-sysctl_configuring-kernel-parameters-at-runtime" title="5.3.&nbsp;Configuring kernel parameters permanently with sysctl">Configuring kernel parameters permanently with sysctl</a>
					</li><li class="listitem">
						<a class="link" href="#using-configuration-files-in-etc-sysctl-d-to-adjust-kernel-parameters_configuring-kernel-parameters-at-runtime" title="5.4.&nbsp;Using configuration files in /etc/sysctl.d/ to adjust kernel parameters">Using configuration files in /etc/sysctl.d/ to adjust kernel parameters</a>
					</li></ul></div></section></section><section class="chapter" id="configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Configuring kernel parameters permanently by using the kernel_settings RHEL System Role</h1></div></div></div><p class="_abstract _abstract">
			You can use the <code class="literal">kernel_settings</code> role to configure kernel parameters on multiple clients at once. This solution:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Provides a friendly interface with efficient input setting.
				</li><li class="listitem">
					Keeps all intended kernel parameters in one place.
				</li></ul></div><p>
			After you run the <code class="literal">kernel_settings</code> role from the control machine, the kernel parameters are applied to the managed systems immediately and persist across reboots.
		</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				Note that RHEL&nbsp;System&nbsp;Role delivered over RHEL channels 
are available to RHEL customers as an RPM package in the default 
AppStream repository. RHEL&nbsp;System&nbsp;Role are also available as a
 collection to customers with Ansible subscriptions over Ansible 
Automation Hub.
			</p></div></div><section class="section" id="introduction-to-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">6.1. Introduction to the kernel_settings role</h2></div></div></div><p class="_abstract _abstract">
				RHEL&nbsp;System&nbsp;Roles is a set of roles that provide a 
consistent configuration interface to remotely manage multiple systems.
			</p><p>
				RHEL&nbsp;System&nbsp;Roles were introduced for automated configurations of the kernel using the <code class="literal">kernel_settings</code> System Role. The <code class="literal">rhel-system-roles</code> package contains this system role, and also the reference documentation.
			</p><p>
				To apply the kernel parameters on one or more systems in an automated fashion, use the <code class="literal">kernel_settings</code>
 role with one or more of its role variables of your choice in a 
playbook. A playbook is a list of one or more plays that are 
human-readable, and are written in the YAML format.
			</p><p>
				With the <code class="literal">kernel_settings</code> role you can configure:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The kernel parameters using the <code class="literal">kernel_settings_sysctl</code> role variable
					</li><li class="listitem">
						Various kernel subsystems, hardware devices, and device drivers using the <code class="literal">kernel_settings_sysfs</code> role variable
					</li><li class="listitem">
						The CPU affinity for the <code class="literal">systemd</code> service manager and processes it forks using the <code class="literal">kernel_settings_systemd_cpu_affinity</code> role variable
					</li><li class="listitem">
						The kernel memory subsystem transparent hugepages using the <code class="literal">kernel_settings_transparent_hugepages</code> and <code class="literal">kernel_settings_transparent_hugepages_defrag</code> role variables
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">README.md</code> and <code class="literal">README.html</code> files in the <code class="literal">/usr/share/doc/rhel-system-roles/kernel_settings/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks.html">Working with playbooks</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html">How to build your inventory</a>
					</li></ul></div></section><section class="section" id="applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">6.2. Applying selected kernel parameters using the kernel_settings role</h2></div></div></div><p class="_abstract _abstract">
				Follow these steps to prepare and apply an Ansible playbook to 
remotely configure kernel parameters with persisting effect on multiple 
managed operating systems.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> permissions.
					</li><li class="listitem">
						Entitled by your RHEL subscription, you installed the <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages on the control machine.
					</li><li class="listitem">
						An inventory of managed hosts is present on the control machine and Ansible is able to connect to them.
					</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0 - 8.5 provided access to a separate Ansible repository 
that contains Ansible Engine 2.9 for automation based on Ansible. 
Ansible Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>; connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>; and the entire world of plugins and modules. For information about how to obtain and install Ansible Engine, refer to <a class="link" href="https://access.redhat.com/articles/3174981">How do I Download and Install Red Hat Ansible Engine?</a>.
				</p><p>
					RHEL 8.6 and 9.0 has introduced Ansible Core (provided as <code class="literal">ansible-core</code>
 RPM), which contains the Ansible command-line utilities, commands, and a
 small set of built-in Ansible plugins. The AppStream repository 
provides <code class="literal">ansible-core</code>, which has a limited scope of support. You can learn more by reviewing <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the ansible-core package included in the RHEL 9 AppStream</a>.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optionally, review the <code class="literal">inventory</code> file for illustration purposes:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--d9ra44d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>cat /home/jdoe/&lt;<span class="emphasis"><em>ansible_project_name</em></span>&gt;/inventory</strong></span>
[testingservers]
pdoe@192.168.122.98
fdoe@192.168.122.226

[db-servers]
db1.example.com
db2.example.com

[webservers]
web1.example.com
web2.example.com
192.0.2.42</pre></div></div><p class="simpara">
						The file defines the <code class="literal">[testingservers]</code> group and other groups. It allows you to run Ansible more effectively against a specific set of systems.
					</p></li><li class="listitem"><p class="simpara">
						Create a configuration file to set defaults and privilege escalation for Ansible operations.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new YAML file and open it in a text editor, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--t63by92"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>vi /home/jdoe/&lt;<span class="emphasis"><em>ansible_project_name</em></span>&gt;/ansible.cfg</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Insert the following content into the file:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bl896ze"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">[defaults]
inventory = ./inventory

[privilege_escalation]
become = true
become_method = sudo
become_user = root
become_ask_pass = true</pre></div></div><p class="simpara">
								The <code class="literal">[defaults]</code> section specifies a path to the inventory file of managed hosts. The <code class="literal">[privilege_escalation]</code> section defines that user privileges be shifted to <code class="literal">root</code>
 on the specified managed hosts. This is necessary for successful 
configuration of kernel parameters. When Ansible playbook is run, you 
will be prompted for user password. The user automatically switches to <code class="literal">root</code> by means of <code class="literal">sudo</code> after connecting to a managed host.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook that uses the <code class="literal">kernel_settings</code> role.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new YAML file and open it in a text editor, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--hcfjo5n"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>vi /home/jdoe/&lt;<span class="emphasis"><em>ansible_project_name</em></span>&gt;/kernel-roles.yml</strong></span></pre></div></div><p class="simpara">
								This file represents a playbook and usually contains an ordered list of tasks, also called <span class="emphasis"><em>plays</em></span>, that are run against specific managed hosts selected from your <code class="literal">inventory</code> file.
							</p></li><li class="listitem"><p class="simpara">
								Insert the following content into the file:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yn5gx49"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">---
-
  hosts: testingservers
  name: "Configure kernel settings"
  roles:
    - rhel-system-roles.kernel_settings
  vars:
    kernel_settings_sysctl:
      - name: fs.file-max
        value: 400000
      - name: kernel.threads-max
        value: 65536
    kernel_settings_sysfs:
      - name: /sys/class/net/lo/mtu
        value: 65000
    kernel_settings_transparent_hugepages: madvise</pre></div></div><p class="simpara">
								The <code class="literal">name</code> key is optional. It associates an arbitrary string with the play as a label and identifies what the play is for. The <code class="literal">hosts</code>
 key in the play specifies the hosts against which the play is run. The 
value or values for this key can be provided as individual names of 
managed hosts or as groups of hosts as defined in the <code class="literal">inventory</code> file.
							</p><p class="simpara">
								The <code class="literal">vars</code> section represents a list of variables containing selected kernel parameter names and values to which they have to be set.
							</p><p class="simpara">
								The <code class="literal">roles</code> key specifies what system role is going to configure the parameters and values mentioned in the <code class="literal">vars</code> section.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You can modify the kernel parameters and their values in the playbook to fit your needs.
								</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Optionally, verify that the syntax in your play is correct.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1m20hpy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>ansible-playbook --syntax-check kernel-roles.yml</strong></span>

playbook: kernel-roles.yml</pre></div></div><p class="simpara">
						This example shows the successful verification of a playbook.
					</p></li><li class="listitem"><p class="simpara">
						Execute your playbook.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pqw5tv3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>ansible-playbook kernel-roles.yml</strong></span>

...

BECOME password:

PLAY [Configure kernel settings] **********************************************************************************



PLAY RECAP ********************************************************************************************************
fdoe@192.168.122.226       : ok=10   changed=4    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0
pdoe@192.168.122.98        : ok=10   changed=4    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0</pre></div></div><p class="simpara">
						Before Ansible runs your playbook, you are going to be prompted 
for your password and so that a user on managed hosts can be switched to
 <code class="literal">root</code>, which is necessary for configuring kernel parameters.
					</p><p class="simpara">
						The recap section shows that the play finished successfully (<code class="literal">failed=0</code>) for all managed hosts, and that 4 kernel parameters have been applied (<code class="literal">changed=4</code>).
					</p></li><li class="listitem">
						Restart your managed hosts and check the affected kernel 
parameters to verify that the changes have been applied and persist 
across reboots.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL System Roles</a>
					</li><li class="listitem">
						<code class="literal">README.html</code> and <code class="literal">README.md</code> files in the <code class="literal">/usr/share/doc/rhel-system-roles/kernel_settings/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/network/getting_started/first_inventory.html">Build Your Inventory</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_configuration.html">Configuring Ansible</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks.html">Working With Playbooks</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html">Using Variables</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html">Roles</a>
					</li></ul></div></section></section><section class="chapter" id="applying-patches-with-kernel-live-patching_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Applying patches with kernel live patching</h1></div></div></div><p class="_abstract _abstract">
			You can use the Red Hat Enterprise Linux kernel live patching 
solution to patch a running kernel without rebooting or restarting any 
processes.
		</p><p>
			With this solution, system administrators:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Can immediately apply critical security patches to the kernel.
				</li><li class="listitem">
					Do not have to wait for long-running tasks to complete, for users to log off, or for scheduled downtime.
				</li><li class="listitem">
					Control the systems uptime more and do not sacrifice security or stability.
				</li></ul></div><p>
			Note that not every critical or important CVE will be resolved using 
the kernel live patching solution. Our goal is to reduce the required 
reboots for security-related patches, not to eliminate them entirely. 
For more details about the scope of live patching, see the <span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/solutions/2206511">Customer Portal Solutions article</a></span></em></span>.
		</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
				Some incompatibilities exist between kernel live patching and other kernel subcomponents. Read the
			</p><p>
				<a class="link" href="#limitations-of-kpatch_applying-patches-with-kernel-live-patching" title="7.1.&nbsp;Limitations of kpatch">Limitations of kpatch</a> carefully before using kernel live patching.
			</p></div></div><section class="section" id="limitations-of-kpatch_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.1. Limitations of kpatch</h2></div></div></div><div class="itemizedlist _abstract"><ul class="itemizedlist _abstract" type="disc"><li class="listitem">
						The <code class="literal">kpatch</code> feature is not a 
general-purpose kernel upgrade mechanism. It is used for applying simple
 security and bug fix updates when rebooting the system is not 
immediately possible.
					</li><li class="listitem">
						Do not use the <code class="literal">SystemTap</code> or <code class="literal">kprobe</code> tools during or after loading a patch. The patch could fail to take effect until after such probes have been removed.
					</li></ul></div></section><section class="section" id="support-for-third-party-live-patching_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.2. Support for third-party live patching</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">kpatch</code> utility is the only kernel 
live patching utility supported by Red&nbsp;Hat with the RPM modules 
provided by Red&nbsp;Hat repositories. Red&nbsp;Hat will not support any
 live patches which were not provided by Red&nbsp;Hat itself.
			</p><p>
				If you require support for an issue that arises with a third-party 
live patch, Red&nbsp;Hat recommends that you open a case with the live 
patching vendor at the outset of any investigation in which a root cause
 determination is necessary. This allows the source code to be supplied 
if the vendor allows, and for their support organization to provide 
assistance in root cause determination prior to escalating the 
investigation to Red&nbsp;Hat Support.
			</p><p>
				For any system running with third-party live patches, Red&nbsp;Hat 
reserves the right to ask for reproduction with Red&nbsp;Hat shipped and
 supported software. In the event that this is not possible, we require a
 similar system and workload be deployed on your test environment 
without live patches applied, to confirm if the same behavior is 
observed.
			</p><p>
				For more information about third-party software support policies, see <a class="link" href="https://access.redhat.com/articles/1067">How
 does Red&nbsp;Hat Global Support Services handle third-party software, 
drivers, and/or uncertified hardware/hypervisors or guest operating 
systems?</a>
			</p></section><section class="section" id="access-to-kernel-live-patches_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.3. Access to kernel live patches</h2></div></div></div><p class="_abstract _abstract">
				Kernel live patching capability is implemented as a kernel module (<code class="literal">kmod</code>) that is delivered as an RPM package.
			</p><p>
				All customers have access to kernel live patches, which are 
delivered through the usual channels. However, customers who do not 
subscribe to an extended support offering will lose access to new 
patches for the current minor release once the next minor release 
becomes available. For example, customers with standard subscriptions 
will only be able to live patch RHEL 9.1 kernel until the RHEL 9.2 
kernel is released.
			</p></section><section class="section" id="components-of-kernel-live-patching_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.4. Components of kernel live patching</h2></div></div></div><p class="_abstract _abstract">
				The components of kernel live patching are as follows:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Kernel patch module</span></dt><dd><p class="simpara">

						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The delivery mechanism for kernel live patches.
								</li><li class="listitem">
									A kernel module which is built specifically for the kernel being patched.
								</li><li class="listitem">
									The patch module contains the code of the desired fixes for the kernel.
								</li><li class="listitem">
									The patch modules register with the <code class="literal">livepatch</code>
 kernel subsystem and provide information about original functions to be
 replaced, with corresponding pointers to the replacement functions. 
Kernel patch modules are delivered as RPMs.
								</li><li class="listitem">
									The naming convention is <code class="literal">kpatch_&lt;kernel version&gt;_&lt;kpatch version&gt;_&lt;kpatch release&gt;</code>. The "kernel version" part of the name has <span class="emphasis"><em>dots</em></span> replaced with <span class="emphasis"><em>underscores</em></span>.
								</li></ul></div></dd><dt><span class="term">The <code class="literal">kpatch</code> utility</span></dt><dd>
							A command-line utility for managing patch modules.
						</dd><dt><span class="term">The <code class="literal">kpatch</code> service</span></dt><dd>
							A <code class="literal">systemd</code> service required by <code class="literal">multiuser.target</code>. This target loads the kernel patch module at boot time.
						</dd><dt><span class="term">The <code class="literal">kpatch-dnf</code> package</span></dt><dd>
							A DNF plugin delivered in the form of an RPM package. This plugin manages automatic subscription to kernel live patches.
						</dd></dl></div></section><section class="section" id="how-kernel-live-patching-works_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.5. How kernel live patching works</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">kpatch</code> kernel patching solution uses the <code class="literal">livepatch</code>
 kernel subsystem to redirect old functions to new ones. When a live 
kernel patch is applied to a system, the following things happen:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						The kernel patch module is copied to the <code class="literal">/var/lib/kpatch/</code> directory and registered for re-application to the kernel by <code class="literal">systemd</code> on next boot.
					</li><li class="listitem">
						The kpatch module is loaded into the running kernel and the new functions are registered to the <code class="literal">ftrace</code> mechanism with a pointer to the location in memory of the new code.
					</li><li class="listitem">
						When the kernel accesses the patched function, it is redirected by the <code class="literal">ftrace</code> mechanism which bypasses the original functions and redirects the kernel to patched version of the function.
					</li></ol></div><div class="figure" id="applying-patches-with-kernel-live-patching-figu-how-kpatch-works"><p class="title">Figure 7.1. How kernel live patching works</p><div class="figure-contents"><div class="mediaobject"><a href="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US/images/0753f887dc454f8d70e75ba6ebe5d325/rhel_kpatch_overview.png" class="rh_docs--zoom" title="rhel kpatch overview"><img src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rhel_kpatch_overview.png" alt="rhel kpatch overview"></a></div></div></div></section><section class="section" id="subscribing-the-currently-installed-kernels-to-the-live-patching-stream_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.6. Subscribing the currently installed kernels to the live patching stream</h2></div></div></div><p class="_abstract _abstract">
				A kernel patch module is delivered in an RPM package, specific to 
the version of the kernel being patched. Each RPM package will be 
cumulatively updated over time.
			</p><p>
				The following procedure explains how to subscribe to all future 
cumulative live patching updates for a given kernel. Because live 
patches are cumulative, you cannot select which individual patches are 
deployed for a given kernel.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Red&nbsp;Hat does not support any third party live patches applied to a Red&nbsp;Hat supported system.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optionally, check your kernel version:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9xs37cv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>uname -r</strong></span>
5.14.0-1.el9.x86_64</pre></div></div></li><li class="listitem"><p class="simpara">
						Search for a live patching package that corresponds to the version of your kernel:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ixqejje"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf search $(uname -r)</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Install the live patching package:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rbm035m"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf install "kpatch-patch = $(uname -r)"</strong></span></pre></div></div><p class="simpara">
						The command above installs and applies the latest cumulative live patches for that specific kernel only.
					</p><p class="simpara">
						If the version of a live patching package is 1-1 or higher, the 
package will contain a patch module. In that case the kernel will be 
automatically patched during the installation of the live patching 
package.
					</p><p class="simpara">
						The kernel patch module is also installed into the <code class="literal">/var/lib/kpatch/</code> directory to be loaded by the <code class="literal">systemd</code> system and service manager during the future reboots.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							An empty live patching package will be installed when there are 
no live patches available for a given kernel. An empty live patching 
package will have a <span class="emphasis"><em>kpatch_version-kpatch_release</em></span> of 0-0, for example <code class="literal">kpatch-patch-5_14_0-1-0-0.x86_64.rpm</code>. The installation of the empty RPM subscribes the system to all future live patches for the given kernel.
						</p></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification step</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Verify that all installed kernels have been patched:
					</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--z2ylpa5"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kpatch list</strong></span>
Loaded patch modules:
kpatch_5_14_0_1_0_1 [enabled]

Installed patch modules:
kpatch_5_14_0_1_0_1 (5.14.0-1.el9.x86_64)
</pre></div></div><p>
				The output shows that the kernel patch module has been loaded into 
the kernel that is now patched with the latest fixes from the <code class="literal">kpatch-patch-5_14_0-1-0-1.el9.x86_64.rpm</code> package.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Entering the <code class="literal">kpatch list</code> command does not return an empty live patching package. Use the <code class="literal">rpm -qa | grep kpatch</code> command instead.
				</p></div></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--n1xxtim"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><span class="strong strong"><strong># rpm -qa | grep kpatch</strong></span>
kpatch-dnf-0.4-3.el9.noarch
kpatch-0.9.7-2.el9.noarch
kpatch-patch-5_14_0-284_25_1-0-0.el9_2.x86_64</pre></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">kpatch(1)</code> manual page
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_software_with_the_dnf_tool/assembly_installing-rhel-9-content_managing-software-with-the-dnf-tool">Installing RHEL 9 content</a>
					</li></ul></div></section><section class="section" id="automatically-subscribing-any-future-kernel-to-the-live-patching-stream_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.7. Automatically subscribing any future kernel to the live patching stream</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">kpatch-dnf</code> DNF plugin 
to subscribe your system to fixes delivered by the kernel patch module, 
also known as kernel live patches. The plugin enables <span class="strong strong"><strong>automatic</strong></span> subscription for any kernel the system currently uses, and also for kernels <span class="strong strong"><strong>to-be-installed in the future</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optionally, check all installed kernels and the kernel you are currently running:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--u1v09zk"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf list installed | grep kernel</strong></span>
Updating Subscription Management repositories.
Installed Packages
...
kernel-core.x86_64            5.14.0-1.el9              @beaker-BaseOS
kernel-core.x86_64            5.14.0-2.el9              @@commandline
...

# <span class="strong strong"><strong>uname -r</strong></span>
5.14.0-2.el9.x86_64</pre></div></div></li><li class="listitem"><p class="simpara">
						Install the <code class="literal">kpatch-dnf</code> plugin:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nnutlik"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf install kpatch-dnf</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Enable automatic subscription to kernel live patches:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2hbdho8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf kpatch auto</strong></span>
Updating Subscription Management repositories.
Last metadata expiration check: 1:38:21 ago on Fri 17 Sep 2021 07:29:53 AM EDT.
Dependencies resolved.
==================================================
 Package                             Architecture
==================================================
Installing:
 kpatch-patch-5_14_0-1               x86_64
 kpatch-patch-5_14_0-2               x86_64

Transaction Summary
===================================================
Install  2 Packages
</pre></div></div><p class="simpara">
						This command subscribes all currently installed kernels to 
receiving kernel live patches. The command also installs and applies the
 latest cumulative live patches, if any, for all installed kernels.
					</p><p class="simpara">
						In the future, when you update the kernel, live patches will 
automatically be installed during the new kernel installation process.
					</p><p class="simpara">
						The kernel patch module is also installed into the <code class="literal">/var/lib/kpatch/</code> directory to be loaded by the <code class="literal">systemd</code> system and service manager during future reboots.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							An empty live patching package will be installed when there are 
no live patches available for a given kernel. An empty live patching 
package will have a <span class="emphasis"><em>kpatch_version-kpatch_release</em></span> of 0-0, for example <code class="literal">kpatch-patch-5_14_0-1-0-0.el9.x86_64.rpm</code> .The installation of the empty RPM subscribes the system to all future live patches for the given kernel.
						</p></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification step</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Verify that all installed kernels have been patched:
					</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--l3pnh84"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kpatch list</strong></span>
Loaded patch modules:
kpatch_5_14_0_2_0_1 [enabled]

Installed patch modules:
kpatch_5_14_0_1_0_1 (5.14.0-1.el9.x86_64)
kpatch_5_14_0_2_0_1 (5.14.0-2.el9.x86_64)</pre></div></div><p>
				The output shows that both the kernel you are running, and the other installed kernel have been patched with fixes from <code class="literal">kpatch-patch-5_14_0-1-0-1.el9.x86_64.rpm</code> and <code class="literal">kpatch-patch-5_14_0-2-0-1.el9.x86_64.rpm</code> packages respectively.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Entering the <code class="literal">kpatch list</code> command does not return an empty live patching package. Use the <code class="literal">rpm -qa | grep kpatch</code> command instead.
				</p></div></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--81xoz43"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>rpm -qa | grep kpatch</strong></span>
kpatch-dnf-0.4-3.el9.noarch
kpatch-0.9.7-2.el9.noarch
kpatch-patch-5_14_0-284_25_1-0-0.el9_2.x86_64</pre></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">kpatch(1)</code> and <code class="literal">dnf-kpatch(8)</code> manual pages
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_basic_system_settings/index#installing-software-packages_managing-software-packages">Configuring basic system settings</a></span></em></span> in RHEL
					</li></ul></div></section><section class="section" id="proc_disabling-automatic-subscription-to-the-live-patching-stream.adoc_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.8. Disabling automatic subscription to the live patching stream</h2></div></div></div><p class="_abstract _abstract">
				When you subscribe your system to fixes delivered by the kernel patch module, your subscription is <span class="strong strong"><strong>automatic</strong></span>. You can disable this feature, and thus disable automatic installation of <code class="literal">kpatch-patch</code> packages.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optionally, check all installed kernels and the kernel you are currently running:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3ebetjv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf list installed | grep kernel</strong></span>
Updating Subscription Management repositories.
Installed Packages
...
kernel-core.x86_64            5.14.0-1.el9              @beaker-BaseOS
kernel-core.x86_64            5.14.0-2.el9              @@commandline
...

# <span class="strong strong"><strong>uname -r</strong></span>
5.14.0-2.el9.x86_64</pre></div></div></li><li class="listitem"><p class="simpara">
						Disable automatic subscription to kernel live patches:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qo8sd4k"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf kpatch manual</strong></span>
Updating Subscription Management repositories.</pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification step</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You can check for the successful outcome:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7bvigml"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>yum kpatch status</strong></span>
...
Updating Subscription Management repositories.
Last metadata expiration check: 0:30:41 ago on Tue Jun 14 15:59:26 2022.
Kpatch update setting: <span class="strong strong"><strong>manual</strong></span></pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">kpatch(1)</code> and <code class="literal">dnf-kpatch(8)</code> manual pages
					</li></ul></div></section><section class="section" id="updating-kernel-patch-modules_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.9. Updating kernel patch modules</h2></div></div></div><p class="_abstract _abstract">
				Since kernel patch modules are delivered and applied through RPM 
packages, updating a cumulative kernel patch module is like updating any
 other RPM package.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The system is subscribed to the live patching stream, as described in <a class="link" href="#subscribing-the-currently-installed-kernels-to-the-live-patching-stream_applying-patches-with-kernel-live-patching" title="7.6.&nbsp;Subscribing the currently installed kernels to the live patching stream">Subscribing the currently installed kernels to the live patching stream</a>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Update to a new cumulative version for the current kernel:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ymoz50v"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf update "kpatch-patch = $(uname -r)"</strong></span></pre></div></div><p class="simpara">
						The command above automatically installs and applies any updates 
that are available for the currently running kernel. Including any 
future released cumulative live patches.
					</p></li><li class="listitem"><p class="simpara">
						Alternatively, update all installed kernel patch modules:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xcp0jlm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf update "kpatch-patch</strong></span>"</pre></div></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					When the system reboots into the same kernel, the kernel is automatically live patched again by the <code class="literal">kpatch.service</code> systemd service.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_basic_system_settings/index#updating-software-packages_managing-software-packages">Configuring basic system settings</a></span></em></span> in RHEL
					</li></ul></div></section><section class="section" id="removing-the-live-patching-package_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.10. Removing the live patching package</h2></div></div></div><p class="_abstract _abstract">
				Disable the Red&nbsp;Hat Enterprise&nbsp;Linux kernel live patching solution by removing the live patching package.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li><li class="listitem">
						The live patching package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Select the live patching package.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5evkmfg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf list installed | grep kpatch-patch</strong></span>
kpatch-patch-5_14_0-1.x86_64        0-1.el9        @@commandline
</pre></div></div><p class="simpara">
						The example output above lists live patching packages that you installed.
					</p></li><li class="listitem"><p class="simpara">
						Remove the live patching package.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--q83tkkt"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf remove kpatch-patch-5_14_0-1.x86_64</strong></span></pre></div></div><p class="simpara">
						When a live patching package is removed, the kernel remains 
patched until the next reboot, but the kernel patch module is removed 
from disk. On future reboot, the corresponding kernel will no longer be 
patched.
					</p></li><li class="listitem">
						Reboot your system.
					</li><li class="listitem"><p class="simpara">
						Verify that the live patching package has been removed.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1p9cn1e"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf list installed | grep kpatch-patch</strong></span></pre></div></div><p class="simpara">
						The command displays no output if the package has been successfully removed.
					</p></li><li class="listitem"><p class="simpara">
						Optionally, verify that the kernel live patching solution is disabled.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zvdy64h"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kpatch list</strong></span>
Loaded patch modules:</pre></div></div><p class="simpara">
						The example output shows that the kernel is not patched and the 
live patching solution is not active because there are no patch modules 
that are currently loaded.
					</p></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Currently, Red Hat does not support reverting live patches without 
rebooting your system. In case of any issues, contact our support team.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">kpatch(1)</code> manual page
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_basic_system_settings/index#uninstalling-software-packages_managing-software-packages">Configuring basic system settings</a></span></em></span> in RHEL
					</li></ul></div></section><section class="section" id="uninstalling-the-kernel-patch-module_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.11. Uninstalling the kernel patch module</h2></div></div></div><p class="_abstract _abstract">
				Prevent the Red&nbsp;Hat Enterprise&nbsp;Linux kernel live patching 
solution from applying a kernel patch module on subsequent boots.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li><li class="listitem">
						A live patching package is installed.
					</li><li class="listitem">
						A kernel patch module is installed and loaded.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Select a kernel patch module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--cd7y0iz"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kpatch list</strong></span>
Loaded patch modules:
kpatch_5_14_0_1_0_1 [enabled]

Installed patch modules:
kpatch_5_14_0_1_0_1 (5.14.0-1.el9.x86_64)
</pre></div></div></li><li class="listitem"><p class="simpara">
						Uninstall the selected kernel patch module.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--91gwu9x"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kpatch uninstall kpatch_5_14_0_1_0_1</strong></span>
uninstalling kpatch_5_14_0_1_0_1 (5.14.0-1.el9.x86_64)</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Note that the uninstalled kernel patch module is still loaded:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pbrkzk7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kpatch list</strong></span>
Loaded patch modules:
kpatch_5_14_0_1_0_1 [enabled]

Installed patch modules:
&lt;<span class="emphasis"><em>NO_RESULT</em></span>&gt;</pre></div></div><p class="simpara">
								When the selected module is uninstalled, the kernel remains 
patched until the next reboot, but the kernel patch module is removed 
from disk.
							</p></li></ul></div></li><li class="listitem">
						Reboot your system.
					</li><li class="listitem"><p class="simpara">
						Optionally, verify that the kernel patch module has been uninstalled.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--eic6b01"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kpatch list</strong></span>
Loaded patch modules:
</pre></div></div><p class="simpara">
						The example output above shows no loaded or installed kernel patch
 modules, therefore the kernel is not patched and the kernel live 
patching solution is not active.
					</p></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Currently, Red Hat does not support reverting live patches without 
rebooting your system. In case of any issues, contact our support team.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">kpatch(1)</code> manual page
					</li></ul></div></section><section class="section" id="disabling-kpatch-service_applying-patches-with-kernel-live-patching"><div class="titlepage"><div><div><h2 class="title">7.12. Disabling kpatch.service</h2></div></div></div><p class="_abstract _abstract">
				Prevent the Red&nbsp;Hat Enterprise&nbsp;Linux kernel live patching 
solution from applying all kernel patch modules globally on subsequent 
boots.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions
					</li><li class="listitem">
						A live patching package is installed.
					</li><li class="listitem">
						A kernel patch module is installed and loaded.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify <code class="literal">kpatch.service</code> is enabled.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--i57bx0g"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl is-enabled kpatch.service</strong></span>
enabled</pre></div></div></li><li class="listitem"><p class="simpara">
						Disable <code class="literal">kpatch.service</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nyr4a45"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl disable kpatch.service</strong></span>
Removed /etc/systemd/system/multi-user.target.wants/kpatch.service.</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Note that the applied kernel patch module is still loaded:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7gjlaf7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kpatch list</strong></span>
Loaded patch modules:
kpatch_5_14_0_1_0_1 [enabled]

Installed patch modules:
kpatch_5_14_0_1_0_1 (5.14.0-1.el9.x86_64)</pre></div></div></li></ul></div></li><li class="listitem">
						Reboot your system.
					</li><li class="listitem"><p class="simpara">
						Optionally, verify the status of <code class="literal">kpatch.service</code>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ma314wc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl status kpatch.service</strong></span>
 kpatch.service - "Apply kpatch kernel patches"
   Loaded: loaded (/usr/lib/systemd/system/kpatch.service; disabled; vendor preset: disabled)
   Active: inactive (dead)</pre></div></div><p class="simpara">
						The example output testifies that <code class="literal">kpatch.service</code> has been disabled and is not running. Thereby, the kernel live patching solution is not active.
					</p></li><li class="listitem"><p class="simpara">
						Verify that the kernel patch module has been unloaded.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--u6nqbir"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kpatch list</strong></span>
Loaded patch modules:

Installed patch modules:
kpatch_5_14_0_1_0_1 (5.14.0-1.el9.x86_64)</pre></div></div><p class="simpara">
						The example output above shows that a kernel patch module is still installed but the kernel is not patched.
					</p></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Currently, Red Hat does not support reverting live patches without 
rebooting your system. In case of any issues, contact our support team.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">kpatch(1)</code> manual page
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_basic_system_settings/index#managing-system-services-with-systemctl_configuring-basic-system-settings">Managing system services with systemctl</a>
					</li></ul></div></section></section><section class="chapter" id="keeping-kernel-panic-parameters-disabled-in-virtualized-environments_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Keeping kernel panic parameters disabled in virtualized environments</h1></div></div></div><p class="_abstract _abstract">
			When configuring a virtualized environment in RHEL 9, you should not enable the <code class="literal">softlockup_panic</code> and <code class="literal">nmi_watchdog</code>
 kernel parameters, because the virtualized environment may trigger a 
spurious soft lockup that should not require a system panic.
		</p><p>
			Find the reasons behind this advice in the following sections.
		</p><section class="section" id="what-is-a-soft-lockup_keeping-kernel-panic-parameters-disabled-in-virtualized-environments"><div class="titlepage"><div><div><h2 class="title">8.1. What is a soft lockup</h2></div></div></div><p class="_abstract _abstract">
				A soft lockup is a situation usually caused by a bug, when a task is
 executing in kernel space on a CPU without rescheduling. The task also 
does not allow any other task to execute on that particular CPU. As a 
result, a warning is displayed to a user through the system console. 
This problem is also referred to as the soft lockup firing.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/articles/371803">What is a CPU soft lockup? </a></span></em></span>
					</li></ul></div></section><section class="section" id="parameters-controlling-kernel-panic_keeping-kernel-panic-parameters-disabled-in-virtualized-environments"><div class="titlepage"><div><div><h2 class="title">8.2. Parameters controlling kernel panic</h2></div></div></div><p class="_abstract _abstract">
				The following kernel parameters can be set to control a systems behavior when a soft lockup is detected.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">softlockup_panic</span></dt><dd><p class="simpara">
							Controls whether or not the kernel will panic when a soft lockup is detected.
						</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="r3p3ntr" id="rh-table--r3p3ntr"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 29%; " class="col_1"><!--Empty--><col style="width: 14%; " class="col_2"><!--Empty--><col style="width: 57%; " class="col_3"><!--Empty--></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139983842847696" scope="col" data-row="1" data-col="1" class="content--sm">Type</th><th style="text-align: left; vertical-align: top; " id="idm139983842846608" scope="col" data-row="1" data-col="2" class="content--sm">Value</th><th style="text-align: left; vertical-align: top; " id="idm139983852548384" scope="col" data-row="1" data-col="3" class="content--sm">Effect</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139983842847696" data-row="2" data-col="1" class="content--md"> <p>
											Integer
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm139983842846608" data-row="2" data-col="2" class="content--md"> <p>
											0
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm139983852548384" data-row="2" data-col="3" class="content--md"> <p>
											kernel does not panic on soft lockup
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139983842847696" data-row="3" data-col="1" class="content--md"> <p>
											Integer
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm139983842846608" data-row="3" data-col="2" class="content--md"> <p>
											1
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm139983852548384" data-row="3" data-col="3" class="content--md"> <p>
											kernel panics on soft lockup
										</p>
										 </td></tr></tbody></table></rh-table><p class="simpara">
							By default, on RHEL8 this value is 0.
						</p><p class="simpara">
							In order to panic, the system needs to detect a hard lockup first. The detection is controlled by the <code class="literal">nmi_watchdog</code> parameter.
						</p></dd><dt><span class="term">nmi_watchdog</span></dt><dd><p class="simpara">
							Controls whether lockup detection mechanisms (<code class="literal">watchdogs</code>) are active or not. This parameter is of integer type.
						</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="xrot9kp" id="rh-table--xrot9kp"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139983851161312" scope="col" data-row="1" data-col="1" class="content--sm">Value</th><th style="text-align: left; vertical-align: top; " id="idm139983851160224" scope="col" data-row="1" data-col="2" class="content--sm">Effect</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139983851161312" data-row="2" data-col="1" class="content--md"> <p>
											0
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm139983851160224" data-row="2" data-col="2" class="content--md"> <p>
											disables lockup detector
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm139983851161312" data-row="3" data-col="1" class="content--md"> <p>
											1
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm139983851160224" data-row="3" data-col="2" class="content--md"> <p>
											enables lockup detector
										</p>
										 </td></tr></tbody></table></rh-table><p class="simpara">
							The hard lockup detector monitors each CPU for its ability to respond to interrupts.
						</p></dd><dt><span class="term">watchdog_thresh</span></dt><dd><p class="simpara">
							Controls frequency of watchdog <code class="literal">hrtimer</code>, NMI events, and soft/hard lockup thresholds.
						</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="4s2nzuy" id="rh-table--4s2nzuy"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm139983844379328" scope="col" data-row="1" data-col="1" class="content--sm">Default threshold</th><th style="text-align: left; vertical-align: top; " id="idm139983844378240" scope="col" data-row="1" data-col="2" class="content--sm">Soft lockup threshold</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm139983844379328" data-row="2" data-col="1" class="content--md"> <p>
											10 seconds
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm139983844378240" data-row="2" data-col="2" class="content--md"> <p>
											2 * <code class="literal">watchdog_thresh</code>
										</p>
										 </td></tr></tbody></table></rh-table><p class="simpara">
							Setting this parameter to zero disables lockup detection altogether.
						</p></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://www.kernel.org/doc/Documentation/lockup-watchdogs.txt">Softlockup detector and hardlockup detector</a></span></em></span>
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://www.kernel.org/doc/Documentation/sysctl/kernel.txt">Kernel sysctl</a></span></em></span>
					</li></ul></div></section><section class="section" id="spurious-soft-lockups-in-virtualized-environments_keeping-kernel-panic-parameters-disabled-in-virtualized-environments"><div class="titlepage"><div><div><h2 class="title">8.3. Spurious soft lockups in virtualized environments</h2></div></div></div><p class="_abstract _abstract">
				The soft lockup firing on physical hosts, as described in <a class="link" href="#what-is-a-soft-lockup_keeping-kernel-panic-parameters-disabled-in-virtualized-environments" title="8.1.&nbsp;What is a soft lockup">What is a soft lockup</a>,
 usually represents a kernel or hardware bug. The same phenomenon 
happening on guest operating systems in virtualized environments may 
represent a false warning.
			</p><p>
				Heavy work-load on a host or high contention over some specific 
resource such as memory, usually causes a spurious soft lockup firing. 
This is because the host may schedule out the guest CPU for a period 
longer than 20 seconds. Then when the guest CPU is again scheduled to 
run on the host, it experiences a <span class="emphasis"><em>time jump</em></span> which triggers due timers. The timers include also watchdog <code class="literal">hrtimer</code>, which can consequently report a soft lockup on the guest CPU.
			</p><p>
				Because a soft lockup in a virtualized environment may be spurious, 
you should not enable the kernel parameters that would cause a system 
panic when a soft lockup is reported on a guest CPU.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					To understand soft lockups in guests, it is essential to know that 
the host schedules the guest as a task, and the guest then schedules its
 own tasks.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#what-is-a-soft-lockup_keeping-kernel-panic-parameters-disabled-in-virtualized-environments" title="8.1.&nbsp;What is a soft lockup">What is a soft lockup</a>
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_and_managing_virtualization/index#rhel-virtual-machine-components-and-their-interaction_introducing-virtualization-in-rhel">Virtual machine components and their interaction</a></span></em></span>
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/solutions/1503333">Virtual machine reports a "BUG: soft lockup"</a></span></em></span>
					</li></ul></div></section></section><section class="chapter" id="adjusting-kernel-parameters-for-database-servers_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 9. Adjusting kernel parameters for database servers</h1></div></div></div><p class="_abstract _abstract">
			There are different sets of kernel parameters which can affect 
performance of specific database applications. To secure efficient 
operation of database servers and databases, configure the respective 
kernel parameters accordingly.
		</p><section class="section" id="introduction-to-databases_adjusting-kernel-parameters-for-database-servers"><div class="titlepage"><div><div><h2 class="title">9.1. Introduction to database servers</h2></div></div></div><p class="_abstract _abstract">
				A database server is a service that provides features of a database 
management system (DBMS). DBMS provides utilities for database 
administration and interacts with end users, applications, and 
databases.
			</p><p>
				Red&nbsp;Hat Enterprise&nbsp;Linux 9 provides the following database management systems:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>MariaDB 10.5</strong></span>
					</li><li class="listitem">
						<span class="strong strong"><strong>MySQL 8.0</strong></span>
					</li><li class="listitem">
						<span class="strong strong"><strong>PostgreSQL 13</strong></span>
					</li><li class="listitem">
						<span class="strong strong"><strong>Redis 6</strong></span>
					</li></ul></div></section><section class="section" id="parameters-affecting-performance-of-database-applications_adjusting-kernel-parameters-for-database-servers"><div class="titlepage"><div><div><h2 class="title">9.2. Parameters affecting performance of database applications</h2></div></div></div><p class="_abstract _abstract">
				The following kernel parameters affect performance of database applications.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">fs.aio-max-nr</span></dt><dd><p class="simpara">
							Defines the maximum number of asynchronous I/O operations the system can handle on the server.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Raising the <code class="literal">fs.aio-max-nr</code> parameter produces no additional changes beyond increasing the aio limit.
							</p></div></div></dd><dt><span class="term">fs.file-max</span></dt><dd><p class="simpara">
							Defines the maximum number of file handles (temporary file names 
or IDs assigned to open files) the system supports at any instance.
						</p><p class="simpara">
							The kernel dynamically allocates file handles whenever a file 
handle is requested by an application. The kernel however does not free 
these file handles when they are released by the application. The kernel
 recycles these file handles instead. This means that over time the 
total number of allocated file handles will increase even though the 
number of currently used file handles may be low.
						</p></dd><dt><span class="term">kernel.shmall</span></dt><dd>
							Defines the total number of shared memory pages that can be used 
system-wide. To use the entire main memory, the value of the <code class="literal">kernel.shmall</code> parameter should be  total main memory size.
						</dd><dt><span class="term">kernel.shmmax</span></dt><dd>
							Defines the maximum size in bytes of a single shared memory 
segment that a Linux process can allocate in its virtual address space.
						</dd><dt><span class="term">kernel.shmmni</span></dt><dd>
							Defines the maximum number of shared memory segments the database server is able to handle.
						</dd><dt><span class="term">net.ipv4.ip_local_port_range</span></dt><dd>
							Defines the port range the system can use for programs which want
 to connect to a database server without a specific port number.
						</dd><dt><span class="term">net.core.rmem_default</span></dt><dd>
							Defines the default receive socket memory through Transmission Control Protocol (TCP).
						</dd><dt><span class="term">net.core.rmem_max</span></dt><dd>
							Defines the maximum receive socket memory through Transmission Control Protocol (TCP).
						</dd><dt><span class="term">net.core.wmem_default</span></dt><dd>
							Defines the default send socket memory through Transmission Control Protocol (TCP).
						</dd><dt><span class="term">net.core.wmem_max</span></dt><dd>
							Defines the maximum send socket memory through Transmission Control Protocol (TCP).
						</dd><dt><span class="term">vm.dirty_bytes / vm.dirty_ratio</span></dt><dd>
							Defines a threshold in bytes / in percentage of dirty-able memory
 at which a process generating dirty data is started in the <code class="literal">write()</code> function.
						</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					<span class="strong strong"><strong>Either</strong></span> <code class="literal">vm.dirty_bytes</code> <span class="strong strong"><strong>or</strong></span> <code class="literal">vm.dirty_ratio</code> can be specified at a time.
				</p></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">vm.dirty_background_bytes / vm.dirty_background_ratio</span></dt><dd>
							Defines a threshold in bytes / in percentage of dirty-able memory
 at which the kernel tries to actively write dirty data to hard-disk.
						</dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					<span class="strong strong"><strong>Either</strong></span> <code class="literal">vm.dirty_background_bytes</code> <span class="strong strong"><strong>or</strong></span> <code class="literal">vm.dirty_background_ratio</code> can be specified at a time.
				</p></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">vm.dirty_writeback_centisecs</span></dt><dd><p class="simpara">
							Defines a time interval between periodic wake-ups of the kernel threads responsible for writing dirty data to hard-disk.
						</p><p class="simpara">
							This kernel parameters measures in 100ths of a second.
						</p></dd><dt><span class="term">vm.dirty_expire_centisecs</span></dt><dd><p class="simpara">
							Defines the time after which dirty data is old enough to be written to hard-disk.
						</p><p class="simpara">
							This kernel parameters measures in 100ths of a second.
						</p></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/articles/45002#control-parameters-4">Dirty pagecache writeback and vm.dirty parameters</a></span></em></span>
					</li></ul></div></section></section><section class="chapter" id="getting-started-with-kernel-logging_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 10. Getting started with kernel logging</h1></div></div></div><p class="_abstract _abstract">
			Log files are files that contain messages about the system, including
 the kernel, services, and applications running on it. The logging 
system in Red&nbsp;Hat Enterprise&nbsp;Linux is based on the built-in <span class="strong strong"><strong>syslog</strong></span>
 protocol. Various utilities use this system to record events and 
organize them into log files. These files are useful when auditing the 
operating system or troubleshooting problems.
		</p><section class="section" id="what-is-the-kernel-ring-buffer_getting-started-with-kernel-logging"><div class="titlepage"><div><div><h2 class="title">10.1. What is the kernel ring buffer</h2></div></div></div><p class="_abstract _abstract">
				During the boot process, the console provides a lot of important 
information about the initial phase of the system startup. To avoid loss
 of the early messages the kernel utilizes what is called a ring buffer.
 This buffer stores all messages, including boot messages, generated by 
the <code class="literal">printk()</code> function within the kernel 
code. The messages from the kernel ring buffer are then read and stored 
in log files on permanent storage, for example, by the <code class="literal">syslog</code> service.
			</p><p>
				The buffer mentioned above is a cyclic data structure which has a 
fixed size, and is hard-coded into the kernel. Users can display data 
stored in the kernel ring buffer through the <code class="literal">dmesg</code> command or the <code class="literal">/var/log/boot.log</code> file. When the ring buffer is full, the new data overwrites the old.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">syslog(2)</code> and <code class="literal">dmesg(1)</code> manual page
					</li></ul></div></section><section class="section" id="role-of-printk-on-log-levels-and-kernel-logging_getting-started-with-kernel-logging"><div class="titlepage"><div><div><h2 class="title">10.2. Role of printk on log-levels and kernel logging</h2></div></div></div><p class="_abstract _abstract">
				Each message the kernel reports has a log-level associated with it 
that defines the importance of the message. The kernel ring buffer, as 
described in <a class="link" href="#what-is-the-kernel-ring-buffer_getting-started-with-kernel-logging" title="10.1.&nbsp;What is the kernel ring buffer">What is the kernel ring buffer</a>, collects kernel messages of all log-levels. It is the <code class="literal">kernel.printk</code> parameter that defines what messages from the buffer are printed to the console.
			</p><p>
				The log-level values break down in this order:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						0  Kernel emergency. The system is unusable.
					</li><li class="listitem">
						1  Kernel alert. Action must be taken immediately.
					</li><li class="listitem">
						2  Condition of the kernel is considered critical.
					</li><li class="listitem">
						3  General kernel error condition.
					</li><li class="listitem">
						4  General kernel warning condition.
					</li><li class="listitem">
						5  Kernel notice of a normal but significant condition.
					</li><li class="listitem">
						6  Kernel informational message.
					</li><li class="listitem">
						7  Kernel debug-level messages.
					</li></ul></div><p>
				By default, <code class="literal">kernel.printk</code> in RHEL 9 contains the following four values:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--511pszr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>sysctl kernel.printk</strong></span>
kernel.printk = 7	4	1	7</pre></div></div><p>
				The four values define the following:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						value. Console log-level, defines the lowest priority of messages printed to the console.
					</li><li class="listitem">
						value. Default log-level for messages without an explicit log-level attached to them.
					</li><li class="listitem">
						value. Sets the lowest possible log-level configuration for the console log-level.
					</li><li class="listitem"><p class="simpara">
						value. Sets default value for the console log-level at boot time.
					</p><p class="simpara">
						Each of these values above defines a different rule for handling error messages.
					</p></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The default <span class="strong strong"><strong>7 4 1 7</strong></span> <code class="literal">printk</code> value allows for better debugging of kernel activity. However, when coupled with a serial console, this <code class="literal">printk</code>
 setting is able to cause intense I/O bursts that could lead to a RHEL 
system becoming temporarily unresponsive. To avoid these situations, 
setting a <code class="literal">printk</code> value of <span class="strong strong"><strong>4 4 1 7</strong></span> typically works, but at the expense of losing the extra debugging information.
				</p><p>
					Also note that certain kernel command line parameters, such as <code class="literal">quiet</code> or <code class="literal">debug</code>, change the default <code class="literal">kernel.printk</code> values.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">syslog(2)</code> manual page
					</li></ul></div></section></section><section class="chapter" id="signing-a-kernel-and-modules-for-secure-boot_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 11. Signing a kernel and modules for Secure Boot</h1></div></div></div><p class="_abstract _abstract">
			You can enhance the security of your system by using a signed kernel 
and signed kernel modules. On UEFI-based build systems where Secure Boot
 is enabled, you can self-sign a privately built kernel or kernel 
modules. Furthermore, you can import your public key into a target 
system where you want to deploy your kernel or kernel modules.
		</p><p>
			If Secure Boot is enabled, all of the following components have to be
 signed with a private key and authenticated with the corresponding 
public key:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					UEFI operating system boot loader
				</li><li class="listitem">
					The Red&nbsp;Hat Enterprise&nbsp;Linux kernel
				</li><li class="listitem">
					All kernel modules
				</li></ul></div><p>
			If any of these components are not signed and authenticated, the system cannot finish the booting process.
		</p><p>
			Red&nbsp;Hat Enterprise&nbsp;Linux 9 includes:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Signed boot loaders
				</li><li class="listitem">
					Signed kernels
				</li><li class="listitem">
					Signed kernel modules
				</li></ul></div><p>
			In addition, the signed first-stage boot loader and the signed kernel
 include embedded Red&nbsp;Hat public keys. These signed executable 
binaries and embedded keys enable Red&nbsp;Hat Enterprise&nbsp;Linux 9 
to install, boot, and run with the Microsoft UEFI Secure Boot 
Certification Authority keys that are provided by the UEFI firmware on 
systems that support UEFI Secure Boot.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Not all UEFI-based systems include support for Secure Boot.
					</li><li class="listitem">
						The build system, where you build and sign your kernel module, 
does not need to have UEFI Secure Boot enabled and does not even need to
 be a UEFI-based system.
					</li></ul></div></div></div><section class="section" id="prerequisites"><div class="titlepage"><div><div><h2 class="title">11.1. Prerequisites</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To be able to sign externally built kernel modules, install the utilities from the following packages:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ayssoei"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf install pesign openssl kernel-devel mokutil keyutils</strong></span></pre></div></div><div class="table" id="idm139983842951568"><p class="title">Table 11.1. Required utilities</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="5nvcvk8" id="rh-table--5nvcvk8" style="--rh-table--scrollbar--width: 0px;"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 18%; " class="col_1"><!--Empty--><col style="width: 18%; " class="col_2"><!--Empty--><col style="width: 18%; " class="col_3"><!--Empty--><col style="width: 45%; " class="col_4"><!--Empty--></colgroup><thead><tr><th id="idm139983842944880" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Utility</th><th id="idm139983842943792" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Provided by package</th><th id="idm139983853121248" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">Used on</th><th id="idm139983853120160" scope="col" data-row="1" data-col="4" class="content--sm" valign="top" align="left">Purpose</th></tr></thead><tbody><tr><td headers="idm139983842944880" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
										<code class="literal">efikeygen</code>
									</p>
									 </td><td headers="idm139983842943792" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
										<code class="literal package">pesign</code>
									</p>
									 </td><td headers="idm139983853121248" data-row="2" data-col="3" class="content--md" valign="top" align="left"> <p>
										Build system
									</p>
									 </td><td headers="idm139983853120160" data-row="2" data-col="4" class="content--lg" valign="top" align="left"> <p>
										Generates public and private X.509 key pair
									</p>
									 </td></tr><tr><td headers="idm139983842944880" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
										<code class="literal">openssl</code>
									</p>
									 </td><td headers="idm139983842943792" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
										<code class="literal package">openssl</code>
									</p>
									 </td><td headers="idm139983853121248" data-row="3" data-col="3" class="content--md" valign="top" align="left"> <p>
										Build system
									</p>
									 </td><td headers="idm139983853120160" data-row="3" data-col="4" class="content--md" valign="top" align="left"> <p>
										Exports the unencrypted private key
									</p>
									 </td></tr><tr><td headers="idm139983842944880" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
										<code class="literal">sign-file</code>
									</p>
									 </td><td headers="idm139983842943792" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
										<code class="literal package">kernel-devel</code>
									</p>
									 </td><td headers="idm139983853121248" data-row="4" data-col="3" class="content--md" valign="top" align="left"> <p>
										Build system
									</p>
									 </td><td headers="idm139983853120160" data-row="4" data-col="4" class="content--lg" valign="top" align="left"> <p>
										Executable file used to sign a kernel module with the private key
									</p>
									 </td></tr><tr><td headers="idm139983842944880" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
										<code class="literal">mokutil</code>
									</p>
									 </td><td headers="idm139983842943792" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
										<code class="literal package">mokutil</code>
									</p>
									 </td><td headers="idm139983853121248" data-row="5" data-col="3" class="content--md" valign="top" align="left"> <p>
										Target system
									</p>
									 </td><td headers="idm139983853120160" data-row="5" data-col="4" class="content--lg" valign="top" align="left"> <p>
										Optional utility used to manually enroll the public key
									</p>
									 </td></tr><tr><td headers="idm139983842944880" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
										<code class="literal">keyctl</code>
									</p>
									 </td><td headers="idm139983842943792" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
										<code class="literal package">keyutils</code>
									</p>
									 </td><td headers="idm139983853121248" data-row="6" data-col="3" class="content--md" valign="top" align="left"> <p>
										Target system
									</p>
									 </td><td headers="idm139983853120160" data-row="6" data-col="4" class="content--lg" valign="top" align="left"> <p>
										Optional utility used to display public keys in the system keyring
									</p>
									 </td></tr></tbody></table></rh-table></div></li></ul></div></section><section class="section" id="con_what-is-uefi-secure-boot_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.2. What is UEFI Secure Boot</h2></div></div></div><p>
				With the <span class="emphasis"><em>Unified Extensible Firmware Interface</em></span>
 (UEFI) Secure Boot technology, you can prevent the execution of the 
kernel-space code that has not been signed by a trusted key. The system 
boot loader is signed with a cryptographic key. The database of public 
keys, which is contained in the firmware, authorizes the signing key. 
You can subsequently verify a signature in the next-stage boot loader 
and the kernel.
			</p><p>
				UEFI Secure Boot establishes a chain of trust from the firmware to the signed drivers and kernel modules as follows:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An UEFI private key signs, and a public key authenticates the <code class="literal">shim</code> first-stage boot loader. A <span class="emphasis"><em>certificate authority</em></span> (CA) in turn signs the public key. The CA is stored in the firmware database.
					</li><li class="listitem">
						The <code class="literal">shim</code> file contains the Red&nbsp;Hat public key <span class="strong strong"><strong>Red Hat Secure Boot (CA key 1)</strong></span> to authenticate the GRUB boot loader and the kernel.
					</li><li class="listitem">
						The kernel in turn contains public keys to authenticate drivers and modules.
					</li></ul></div><p>
				Secure Boot is the boot path validation component of the UEFI specification. The specification defines:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Programming interface for cryptographically protected UEFI variables in non-volatile storage.
					</li><li class="listitem">
						Storing the trusted X.509 root certificates in UEFI variables.
					</li><li class="listitem">
						Validation of UEFI applications such as boot loaders and drivers.
					</li><li class="listitem">
						Procedures to revoke known-bad certificates and application hashes.
					</li></ul></div><p>
				UEFI Secure Boot helps in the detection of unauthorized changes but does <span class="strong strong"><strong>not</strong></span>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Prevent installation or removal of second-stage boot loaders.
					</li><li class="listitem">
						Require explicit user confirmation of such changes.
					</li><li class="listitem">
						Stop boot path manipulations. Signatures are verified during booting, not when the boot loader is installed or updated.
					</li></ul></div><p>
				If the boot loader or the kernel are not signed by a system trusted key, Secure Boot prevents them from starting.
			</p></section><section class="section" id="con_uefi-secure-boot-support_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.3. UEFI Secure Boot support</h2></div></div></div><p>
				You can install and run Red&nbsp;Hat Enterprise&nbsp;Linux 9 on 
systems with enabled UEFI Secure Boot if the kernel and all the loaded 
drivers are signed with a trusted key. Red&nbsp;Hat provides kernels and
 drivers that are signed and authenticated by the relevant Red&nbsp;Hat 
keys.
			</p><p>
				If you want to load externally built kernels or drivers, you must sign them as well.
			</p><div class="itemizedlist"><p class="title"><strong>Restrictions imposed by UEFI Secure Boot</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The system only runs the kernel-mode code after its signature has been properly authenticated.
					</li><li class="listitem">
						GRUB module loading is disabled because there is no infrastructure
 for signing and verification of GRUB modules. Allowing them to be 
loaded constitutes execution of untrusted code inside the security 
perimeter that Secure Boot defines.
					</li><li class="listitem">
						Red Hat provides a signed GRUB binary that contains all the supported modules on Red&nbsp;Hat Enterprise&nbsp;Linux 9.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/1351013">Restrictions Imposed by UEFI Secure Boot</a>
					</li></ul></div></section><section class="section" id="ref_requirements-for-authenticating-kernel-modules-with-x-509-keys_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.4. Requirements for authenticating kernel modules with X.509 keys</h2></div></div></div><p class="_abstract _abstract">
				In Red&nbsp;Hat Enterprise&nbsp;Linux 9, when a kernel module is 
loaded, the kernel checks the signature of the module against the public
 X.509 keys from the kernel system keyring (<code class="literal">.builtin_trusted_keys</code>) and the kernel platform keyring (<code class="literal">.platform</code>). The <code class="literal">.platform</code> keyring contains keys from third-party platform providers and custom public keys. The keys from the kernel system <code class="literal">.blacklist</code> keyring are excluded from verification.
			</p><p>
				You need to meet certain conditions to load kernel modules on systems with enabled UEFI Secure Boot functionality:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If UEFI Secure Boot is enabled or if the <code class="literal option">module.sig_enforce</code> kernel parameter has been specified:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You can only load those signed kernel modules whose signatures were authenticated against keys from the system keyring (<code class="literal">.builtin_trusted_keys</code>) and the platform keyring (<code class="literal">.platform</code>).
							</li><li class="listitem">
								The public key must not be on the system revoked keys keyring (<code class="literal">.blacklist</code>).
							</li></ul></div></li><li class="listitem"><p class="simpara">
						If UEFI Secure Boot is disabled and the <code class="literal option">module.sig_enforce</code> kernel parameter has not been specified:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You can load unsigned kernel modules and signed kernel modules without a public key.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						If the system is not UEFI-based or if UEFI Secure Boot is disabled:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Only the keys embedded in the kernel are loaded onto <code class="literal">.builtin_trusted_keys</code> and <code class="literal">.platform</code>.
							</li><li class="listitem">
								You have no ability to augment that set of keys without rebuilding the kernel.
							</li></ul></div></li></ul></div><div class="table" id="idm139983873265888"><p class="title">Table 11.2. Kernel module authentication requirements for loading</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="jkapelz" id="rh-table--jkapelz" style="--rh-table--scrollbar--width: 0px;"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 18%; " class="col_1"><!--Empty--><col style="width: 18%; " class="col_2"><!--Empty--><col style="width: 18%; " class="col_3"><!--Empty--><col style="width: 18%; " class="col_4"><!--Empty--><col style="width: 18%; " class="col_5"><!--Empty--><col style="width: 9%; " class="col_6"><!--Empty--></colgroup><thead><tr><th id="idm139983842244560" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Module signed</th><th id="idm139983842243472" scope="col" data-row="1" data-col="2" class="content--md" valign="top" align="left">Public key found and signature valid</th><th id="idm139983842242368" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">UEFI Secure Boot state</th><th id="idm139983842241280" scope="col" data-row="1" data-col="4" class="content--sm" valign="top" align="left"><code class="literal">sig_enforce</code></th><th id="idm139983842142928" scope="col" data-row="1" data-col="5" class="content--sm" valign="top" align="left">Module load</th><th id="idm139983842141840" scope="col" data-row="1" data-col="6" class="content--sm" valign="top" align="left">Kernel tainted</th></tr></thead><tbody><tr><td rowspan="3" headers="idm139983842244560" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								Unsigned
							</p>
							 </td><td rowspan="3" headers="idm139983842243472" data-row="2" data-col="2" class="content--sm" valign="top" align="left"> <p>
								-
							</p>
							 </td><td headers="idm139983842242368" data-row="2" data-col="3" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983842241280" data-row="2" data-col="4" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983842142928" data-row="2" data-col="5" class="content--md" valign="top" align="left"> <p>
								Succeeds
							</p>
							 </td><td headers="idm139983842141840" data-row="2" data-col="6" class="content--sm" valign="top" align="left"> <p>
								Yes
							</p>
							 </td></tr><tr><td headers="idm139983842242368" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983842241280" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								Enabled
							</p>
							 </td><td headers="idm139983842142928" data-row="3" data-col="3" class="content--md" valign="top" align="left"> <p>
								Fails
							</p>
							 </td><td headers="idm139983842141840" data-row="3" data-col="4" class="content--sm" valign="top" align="left"> <p>
								-
							</p>
							 </td></tr><tr><td headers="idm139983842242368" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								Enabled
							</p>
							 </td><td headers="idm139983842241280" data-row="4" data-col="2" class="content--sm" valign="top" align="left"> <p>
								-
							</p>
							 </td><td headers="idm139983842142928" data-row="4" data-col="3" class="content--md" valign="top" align="left"> <p>
								Fails
							</p>
							 </td><td headers="idm139983842141840" data-row="4" data-col="4" class="content--sm" valign="top" align="left"> <p>
								-
							</p>
							 </td></tr><tr><td rowspan="3" headers="idm139983842244560" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								Signed
							</p>
							 </td><td rowspan="3" headers="idm139983842243472" data-row="5" data-col="2" class="content--sm" valign="top" align="left"> <p>
								No
							</p>
							 </td><td headers="idm139983842242368" data-row="5" data-col="3" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983842241280" data-row="5" data-col="4" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983842142928" data-row="5" data-col="5" class="content--md" valign="top" align="left"> <p>
								Succeeds
							</p>
							 </td><td headers="idm139983842141840" data-row="5" data-col="6" class="content--sm" valign="top" align="left"> <p>
								Yes
							</p>
							 </td></tr><tr><td headers="idm139983842242368" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983842241280" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Enabled
							</p>
							 </td><td headers="idm139983842142928" data-row="6" data-col="3" class="content--md" valign="top" align="left"> <p>
								Fails
							</p>
							 </td><td headers="idm139983842141840" data-row="6" data-col="4" class="content--sm" valign="top" align="left"> <p>
								-
							</p>
							 </td></tr><tr><td headers="idm139983842242368" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								Enabled
							</p>
							 </td><td headers="idm139983842241280" data-row="7" data-col="2" class="content--sm" valign="top" align="left"> <p>
								-
							</p>
							 </td><td headers="idm139983842142928" data-row="7" data-col="3" class="content--md" valign="top" align="left"> <p>
								Fails
							</p>
							 </td><td headers="idm139983842141840" data-row="7" data-col="4" class="content--sm" valign="top" align="left"> <p>
								-
							</p>
							 </td></tr><tr><td rowspan="3" headers="idm139983842244560" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								Signed
							</p>
							 </td><td rowspan="3" headers="idm139983842243472" data-row="8" data-col="2" class="content--sm" valign="top" align="left"> <p>
								Yes
							</p>
							 </td><td headers="idm139983842242368" data-row="8" data-col="3" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983842241280" data-row="8" data-col="4" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983842142928" data-row="8" data-col="5" class="content--md" valign="top" align="left"> <p>
								Succeeds
							</p>
							 </td><td headers="idm139983842141840" data-row="8" data-col="6" class="content--sm" valign="top" align="left"> <p>
								No
							</p>
							 </td></tr><tr><td headers="idm139983842242368" data-row="9" data-col="1" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983842241280" data-row="9" data-col="2" class="content--md" valign="top" align="left"> <p>
								Enabled
							</p>
							 </td><td headers="idm139983842142928" data-row="9" data-col="3" class="content--md" valign="top" align="left"> <p>
								Succeeds
							</p>
							 </td><td headers="idm139983842141840" data-row="9" data-col="4" class="content--sm" valign="top" align="left"> <p>
								No
							</p>
							 </td></tr><tr><td headers="idm139983842242368" data-row="10" data-col="1" class="content--md" valign="top" align="left"> <p>
								Enabled
							</p>
							 </td><td headers="idm139983842241280" data-row="10" data-col="2" class="content--sm" valign="top" align="left"> <p>
								-
							</p>
							 </td><td headers="idm139983842142928" data-row="10" data-col="3" class="content--md" valign="top" align="left"> <p>
								Succeeds
							</p>
							 </td><td headers="idm139983842141840" data-row="10" data-col="4" class="content--sm" valign="top" align="left"> <p>
								No
							</p>
							 </td></tr></tbody></table></rh-table></div></section><section class="section" id="sources-for-public-keys_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.5. Sources for public keys</h2></div></div></div><p class="_abstract _abstract">
				During boot, the kernel loads X.509 keys from a set of persistent key stores into the following keyrings:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The system keyring (<code class="literal">.builtin_trusted_keys</code>)
					</li><li class="listitem">
						The <code class="literal">.platform</code> keyring
					</li><li class="listitem">
						The system <code class="literal">.blacklist</code> keyring
					</li></ul></div><div class="table" id="idm139983840941264"><p class="title">Table 11.3. Sources for system keyrings</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="apdsc0r" id="rh-table--apdsc0r" style="--rh-table--scrollbar--width: 0px;"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--><col style="width: 15%; " class="col_2"><!--Empty--><col style="width: 20%; " class="col_3"><!--Empty--><col style="width: 35%; " class="col_4"><!--Empty--></colgroup><thead><tr><th id="idm139983840934560" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Source of X.509 keys</th><th id="idm139983840933472" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">User can add keys</th><th id="idm139983840932384" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">UEFI Secure Boot state</th><th id="idm139983840931296" scope="col" data-row="1" data-col="4" class="content--sm" valign="top" align="left">Keys loaded during boot</th></tr></thead><tbody><tr><td headers="idm139983840934560" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								Embedded in kernel
							</p>
							 </td><td headers="idm139983840933472" data-row="2" data-col="2" class="content--sm" valign="top" align="left"> <p>
								No
							</p>
							 </td><td headers="idm139983840932384" data-row="2" data-col="3" class="content--sm" valign="top" align="left"> <p>
								-
							</p>
							 </td><td headers="idm139983840931296" data-row="2" data-col="4" class="content--md" valign="top" align="left"> <p>
								<code class="literal">.builtin_trusted_keys</code>
							</p>
							 </td></tr><tr><td rowspan="2" headers="idm139983840934560" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								UEFI <code class="literal">db</code>
							</p>
							 </td><td rowspan="2" headers="idm139983840933472" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								Limited
							</p>
							 </td><td headers="idm139983840932384" data-row="3" data-col="3" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983840931296" data-row="3" data-col="4" class="content--sm" valign="top" align="left"> <p>
								No
							</p>
							 </td></tr><tr><td headers="idm139983840932384" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								Enabled
							</p>
							 </td><td headers="idm139983840931296" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								<code class="literal">.platform</code>
							</p>
							 </td></tr><tr><td rowspan="2" headers="idm139983840934560" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								Embedded in the <code class="literal">shim</code> boot loader
							</p>
							 </td><td rowspan="2" headers="idm139983840933472" data-row="5" data-col="2" class="content--sm" valign="top" align="left"> <p>
								No
							</p>
							 </td><td headers="idm139983840932384" data-row="5" data-col="3" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983840931296" data-row="5" data-col="4" class="content--sm" valign="top" align="left"> <p>
								No
							</p>
							 </td></tr><tr><td headers="idm139983840932384" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								Enabled
							</p>
							 </td><td headers="idm139983840931296" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								<code class="literal">.platform</code>
							</p>
							 </td></tr><tr><td rowspan="2" headers="idm139983840934560" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								Machine Owner Key (MOK) list
							</p>
							 </td><td rowspan="2" headers="idm139983840933472" data-row="7" data-col="2" class="content--sm" valign="top" align="left"> <p>
								Yes
							</p>
							 </td><td headers="idm139983840932384" data-row="7" data-col="3" class="content--md" valign="top" align="left"> <p>
								Not enabled
							</p>
							 </td><td headers="idm139983840931296" data-row="7" data-col="4" class="content--sm" valign="top" align="left"> <p>
								No
							</p>
							 </td></tr><tr><td headers="idm139983840932384" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								Enabled
							</p>
							 </td><td headers="idm139983840931296" data-row="8" data-col="2" class="content--md" valign="top" align="left"> <p>
								<code class="literal">.platform</code>
							</p>
							 </td></tr></tbody></table></rh-table></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">.builtin_trusted_keys</code></span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A keyring that is built on boot
								</li><li class="listitem">
									Contains trusted public keys
								</li><li class="listitem">
									<code class="literal">root</code> privileges are needed to view the keys
								</li></ul></div></dd><dt><span class="term"><code class="literal">.platform</code></span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A keyring that is built on boot
								</li><li class="listitem">
									Contains keys from third-party platform providers and custom public keys
								</li><li class="listitem">
									<code class="literal">root</code> privileges are needed to view the keys
								</li></ul></div></dd><dt><span class="term"><code class="literal">.blacklist</code></span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A keyring with X.509 keys which have been revoked
								</li><li class="listitem">
									A module signed by a key from <code class="literal">.blacklist</code> will fail authentication even if your public key is in <code class="literal">.builtin_trusted_keys</code>
								</li></ul></div></dd><dt><span class="term">UEFI Secure Boot <code class="literal">db</code></span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A signature database
								</li><li class="listitem">
									Stores keys (hashes) of UEFI applications, UEFI drivers, and boot loaders
								</li><li class="listitem">
									The keys can be loaded on the machine
								</li></ul></div></dd><dt><span class="term">UEFI Secure Boot <code class="literal">dbx</code></span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A revoked signature database
								</li><li class="listitem">
									Prevents keys from being loaded
								</li><li class="listitem">
									The revoked keys from this database are added to the <code class="literal">.blacklist</code> keyring
								</li></ul></div></dd></dl></div></section><section class="section" id="generating-a-public-and-private-key-pair_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.6. Generating a public and private key pair</h2></div></div></div><p class="_abstract _abstract">
				To use a custom kernel or custom kernel modules on a Secure 
Boot-enabled system, you must generate a public and private X.509 key 
pair. You can use the generated private key to sign the kernel or the 
kernel modules. You can also validate the signed kernel or kernel 
modules by adding the corresponding public key to the Machine Owner Key 
(MOK) for Secure Boot.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Apply strong security measures and access policies to guard the 
contents of your private key. In the wrong hands, the key could be used 
to compromise any system which is authenticated by the corresponding 
public key.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Create an X.509 public and private key pair:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								If you only want to sign custom kernel <span class="emphasis"><em>modules</em></span>:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--t98syg8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>efikeygen --dbdir /etc/pki/pesign \</strong></span>
            <span class="strong strong"><strong>--self-sign \</strong></span>
            <span class="strong strong"><strong>--module \</strong></span>
            <span class="strong strong"><strong>--common-name 'CN=<span class="emphasis"><em>Organization signing key</em></span>' \</strong></span>
            <span class="strong strong"><strong>--nickname '<span class="emphasis"><em>Custom Secure Boot key</em></span>'</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								If you want to sign custom <span class="emphasis"><em>kernel</em></span>:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--95du601"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>efikeygen --dbdir /etc/pki/pesign \</strong></span>
            <span class="strong strong"><strong>--self-sign \</strong></span>
            <span class="strong strong"><strong>--kernel \</strong></span>
            <span class="strong strong"><strong>--common-name 'CN=<span class="emphasis"><em>Organization signing key</em></span>' \</strong></span>
            <span class="strong strong"><strong>--nickname '<span class="emphasis"><em>Custom Secure Boot key</em></span>'</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								When the RHEL system is running FIPS mode:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--i4gm8kd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>efikeygen --dbdir /etc/pki/pesign \</strong></span>
            <span class="strong strong"><strong>--self-sign \</strong></span>
            <span class="strong strong"><strong>--kernel \</strong></span>
            <span class="strong strong"><strong>--common-name 'CN=<span class="emphasis"><em>Organization signing key</em></span>' \</strong></span>
            <span class="strong strong"><strong>--nickname '<span class="emphasis"><em>Custom Secure Boot key</em></span>'</strong></span>
            <span class="strong strong"><strong>--token 'NSS FIPS 140-2 Certificate DB'</strong></span></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									In FIPS mode, you must use the <code class="literal">--token</code> option so that <code class="literal">efikeygen</code> finds the default "NSS Certificate DB" token in the PKI database.
								</p></div></div><p class="simpara">
								The public and private keys are now stored in the <code class="literal">/etc/pki/pesign/</code> directory.
							</p></li></ul></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					It is a good security practice to sign the kernel and the kernel 
modules within the validity period of its signing key. However, the <code class="literal">sign-file</code> utility does not warn you and the key will be usable in Red&nbsp;Hat Enterprise&nbsp;Linux 9 regardless of the validity dates.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">openssl(1)</code> manual page
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/security_guide/index#sec-Using_OpenSSL">RHEL Security Guide</a></span></em></span>
					</li><li class="listitem">
						<a class="link" href="#enrolling-public-key-on-target-system-by-adding-the-public-key-to-the-mok-list_signing-a-kernel-and-modules-for-secure-boot" title="11.8.&nbsp;Enrolling public key on target system by adding the public key to the MOK list">Enrolling public key on target system by adding the public key to the MOK list</a>
					</li></ul></div></section><section class="section" id="example-output-of-system-keyrings_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.7. Example output of system keyrings</h2></div></div></div><p class="_abstract _abstract">
				You can display information about the keys on the system keyrings using the <code class="literal command">keyctl</code> utility from the <code class="literal">keyutils</code> package.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions.
					</li><li class="listitem">
						You have installed the <code class="literal command">keyctl</code> utility from the <code class="literal">keyutils</code> package.
					</li></ul></div><div class="example" id="idm139983845458656"><p class="title">Example 11.1. Keyrings output</p><div class="example-contents"><p>
					The following is a shortened example output of <code class="literal">.builtin_trusted_keys</code>, <code class="literal">.platform</code>, and <code class="literal">.blacklist</code> keyrings from a Red&nbsp;Hat Enterprise&nbsp;Linux 9 system where UEFI Secure Boot is enabled.
				</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--y7043r0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl list %:.builtin_trusted_keys</strong></span>
6 keys in keyring:
...asymmetric: Red Hat Enterprise Linux Driver Update Program (key 3): bf57f3e87...
...asymmetric: Red Hat Secure Boot (CA key 1): 4016841644ce3a810408050766e8f8a29...
...asymmetric: Microsoft Corporation UEFI CA 2011: 13adbf4309bd82709c8cd54f316ed...
...asymmetric: Microsoft Windows Production PCA 2011: a92902398e16c49778cd90f99e...
...asymmetric: Red Hat Enterprise Linux kernel signing key: 4249689eefc77e95880b...
...asymmetric: Red Hat Enterprise Linux kpatch signing key: 4d38fd864ebe18c5f0b7...

# <span class="strong strong"><strong>keyctl list %:.platform</strong></span>
4 keys in keyring:
...asymmetric: VMware, Inc.: 4ad8da0472073...
...asymmetric: Red Hat Secure Boot CA 5: cc6fafe72...
...asymmetric: Microsoft Windows Production PCA 2011: a929f298e1...
...asymmetric: Microsoft Corporation UEFI CA 2011: 13adbf4e0bd82...

# <span class="strong strong"><strong>keyctl list %:.blacklist</strong></span>
4 keys in keyring:
...blacklist: bin:f5ff83a...
...blacklist: bin:0dfdbec...
...blacklist: bin:38f1d22...
...blacklist: bin:51f831f...</pre></div></div><p>
					The <code class="literal">.builtin_trusted_keys</code> keyring in the example shows the addition of two keys from the UEFI Secure Boot <code class="literal">db</code> keys as well as the <code class="literal">Red&nbsp;Hat Secure Boot (CA key 1)</code>, which is embedded in the <code class="literal">shim</code> boot loader.
				</p></div></div><div class="example" id="idm139983840887216"><p class="title">Example 11.2. Kernel console output</p><div class="example-contents"><p>
					The following example shows the kernel console output. The messages
 identify the keys with an UEFI Secure Boot related source. These 
include UEFI Secure Boot <code class="literal">db</code>, embedded <code class="literal">shim</code>, and MOK list.
				</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3u6qirh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dmesg | egrep 'integrity.*cert'</strong></span>
[1.512966] integrity: Loading X.509 certificate: UEFI:db
[1.513027] integrity: Loaded X.509 cert 'Microsoft Windows Production PCA 2011: a929023...
[1.513028] integrity: Loading X.509 certificate: UEFI:db
[1.513057] integrity: Loaded X.509 cert 'Microsoft Corporation UEFI CA 2011: 13adbf4309...
[1.513298] integrity: Loading X.509 certificate: UEFI:MokListRT (MOKvar table)
[1.513549] integrity: Loaded X.509 cert 'Red Hat Secure Boot CA 5: cc6fa5e72868ba494e93...</pre></div></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">keyctl(1)</code>, <code class="literal">dmesg(1)</code> manual pages
					</li></ul></div></section><section class="section" id="enrolling-public-key-on-target-system-by-adding-the-public-key-to-the-mok-list_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.8. Enrolling public key on target system by adding the public key to the MOK list</h2></div></div></div><p class="_abstract _abstract">
				You must enroll your public key on all systems where you want to 
authenticate and load your kernel or kernel modules. You can import the 
public key on a target system in different ways so that the platform 
keyring (<code class="literal">.platform</code>) is able to use the public key to authenticate the kernel or kernel modules.
			</p><p>
				When RHEL 9 boots on a UEFI-based system with Secure Boot enabled, the kernel loads onto the platform keyring (<code class="literal">.platform</code>) all public keys that are in the Secure Boot <code class="literal">db</code> key database. At the same time, the kernel excludes the keys in the <code class="literal">dbx</code> database of revoked keys.
			</p><p>
				You can use the Machine Owner Key (MOK) facility feature to expand 
the UEFI Secure Boot key database. When RHEL 9 boots on an UEFI-enabled 
system with Secure Boot enabled, the keys on the MOK list are also added
 to the platform keyring (<code class="literal">.platform</code>) in 
addition to the keys from the key database. The MOK list keys are also 
stored persistently and securely in the same fashion as the Secure Boot 
database keys, but these are two separate facilities. The MOK facility 
is supported by <code class="literal">shim</code>, <code class="literal">MokManager</code>, <code class="literal">GRUB</code>, and the <code class="literal">mokutil</code> utility.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					To facilitate authentication of your kernel module on your systems,
 consider requesting your system vendor to incorporate your public key 
into the UEFI Secure Boot key database in their factory firmware image.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have generated a public and private key pair and know the validity dates of your public keys. For details, see <a class="link" href="#generating-a-public-and-private-key-pair_signing-a-kernel-and-modules-for-secure-boot" title="11.6.&nbsp;Generating a public and private key pair">Generating a public and private key pair</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Export your public key to the <code class="literal">sb_cert.cer</code> file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--y09xp1w"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>certutil -d /etc/pki/pesign \</strong></span>
           <span class="strong strong"><strong>-n '<span class="emphasis"><em>Custom Secure Boot key</em></span>' \</strong></span>
           <span class="strong strong"><strong>-Lr \</strong></span>
           <span class="strong strong"><strong>&gt; sb_cert.cer</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Import your public key into the MOK list:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--s2irnf8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mokutil --import sb_cert.cer</strong></span></pre></div></div></li><li class="listitem">
						Enter a new password for this MOK enrollment request.
					</li><li class="listitem"><p class="simpara">
						Reboot the machine.
					</p><p class="simpara">
						The <code class="literal">shim</code> boot loader notices the pending MOK key enrollment request and it launches <code class="literal">MokManager.efi</code> to enable you to complete the enrollment from the UEFI console.
					</p></li><li class="listitem"><p class="simpara">
						Choose <code class="literal">Enroll MOK</code>, enter the password you previously associated with this request when prompted, and confirm the enrollment.
					</p><p class="simpara">
						Your public key is added to the MOK list, which is persistent.
					</p><p class="simpara">
						Once a key is on the MOK list, it will be automatically propagated to the <code class="literal">.platform</code> keyring on this and subsequent boots when UEFI Secure Boot is enabled.
					</p></li></ol></div></section><section class="section" id="signing-a-kernel-with-the-private-key_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.9. Signing a kernel with the private key</h2></div></div></div><p class="_abstract _abstract">
				You can obtain enhanced security benefits on your system by loading a
 signed kernel if the UEFI Secure Boot mechanism is enabled.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have generated a public and private key pair and know the validity dates of your public keys. For details, see <a class="link" href="#generating-a-public-and-private-key-pair_signing-a-kernel-and-modules-for-secure-boot" title="11.6.&nbsp;Generating a public and private key pair">Generating a public and private key pair</a>.
					</li><li class="listitem">
						You have enrolled your public key on the target system. For details, see <a class="link" href="#enrolling-public-key-on-target-system-by-adding-the-public-key-to-the-mok-list_signing-a-kernel-and-modules-for-secure-boot" title="11.8.&nbsp;Enrolling public key on target system by adding the public key to the MOK list">Enrolling public key on target system by adding the public key to the MOK list</a>.
					</li><li class="listitem">
						You have a kernel image in the ELF format available for signing.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the x64 architecture:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a signed image:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--hfa59wi"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>pesign --certificate '<span class="emphasis"><em>Custom Secure Boot key</em></span>'</strong></span> \
         <span class="strong strong"><strong>--in vmlinuz-<span class="emphasis"><em>version</em></span></strong></span> \
         <span class="strong strong"><strong>--sign</strong></span> \
         <span class="strong strong"><strong>--out vmlinuz-<span class="emphasis"><em>version</em></span>.signed</strong></span></pre></div></div><p class="simpara">
								Replace <code class="literal"><span class="emphasis"><em>version</em></span></code> with the version suffix of your <code class="literal">vmlinuz</code> file, and <code class="literal"><span class="emphasis"><em>Custom Secure Boot key</em></span></code> with the name that you chose earlier.
							</p></li><li class="listitem"><p class="simpara">
								Optional: Check the signatures:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--my7cntd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>pesign --show-signature</strong></span> \
         <span class="strong strong"><strong>--in vmlinuz-<span class="emphasis"><em>version</em></span>.signed</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Overwrite the unsigned image with the signed image:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--11h5wp5"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mv vmlinuz-<span class="emphasis"><em>version</em></span>.signed vmlinuz-<span class="emphasis"><em>version</em></span></strong></span></pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						On the 64-bit ARM architecture:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Decompress the <code class="literal">vmlinuz</code> file:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zzgss3s"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>zcat vmlinuz-<span class="emphasis"><em>version</em></span> &gt; vmlinux-<span class="emphasis"><em>version</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Create a signed image:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--n55ucwq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>pesign --certificate '<span class="emphasis"><em>Custom Secure Boot key</em></span>'</strong></span> \
         <span class="strong strong"><strong>--in vmlinux-<span class="emphasis"><em>version</em></span></strong></span> \
         <span class="strong strong"><strong>--sign</strong></span> \
         <span class="strong strong"><strong>--out vmlinux-<span class="emphasis"><em>version</em></span>.signed</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Optional: Check the signatures:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wrybgc0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>pesign --show-signature</strong></span> \
         <span class="strong strong"><strong>--in vmlinux-<span class="emphasis"><em>version</em></span>.signed</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Compress the <code class="literal">vmlinux</code> file:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--hdegzw1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>gzip --to-stdout vmlinux-<span class="emphasis"><em>version</em></span>.signed &gt; vmlinuz-<span class="emphasis"><em>version</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Remove the uncompressed <code class="literal">vmlinux</code> file:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qeriznr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>rm vmlinux-<span class="emphasis"><em>version</em></span>*</strong></span></pre></div></div></li></ol></div></li></ul></div></section><section class="section" id="signing-a-grub-build-with-the-private-key_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.10. Signing a GRUB build with the private key</h2></div></div></div><p class="_abstract _abstract">
				On a system where the UEFI Secure Boot mechanism is enabled, you can
 sign a GRUB build with a custom existing private key. You must do this 
if you are using a custom GRUB build, or if you have removed the 
Microsoft trust anchor from your system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have generated a public and private key pair and know the validity dates of your public keys. For details, see <a class="link" href="#generating-a-public-and-private-key-pair_signing-a-kernel-and-modules-for-secure-boot" title="11.6.&nbsp;Generating a public and private key pair">Generating a public and private key pair</a>.
					</li><li class="listitem">
						You have enrolled your public key on the target system. For details, see <a class="link" href="#enrolling-public-key-on-target-system-by-adding-the-public-key-to-the-mok-list_signing-a-kernel-and-modules-for-secure-boot" title="11.8.&nbsp;Enrolling public key on target system by adding the public key to the MOK list">Enrolling public key on target system by adding the public key to the MOK list</a>.
					</li><li class="listitem">
						You have a GRUB EFI binary available for signing.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the x64 architecture:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a signed GRUB EFI binary:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--u7t6d2w"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>pesign --in /boot/efi/EFI/redhat/grubx64.efi</strong></span> \
         <span class="strong strong"><strong>--out /boot/efi/EFI/redhat/grubx64.efi.signed</strong></span> \
         <span class="strong strong"><strong>--certificate '<span class="emphasis"><em>Custom Secure Boot key</em></span>'</strong></span> \
         <span class="strong strong"><strong>--sign</strong></span></pre></div></div><p class="simpara">
								Replace <code class="literal"><span class="emphasis"><em>Custom Secure Boot key</em></span></code> with the name that you chose earlier.
							</p></li><li class="listitem"><p class="simpara">
								Optional: Check the signatures:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--go08i27"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>pesign --in /boot/efi/EFI/redhat/grubx64.efi.signed</strong></span> \
         <span class="strong strong"><strong>--show-signature</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Overwrite the unsigned binary with the signed binary:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8z6mh7w"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mv /boot/efi/EFI/redhat/grubx64.efi.signed</strong></span> \
     <span class="strong strong"><strong>/boot/efi/EFI/redhat/grubx64.efi</strong></span></pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						On the 64-bit ARM architecture:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a signed GRUB EFI binary:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--38rmajq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>pesign --in /boot/efi/EFI/redhat/grubaa64.efi</strong></span> \
         <span class="strong strong"><strong>--out /boot/efi/EFI/redhat/grubaa64.efi.signed</strong></span> \
         <span class="strong strong"><strong>--certificate '<span class="emphasis"><em>Custom Secure Boot key</em></span>'</strong></span> \
         <span class="strong strong"><strong>--sign</strong></span></pre></div></div><p class="simpara">
								Replace <code class="literal"><span class="emphasis"><em>Custom Secure Boot key</em></span></code> with the name that you chose earlier.
							</p></li><li class="listitem"><p class="simpara">
								Optional: Check the signatures:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--foe9h22"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>pesign --in /boot/efi/EFI/redhat/grubaa64.efi.signed</strong></span> \
         <span class="strong strong"><strong>--show-signature</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Overwrite the unsigned binary with the signed binary:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rr71oum"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mv /boot/efi/EFI/redhat/grubaa64.efi.signed</strong></span> \
     <span class="strong strong"><strong>/boot/efi/EFI/redhat/grubaa64.efi</strong></span></pre></div></div></li></ol></div></li></ul></div></section><section class="section" id="signing-kernel-modules-with-the-private-key_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.11. Signing kernel modules with the private key</h2></div></div></div><p class="_abstract _abstract">
				You can enhance the security of your system by loading signed kernel modules if the UEFI Secure Boot mechanism is enabled.
			</p><p>
				Your signed kernel module is also loadable on systems where UEFI 
Secure Boot is disabled or on a non-UEFI system. As a result, you do not
 need to provide both a signed and unsigned version of your kernel 
module.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have generated a public and private key pair and know the validity dates of your public keys. For details, see <a class="link" href="#generating-a-public-and-private-key-pair_signing-a-kernel-and-modules-for-secure-boot" title="11.6.&nbsp;Generating a public and private key pair">Generating a public and private key pair</a>.
					</li><li class="listitem">
						You have enrolled your public key on the target system. For details, see <a class="link" href="#enrolling-public-key-on-target-system-by-adding-the-public-key-to-the-mok-list_signing-a-kernel-and-modules-for-secure-boot" title="11.8.&nbsp;Enrolling public key on target system by adding the public key to the MOK list">Enrolling public key on target system by adding the public key to the MOK list</a>.
					</li><li class="listitem">
						You have a kernel module in ELF image format available for signing.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Export your public key to the <code class="literal">sb_cert.cer</code> file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ik4y798"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>certutil -d /etc/pki/pesign \</strong></span>
           <span class="strong strong"><strong>-n '<span class="emphasis"><em>Custom Secure Boot key</em></span>' \</strong></span>
           <span class="strong strong"><strong>-Lr \</strong></span>
           <span class="strong strong"><strong>&gt; sb_cert.cer</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Extract the key from the NSS database as a PKCS #12 file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7cxzaqp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>pk12util -o sb_cert.p12 \</strong></span>
           <span class="strong strong"><strong>-n '<span class="emphasis"><em>Custom Secure Boot key</em></span>' \</strong></span>
           <span class="strong strong"><strong>-d /etc/pki/pesign</strong></span></pre></div></div></li><li class="listitem">
						When the previous command prompts you, enter a new password that encrypts the private key.
					</li><li class="listitem"><p class="simpara">
						Export the unencrypted private key:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5ke9n3d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>openssl pkcs12 \</strong></span>
         <span class="strong strong"><strong>-in sb_cert.p12 \</strong></span>
         <span class="strong strong"><strong>-out sb_cert.priv \</strong></span>
         <span class="strong strong"><strong>-nocerts \</strong></span>
         <span class="strong strong"><strong>-noenc</strong></span></pre></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Handle the unencrypted private key with care.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Sign your kernel module. The following command appends the signature directly to the ELF image in your kernel module file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2muuz75"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>/usr/src/kernels/$(uname -r)/scripts/sign-file \</strong></span>
          <span class="strong strong"><strong>sha256 \</strong></span>
          <span class="strong strong"><strong>sb_cert.priv \</strong></span>
          <span class="strong strong"><strong>sb_cert.cer \</strong></span>
          <span class="strong strong"><strong><span class="emphasis"><em>my_module</em></span>.ko</strong></span></pre></div></div></li></ol></div><p>
				Your kernel module is now ready for loading.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					In Red&nbsp;Hat Enterprise&nbsp;Linux 9, the validity dates of the 
key pair matter. The key does not expire, but the kernel module must be 
signed within the validity period of its signing key. The <code class="literal">sign-file</code>
 utility will not warn you of this. For example, a key that is only 
valid in 2021 can be used to authenticate a kernel module signed in 2021
 with that key. However, users cannot use that key to sign a kernel 
module in 2022.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display information about the kernel modules signature:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--s17iycj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>modinfo <span class="emphasis"><em>my_module</em></span>.ko | grep signer</strong></span>
  signer:         <span class="emphasis"><em>Your Name Key</em></span></pre></div></div><p class="simpara">
						Check that the signature lists your name as entered during generation.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The appended signature is not contained in an ELF image section 
and is not a formal part of the ELF image. Therefore, utilities such as <code class="literal command">readelf</code> cannot display the signature on your kernel module.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Load the module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pderkcv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>insmod <span class="emphasis"><em>my_module</em></span>.ko</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Remove (unload) the module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8k28h0g"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>modprobe -r <span class="emphasis"><em>my_module</em></span>.ko</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#displaying-information-about-kernel-modules_managing-kernel-modules" title="3.5.&nbsp;Displaying information about kernel modules">Displaying information about kernel modules</a>
					</li></ul></div></section><section class="section" id="loading-signed-kernel-modules_signing-a-kernel-and-modules-for-secure-boot"><div class="titlepage"><div><div><h2 class="title">11.12. Loading signed kernel modules</h2></div></div></div><p class="_abstract _abstract">
				Once your public key is enrolled in the system keyring (<code class="literal">.builtin_trusted_keys</code>)
 and the MOK list, and after you have signed the respective kernel 
module with your private key, you can load your signed kernel module 
with the <code class="literal command">modprobe</code> command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have generated the public and private key pair. For details, see <a class="link" href="#generating-a-public-and-private-key-pair_signing-a-kernel-and-modules-for-secure-boot" title="11.6.&nbsp;Generating a public and private key pair">Generating a public and private key pair</a>.
					</li><li class="listitem">
						You have enrolled the public key into the system keyring. For details, see <a class="link" href="#enrolling-public-key-on-target-system-by-adding-the-public-key-to-the-mok-list_signing-a-kernel-and-modules-for-secure-boot" title="11.8.&nbsp;Enrolling public key on target system by adding the public key to the MOK list">Enrolling public key on target system by adding the public key to the MOK list</a>.
					</li><li class="listitem">
						You have signed a kernel module with the private key. For details, see <a class="link" href="#signing-kernel-modules-with-the-private-key_signing-a-kernel-and-modules-for-secure-boot" title="11.11.&nbsp;Signing kernel modules with the private key">Signing kernel modules with the private key</a>.
					</li><li class="listitem"><p class="simpara">
						Install the <code class="literal">kernel-modules-extra</code> package, which creates the <code class="literal">/lib/modules/$(uname -r)/extra/</code> directory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zf605lf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf -y install kernel-modules-extra</strong></span></pre></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that your public keys are on the system keyring:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qmqr6my"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl list %:.platform</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Copy the kernel module into the <code class="literal">extra/</code> directory of the kernel that you want:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6c816ws"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cp <span class="emphasis"><em>my_module</em></span>.ko /lib/modules/$(uname -r)/extra/</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Update the modular dependency list:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--s2p9764"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>depmod -a</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Load the kernel module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8oqah93"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>modprobe -v my_module</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Optionally, to load the module on boot, add it to the <code class="literal">/etc/modules-loaded.d/<span class="emphasis"><em>my_module</em></span>.conf</code> file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--88jmqky"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo "<span class="emphasis"><em>my_module</em></span>" &gt; /etc/modules-load.d/<span class="emphasis"><em>my_module</em></span>.conf</strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the module was successfully loaded:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--eneiro4"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>lsmod | grep my_module</strong></span></pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#managing-kernel-modules_managing-monitoring-and-updating-the-kernel" title="Chapter&nbsp;3.&nbsp;Managing kernel modules">Managing kernel modules</a>
					</li></ul></div></section></section><section class="chapter" id="updating-the-secure-boot-revocation-list_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 12. Updating the Secure Boot Revocation List</h1></div></div></div><p>
			You can update the UEFI Secure Boot Revocation List on your system so
 that Secure Boot identifies software with known security issues and 
prevents it from compromising your boot process.
		</p><section class="section" id="prerequisites_2"><div class="titlepage"><div><div><h2 class="title">12.1. Prerequisites</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Secure Boot is enabled on your system.
					</li></ul></div></section><section class="section" id="con_what-is-uefi-secure-boot_updating-the-secure-boot-revocation-list"><div class="titlepage"><div><div><h2 class="title">12.2. What is UEFI Secure Boot</h2></div></div></div><p>
				With the <span class="emphasis"><em>Unified Extensible Firmware Interface</em></span>
 (UEFI) Secure Boot technology, you can prevent the execution of the 
kernel-space code that has not been signed by a trusted key. The system 
boot loader is signed with a cryptographic key. The database of public 
keys, which is contained in the firmware, authorizes the signing key. 
You can subsequently verify a signature in the next-stage boot loader 
and the kernel.
			</p><p>
				UEFI Secure Boot establishes a chain of trust from the firmware to the signed drivers and kernel modules as follows:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An UEFI private key signs, and a public key authenticates the <code class="literal">shim</code> first-stage boot loader. A <span class="emphasis"><em>certificate authority</em></span> (CA) in turn signs the public key. The CA is stored in the firmware database.
					</li><li class="listitem">
						The <code class="literal">shim</code> file contains the Red&nbsp;Hat public key <span class="strong strong"><strong>Red Hat Secure Boot (CA key 1)</strong></span> to authenticate the GRUB boot loader and the kernel.
					</li><li class="listitem">
						The kernel in turn contains public keys to authenticate drivers and modules.
					</li></ul></div><p>
				Secure Boot is the boot path validation component of the UEFI specification. The specification defines:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Programming interface for cryptographically protected UEFI variables in non-volatile storage.
					</li><li class="listitem">
						Storing the trusted X.509 root certificates in UEFI variables.
					</li><li class="listitem">
						Validation of UEFI applications such as boot loaders and drivers.
					</li><li class="listitem">
						Procedures to revoke known-bad certificates and application hashes.
					</li></ul></div><p>
				UEFI Secure Boot helps in the detection of unauthorized changes but does <span class="strong strong"><strong>not</strong></span>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Prevent installation or removal of second-stage boot loaders.
					</li><li class="listitem">
						Require explicit user confirmation of such changes.
					</li><li class="listitem">
						Stop boot path manipulations. Signatures are verified during booting, not when the boot loader is installed or updated.
					</li></ul></div><p>
				If the boot loader or the kernel are not signed by a system trusted key, Secure Boot prevents them from starting.
			</p></section><section class="section" id="the-secure-boot-revocation-list_updating-the-secure-boot-revocation-list"><div class="titlepage"><div><div><h2 class="title">12.3. The Secure Boot Revocation List</h2></div></div></div><p>
				The UEFI Secure Boot Revocation List, or the Secure Boot Forbidden Signature Database (<code class="literal">dbx</code>), is a list that identifies software that Secure Boot no longer allows to run.
			</p><p>
				When a security issue or a stability problem is found in software 
that interfaces with Secure Boot, such as in the GRUB boot loader, the 
Revocation List stores its hash signature. Software with such a 
recognized signature cannot run during boot, and the system boot fails 
in order to prevent compromising the system.
			</p><p>
				For example, a certain version of GRUB might contain a security 
issue that allows an attacker to bypass the Secure Boot mechanism. When 
the issue is found, the Revocation List adds hash signatures of all GRUB
 versions that contain the issue. As a result, only secure GRUB versions
 can boot on the system.
			</p><p>
				The Revocation List requires regular updates to recognize newly 
found issues. When updating the Revocation List, make sure to use a safe
 update method that does not cause your currently installed system to no
 longer boot.
			</p></section><section class="section" id="applying-an-online-revocation-list-update_updating-the-secure-boot-revocation-list"><div class="titlepage"><div><div><h2 class="title">12.4. Applying an online Revocation List update</h2></div></div></div><p>
				You can update the Secure Boot Revocation List on your system so 
that Secure Boot prevents known security issues. This procedure is safe 
and ensures that the update does not prevent your system from booting.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your system can access the internet for updates.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Determine the current version of the Revocation List:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ew0itav"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># fwupdmgr get-devices</pre></div></div><p class="simpara">
						See the <code class="literal">Current version</code> field under <code class="literal">UEFI dbx</code>.
					</p></li><li class="listitem"><p class="simpara">
						Enable the LVFS Revocation List repository:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7yy8b7w"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># fwupdmgr enable-remote lvfs</pre></div></div></li><li class="listitem"><p class="simpara">
						Refresh the repository metadata:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pgy8gsa"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># fwupdmgr refresh</pre></div></div></li><li class="listitem"><p class="simpara">
						Apply the Revocation List update:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								On the command line:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3777oay"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># fwupdmgr update</pre></div></div></li><li class="listitem"><p class="simpara">
								In the graphical interface:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Open the <span class="strong strong"><strong>Software</strong></span> application
									</li><li class="listitem">
										Navigate to the <span class="strong strong"><strong>Updates</strong></span> tab.
									</li><li class="listitem">
										Find the <span class="strong strong"><strong>Secure Boot dbx Configuration Update</strong></span> entry.
									</li><li class="listitem">
										Click <span class="guibutton">Update</span>.
									</li></ol></div></li></ul></div></li><li class="listitem">
						At the end of the update, <code class="literal">fwupdmgr</code> or <span class="strong strong"><strong>Software</strong></span> asks you to reboot the system. Confirm the reboot.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						After the reboot, check the current version of the Revocation List again:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0h5a6fa"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># fwupdmgr get-devices</pre></div></div></li></ul></div></section><section class="section" id="applying-an-offline-revocation-list-update_updating-the-secure-boot-revocation-list"><div class="titlepage"><div><div><h2 class="title">12.5. Applying an offline Revocation List update</h2></div></div></div><p>
				On a system with no internet connection, you can update the Secure 
Boot Revocation List from RHEL so that Secure Boot prevents known 
security issues. This procedure is safe and ensures that the update does
 not prevent your system from booting.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Determine the current version of the Revocation List:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rvzcxsc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># fwupdmgr get-devices</pre></div></div><p class="simpara">
						See the <code class="literal">Current version</code> field under <code class="literal">UEFI dbx</code>.
					</p></li><li class="listitem"><p class="simpara">
						List the updates available from RHEL:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--g7k7j2t"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># ls /usr/share/dbxtool/</pre></div></div></li><li class="listitem"><p class="simpara">
						Select the most recent update file for your architecture. The file names use the following format:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--g1cktrv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">DBXUpdate-<span class="emphasis"><em>date</em></span>-<span class="emphasis"><em>architecture</em></span>.cab</pre></div></div></li><li class="listitem"><p class="simpara">
						Install the selected update file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--m6frbvh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># fwupdmgr install /usr/share/dbxtool/DBXUpdate-<span class="emphasis"><em>date</em></span>-<span class="emphasis"><em>architecture</em></span>.cab</pre></div></div></li><li class="listitem">
						At the end of the update, <code class="literal">fwupdmgr</code> asks you to reboot the system. Confirm the reboot.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						After the reboot, check the current version of the Revocation List again:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7abeqw2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># fwupdmgr get-devices</pre></div></div></li></ul></div></section></section><section class="chapter" id="enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 13. Enhancing security with the kernel integrity subsystem</h1></div></div></div><p class="_abstract _abstract">
			You can improve the protection of your system by using components of 
the kernel integrity subsystem. Learn more about the relevant components
 and their configuration.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				You can use the features with cryptographic signatures only for Red 
Hat products because the kernel keyring system includes only the 
certificates for Red Hat signature keys. Using other hash features 
results in incomplete tamper-proofing.
			</p></div></div><section class="section" id="the-kernel-integrity-subsystem_enhancing-security-with-the-kernel-integrity-subsystem"><div class="titlepage"><div><div><h2 class="title">13.1. The kernel integrity subsystem</h2></div></div></div><p class="_abstract _abstract">
				The integrity subsystem is the part of the kernel that maintains 
overall integrity of system data. This subsystem helps to keep the state
 of a system the same from the time it was built. By using this 
subsystem, you can prevent undesired modification of specific system 
files.
			</p><p>
				The kernel integrity subsystem consists of two major components:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Integrity Measurement Architecture (IMA)</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									IMA measures file content whenever it is executed or opened by 
cryptographically hashing or signing with cryptographic keys. The keys 
are stored in the kernel keyring subsystem.
								</li><li class="listitem">
									IMA places the measured values within the kernels memory 
space. This prevents users of the system from modifying the measured 
values.
								</li><li class="listitem">
									IMA allows local and remote parties to verify the measured values.
								</li><li class="listitem">
									IMA provides local validation of the current content of files 
against the values previously stored in the measurement list within the 
kernel memory. This extension forbids performing any operation on a 
specific file in case the current and the previous measures do not 
match.
								</li></ul></div></dd><dt><span class="term">Extended Verification Module (EVM)</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									EVM protects extended attributes of files (also known as <span class="emphasis"><em>xattr</em></span>)
 that are related to system security, such as IMA measurements and 
SELinux attributes. EVM cryptographically hashes their corresponding 
values or signs them with cryptographic keys. The keys are stored in the
 kernel keyring subsystem.
								</li></ul></div></dd></dl></div><p>
				The kernel integrity subsystem can use the Trusted Platform Module (TPM) to further harden system security.
			</p><p>
				A TPM is a hardware, firmware, or virtual component with integrated 
cryptographic keys, which is built according to the TPM specification by
 the Trusted Computing Group (TCG) for important cryptographic 
functions. TPMs are usually built as dedicated hardware attached to the 
platforms motherboard. By providing cryptographic functions from a 
protected and tamper-proof area of the hardware chip, TPMs are protected
 from software-based attacks. TPMs provide the following features:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Random-number generator
					</li><li class="listitem">
						Generator and secure storage for cryptographic keys
					</li><li class="listitem">
						Hashing generator
					</li><li class="listitem">
						Remote attestation
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/security_hardening/index">Security hardening</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/index">Basic and advanced configuration of Security-Enhanced Linux (SELinux)</a>
					</li></ul></div></section><section class="section" id="trusted-and-encrypted-keys_enhancing-security-with-the-kernel-integrity-subsystem"><div class="titlepage"><div><div><h2 class="title">13.2. Trusted and encrypted keys</h2></div></div></div><p class="_abstract _abstract">
				<span class="emphasis"><em>Trusted keys</em></span> and <span class="emphasis"><em>encrypted keys</em></span> are an important part of enhancing system security.
			</p><p>
				Trusted and encrypted keys are variable-length symmetric keys 
generated by the kernel that use the kernel keyring service. The 
integrity of the keys can be verified, which means that they can be 
used, for example, by the extended verification module (EVM) to verify 
and confirm the integrity of a running system. User-level programs can 
only access the keys in the form of encrypted <span class="emphasis"><em>blobs</em></span>.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Trusted keys</span></dt><dd><p class="simpara">
							Trusted keys need the Trusted Platform Module (TPM) chip, which 
is used to both create and encrypt (seal) the keys. Each TPM has a 
master wrapping key, called the storage root key, which is stored within
 the TPM itself.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								RHEL 9 supports only TPM 2.0. If you must use TPM 1.2, use RHEL 8. For more information, see the <a class="link" href="https://access.redhat.com/solutions/253363">Is Trusted Platform Module (TPM) supported by Red Hat?</a> solution.
							</p></div></div><p class="simpara">
							You can verify that a TPM 2.0 chip has been enabled by entering the following command:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--l8m4rbq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>cat /sys/class/tpm/tpm0/tpm_version_major</strong></span>
2</pre></div></div><p class="simpara">
							You can also enable a TPM 2.0 chip and manage the TPM 2.0 device through settings in the machine firmware.
						</p><p class="simpara">
							In addition to that, you can seal the trusted keys with a specific set of the TPMs <span class="emphasis"><em>platform configuration register</em></span>
 (PCR) values. PCR contains a set of integrity-management values that 
reflect the firmware, boot loader, and operating system. This means that
 PCR-sealed keys can only be decrypted by the TPM on the same system on 
which they were encrypted. However, when a PCR-sealed trusted key is 
loaded (added to a keyring), and thus its associated PCR values are 
verified, it can be updated with new (or future) PCR values, so that a 
new kernel, for example, can be booted. You can save a single key also 
as multiple blobs, each with a different PCR value.
						</p></dd><dt><span class="term">Encrypted keys</span></dt><dd>
							Encrypted keys do not require a TPM, because they use the kernel 
Advanced Encryption Standard (AES), which makes them faster than trusted
 keys. Encrypted keys are created using kernel-generated random numbers 
and encrypted by a <span class="emphasis"><em>master key</em></span> when they are exported into user-space blobs.
						</dd></dl></div><p>
				The master key is either a trusted key or a user key. If the master 
key is not trusted, the encrypted key is only as secure as the user key 
used to encrypt it.
			</p></section><section class="section" id="working-with-trusted-keys_enhancing-security-with-the-kernel-integrity-subsystem"><div class="titlepage"><div><div><h2 class="title">13.3. Working with trusted keys</h2></div></div></div><p class="_abstract _abstract">
				You can improve system security by using the <code class="literal">keyctl</code> utility to create, export, load and update trusted keys.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Trusted Platform Module (TPM) is enabled and active. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#the-kernel-integrity-subsystem_enhancing-security-with-the-kernel-integrity-subsystem">The kernel integrity subsystem</a> and <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#trusted-and-encrypted-keys_enhancing-security-with-the-kernel-integrity-subsystem">Trusted and encrypted keys</a>.
					</p><p class="simpara">
						You can verify that your system has a TPM by entering the <code class="literal">tpm2_pcrread</code> command. If the output from this command displays several hashes, you have a TPM.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a 2048-bit RSA key with an SHA-256 primary storage key with a persistent handle of, for example, <span class="emphasis"><em>81000001</em></span>, by using one of the following utilities:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								By using the <code class="literal">tss2</code> package:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--d5ppky0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>TPM_DEVICE=/dev/tpm0 tsscreateprimary -hi o -st</strong></span>
Handle 80000000
# <span class="strong strong"><strong>TPM_DEVICE=/dev/tpm0 tssevictcontrol -hi o -ho 80000000 -hp 81000001</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								By using the <code class="literal">tpm2-tools</code> package:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mt8178u"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>tpm2_createprimary --key-algorithm=rsa2048 --key-context=key.ctxt</strong></span>
name-alg:
  value: sha256
  raw: 0xb

sym-keybits: 128
rsa: xxxxxx

# <span class="strong strong"><strong>tpm2_evictcontrol -c key.ctxt 0x81000001</strong></span>
persistentHandle: 0x81000001
action: persisted</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Create a trusted key by using a TPM 2.0 with the syntax of <code class="literal">keyctl add trusted <span class="emphasis"><em>&lt;NAME&gt;</em></span> "new <span class="emphasis"><em>&lt;KEY_LENGTH&gt;</em></span> keyhandle=<span class="emphasis"><em>&lt;PERSISTENT-HANDLE&gt;</em></span> [options]" <span class="emphasis"><em>&lt;KEYRING&gt;</em></span></code>. In this example, the persistent handle is <span class="emphasis"><em>81000001</em></span>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--cv48dro"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl add trusted kmk "new 32 keyhandle=0x81000001" @u</strong></span>
642500861</pre></div></div><p class="simpara">
						The command creates a trusted key called <code class="literal">kmk</code> with the length of <code class="literal">32</code> bytes (256 bits) and places it in the user keyring (<code class="literal">@u</code>). The keys may have a length of 32 to 128 bytes (256 to 1024 bits).
					</p></li><li class="listitem"><p class="simpara">
						List the current structure of the kernel keyrings:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0g1n59a"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl show</strong></span>
Session Keyring
       -3 --alswrv    500   500  keyring: <span class="emphasis"><em>ses 97833714 --alswrv 500 -1 \</em></span> keyring: <span class="emphasis"><em>uid.1000 642500861 --alswrv 500 500 \</em></span> trusted: kmk</pre></div></div></li><li class="listitem"><p class="simpara">
						Export the key to a user-space blob by using the serial number of the trusted key:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--n4qgplj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl pipe 642500861 &gt; kmk.blob</strong></span></pre></div></div><p class="simpara">
						The command uses the <code class="literal">pipe</code> subcommand and the serial number of <code class="literal">kmk</code>.
					</p></li><li class="listitem"><p class="simpara">
						Load the trusted key from the user-space blob:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qvs5mqm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl add trusted kmk "load `cat kmk.blob`" @u</strong></span>
268728824</pre></div></div></li><li class="listitem"><p class="simpara">
						Create secure encrypted keys that use the TPM-sealed trusted key (<code class="literal">kmk</code>). Follow this syntax: <span class="emphasis"><em>keyctl add encrypted &lt;NAME&gt; "new [FORMAT] &lt;KEY_TYPE&gt;:&lt;PRIMARY_KEY_NAME&gt; &lt;KEY_LENGTH&gt;" &lt;KEYRING&gt;</em></span>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--n0d009d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl add encrypted encr-key "new trusted:kmk 32" @u</strong></span>
159771175</pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						the <code class="literal">keyctl(1)</code> manual page
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#trusted-and-encrypted-keys_enhancing-security-with-the-kernel-integrity-subsystem">Trusted and encrypted keys</a>
					</li><li class="listitem">
						<a class="link" href="https://www.kernel.org/doc/html/v4.18/security/keys/core.html#">Kernel Key Retention Service</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#the-kernel-integrity-subsystem_enhancing-security-with-the-kernel-integrity-subsystem">The kernel integrity subsystem</a>
					</li></ul></div></section><section class="section" id="working-with-encrypted-keys_enhancing-security-with-the-kernel-integrity-subsystem"><div class="titlepage"><div><div><h2 class="title">13.4. Working with encrypted keys</h2></div></div></div><p class="_abstract _abstract">
				You can improve system security on systems where a Trusted Platform 
Module (TPM) is not available by managing encrypted keys.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a user key by using a random sequence of numbers.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rdn115h"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl add user kmk-user "$(dd if=/dev/urandom bs=1 count=32 2&gt;/dev/null)" @u</strong></span>
427069434</pre></div></div><p class="simpara">
						The command generates a user key called <code class="literal">kmk-user</code> which acts as a <span class="emphasis"><em>primary key</em></span> and is used to seal the actual encrypted keys.
					</p></li><li class="listitem"><p class="simpara">
						Generate an encrypted key using the primary key from the previous step:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wnwdnk8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl add encrypted encr-key "new user:kmk-user 32" @u</strong></span>
1012412758</pre></div></div></li><li class="listitem"><p class="simpara">
						Optionally, list all keys in the specified user keyring:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--12kw69v"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl list @u</strong></span>
2 keys in keyring:
427069434: --alswrv  1000  1000 user: kmk-user
1012412758: --alswrv  1000  1000 encrypted: encr-key</pre></div></div></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Encrypted keys that are not sealed by a trusted primary key are 
only as secure as the user primary key (random-number key) that was used
 to encrypt them. Therefore, load the primary user key as securely as 
possible and preferably early during the boot process.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">keyctl(1)</code> manual page
					</li><li class="listitem">
						<a class="link" href="https://www.kernel.org/doc/html/v4.18/security/keys/core.html#">Kernel Key Retention Service</a>
					</li></ul></div></section><section class="section" id="enabling-integrity-measurement-architecture-and-extended-verification-module_enhancing-security-with-the-kernel-integrity-subsystem"><div class="titlepage"><div><div><h2 class="title">13.5. Enabling IMA and EVM</h2></div></div></div><p class="_abstract _abstract">
				You can enable and configure Integrity measurement architecture 
(IMA) and extended verification module (EVM) to improve the security of 
the operating system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Secure Boot is temporarily disabled.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When Secure Boot is enabled, the <code class="literal">ima_appraise=fix</code> kernel command-line parameter does not work.
						</p></div></div></li><li class="listitem"><p class="simpara">
						The <code class="literal">securityfs</code> file system is mounted on the <code class="literal">/sys/kernel/security/</code> directory and the <code class="literal">/sys/kernel/security/integrity/ima/</code> directory exists. You can verify where <code class="literal">securityfs</code> is mounted by using the <code class="literal">mount</code> command:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--v1arlar"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mount</strong></span>
...
securityfs on /sys/kernel/security type securityfs (rw,nosuid,nodev,noexec,relatime)
...</pre></div></div></li><li class="listitem"><p class="simpara">
						The <code class="literal">systemd</code> service manager is patched to support IMA and EVM on boot time. You can verify this by using the following command:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mve3ntn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dmesg | grep -i -e EVM -e IMA</strong></span>
[    0.000000] Command line: BOOT_IMAGE=(hd0,msdos1)/vmlinuz-5.14.0-1.el9.x86_64 root=/dev/mapper/rhel-root ro crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet
[    0.000000] kvm-clock: cpu 0, msr 23601001, primary cpu clock
[    0.000000] Using crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M, the size chosen is a best effort estimation.
[    0.000000] Kernel command line: BOOT_IMAGE=(hd0,msdos1)/vmlinuz-5.14.0-1.el9.x86_64 root=/dev/mapper/rhel-root ro crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet
[    0.911527] ima: No TPM chip found, activating TPM-bypass!
[    0.911538] ima: Allocated hash algorithm: sha1
[    0.911580] evm: Initialising EVM extended attributes:
[    0.911581] evm: security.selinux
[    0.911581] evm: security.ima
[    0.911582] evm: security.capability
[    0.911582] evm: HMAC attrs: 0x1
[    1.715151] systemd[1]: systemd 239 running in system mode. (+PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUTILS +KMOD +IDN2 -IDN +PCRE2 default-hierarchy=legacy)
[    3.824198] fbcon: qxldrmfb (fb0) is primary device
[    4.673457] PM: Image not found (code -22)
[    6.549966] systemd[1]: systemd 239 running in system mode. (+PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ +LZ4 +SECCOMP +BLKID +ELFUTILS +KMOD +IDN2 -IDN +PCRE2 default-hierarchy=legacy)</pre></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enable IMA and EVM in the <span class="emphasis"><em>fix</em></span>
 mode for the current boot entry and allow users to gather and update 
the IMA measurements by adding the following kernel command-line 
parameters:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--opfkptc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=/boot/vmlinuz-$(uname -r) --args="ima_policy=appraise_tcb ima_appraise=fix evm=fix"</strong></span></pre></div></div><p class="simpara">
						The command enables IMA and EVM in the <span class="emphasis"><em>fix</em></span> mode for the current boot entry and allows users to gather and update the IMA measurements.
					</p><p class="simpara">
						The <code class="literal">ima_policy=appraise_tcb</code> kernel 
command-line parameter ensures that the kernel uses the default Trusted 
Computing Base (TCB) measurement policy and the appraisal step. The 
appraisal step forbids access to files whose prior and current measures 
do not match.
					</p></li><li class="listitem">
						Reboot to make the changes come into effect.
					</li><li class="listitem"><p class="simpara">
						Optional: Verify that the parameters have been added to the kernel command line:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--z8641qx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /proc/cmdline</strong></span>
BOOT_IMAGE=(hd0,msdos1)/vmlinuz-5.14.0-1.el9.x86_64 root=/dev/mapper/rhel-root ro crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet ima_policy=appraise_tcb ima_appraise=fix evm=fix</pre></div></div></li><li class="listitem"><p class="simpara">
						Create a kernel master key to protect the EVM key:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8rjfoxw"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl add user kmk "$(dd if=/dev/urandom bs=1 count=32 2&gt; /dev/null)" @u</strong></span>
748544121</pre></div></div><p class="simpara">
						The <code class="literal">kmk</code> is kept entirely in the kernel space memory. The 32-byte long value of the <code class="literal">kmk</code> is generated from random bytes from the <code class="literal">/dev/urandom</code> file and placed in the user (<code class="literal">@u</code>) keyring. The key serial number is on the first line of the previous output.
					</p></li><li class="listitem"><p class="simpara">
						Create an encrypted EVM key based on the <code class="literal">kmk</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--e5vrvjz"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl add encrypted evm-key "new user:kmk 64" @u</strong></span>
641780271</pre></div></div><p class="simpara">
						The command uses the <code class="literal">kmk</code> to generate and encrypt a 64-byte long user key (named <code class="literal">evm-key</code>) and places it in the user (<code class="literal">@u</code>) keyring. The key serial number is on the first line of the previous output.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							It is necessary to name the user key as <span class="strong strong"><strong>evm-key</strong></span> because that is the name the EVM subsystem is expecting and is working with.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Create a directory for exported keys.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--4usr87e"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mkdir -p /etc/keys/</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Search for the <code class="literal">kmk</code> and export its unencrypted value into the new directory.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qjz7rcf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl pipe $(keyctl search @u user kmk) &gt; /etc/keys/kmk</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Search for the <code class="literal">evm-key</code> and export its encrypted value into the new directory.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nc2x28l"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl pipe $(keyctl search @u encrypted evm-key) &gt; /etc/keys/evm-key</strong></span></pre></div></div><p class="simpara">
						The <code class="literal">evm-key</code> has been encrypted by the kernel master key earlier.
					</p></li><li class="listitem"><p class="simpara">
						Optional: View the newly created keys.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--v66sgtn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl show</strong></span>
Session Keyring
974575405   --alswrv     0        0      keyring: <span class="emphasis"><em>ses 299489774 --alswrv 0 65534 \</em></span> keyring: <span class="emphasis"><em>uid.0 748544121 --alswrv 0 0 \</em></span> user: kmk
641780271   --alswrv     0        0           \_ encrypted: evm-key

# <span class="strong strong"><strong>ls -l /etc/keys/</strong></span>
total 8
-rw-r--r--. 1 root root 246 Jun 24 12:44 evm-key
-rw-r--r--. 1 root root  32 Jun 24 12:43 kmk</pre></div></div></li><li class="listitem"><p class="simpara">
						Optional: If the keys have been removed from the keyring, for 
example after system reboot, you can import the already exported <code class="literal">kmk</code> and <code class="literal">evm-key</code> instead of creating new ones.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Import the <code class="literal">kmk</code>.
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wggmwhd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl add user kmk "$(cat /etc/keys/kmk)" @u</strong></span>
451342217</pre></div></div></li><li class="listitem"><p class="simpara">
								Import the <code class="literal">evm-key</code>.
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1esfe1z"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>keyctl add encrypted evm-key "load $(cat /etc/keys/evm-key)" @u</strong></span>
924537557</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Activate EVM.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--oz4d3gy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo 1 &gt; /sys/kernel/security/evm</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Relabel the whole system.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ojfoe0g"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>find / -fstype xfs -type f -uid 0 -exec head -n 1 '{}' &gt;/dev/null \;</strong></span></pre></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Enabling IMA and EVM without relabeling the system might make the majority of the files on the system inaccessible.
						</p></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that EVM has been initialized.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--osyb9j2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dmesg | tail -1</strong></span>
[] evm: key initialized</pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#the-kernel-integrity-subsystem_enhancing-security-with-the-kernel-integrity-subsystem">The kernel integrity subsystem</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#trusted-and-encrypted-keys_enhancing-security-with-the-kernel-integrity-subsystem">Trusted and encrypted keys</a>.
					</li></ul></div></section><section class="section" id="collecting-file-hashes-with-integrity-measurement-architecture_enhancing-security-with-the-kernel-integrity-subsystem"><div class="titlepage"><div><div><h2 class="title">13.6. Collecting file hashes with integrity measurement architecture</h2></div></div></div><p class="_abstract _abstract">
				In the <span class="emphasis"><em>measurement</em></span> phase, you can create file hashes and store them as extended attributes (<span class="emphasis"><em>xattrs</em></span>)
 of those files. With the file hashes, you can generate either an 
RSA-based digital signature or a Hash-based Message Authentication Code 
(HMAC-SHA1) and thus prevent offline tampering attacks on the extended 
attributes.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						IMA and EVM are enabled. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#enabling-integrity-measurement-architecture-and-extended-verification-module_enhancing-security-with-the-kernel-integrity-subsystem">Enabling integrity measurement architecture and extended verification module</a>.
					</li><li class="listitem">
						A valid trusted key or encrypted key is stored in the kernel keyring.
					</li><li class="listitem">
						The <code class="literal">ima-evm-utils</code>, <code class="literal">attr</code>, and <code class="literal">keyutils</code> packages are installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a test file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1pxpmr5"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo &lt;<span class="emphasis"><em>Test_text</em></span>&gt; &gt; test_file</strong></span></pre></div></div><p class="simpara">
						IMA and EVM ensure that the <code class="literal">test_file</code> example file has assigned hash values that are stored as its extended attributes.
					</p></li><li class="listitem"><p class="simpara">
						Inspect the files extended attributes:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--i1390cm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>getfattr -m . -d test_file</strong></span>
# <span class="strong strong"><strong>file: test_file</strong></span>
security.evm=0sAnDIy4VPA0HArpPO/EqiutnNyBql
security.ima=0sAQOEDeuUnWzwwKYk+n66h/vby3eD</pre></div></div><p class="simpara">
						The example output shows extended attributes with the IMA and EVM hash values and SELinux context. EVM adds a <code class="literal">security.evm</code> extended attribute related to the other attributes. At this point, you can use the <code class="literal">evmctl</code> utility on <code class="literal">security.evm</code> to generate either an RSA-based digital signature or a Hash-based Message Authentication Code (HMAC-SHA1).
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/security_hardening/index">Security hardening</a>
					</li></ul></div></section></section><section class="chapter" id="assembly_using-systemd-to-manage-resources-used-by-applications_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 14. Using systemd to manage resources used by applications</h1></div></div></div><p>
			RHEL 9 moves the resource management settings from the process level to the application level by binding the system of <code class="literal">cgroup</code> hierarchies with the <code class="literal">systemd</code> unit tree. Therefore, you can manage the system resources with the <code class="literal">systemctl</code> command, or by modifying the <code class="literal">systemd</code> unit files.
		</p><p>
			To achieve this, <code class="literal">systemd</code> takes various configuration options from the unit files or directly via the <code class="literal">systemctl</code> command. Then <code class="literal">systemd</code> applies those options to specific process groups by utilizing the Linux kernel system calls and features like <code class="literal">cgroups</code> and <code class="literal">namespaces</code>.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				You can review the full set of configuration options for <code class="literal">systemd</code> in the following manual pages:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">systemd.resource-control(5)</code>
					</li><li class="listitem">
						<code class="literal">systemd.exec(5)</code>
					</li></ul></div></div></div><section class="section" id="proc_allocating-system-resources-using-systemd_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.1. Allocating system resources using systemd</h2></div></div></div><p>
				To modify the distribution of system resources, you can apply one or more of the following distribution models:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Weights</span></dt><dd><p class="simpara">
							You can distribute the resource by adding up the weights of all 
sub-groups and giving each sub-group the fraction matching its ratio 
against the sum.
						</p><p class="simpara">
							For example, if you have 10 cgroups, each with weight of value 
100, the sum is 1000. Each cgroup receives one tenth of the resource.
						</p><p class="simpara">
							Weight is usually used to distribute stateless resources. For example the&nbsp;<span class="emphasis"><em>CPUWeight=</em></span> option is an implementation of this resource distribution model.
						</p></dd><dt><span class="term">Limits</span></dt><dd><p class="simpara">
							A cgroup can consume up to the configured amount of the resource.
 The sum of sub-group limits can exceed the limit of the parent cgroup. 
Therefore it is possible to overcommit resources in this model.
						</p><p class="simpara">
							For example the&nbsp;<span class="emphasis"><em>MemoryMax=</em></span> option is an implementation of this resource distribution model.
						</p></dd><dt><span class="term">Protections</span></dt><dd><p class="simpara">
							You can set up a protected amount of a resource for a cgroup. If 
the resource usage is below the protection boundary, the kernel will try
 not to penalize this cgroup in favor of other cgroups that compete for 
the same resource. An overcommit is also possible.
						</p><p class="simpara">
							For example the <span class="emphasis"><em>MemoryLow=</em></span> option is an implementation of this resource distribution model.
						</p></dd><dt><span class="term">Allocations</span></dt><dd>
							Exclusive allocations of an absolute amount of a finite resource.
 An overcommit is not possible. An example of this resource type in 
Linux is the real-time budget.
						</dd><dt><span class="term">unit file option</span></dt><dd><p class="simpara">
							A setting for resource control configuration.
						</p><p class="simpara">
							For example, you can configure CPU resource with options like <span class="emphasis"><em>CPUAccounting=</em></span>, or <span class="emphasis"><em>CPUQuota=</em></span>. Similarly, you can configure memory or I/O resources with options like <span class="emphasis"><em>AllowedMemoryNodes=</em></span> and <span class="emphasis"><em>IOAccounting=</em></span>.
						</p></dd></dl></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To change the required value of the unit file option of your service, you can adjust the value in the unit file, or use <code class="literal">systemctl</code> command:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the assigned values for the service of your choice.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5qvkwv1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl show</strong></span> --property <span class="emphasis"><em>&lt;unit file option&gt;</em></span> <span class="emphasis"><em>&lt;service name&gt;</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Set the required value of the CPU time allocation policy option:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ucpo741"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl set-property</strong></span> <span class="emphasis"><em>&lt;service name&gt;</em></span> <span class="emphasis"><em>&lt;unit file option&gt;</em></span>=<span class="emphasis"><em>&lt;value&gt;</em></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check the newly assigned values for the service of your choice.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zizyyls"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl show</strong></span> --property <span class="emphasis"><em>&lt;unit file option&gt;</em></span> <span class="emphasis"><em>&lt;service name&gt;</em></span></pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">systemd.resource-control(5)</code>, <code class="literal">systemd.exec(5)</code> manual pages
					</li></ul></div></section><section class="section" id="con_role-of-systemd-in-resource-management_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.2. Role of systemd in resource management</h2></div></div></div><p>
				The core function of <code class="literal">systemd</code> is service management and supervision. The <code class="literal">systemd</code>
 system and service manager ensures that managed services start at the 
right time and in the correct order during the boot process. The 
services have to run smoothly to use the underlying hardware platform 
optimally. Therefore, <code class="literal">systemd</code> also provides
 capabilities to define resource management policies, and to tune 
various options, which can improve the performance of the service.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					In general, Red Hat recommends you use <code class="literal">systemd</code> for controlling the usage of system resources. You should manually configure the <code class="literal">cgroups</code> virtual file system only in special cases. For example, when you need to use <code class="literal">cgroup-v1</code> controllers that have no equivalents in <code class="literal">cgroup-v2</code> hierarchy.
				</p></div></div></section><section class="section" id="con_overview-of-systemd-hierarchy-for-cgroups_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.3. Overview of systemd hierarchy for cgroups</h2></div></div></div><p>
				On the backend, the <code class="literal">systemd</code> system and service manager makes use of the <code class="literal">slice</code>, the <code class="literal">scope</code> and the <code class="literal">service</code>
 units to organize and structure processes in the control groups. You 
can further modify this hierarchy by creating custom unit files or using
 the <code class="literal">systemctl</code> command. Also, <code class="literal">systemd</code> automatically mounts hierarchies for important kernel resource controllers at the <code class="literal">/sys/fs/cgroup/</code> directory.
			</p><p>
				Three <code class="literal">systemd</code> unit types are used for resource control:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Service</strong></span> - A process or a group of processes, which <code class="literal">systemd</code>
 started according to a unit configuration file. Services encapsulate 
the specified processes so that they can be started and stopped as one 
set. Services are named in the following way:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--48h1cal"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">&lt;<span class="emphasis"><em>name</em></span>&gt;.service</pre></div></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Scope</strong></span> - A 
group of externally created processes. Scopes encapsulate processes that
 are started and stopped by the arbitrary processes through the <code class="literal">fork()</code> function and then registered by <code class="literal">systemd</code> at runtime. For example, user sessions, containers, and virtual machines are treated as scopes. Scopes are named as follows:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--c6uridw"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">&lt;<span class="emphasis"><em>name</em></span>&gt;.scope</pre></div></div></li><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Slice</strong></span> - A 
group of hierarchically organized units. Slices organize a hierarchy in 
which scopes and services are placed. The actual processes are contained
 in scopes or in services. Every name of a slice unit corresponds to the
 path to a location in the hierarchy. The dash ("-") character acts as a
 separator of the path components to a slice from the <code class="literal">-.slice</code> root slice. In the following example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5m5otl8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">&lt;<span class="emphasis"><em>parent-name</em></span>&gt;.slice</pre></div></div><p class="simpara">
						<code class="literal">parent-name.slice</code> is a sub-slice of <code class="literal">parent.slice</code>, which is a sub-slice of the <code class="literal">-.slice</code> root slice. <code class="literal">parent-name.slice</code> can have its own sub-slice named <code class="literal">parent-name-name2.slice</code>, and so on.
					</p></li></ul></div><p>
				The <code class="literal">service</code>, the <code class="literal">scope</code>, and the <code class="literal">slice</code>
 units directly map to objects in the control group hierarchy. When 
these units are activated, they map directly to control group paths 
built from the unit names.
			</p><p>
				The following is an abbreviated example of a control group hierarchy:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--czxhb6y"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">Control group /:
-.slice
user.slice
 user-42.slice
  session-c1.scope
    967 gdm-session-worker [pam/gdm-launch-environment]
   1035 /usr/libexec/gdm-x-session gnome-session --autostart /usr/share/gdm/greeter/autostart
   1054 /usr/libexec/Xorg vt1 -displayfd 3 -auth /run/user/42/gdm/Xauthority -background none -noreset -keeptty -verbose 3
   1212 /usr/libexec/gnome-session-binary --autostart /usr/share/gdm/greeter/autostart
   1369 /usr/bin/gnome-shell
   1732 ibus-daemon --xim --panel disable
   1752 /usr/libexec/ibus-dconf
   1762 /usr/libexec/ibus-x11 --kill-daemon
   1912 /usr/libexec/gsd-xsettings
   1917 /usr/libexec/gsd-a11y-settings
   1920 /usr/libexec/gsd-clipboard

init.scope
 1 /usr/lib/systemd/systemd --switched-root --system --deserialize 18
system.slice
  rngd.service
   800 /sbin/rngd -f
  systemd-udevd.service
   659 /usr/lib/systemd/systemd-udevd
  chronyd.service
   823 /usr/sbin/chronyd
  auditd.service
   761 /sbin/auditd
   763 /usr/sbin/sedispatch
  accounts-daemon.service
   876 /usr/libexec/accounts-daemon
  example.service
    929 /bin/bash /home/jdoe/example.sh
   4902 sleep 1
  </pre></div></div><p>
				The example above shows that services and scopes contain processes 
and are placed in slices that do not contain processes of their own.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_basic_system_settings/managing-system-services-with-systemctl_configuring-basic-system-settings">Configuring basic system settings</a></span></em></span> in Red Hat Enterprise Linux
					</li><li class="listitem">
						<a class="link" href="#what-kernel-resource-controllers-are_setting-limits-for-applications" title="15.2.&nbsp;Introducing kernel resource controllers">What are kernel resource controllers</a>
					</li><li class="listitem">
						<code class="literal">systemd.resource-control(5)</code>, <code class="literal">systemd.exec(5)</code>, <code class="literal">cgroups(7)</code>, <code class="literal">fork()</code>, <code class="literal">fork(2)</code> manual pages
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#setting-limits-for-applications_managing-monitoring-and-updating-the-kernel">Understanding cgroups</a>
					</li></ul></div></section><section class="section" id="listing-systemd_units_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.4. Listing systemd units</h2></div></div></div><p class="_abstract _abstract">
				Use the <code class="literal">systemd</code> system and service manager to list its units.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						List all active units on the system with the <code class="literal"># systemctl</code> command. The terminal will return an output similar to the following example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--flsi5hc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><span class="strong strong"><strong># systemctl</strong></span>
UNIT                                                LOAD   ACTIVE SUB       DESCRIPTION

init.scope                                          loaded active running   System and Service Manager
session-2.scope                                     loaded active running   Session 2 of user jdoe
abrt-ccpp.service                                   loaded active exited    Install ABRT coredump hook
abrt-oops.service                                   loaded active running   ABRT kernel log watcher
abrt-vmcore.service                                 loaded active exited    Harvest vmcores for ABRT
abrt-xorg.service                                   loaded active running   ABRT Xorg log watcher

-.slice                                             loaded active active    Root Slice
machine.slice                                       loaded active active    Virtual Machine and Container Slice system-getty.slice                                                                       loaded active active    system-getty.slice
system-lvm2\x2dpvscan.slice                         loaded active active    system-lvm2\x2dpvscan.slice
system-sshd\x2dkeygen.slice                         loaded active active    system-sshd\x2dkeygen.slice
system-systemd\x2dhibernate\x2dresume.slice         loaded active active    system-systemd\x2dhibernate\x2dresume&gt;
system-user\x2druntime\x2ddir.slice                 loaded active active    system-user\x2druntime\x2ddir.slice
system.slice                                        loaded active active    System Slice
user-1000.slice                                     loaded active active    User Slice of UID 1000
user-42.slice                                       loaded active active    User Slice of UID 42
user.slice                                          loaded active active    User and Session Slice
</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">UNIT</code> - a name of a unit that also 
reflects the unit position in a control group hierarchy. The units 
relevant for resource control are a <span class="emphasis"><em>slice</em></span>, a <span class="emphasis"><em>scope</em></span>, and a <span class="emphasis"><em>service</em></span>.
							</li><li class="listitem">
								<code class="literal">LOAD</code> - indicates whether the unit 
configuration file was properly loaded. If the unit file failed to load,
 the field contains the state <span class="emphasis"><em>error</em></span> instead of <span class="emphasis"><em>loaded</em></span>. Other unit load states are: <span class="emphasis"><em>stub</em></span>, <span class="emphasis"><em>merged</em></span>, and <span class="emphasis"><em>masked</em></span>.
							</li><li class="listitem">
								<code class="literal">ACTIVE</code> - the high-level unit activation state, which is a generalization of <code class="literal">SUB</code>.
							</li><li class="listitem">
								<code class="literal">SUB</code> - the low-level unit activation state. The range of possible values depends on the unit type.
							</li><li class="listitem">
								<code class="literal">DESCRIPTION</code> - the description of the unit content and functionality.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						List inactive units.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--m6o4lf7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl --all</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Limit the amount of information in the output.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--589xj8i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl --type service,masked</strong></span></pre></div></div><p class="simpara">
						The <code class="literal">--type</code> option requires a comma-separated list of unit types such as a <span class="emphasis"><em>service</em></span> and a <span class="emphasis"><em>slice</em></span>, or unit load states such as <span class="emphasis"><em>loaded</em></span> and <span class="emphasis"><em>masked</em></span>.
					</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_basic_system_settings/managing-system-services-with-systemctl_configuring-basic-system-settings">Configuring basic system settings</a></span></em></span> in RHEL
					</li><li class="listitem">
						The <code class="literal">systemd.resource-control(5)</code>, <code class="literal">systemd.exec(5)</code> manual pages
					</li></ul></div></section><section class="section" id="viewing-systemd-control-group-hierarchy_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.5. Viewing systemd control group hierarchy</h2></div></div></div><p class="_abstract _abstract">
				Display control groups (<code class="literal">cgroups</code>) hierarchy and processes running in specific <code class="literal">cgroups</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display the whole <code class="literal">cgroups</code> hierarchy on your system with the <code class="literal">systemd-cgls</code> command.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pkwq041"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemd-cgls</strong></span>
Control group /:
-.slice
user.slice
 user-42.slice
  session-c1.scope
    965 gdm-session-worker [pam/gdm-launch-environment]
   1040 /usr/libexec/gdm-x-session gnome-session --autostart /usr/share/gdm/greeter/autostart

init.scope
 1 /usr/lib/systemd/systemd --switched-root --system --deserialize 18
system.slice
  
  example.service
   6882 /bin/bash /home/jdoe/example.sh
   6902 sleep 1
  systemd-journald.service
    629 /usr/lib/systemd/systemd-journald
  </pre></div></div><p class="simpara">
						The example output returns the entire <code class="literal">cgroups</code> hierarchy, where the highest level is formed by <span class="emphasis"><em>slices</em></span>.
					</p></li><li class="listitem"><p class="simpara">
						Display the <code class="literal">cgroups</code> hierarchy filtered by a resource controller with the <code class="literal">systemd-cgls &lt;<span class="emphasis"><em>resource_controller</em></span>&gt;</code> command.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qq8qx6q"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemd-cgls memory</strong></span>
Controller memory; Control group /:
1 /usr/lib/systemd/systemd --switched-root --system --deserialize 18
user.slice
 user-42.slice
  session-c1.scope
    965 gdm-session-worker [pam/gdm-launch-environment]

system.slice
  |
  
  chronyd.service
   844 /usr/sbin/chronyd
  example.service
   8914 /bin/bash /home/jdoe/example.sh
   8916 sleep 1
  </pre></div></div><p class="simpara">
						The example output of the above command lists the services that interact with the selected controller.
					</p></li><li class="listitem"><p class="simpara">
						Display detailed information about a certain unit and its part of the <code class="literal">cgroups</code> hierarchy with the <code class="literal">systemctl status &lt;<span class="emphasis"><em>system_unit</em></span>&gt;</code> command.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5bork9i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl status example.service</strong></span>
 example.service - My example service
   Loaded: loaded (/usr/lib/systemd/system/example.service; enabled; vendor preset: disabled)
   Active: active (running) since Tue 2019-04-16 12:12:39 CEST; 3s ago
 Main PID: 17737 (bash)
    Tasks: 2 (limit: 11522)
   Memory: 496.0K (limit: 1.5M)
   CGroup: /system.slice/example.service
           17737 /bin/bash /home/jdoe/example.sh
           17743 sleep 1
Apr 16 12:12:39 redhat systemd[1]: Started My example service.
Apr 16 12:12:39 redhat bash[17737]: The current time is Tue Apr 16 12:12:39 CEST 2019
Apr 16 12:12:40 redhat bash[17737]: The current time is Tue Apr 16 12:12:40 CEST 2019</pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#what-kernel-resource-controllers-are_setting-limits-for-applications" title="15.2.&nbsp;Introducing kernel resource controllers">What are kernel resource controllers</a>
					</li><li class="listitem">
						The <code class="literal">systemd.resource-control(5)</code>, <code class="literal">cgroups(7)</code> manual pages
					</li></ul></div></section><section class="section" id="proc_viewing-cgroups-of-processes_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.6. Viewing cgroups of processes</h2></div></div></div><p>
				The following procedure describes how to learn which <span class="emphasis"><em>control group</em></span> (<code class="literal">cgroup</code>) a process belongs to. Then you can check the <code class="literal">cgroup</code> to learn which controllers and controller-specific configurations it uses.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To view which <code class="literal">cgroup</code> a process belongs to, run the <code class="literal"># cat proc/&lt;<span class="emphasis"><em>PID</em></span>&gt;/cgroup</code> command:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pyrfw0d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /proc/2467/cgroup</strong></span>
0::/system.slice/example.service</pre></div></div><p class="simpara">
						The example output relates to a process of interest. In this case, it is a process identified by <code class="literal">PID 2467</code>, which belongs to the <code class="literal">example.service</code> unit. You can determine whether the process was placed in a correct control group as defined by the <code class="literal">systemd</code> unit file specifications.
					</p></li><li class="listitem"><p class="simpara">
						To display what controllers the <code class="literal">cgroup</code> utilizes and the respective configuration files, check the <code class="literal">cgroup</code> directory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nxtlqos"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /sys/fs/cgroup/system.slice/example.service/cgroup.controllers</strong></span>
memory pids

# <span class="strong strong"><strong>ls /sys/fs/cgroup/system.slice/example.service/</strong></span>
cgroup.controllers
cgroup.events

cpu.pressure
cpu.stat
io.pressure
memory.current
memory.events

pids.current
pids.events
pids.max</pre></div></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The version 1 hierarchy of <code class="literal">cgroups</code> uses a per-controller model. Therefore the output from the <code class="literal">/proc/<span class="emphasis"><em>PID</em></span>/cgroup</code> file shows, which <code class="literal">cgroups</code> under each controller the PID belongs to. You can find the respective <code class="literal">cgroups</code> under the controller directories at <code class="literal">/sys/fs/cgroup/<span class="emphasis"><em>&lt;controller_name&gt;</em></span>/</code>.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">cgroups(7)</code> manual page
					</li><li class="listitem">
						<a class="link" href="#what-kernel-resource-controllers-are_setting-limits-for-applications" title="15.2.&nbsp;Introducing kernel resource controllers">What are kernel resource controllers</a>
					</li><li class="listitem">
						Documentation in the <code class="literal">/usr/share/doc/kernel-doc-&lt;kernel_version&gt;/Documentation/admin-guide/cgroup-v2.rst</code> file (after installing the <code class="literal">kernel-doc</code> package)
					</li></ul></div></section><section class="section" id="monitoring-resource-consumption_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.7. Monitoring resource consumption</h2></div></div></div><p class="_abstract _abstract">
				View a list of currently running control groups (<code class="literal">cgroups</code>) and their resource consumption in real-time.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display a dynamic account of currently running <code class="literal">cgroups</code> with the <code class="literal">systemd-cgtop</code> command.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--prlrzkz"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemd-cgtop</strong></span>
Control Group                            Tasks   %CPU   Memory  Input/s Output/s
/                                          607   29.8     1.5G        -        -
/system.slice                              125      -   428.7M        -        -
/system.slice/ModemManager.service           3      -     8.6M        -        -
/system.slice/NetworkManager.service         3      -    12.8M        -        -
/system.slice/accounts-daemon.service        3      -     1.8M        -        -
/system.slice/boot.mount                     -      -    48.0K        -        -
/system.slice/chronyd.service                1      -     2.0M        -        -
/system.slice/cockpit.socket                 -      -     1.3M        -        -
/system.slice/colord.service                 3      -     3.5M        -        -
/system.slice/crond.service                  1      -     1.8M        -        -
/system.slice/cups.service                   1      -     3.1M        -        -
/system.slice/dev-hugepages.mount            -      -   244.0K        -        -
/system.slice/dev-mapper-rhel\x2dswap.swap   -      -   912.0K        -        -
/system.slice/dev-mqueue.mount               -      -    48.0K        -        -
/system.slice/example.service                2      -     2.0M        -        -
/system.slice/firewalld.service              2      -    28.8M        -        -
...</pre></div></div><p class="simpara">
						The example output displays currently running <code class="literal">cgroups</code>
 ordered by their resource usage (CPU, memory, disk I/O load). The list 
refreshes every 1 second by default. Therefore, it offers a dynamic 
insight into the actual resource usage of each control group.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">systemd-cgtop(1)</code> manual page
					</li></ul></div></section><section class="section" id="proc_using-systemd-unit-files-to-set-limits-for-applications_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.8. Using systemd unit files to set limits for applications</h2></div></div></div><p>
				Each existing or running unit is supervised by the <code class="literal">systemd</code>, which also creates control groups for them. The units have configuration files in the <code class="literal">/usr/lib/systemd/system/</code>
 directory. You can manually modify the unit files to set limits, 
prioritize, or control access to hardware resources for groups of 
processes.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the <code class="literal">root</code> privileges.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Modify the <code class="literal">/usr/lib/systemd/system/example.service</code> file to limit the memory usage of a service:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--38mvsno"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">
[Service]
MemoryMax=1500K
</pre></div></div><p class="simpara">
						The configuration above places a maximum memory limit, which the processes in a control group cannot exceed. The <code class="literal">example.service</code>
 service is part of such a control group which has imposed limitations. 
You can use suffixes K, M, G, or T to identify Kilobyte, Megabyte, 
Gigabyte, or Terabyte as a unit of measurement.
					</p></li><li class="listitem"><p class="simpara">
						Reload all unit configuration files:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wsjgtoz"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl daemon-reload</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Restart the service:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--dmr7may"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl restart</strong></span> <span class="emphasis"><em>example.service</em></span></pre></div></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can review the full set of configuration options for <code class="literal">systemd</code> in the following manual pages:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">systemd.resource-control(5)</code>
						</li><li class="listitem">
							<code class="literal">systemd.exec(5)</code>
						</li></ul></div></div></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the changes took effect:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--cgip73q"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /sys/fs/cgroup/system.slice/example.service/memory.max</strong></span>
1536000</pre></div></div><p class="simpara">
						The example output shows that the memory consumption was limited at around 1,500 KB.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#setting-limits-for-applications_managing-monitoring-and-updating-the-kernel">Understanding cgroups</a>
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_basic_system_settings/index#managing-system-services-with-systemctl_configuring-basic-system-settings">Configuring basic system settings</a></span></em></span> in Red Hat Enterprise Linux
					</li><li class="listitem">
						<code class="literal">systemd.resource-control(5)</code>, <code class="literal">systemd.exec(5)</code>, <code class="literal">cgroups(7)</code> manual pages
					</li></ul></div></section><section class="section" id="proc_using-systemctl-command-to-set-limits-to-applications_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.9. Using systemctl command to set limits to applications</h2></div></div></div><p class="_abstract _abstract">
				CPU affinity settings help you restrict the access of a particular 
process to some CPUs. Effectively, the CPU scheduler never schedules the
 process to run on the CPU that is not in the affinity mask of the 
process.
			</p><p>
				The default CPU affinity mask applies to all services managed by <code class="literal">systemd</code>.
			</p><p>
				To configure CPU affinity mask for a particular <code class="literal">systemd</code> service, <code class="literal">systemd</code> provides <code class="literal">CPUAffinity=</code> both as a unit file option and a manager configuration option in the <code class="literal">/etc/systemd/system.conf</code> file.
			</p><p>
				The <span class="strong strong"><strong><code class="literal">CPUAffinity=</code> unit file option</strong></span> sets a list of CPUs or CPU ranges that are merged and used as the affinity mask.
			</p><p>
				After configuring CPU affinity mask for a particular <code class="literal">systemd</code> service, you must restart the service to apply the changes.
			</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To set CPU affinity mask for a particular <code class="literal">systemd</code> service using the <span class="strong strong"><strong><code class="literal">CPUAffinity</code> unit file</strong></span> option:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the values of the <code class="literal">CPUAffinity</code> unit file option in the service of your choice:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--15bjqgn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>systemctl show</strong></span> --property <span class="emphasis"><em>&lt;CPU affinity configuration option&gt;</em></span> <span class="emphasis"><em>&lt;service name&gt;</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						As a root, set the required value of the <code class="literal">CPUAffinity</code> unit file option for the CPU ranges used as the affinity mask:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yxgo399"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl set-property</strong></span> <span class="emphasis"><em>&lt;service name&gt;</em></span> CPUAffinity=<span class="emphasis"><em>&lt;value&gt;</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Restart the service to apply the changes.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--54soc4e"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl restart</strong></span> <span class="emphasis"><em>&lt;service name&gt;</em></span></pre></div></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can review the full set of configuration options for <code class="literal">systemd</code> in the following manual pages:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">systemd.resource-control(5)</code>
						</li><li class="listitem">
							<code class="literal">systemd.exec(5)</code>
						</li></ul></div></div></div></section><section class="section" id="proc_setting-global-default-cpu-affinity-through-manager-configuration_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.10. Setting global default CPU affinity through manager configuration</h2></div></div></div><p>
				The <span class="strong strong"><strong><code class="literal">CPUAffinity</code> option</strong></span> in the <code class="literal">/etc/systemd/system.conf</code>
 file defines an affinity mask for the process identification number 
(PID) 1 and all processes forked off of PID1. You can then override the <code class="literal">CPUAffinity</code> on a per-service basis.
			</p><p>
				To set default CPU affinity mask for all systemd services using the <span class="strong strong"><strong>manager configuration</strong></span> option:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Set the CPU numbers for the <code class="literal">CPUAffinity=</code> option in the <code class="literal">/etc/systemd/system.conf</code> file.
					</li><li class="listitem"><p class="simpara">
						Save the edited file and reload the <code class="literal">systemd</code> service:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--snbgtsy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl daemon-reload</strong></span></pre></div></div></li><li class="listitem">
						Reboot the server to apply the changes.
					</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can review the full set of configuration options for <code class="literal">systemd</code> in the following manual pages:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">systemd.resource-control(5)</code>
						</li><li class="listitem">
							<code class="literal">systemd.exec(5)</code>
						</li></ul></div></div></div></section><section class="section" id="proc_configuring-numa-using-systemd_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.11. Configuring NUMA policies using systemd</h2></div></div></div><p class="_abstract _abstract">
				Non-uniform memory access (NUMA) is a computer memory subsystem 
design, in which the memory access time depends on the physical memory 
location relative to the processor.
			</p><p>
				Memory close to the CPU has lower latency (local memory) than memory
 that is local for a different CPU (foreign memory) or is shared between
 a set of CPUs.
			</p><p>
				In terms of the Linux kernel, NUMA policy governs where (for 
example, on which NUMA nodes) the kernel allocates physical memory pages
 for the process.
			</p><p>
				<code class="literal">systemd</code> provides unit file options <code class="literal">NUMAPolicy</code> and <code class="literal">NUMAMask</code> to control memory allocation policies for services.
			</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To set the NUMA memory policy through the <span class="strong strong"><strong><code class="literal">NUMAPolicy</code> unit file</strong></span> option:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the values of the <code class="literal">NUMAPolicy</code> unit file option in the service of your choice:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xv38fzi"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>systemctl show --property <span class="emphasis"><em>&lt;NUMA policy configuration option&gt;</em></span> <span class="emphasis"><em>&lt;service name&gt;</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						As a root, set the required policy type of the <code class="literal">NUMAPolicy</code> unit file option:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8qcs4wx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl set-property <span class="emphasis"><em>&lt;service name&gt;</em></span> NUMAPolicy=<span class="emphasis"><em>&lt;value&gt;</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Restart the service to apply the changes.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0kcgtmm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl restart <span class="emphasis"><em>&lt;service name&gt;</em></span></strong></span></pre></div></div></li></ol></div><p>
				To set a global <code class="literal">NUMAPolicy</code> setting through the <span class="strong strong"><strong>manager configuration</strong></span> option:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Search in the <code class="literal">/etc/systemd/system.conf</code> file for the <code class="literal">NUMAPolicy</code> option.
					</li><li class="listitem">
						Edit the policy type and save the file.
					</li><li class="listitem"><p class="simpara">
						Reload the <code class="literal">systemd</code> configuration:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qakafwr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemd daemon-reload</strong></span></pre></div></div></li><li class="listitem">
						Reboot the server.
					</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					When you configure a strict NUMA policy, for example <code class="literal">bind</code>, make sure that you also appropriately set the <code class="literal">CPUAffinity=</code> unit file option.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#proc_using-systemctl-command-to-set-limits-to-applications_assembly_using-systemd-to-manage-resources-used-by-applications" title="14.9.&nbsp;Using systemctl command to set limits to applications">Using systemctl command to set limits to applications</a>
					</li><li class="listitem">
						The <code class="literal">systemd.resource-control(5)</code>, <code class="literal">systemd.exec(5)</code>, <code class="literal">set_mempolicy(2)</code> manual pages.
					</li></ul></div></section><section class="section" id="ref_numa-policy-configuration-options-with-systemd_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.12. NUMA policy configuration options for systemd</h2></div></div></div><p class="_abstract _abstract">
				Systemd provides the following options to configure the NUMA policy:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">NUMAPolicy</code></span></dt><dd><p class="simpara">
							Controls the NUMA memory policy of the executed processes. The following policy types are possible:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									default
								</li><li class="listitem">
									preferred
								</li><li class="listitem">
									bind
								</li><li class="listitem">
									interleave
								</li><li class="listitem">
									local
								</li></ul></div></dd><dt><span class="term"><code class="literal">NUMAMask</code></span></dt><dd><p class="simpara">
							Controls the NUMA node list which is associated with the selected NUMA policy.
						</p><p class="simpara">
							Note that the <code class="literal">NUMAMask</code> option is not required to be specified for the following policies:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									default
								</li><li class="listitem">
									local
								</li></ul></div><p class="simpara">
							For the preferred policy, the list specifies only a single NUMA node.
						</p></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">systemd.resource-control(5)</code>, <code class="literal">systemd.exec(5)</code>, and <code class="literal">set_mempolicy(2)</code> manual pages
					</li></ul></div></section><section class="section" id="creating-transient-control-groups_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.13. Creating transient cgroups using systemd-run command</h2></div></div></div><p class="_abstract _abstract">
				The transient <code class="literal">cgroups</code> set limits on resources consumed by a unit (service or scope) during its runtime.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To create a transient control group, use the <code class="literal">systemd-run</code> command in the following format:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0zhrcf4"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemd-run</strong></span> --unit=<span class="emphasis"><em>&lt;name&gt;</em></span> --slice=<span class="emphasis"><em>&lt;name&gt;</em></span>.slice <span class="emphasis"><em>&lt;command&gt;</em></span></pre></div></div><p class="simpara">
						This command creates and starts a transient service or a scope unit and runs a custom command in such a unit.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">--unit=&lt;name&gt;</code> option gives a name to the unit. If <code class="literal">--unit</code> is not specified, the name is generated automatically.
							</li><li class="listitem">
								The <code class="literal">--slice=&lt;<span class="emphasis"><em>name</em></span>&gt;.slice</code> option makes your service or scope unit a member of a specified slice. Replace <code class="literal">&lt;<span class="emphasis"><em>name</em></span>&gt;.slice</code> with the name of an existing slice (as shown in the output of <code class="literal">systemctl -t slice</code>), or create a new slice by passing a unique name. By default, services and scopes are created as members of the <code class="literal">system.slice</code>.
							</li><li class="listitem"><p class="simpara">
								Replace <code class="literal">&lt;<span class="emphasis"><em>command</em></span>&gt;</code> with the command you wish to execute in the service or the scope unit.
							</p><p class="simpara">
								The following message is displayed to confirm that you created and started the service or the scope successfully:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--26zsvc3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># Running as unit <span class="emphasis"><em>&lt;name&gt;</em></span>.service</pre></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Optionally, keep the unit running after its processes finished to collect run-time information:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ksk2m3n"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemd-run</strong></span> --unit=<span class="emphasis"><em>&lt;name&gt;</em></span> --slice=<span class="emphasis"><em>&lt;name&gt;</em></span>.slice --remain-after-exit <span class="emphasis"><em>&lt;command&gt;</em></span></pre></div></div><p class="simpara">
						The command creates and starts a transient service unit and runs a custom command in such a unit. The <code class="literal">--remain-after-exit</code> option ensures that the service keeps running after its processes have finished.
					</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#understanding-control-groups_setting-limits-for-applications" title="15.1.&nbsp;Introducing control groups">What are control groups</a>
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_basic_system_settings/index#managing-system-services-with-systemctl_configuring-basic-system-settings">Configuring basic system settings</a></span></em></span> in RHEL
					</li><li class="listitem">
						the <code class="literal">systemd-run(1)</code> manual page
					</li></ul></div></section><section class="section" id="removing-transient-control-groups_assembly_using-systemd-to-manage-resources-used-by-applications"><div class="titlepage"><div><div><h2 class="title">14.14. Removing transient control groups</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">systemd</code> system and service manager to remove transient control groups (<code class="literal">cgroups</code>) if you no longer need to limit, prioritize, or control access to hardware resources for groups of processes.
			</p><p>
				Transient <code class="literal">cgroups</code> are automatically released once all the processes that a service or a scope unit contains, finish.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To stop the service unit with all its processes, execute:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--g09i65g"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl stop</strong></span> <span class="emphasis"><em>name</em></span>.service</pre></div></div></li><li class="listitem"><p class="simpara">
						To terminate one or more of the unit processes, execute:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qi153se"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl kill</strong></span> <span class="emphasis"><em>name</em></span>.service --kill-who=<span class="emphasis"><em>PID,...</em></span> --signal=<span class="emphasis"><em>&lt;signal&gt;</em></span></pre></div></div><p class="simpara">
						The command above uses the <code class="literal">--kill-who</code>
 option to select process(es) from the control group you wish to 
terminate. To kill multiple processes at the same time, pass a 
comma-separated list of PIDs. The <code class="literal">--signal</code> option determines the type of POSIX signal to be sent to the specified processes. The default signal is <span class="emphasis"><em>SIGTERM</em></span>.
					</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#understanding-control-groups_setting-limits-for-applications" title="15.1.&nbsp;Introducing control groups">What are control groups</a>
					</li><li class="listitem">
						<a class="link" href="#what-kernel-resource-controllers-are_setting-limits-for-applications" title="15.2.&nbsp;Introducing kernel resource controllers">What are kernel resource controllers</a>
					</li><li class="listitem">
						<code class="literal">systemd.resource-control(5)</code>, <code class="literal">cgroups(7)</code> manual pages
					</li><li class="listitem">
						<span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_basic_system_settings/index#managing-system-services-with-systemctl_configuring-basic-system-settings">Configuring basic system settings</a></span></em></span> in RHEL
					</li></ul></div></section></section><section class="chapter" id="setting-limits-for-applications_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 15. Understanding control groups</h1></div></div></div><p class="_abstract _abstract">
			Using the control groups (<code class="literal">cgroups</code>) kernel functionality, you can control resource usage of applications to use them more efficiently.
		</p><p>
			You can use <code class="literal">cgroups</code> for the following tasks:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Setting limits for system recourse allocation.
				</li><li class="listitem">
					Prioritizing the allocation of hardware resources to specific processes.
				</li><li class="listitem">
					Isolating certain processes from obtaining hardware resources.
				</li></ul></div><section class="section" id="understanding-control-groups_setting-limits-for-applications"><div class="titlepage"><div><div><h2 class="title">15.1. Introducing control groups</h2></div></div></div><p class="_abstract _abstract">
				Using the <span class="emphasis"><em>control groups</em></span> Linux kernel feature, you can organize processes into hierarchically ordered groups - <code class="literal">cgroups</code>. You define the hierarchy (control groups tree) by providing structure to <code class="literal">cgroups</code> virtual file system, mounted by default on the <code class="literal">/sys/fs/cgroup/</code> directory.
			</p><p>
				The <code class="literal">systemd</code> service manager uses <code class="literal">cgroups</code> to organize all units and services that it governs. Manually, you can manage the hierarchies of <code class="literal">cgroups</code> by creating and removing sub-directories in the <code class="literal">/sys/fs/cgroup/</code> directory.
			</p><p>
				The resource controllers in the kernel then modify the behavior of processes in <code class="literal">cgroups</code> by limiting, prioritizing or allocating system resources, of those processes. These resources include the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						CPU time
					</li><li class="listitem">
						Memory
					</li><li class="listitem">
						Network bandwidth
					</li><li class="listitem">
						Combinations of these resources
					</li></ul></div><p>
				The primary use case of <code class="literal">cgroups</code> is 
aggregating system processes and dividing hardware resources among 
applications and users. This makes it possible to increase the 
efficiency, stability, and security of your environment.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Control groups version 1</span></dt><dd><p class="simpara">
							<span class="emphasis"><em>Control groups version 1</em></span> (<code class="literal">cgroups-v1</code>)
 provide a per-resource controller hierarchy. This means that each 
resource (such as CPU, memory, or I/O) has its own control group 
hierarchy. You can combine different control group hierarchies in a way 
that one controller can coordinate with another in managing their 
respective resources. However, when the two controllers belong to 
different process hierarchies, proper coordination is limited.
						</p><p class="simpara">
							The <code class="literal">cgroups-v1</code> controllers were 
developed across a large time span and as a result, the behavior and 
naming of their control files is not uniform.
						</p></dd><dt><span class="term">Control groups version 2</span></dt><dd><p class="simpara">
							<span class="emphasis"><em>Control groups version 2</em></span> (<code class="literal">cgroups-v2</code>) provide a single control group hierarchy against which all resource controllers are mounted.
						</p><p class="simpara">
							The control file behavior and naming is consistent among different controllers.
						</p></dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 9, by default, mounts and uses <code class="literal">cgroups-v2</code>.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#what-kernel-resource-controllers-are_setting-limits-for-applications" title="15.2.&nbsp;Introducing kernel resource controllers">Introducing kernel resource controllers</a>
					</li><li class="listitem">
						The <code class="literal">cgroups(7)</code> manual page
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/labs/rhcb/RHEL-9.0/kernel-5.14.0-1.7.1.el9/source/Documentation/admin-guide/cgroup-v1">cgroups-v1</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/labs/rhcb/RHEL-9.0/kernel-5.14.0-1.7.1.el9/source/blob/Documentation/admin-guide/cgroup-v2.rst">cgroups-v2</a>
					</li></ul></div></section><section class="section" id="what-kernel-resource-controllers-are_setting-limits-for-applications"><div class="titlepage"><div><div><h2 class="title">15.2. Introducing kernel resource controllers</h2></div></div></div><p class="_abstract _abstract">
				Kernel resource controllers enable the functionality of control groups. RHEL 9 supports various controllers for <span class="emphasis"><em>control groups version 1</em></span> (<code class="literal">cgroups-v1</code>) and <span class="emphasis"><em>control groups version 2</em></span> (<code class="literal">cgroups-v2</code>).
			</p><p>
				A resource controller, also called a control group subsystem, is a 
kernel subsystem that represents a single resource, such as CPU time, 
memory, network bandwidth or disk I/O. The Linux kernel provides a range
 of resource controllers that are mounted automatically by the <code class="literal">systemd</code> service manager. You can find a list of the currently mounted resource controllers in the <code class="literal">/proc/cgroups</code> file.
			</p><div class="table" id="idm139983842556256"><p class="title">Table 15.1. Controllers available for cgroups-v1:</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="e0viu8x" id="rh-table--e0viu8x" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--><col style="width: 75%; " class="col_2"><!--Empty--></colgroup><tbody><tr><td data-row="1" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">blkio</code>
							</p>
							 </td><td data-row="1" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Sets limits on input/output access to and from block devices.
							</p>
							 </td></tr><tr><td data-row="2" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<code class="literal">cpu</code>
							</p>
							 </td><td data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Adjusts the parameters of the Completely Fair Scheduler (CFS) for a control groups tasks. The <code class="literal">cpu</code> controller is mounted together with the <code class="literal">cpuacct</code> controller on the same mount.
							</p>
							 </td></tr><tr><td data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">cpuacct</code>
							</p>
							 </td><td data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Creates automatic reports on CPU resources used by tasks in a control group. The <code class="literal">cpuacct</code> controller is mounted together with the <code class="literal">cpu</code> controller on the same mount.
							</p>
							 </td></tr><tr><td data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">cpuset</code>
							</p>
							 </td><td data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Restricts control group tasks to run only on a specified subset 
of CPUs and to direct the tasks to use memory only on specified memory 
nodes.
							</p>
							 </td></tr><tr><td data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">devices</code>
							</p>
							 </td><td data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Controls access to devices for tasks in a control group.
							</p>
							 </td></tr><tr><td data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">freezer</code>
							</p>
							 </td><td data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Suspends or resumes tasks in a control group.
							</p>
							 </td></tr><tr><td data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">memory</code>
							</p>
							 </td><td data-row="7" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Sets limits on memory use by tasks in a control group and 
generates automatic reports on memory resources used by those tasks.
							</p>
							 </td></tr><tr><td data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">net_cls</code>
							</p>
							 </td><td data-row="8" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Tags network packets with a class identifier (<code class="literal">classid</code>) that enables the Linux traffic controller (the <code class="literal">tc</code> command) to identify packets that originate from a particular control group task. A subsystem of <code class="literal">net_cls</code>, the <code class="literal">net_filter</code> (iptables), can also use this tag to perform actions on such packets. The <code class="literal">net_filter</code> tags network sockets with a firewall identifier (<code class="literal">fwid</code>) that allows the Linux firewall to identify packets that originate from a particular control group task (by using the <code class="literal">iptables</code> command).
							</p>
							 </td></tr><tr><td data-row="9" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">net_prio</code>
							</p>
							 </td><td data-row="9" data-col="2" class="content--md" valign="top" align="left"> <p>
								Sets the priority of network traffic.
							</p>
							 </td></tr><tr><td data-row="10" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">pids</code>
							</p>
							 </td><td data-row="10" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Sets limits for a number of processes and their children in a control group.
							</p>
							 </td></tr><tr><td data-row="11" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">perf_event</code>
							</p>
							 </td><td data-row="11" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Groups tasks for monitoring by the <code class="literal">perf</code> performance monitoring and reporting utility.
							</p>
							 </td></tr><tr><td data-row="12" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">rdma</code>
							</p>
							 </td><td data-row="12" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Sets limits on Remote Direct Memory Access/InfiniBand specific resources in a control group.
							</p>
							 </td></tr><tr><td data-row="13" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">hugetlb</code>
							</p>
							 </td><td data-row="13" data-col="2" class="content--lg" valign="top" align="left"> <p>
								can be used to limit the usage of large size virtual memory pages by tasks in a control group.
							</p>
							 </td></tr></tbody></table></rh-table></div><div class="table" id="idm139983843563936"><p class="title">Table 15.2. Controllers available for cgroups-v2:</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="ndxrzj6" id="rh-table--ndxrzj6" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--><col style="width: 75%; " class="col_2"><!--Empty--></colgroup><tbody><tr><td data-row="1" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<code class="literal">io</code>
							</p>
							 </td><td data-row="1" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Sets limits on input/output access to and from block devices.
							</p>
							 </td></tr><tr><td data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">memory</code>
							</p>
							 </td><td data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Sets limits on memory use by tasks in a control group and 
generates automatic reports on memory resources used by those tasks.
							</p>
							 </td></tr><tr><td data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">pids</code>
							</p>
							 </td><td data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Sets limits for a number of processes and their children in a control group.
							</p>
							 </td></tr><tr><td data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">rdma</code>
							</p>
							 </td><td data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Sets limits on Remote Direct Memory Access/InfiniBand specific resources in a control group.
							</p>
							 </td></tr><tr><td data-row="5" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<code class="literal">cpu</code>
							</p>
							 </td><td data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Adjusts the parameters of the Completely Fair Scheduler (CFS) 
for a control groups tasks and creates automatic reports on CPU 
resources used by tasks in a control group.
							</p>
							 </td></tr><tr><td data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">cpuset</code>
							</p>
							 </td><td data-row="6" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Restricts control group tasks to run only on a specified subset 
of CPUs and to direct the tasks to use memory only on specified memory 
nodes. Supports only the core functionality (<code class="literal">cpus{,.effective}</code>, <code class="literal">mems{,.effective}</code>) with a new partition feature.
							</p>
							 </td></tr><tr><td data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">perf_event</code>
							</p>
							 </td><td data-row="7" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Groups tasks for monitoring by the <code class="literal">perf</code> performance monitoring and reporting utility. <code class="literal">perf_event</code> is enabled automatically on the v2 hierarchy.
							</p>
							 </td></tr></tbody></table></rh-table></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					A resource controller can be used either in a <code class="literal">cgroups-v1</code> hierarchy or a <code class="literal">cgroups-v2</code> hierarchy, not simultaneously in both.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">cgroups(7)</code> manual page
					</li><li class="listitem">
						Documentation in <code class="literal">/usr/share/doc/kernel-doc-&lt;kernel_version&gt;/Documentation/cgroups-v1/</code> directory (after installing the <code class="literal">kernel-doc</code> package).
					</li></ul></div></section><section class="section" id="what-namespaces-are_setting-limits-for-applications"><div class="titlepage"><div><div><h2 class="title">15.3. Introducing namespaces</h2></div></div></div><p class="_abstract _abstract">
				Namespaces are one of the most important methods for organizing and identifying software objects.
			</p><p>
				A namespace wraps a global system resource (for example, a mount 
point, a network device, or a hostname) in an abstraction that makes it 
appear to processes within the namespace that they have their own 
isolated instance of the global resource. One of the most common 
technologies that use namespaces are containers.
			</p><p>
				Changes to a particular global resource are visible only to 
processes in that namespace and do not affect the rest of the system or 
other namespaces.
			</p><p>
				To inspect which namespaces a process is a member of, you can check the symbolic links in the <code class="literal">/proc/&lt;<span class="emphasis"><em>PID</em></span>&gt;/ns/</code> directory.
			</p><div class="table" id="idm139983845813312"><p class="title">Table 15.3. Supported namespaces and resources which they isolate:</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="90mb3qa" id="rh-table--90mb3qa" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm139983845808512" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Namespace</th><th id="idm139983845807424" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Isolates</th></tr></thead><tbody><tr><td headers="idm139983845808512" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								<span class="strong strong"><strong>Mount</strong></span>
							</p>
							 </td><td headers="idm139983845807424" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								Mount points
							</p>
							 </td></tr><tr><td headers="idm139983845808512" data-row="3" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<span class="strong strong"><strong>UTS</strong></span>
							</p>
							 </td><td headers="idm139983845807424" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								Hostname and NIS domain name
							</p>
							 </td></tr><tr><td headers="idm139983845808512" data-row="4" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<span class="strong strong"><strong>IPC</strong></span>
							</p>
							 </td><td headers="idm139983845807424" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								System V IPC, POSIX message queues
							</p>
							 </td></tr><tr><td headers="idm139983845808512" data-row="5" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<span class="strong strong"><strong>PID</strong></span>
							</p>
							 </td><td headers="idm139983845807424" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								Process IDs
							</p>
							 </td></tr><tr><td headers="idm139983845808512" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								<span class="strong strong"><strong>Network</strong></span>
							</p>
							 </td><td headers="idm139983845807424" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Network devices, stacks, ports, etc
							</p>
							 </td></tr><tr><td headers="idm139983845808512" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								<span class="strong strong"><strong>User</strong></span>
							</p>
							 </td><td headers="idm139983845807424" data-row="7" data-col="2" class="content--md" valign="top" align="left"> <p>
								User and group IDs
							</p>
							 </td></tr><tr><td headers="idm139983845808512" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								<span class="strong strong"><strong>Control groups</strong></span>
							</p>
							 </td><td headers="idm139983845807424" data-row="8" data-col="2" class="content--md" valign="top" align="left"> <p>
								Control group root directory
							</p>
							 </td></tr></tbody></table></rh-table></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">namespaces(7)</code> and <code class="literal">cgroup_namespaces(7)</code> manual pages
					</li><li class="listitem">
						<a class="link" href="#understanding-control-groups_setting-limits-for-applications" title="15.1.&nbsp;Introducing control groups">Introducing control groups</a>
					</li></ul></div></section></section><section class="chapter" id="assembly_using-cgroupfs-to-manually-manage-cgroups_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 16. Using cgroupfs to manually manage cgroups</h1></div></div></div><p>
			You can manage <code class="literal">cgroup</code> hierarchies on your system by creating directories on the <code class="literal">cgroupfs</code> virtual file system. The file system is mounted by default on the <code class="literal">/sys/fs/cgroup/</code> directory and you can specify desired configurations in dedicated control files.
		</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				In general, Red Hat recommends you use <code class="literal">systemd</code> for controlling the usage of system resources. You should manually configure the <code class="literal">cgroups</code> virtual file system only in special cases. For example, when you need to use <code class="literal">cgroup-v1</code> controllers that have no equivalents in <code class="literal">cgroup-v2</code> hierarchy.
			</p></div></div><section class="section" id="proc_creating-cgroups-and-enabling-controllers-in-cgroups-v2-file-system_assembly_using-cgroupfs-to-manually-manage-cgroups"><div class="titlepage"><div><div><h2 class="title">16.1. Creating cgroups and enabling controllers in cgroups-v2 file system</h2></div></div></div><p>
				You can manage the <span class="emphasis"><em>control groups</em></span> (<code class="literal">cgroups</code>) by creating or removing directories and by writing to files in the <code class="literal">cgroups</code> virtual file system. The file system is by default mounted on the <code class="literal">/sys/fs/cgroup/</code> directory. To use settings from the <code class="literal">cgroups</code> controllers, you also need to enable the desired controllers for child <code class="literal">cgroups</code>. The root <code class="literal">cgroup</code> has, by default, enabled the <code class="literal">memory</code> and <code class="literal">pids</code> controllers for its child <code class="literal">cgroups</code>. Therefore, Red Hat recommends to create at least two levels of child <code class="literal">cgroups</code> inside the <code class="literal">/sys/fs/cgroup/</code> root <code class="literal">cgroup</code>. This way you optionally remove the <code class="literal">memory</code> and <code class="literal">pids</code> controllers from the child <code class="literal">cgroups</code> and maintain better organizational clarity of <code class="literal">cgroup</code> files.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create the <code class="literal">/sys/fs/cgroup/Example/</code> directory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--q5virj3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mkdir /sys/fs/cgroup/Example/</strong></span></pre></div></div><p class="simpara">
						The <code class="literal">/sys/fs/cgroup/Example/</code> directory defines a child group. When you create the <code class="literal">/sys/fs/cgroup/Example/</code> directory, some <code class="literal">cgroups-v2</code> interface files are automatically created in the directory. The <code class="literal">/sys/fs/cgroup/Example/</code> directory contains also controller-specific files for the <code class="literal">memory</code> and <code class="literal">pids</code> controllers.
					</p></li><li class="listitem"><p class="simpara">
						Optionally, inspect the newly created child control group:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3eegzgf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ll /sys/fs/cgroup/Example/</strong></span>
-rrr--. 1 root root 0 Jun  1 10:33 cgroup.controllers
-rrr--. 1 root root 0 Jun  1 10:33 cgroup.events
-rw-rr--. 1 root root 0 Jun  1 10:33 cgroup.freeze
-rw-rr--. 1 root root 0 Jun  1 10:33 cgroup.procs

-rw-rr--. 1 root root 0 Jun  1 10:33 cgroup.subtree_control
-rrr--. 1 root root 0 Jun  1 10:33 memory.events.local
-rw-rr--. 1 root root 0 Jun  1 10:33 memory.high
-rw-rr--. 1 root root 0 Jun  1 10:33 memory.low

-rrr--. 1 root root 0 Jun  1 10:33 pids.current
-rrr--. 1 root root 0 Jun  1 10:33 pids.events
-rw-rr--. 1 root root 0 Jun  1 10:33 pids.max</pre></div></div><p class="simpara">
						The example output shows general <code class="literal">cgroup</code> control interface files such as <code class="literal">cgroup.procs</code> or <code class="literal">cgroup.controllers</code>. These files are common to all control groups, regardless of enabled controllers.
					</p><p class="simpara">
						The files such as <code class="literal">memory.high</code> and <code class="literal">pids.max</code> relate to the <code class="literal">memory</code> and <code class="literal">pids</code> controllers, which are in the root control group (<code class="literal">/sys/fs/cgroup/</code>), and are enabled by default by <code class="literal">systemd</code>.
					</p><p class="simpara">
						By default, the newly created child group inherits all settings from the parent <code class="literal">cgroup</code>. In this case, there are no limits from the root <code class="literal">cgroup</code>.
					</p></li><li class="listitem"><p class="simpara">
						Verify that the desired controllers are available in the <code class="literal">/sys/fs/cgroup/cgroup.controllers</code> file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9qxxrez"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /sys/fs/cgroup/cgroup.controllers</strong></span>
cpuset cpu io memory hugetlb pids rdma</pre></div></div></li><li class="listitem"><p class="simpara">
						Enable the desired controllers. In this example it is <code class="literal">cpu</code> and <code class="literal">cpuset</code> controllers:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yh5jl87"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo "+cpu" &gt;&gt; /sys/fs/cgroup/cgroup.subtree_control</strong></span>
# <span class="strong strong"><strong>echo "+cpuset" &gt;&gt; /sys/fs/cgroup/cgroup.subtree_control</strong></span></pre></div></div><p class="simpara">
						These commands enable the <code class="literal">cpu</code> and <code class="literal">cpuset</code> controllers for the immediate child groups of the <code class="literal">/sys/fs/cgroup/</code> root control group. Including the newly created <code class="literal">Example</code> control group. A <span class="emphasis"><em>child group</em></span> is where you can specify processes and apply control checks to each of the processes based on your criteria.
					</p><p class="simpara">
						Users can read the contents of the <code class="literal">cgroup.subtree_control</code> file at any level to get an idea of what controllers are going to be available for enablement in the immediate child group.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							By default, the <code class="literal">/sys/fs/cgroup/cgroup.subtree_control</code> file in the root control group contains <code class="literal">memory</code> and <code class="literal">pids</code> controllers.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Enable the desired controllers for child <code class="literal">cgroups</code> of the <code class="literal">Example</code> control group:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--woi6xp6"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo "+cpu +cpuset" &gt;&gt; /sys/fs/cgroup/Example/cgroup.subtree_control</strong></span></pre></div></div><p class="simpara">
						This command ensures that the immediate child control group will <span class="emphasis"><em>only</em></span> have controllers relevant to regulate the CPU time distribution - not to <code class="literal">memory</code> or <code class="literal">pids</code> controllers.
					</p></li><li class="listitem"><p class="simpara">
						Create the <code class="literal">/sys/fs/cgroup/Example/tasks/</code> directory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sz62gzg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mkdir /sys/fs/cgroup/Example/tasks/</strong></span></pre></div></div><p class="simpara">
						The <code class="literal">/sys/fs/cgroup/Example/tasks/</code> directory defines a child group with files that relate purely to <code class="literal">cpu</code> and <code class="literal">cpuset</code> controllers. You can now assign processes to this control group and utilize <code class="literal">cpu</code> and <code class="literal">cpuset</code> controller options for your processes.
					</p></li><li class="listitem"><p class="simpara">
						Optionally, inspect the child control group:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ar72xia"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ll /sys/fs/cgroup/Example/tasks</strong></span>
-rrr--. 1 root root 0 Jun  1 11:45 cgroup.controllers
-rrr--. 1 root root 0 Jun  1 11:45 cgroup.events
-rw-rr--. 1 root root 0 Jun  1 11:45 cgroup.freeze
-rw-rr--. 1 root root 0 Jun  1 11:45 cgroup.max.depth
-rw-rr--. 1 root root 0 Jun  1 11:45 cgroup.max.descendants
-rw-rr--. 1 root root 0 Jun  1 11:45 cgroup.procs
-rrr--. 1 root root 0 Jun  1 11:45 cgroup.stat
-rw-rr--. 1 root root 0 Jun  1 11:45 cgroup.subtree_control
-rw-rr--. 1 root root 0 Jun  1 11:45 cgroup.threads
-rw-rr--. 1 root root 0 Jun  1 11:45 cgroup.type
-rw-rr--. 1 root root 0 Jun  1 11:45 cpu.max
-rw-rr--. 1 root root 0 Jun  1 11:45 cpu.pressure
-rw-rr--. 1 root root 0 Jun  1 11:45 cpuset.cpus
-rrr--. 1 root root 0 Jun  1 11:45 cpuset.cpus.effective
-rw-rr--. 1 root root 0 Jun  1 11:45 cpuset.cpus.partition
-rw-rr--. 1 root root 0 Jun  1 11:45 cpuset.mems
-rrr--. 1 root root 0 Jun  1 11:45 cpuset.mems.effective
-rrr--. 1 root root 0 Jun  1 11:45 cpu.stat
-rw-rr--. 1 root root 0 Jun  1 11:45 cpu.weight
-rw-rr--. 1 root root 0 Jun  1 11:45 cpu.weight.nice
-rw-rr--. 1 root root 0 Jun  1 11:45 io.pressure
-rw-rr--. 1 root root 0 Jun  1 11:45 memory.pressure</pre></div></div></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The <code class="literal">cpu</code> controller is only activated 
if the relevant child control group has at least 2 processes which 
compete for time on a single CPU.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Optional: confirm that you have created a new <code class="literal">cgroup</code> with only the desired controllers active:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--emhtz8p"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /sys/fs/cgroup/Example/tasks/cgroup.controllers</strong></span>
cpuset cpu</pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#understanding-control-groups_setting-limits-for-applications" title="15.1.&nbsp;Introducing control groups">Understanding control groups</a>
					</li><li class="listitem">
						<a class="link" href="#what-kernel-resource-controllers-are_setting-limits-for-applications" title="15.2.&nbsp;Introducing kernel resource controllers">What are kernel resource controllers</a>
					</li><li class="listitem">
						<a class="link" href="#proc_mounting-cgroups-v1_assembly_using-cgroupfs-to-manually-manage-cgroups" title="16.3.&nbsp;Mounting cgroups-v1">Mounting cgroups-v1</a>
					</li><li class="listitem">
						<code class="literal">cgroups(7)</code>, <code class="literal">sysfs(5)</code> manual pages
					</li></ul></div></section><section class="section" id="proc_controlling-distribution-of-cpu-time-for-applications-by-adjusting-cpu-weight_assembly_using-cgroupfs-to-manually-manage-cgroups"><div class="titlepage"><div><div><h2 class="title">16.2. Controlling distribution of CPU time for applications by adjusting CPU weight</h2></div></div></div><p class="_abstract _abstract">
				You need to assign values to the relevant files of the <code class="literal">cpu</code> controller to regulate distribution of the CPU time to applications under the specific cgroup tree.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions.
					</li><li class="listitem">
						You have applications for which you want to control distribution of CPU time.
					</li><li class="listitem"><p class="simpara">
						You created a two level hierarchy of <span class="emphasis"><em>child control groups</em></span> inside the <code class="literal">/sys/fs/cgroup/</code> <span class="emphasis"><em>root control group</em></span> as in the following example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--774clqh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">
   Example
      g1
      g2
      g3
</pre></div></div></li><li class="listitem">
						You enabled the <code class="literal">cpu</code> controller in the parent control group and in child control groups similarly as described in <a class="link" href="#proc_creating-cgroups-and-enabling-controllers-in-cgroups-v2-file-system_assembly_using-cgroupfs-to-manually-manage-cgroups" title="16.1.&nbsp;Creating cgroups and enabling controllers in cgroups-v2 file system">Creating cgroups and enabling controllers in cgroups-v2 file system</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Configure desired CPU weights to achieve resource restrictions within the control groups:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--idqmj6q"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo "150" &gt; /sys/fs/cgroup/Example/g1/cpu.weight</strong></span>
# <span class="strong strong"><strong>echo "100" &gt; /sys/fs/cgroup/Example/g2/cpu.weight</strong></span>
# <span class="strong strong"><strong>echo "50" &gt; /sys/fs/cgroup/Example/g3/cpu.weight</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Add the applications' PIDs to the <code class="literal">g1</code>, <code class="literal">g2</code>, and <code class="literal">g3</code> child groups:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--cbdszsd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo "33373" &gt; /sys/fs/cgroup/Example/g1/cgroup.procs</strong></span>
# <span class="strong strong"><strong>echo "33374" &gt; /sys/fs/cgroup/Example/g2/cgroup.procs</strong></span>
# <span class="strong strong"><strong>echo "33377" &gt; /sys/fs/cgroup/Example/g3/cgroup.procs</strong></span></pre></div></div><p class="simpara">
						The example commands ensure that desired applications become members of the <code class="literal">Example/g*/</code> child cgroups and will get their CPU time distributed as per the configuration of those cgroups.
					</p><p class="simpara">
						The weights of the children cgroups (<code class="literal">g1</code>, <code class="literal">g2</code>, <code class="literal">g3</code>) that have running processes are summed up at the level of the parent cgroup (<code class="literal">Example</code>). The CPU resource is then distributed proportionally based on the respective weights.
					</p><p class="simpara">
						As a result, when all processes run at the same time, the kernel 
allocates to each of them the proportionate CPU time based on their 
respective cgroups <code class="literal">cpu.weight</code> file:
					</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="8ijmre6" id="rh-table--8ijmre6"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--><col style="width: 30%; " class="col_2"><!--Empty--><col style="width: 40%; " class="col_3"><!--Empty--></colgroup><thead><tr><th id="idm139983841500080" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Child cgroup</th><th id="idm139983841498992" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left"><code class="literal">cpu.weight</code> file</th><th id="idm139983841497584" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">CPU time allocation</th></tr></thead><tbody><tr><td headers="idm139983841500080" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
										g1
									</p>
									 </td><td headers="idm139983841498992" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
										150
									</p>
									 </td><td headers="idm139983841497584" data-row="2" data-col="3" class="content--md" valign="top" align="left"> <p>
										~50% (150/300)
									</p>
									 </td></tr><tr><td headers="idm139983841500080" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
										g2
									</p>
									 </td><td headers="idm139983841498992" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
										100
									</p>
									 </td><td headers="idm139983841497584" data-row="3" data-col="3" class="content--md" valign="top" align="left"> <p>
										~33% (100/300)
									</p>
									 </td></tr><tr><td headers="idm139983841500080" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
										g3
									</p>
									 </td><td headers="idm139983841498992" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
										50
									</p>
									 </td><td headers="idm139983841497584" data-row="4" data-col="3" class="content--md" valign="top" align="left"> <p>
										~16% (50/300)
									</p>
									 </td></tr></tbody></table></rh-table><p class="simpara">
						The value of the <code class="literal">cpu.weight</code> controller file is not a percentage.
					</p><p class="simpara">
						If one process stopped running, leaving cgroup <code class="literal">g2</code> with no running processes, the calculation would omit the cgroup <code class="literal">g2</code> and only account weights of cgroups <code class="literal">g1</code> and <code class="literal">g3</code>:
					</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="79xk9ho" id="rh-table--79xk9ho"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 30%; " class="col_1"><!--Empty--><col style="width: 30%; " class="col_2"><!--Empty--><col style="width: 40%; " class="col_3"><!--Empty--></colgroup><thead><tr><th id="idm139983845966656" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Child cgroup</th><th id="idm139983845965568" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left"><code class="literal">cpu.weight</code> file</th><th id="idm139983845964160" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">CPU time allocation</th></tr></thead><tbody><tr><td headers="idm139983845966656" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
										g1
									</p>
									 </td><td headers="idm139983845965568" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
										150
									</p>
									 </td><td headers="idm139983845964160" data-row="2" data-col="3" class="content--md" valign="top" align="left"> <p>
										~75% (150/200)
									</p>
									 </td></tr><tr><td headers="idm139983845966656" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
										g3
									</p>
									 </td><td headers="idm139983845965568" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
										50
									</p>
									 </td><td headers="idm139983845964160" data-row="3" data-col="3" class="content--md" valign="top" align="left"> <p>
										~25% (50/200)
									</p>
									 </td></tr></tbody></table></rh-table><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If a child cgroup had multiple running processes, the CPU time 
allocated to the respective cgroup would be distributed equally to the 
member processes of that cgroup.
						</p></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the applications run in the specified control groups:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ssnlbc6"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /proc/33373/cgroup /proc/33374/cgroup /proc/33377/cgroup</strong></span>
0::/Example/g1
0::/Example/g2
0::/Example/g3</pre></div></div><p class="simpara">
						The command output shows the processes of the specified applications that run in the <code class="literal">Example/g*/</code> child cgroups.
					</p></li><li class="listitem"><p class="simpara">
						Inspect the current CPU consumption of the throttled applications:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mtt981x"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>top</strong></span>
top - 05:17:18 up 1 day, 18:25,  1 user,  load average: 3.03, 3.03, 3.00
Tasks:  95 total,   4 running,  91 sleeping,   0 stopped,   0 zombie
%Cpu(s): 18.1 us, 81.6 sy,  0.0 ni,  0.0 id,  0.0 wa,  0.3 hi,  0.0 si,  0.0 st
MiB Mem :   3737.0 total,   3233.7 free,    132.8 used,    370.5 buff/cache
MiB Swap:   4060.0 total,   4060.0 free,      0.0 used.   3373.1 avail Mem

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
  33373 root      20   0   18720   1748   1460 R  <span class="strong strong"><strong>49.5</strong></span>   0.0 415:05.87 sha1sum
  33374 root      20   0   18720   1756   1464 R  <span class="strong strong"><strong>32.9</strong></span>   0.0 412:58.33 sha1sum
  33377 root      20   0   18720   1860   1568 R  <span class="strong strong"><strong>16.3</strong></span>   0.0 411:03.12 sha1sum
    760 root      20   0  416620  28540  15296 S   0.3   0.7   0:10.23 tuned
      1 root      20   0  186328  14108   9484 S   0.0   0.4   0:02.00 systemd
      2 root      20   0       0      0      0 S   0.0   0.0   0:00.01 kthread
...</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							We forced all the example processes to run on a single CPU for 
clearer illustration. The CPU weight applies the same principles also 
when used on multiple CPUs.
						</p></div></div><p class="simpara">
						Notice that the CPU resource for the <code class="literal">PID 33373</code>, <code class="literal">PID 33374</code>, and <code class="literal">PID 33377</code>
 was allocated based on the weights, 150, 100, 50, you assigned to the 
respective child cgroups. The weights correspond to around 50%, 33%, and
 16% allocation of CPU time for each application.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#understanding-control-groups_setting-limits-for-applications" title="15.1.&nbsp;Introducing control groups">Understanding control groups</a>
					</li><li class="listitem">
						<a class="link" href="#what-kernel-resource-controllers-are_setting-limits-for-applications" title="15.2.&nbsp;Introducing kernel resource controllers">What are kernel resource controllers</a>
					</li><li class="listitem">
						<a class="link" href="#proc_creating-cgroups-and-enabling-controllers-in-cgroups-v2-file-system_assembly_using-cgroupfs-to-manually-manage-cgroups" title="16.1.&nbsp;Creating cgroups and enabling controllers in cgroups-v2 file system">Creating cgroups and enabling controllers in cgroups-v2 file system</a>
					</li><li class="listitem">
						<a class="link" href="https://www.kernel.org/doc/html/latest/admin-guide/cgroup-v2.html#resource-distribution-models">Resource Distribution Models</a>
					</li><li class="listitem">
						<code class="literal">cgroups(7)</code>, <code class="literal">sysfs(5)</code> manual pages
					</li></ul></div></section><section class="section" id="proc_mounting-cgroups-v1_assembly_using-cgroupfs-to-manually-manage-cgroups"><div class="titlepage"><div><div><h2 class="title">16.3. Mounting cgroups-v1</h2></div></div></div><p>
				During the boot process, RHEL 9 mounts the <code class="literal">cgroup-v2</code> virtual filesystem by default. To utilize <code class="literal">cgroup-v1</code> functionality in limiting resources for your applications, manually configure the system.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Both <code class="literal">cgroup-v1</code> and <code class="literal">cgroup-v2</code> are fully enabled in the kernel. There is no default control group version from the kernel point of view, and is decided by <code class="literal">systemd</code> to mount at startup.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Configure the system to mount <code class="literal">cgroups-v1</code> by default during system boot by the <code class="literal">systemd</code> system and service manager:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6butfh7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=/boot/vmlinuz-$(uname -r) --args="systemd.unified_cgroup_hierarchy=0 systemd.legacy_systemd_cgroup_controller"</strong></span></pre></div></div><p class="simpara">
						This adds the necessary kernel command-line parameters to the current boot entry.
					</p><p class="simpara">
						To add the same parameters to all kernel boot entries:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nr8vrd1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=ALL --args="systemd.unified_cgroup_hierarchy=0 systemd.legacy_systemd_cgroup_controller"</strong></span></pre></div></div></li><li class="listitem">
						Reboot the system for the changes to take effect.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optionally, verify that the <code class="literal">cgroups-v1</code> filesystem was mounted:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xlv4t60"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mount -l | grep cgroup</strong></span>
tmpfs on /sys/fs/cgroup type tmpfs (ro,nosuid,nodev,noexec,seclabel,size=4096k,nr_inodes=1024,mode=755,inode64)
cgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd)
cgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,perf_event)
cgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,cpu,cpuacct)
cgroup on /sys/fs/cgroup/pids type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,pids)
cgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,cpuset)
cgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,net_cls,net_prio)
cgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,hugetlb)
cgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,memory)
cgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,blkio)
cgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,devices)
cgroup on /sys/fs/cgroup/misc type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,misc)
cgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,freezer)
cgroup on /sys/fs/cgroup/rdma type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,rdma)</pre></div></div><p class="simpara">
						The <code class="literal">cgroups-v1</code> filesystems that correspond to various <code class="literal">cgroup-v1</code> controllers, were successfully mounted on the <code class="literal">/sys/fs/cgroup/</code> directory.
					</p></li><li class="listitem"><p class="simpara">
						Optionally, inspect the contents of the <code class="literal">/sys/fs/cgroup/</code> directory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nhj4jga"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ll /sys/fs/cgroup/</strong></span>
dr-xr-xr-x. 10 root root  0 Mar 16 09:34 blkio
lrwxrwxrwx.  1 root root 11 Mar 16 09:34 cpu  cpu,cpuacct
lrwxrwxrwx.  1 root root 11 Mar 16 09:34 cpuacct  cpu,cpuacct
dr-xr-xr-x. 10 root root  0 Mar 16 09:34 cpu,cpuacct
dr-xr-xr-x.  2 root root  0 Mar 16 09:34 cpuset
dr-xr-xr-x. 10 root root  0 Mar 16 09:34 devices
dr-xr-xr-x.  2 root root  0 Mar 16 09:34 freezer
dr-xr-xr-x.  2 root root  0 Mar 16 09:34 hugetlb
dr-xr-xr-x. 10 root root  0 Mar 16 09:34 memory
dr-xr-xr-x.  2 root root  0 Mar 16 09:34 misc
lrwxrwxrwx.  1 root root 16 Mar 16 09:34 net_cls  net_cls,net_prio
dr-xr-xr-x.  2 root root  0 Mar 16 09:34 net_cls,net_prio
lrwxrwxrwx.  1 root root 16 Mar 16 09:34 net_prio  net_cls,net_prio
dr-xr-xr-x.  2 root root  0 Mar 16 09:34 perf_event
dr-xr-xr-x. 10 root root  0 Mar 16 09:34 pids
dr-xr-xr-x.  2 root root  0 Mar 16 09:34 rdma
dr-xr-xr-x. 11 root root  0 Mar 16 09:34 systemd</pre></div></div><p class="simpara">
						The <code class="literal">/sys/fs/cgroup/</code> directory, also called the <span class="emphasis"><em>root control group</em></span>, by default, contains controller-specific directories such as <code class="literal">cpuset</code>. In addition, there are some directories related to <code class="literal">systemd</code>.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#understanding-control-groups_setting-limits-for-applications" title="15.1.&nbsp;Introducing control groups">Understanding control groups</a>
					</li><li class="listitem">
						<a class="link" href="#what-kernel-resource-controllers-are_setting-limits-for-applications" title="15.2.&nbsp;Introducing kernel resource controllers">What are kernel resource controllers</a>
					</li><li class="listitem">
						<code class="literal">cgroups(7)</code>, <code class="literal">sysfs(5)</code> manual pages
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/9.0_release_notes/index#BZ-1953515">cgroup-v2 enabled by default in RHEL 9</a>
					</li></ul></div></section><section class="section" id="setting-cpu-limits-to-applications-using-cgroups-v1_assembly_using-cgroupfs-to-manually-manage-cgroups"><div class="titlepage"><div><div><h2 class="title">16.4. Setting CPU limits to applications using cgroups-v1</h2></div></div></div><p class="_abstract _abstract">
				Sometimes an application consumes a lot of CPU time, which may 
negatively impact the overall health of your environment. Use the <code class="literal">/sys/fs/</code> virtual file system to configure CPU limits to an application using <span class="emphasis"><em>control groups version 1</em></span> (<code class="literal">cgroups-v1</code>).
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions.
					</li><li class="listitem">
						You have an application whose CPU consumption you want to restrict.
					</li><li class="listitem"><p class="simpara">
						You configured the system to mount <code class="literal">cgroups-v1</code> by default during system boot by the <code class="literal">systemd</code> system and service manager:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mbgo5wo"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=/boot/vmlinuz-$(uname -r) --args="systemd.unified_cgroup_hierarchy=0 systemd.legacy_systemd_cgroup_controller"</strong></span></pre></div></div><p class="simpara">
						This adds the necessary kernel command-line parameters to the current boot entry.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Identify the process ID (PID) of the application you want to restrict in CPU consumption:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--julfbzu"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>top</strong></span>
top - 11:34:09 up 11 min,  1 user,  load average: 0.51, 0.27, 0.22
Tasks: 267 total,   3 running, 264 sleeping,   0 stopped,   0 zombie
%Cpu(s): 49.0 us,  3.3 sy,  0.0 ni, 47.5 id,  0.0 wa,  0.2 hi,  0.0 si,  0.0 st
MiB Mem :   1826.8 total,    303.4 free,   1046.8 used,    476.5 buff/cache
MiB Swap:   1536.0 total,   1396.0 free,    140.0 used.    616.4 avail Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
 6955 root      20   0  228440   1752   1472 R  <span class="strong strong"><strong>99.3</strong></span>   0.1   0:32.71 sha1sum
 5760 jdoe      20   0 3603868 205188  64196 S   3.7  11.0   0:17.19 gnome-shell
 6448 jdoe      20   0  743648  30640  19488 S   0.7   1.6   0:02.73 gnome-terminal-
    1 root      20   0  245300   6568   4116 S   0.3   0.4   0:01.87 systemd
  505 root      20   0       0      0      0 I   0.3   0.0   0:00.75 kworker/u4:4-events_unbound
...</pre></div></div><p class="simpara">
						The example output of the <code class="literal">top</code> program reveals that <code class="literal">PID 6955</code> (illustrative application <code class="literal">sha1sum</code>) consumes a lot of CPU resources.
					</p></li><li class="listitem"><p class="simpara">
						Create a sub-directory in the <code class="literal">cpu</code> resource controller directory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sjmuet7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>mkdir /sys/fs/cgroup/cpu/Example/</strong></span></pre></div></div><p class="simpara">
						The directory above represents a control group, where you can 
place specific processes and apply certain CPU limits to the processes. 
At the same time, some <code class="literal">cgroups-v1</code> interface files and <code class="literal">cpu</code> controller-specific files will be created in the directory.
					</p></li><li class="listitem"><p class="simpara">
						Optionally, inspect the newly created control group:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3zyyiib"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ll /sys/fs/cgroup/cpu/Example/</strong></span>
-rw-rr--. 1 root root 0 Mar 11 11:42 cgroup.clone_children
-rw-rr--. 1 root root 0 Mar 11 11:42 cgroup.procs
-rrr--. 1 root root 0 Mar 11 11:42 cpuacct.stat
-rw-rr--. 1 root root 0 Mar 11 11:42 cpuacct.usage
-rrr--. 1 root root 0 Mar 11 11:42 cpuacct.usage_all
-rrr--. 1 root root 0 Mar 11 11:42 cpuacct.usage_percpu
-rrr--. 1 root root 0 Mar 11 11:42 cpuacct.usage_percpu_sys
-rrr--. 1 root root 0 Mar 11 11:42 cpuacct.usage_percpu_user
-rrr--. 1 root root 0 Mar 11 11:42 cpuacct.usage_sys
-rrr--. 1 root root 0 Mar 11 11:42 cpuacct.usage_user
-rw-rr--. 1 root root 0 Mar 11 11:42 cpu.cfs_period_us
-rw-rr--. 1 root root 0 Mar 11 11:42 cpu.cfs_quota_us
-rw-rr--. 1 root root 0 Mar 11 11:42 cpu.rt_period_us
-rw-rr--. 1 root root 0 Mar 11 11:42 cpu.rt_runtime_us
-rw-rr--. 1 root root 0 Mar 11 11:42 cpu.shares
-rrr--. 1 root root 0 Mar 11 11:42 cpu.stat
-rw-rr--. 1 root root 0 Mar 11 11:42 notify_on_release
-rw-rr--. 1 root root 0 Mar 11 11:42 tasks</pre></div></div><p class="simpara">
						The example output shows files, such as <code class="literal">cpuacct.usage</code>, <code class="literal">cpu.cfs._period_us</code>, that represent specific configurations and/or limits, which can be set for processes in the <code class="literal">Example</code>
 control group. Notice that the respective file names are prefixed with 
the name of the control group controller to which they belong.
					</p><p class="simpara">
						By default, the newly created control group inherits access to the systems entire CPU resources without a limit.
					</p></li><li class="listitem"><p class="simpara">
						Configure CPU limits for the control group:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rv2mudt"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo "1000000" &gt; /sys/fs/cgroup/cpu/Example/cpu.cfs_period_us</strong></span>
# <span class="strong strong"><strong>echo "200000" &gt; /sys/fs/cgroup/cpu/Example/cpu.cfs_quota_us</strong></span></pre></div></div><p class="simpara">
						The <code class="literal">cpu.cfs_period_us</code> file represents
 a period of time in microseconds (s, represented here as "us") for how
 frequently a control groups access to CPU resources should be 
reallocated. The upper limit is 1 second and the lower limit is 1000 
microseconds.
					</p><p class="simpara">
						The <code class="literal">cpu.cfs_quota_us</code> file represents 
the total amount of time in microseconds for which all processes 
collectively in a control group can run during one period (as defined by
 <code class="literal">cpu.cfs_period_us</code>). As soon as processes 
in a control group, during a single period, use up all the time 
specified by the quota, they are throttled for the remainder of the 
period and not allowed to run until the next period. The lower limit is 
1000 microseconds.
					</p><p class="simpara">
						The example commands above set the CPU time limits so that all processes collectively in the <code class="literal">Example</code> control group will be able to run only for 0.2 seconds (defined by <code class="literal">cpu.cfs_quota_us</code>) out of every 1 second (defined by <code class="literal">cpu.cfs_period_us</code>).
					</p></li><li class="listitem"><p class="simpara">
						Optionally, verify the limits:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sxbs298"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /sys/fs/cgroup/cpu/Example/cpu.cfs_period_us /sys/fs/cgroup/cpu/Example/cpu.cfs_quota_us</strong></span>
1000000
200000</pre></div></div></li><li class="listitem"><p class="simpara">
						Add the applications PID to the <code class="literal">Example</code> control group:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wcw2pex"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>echo "6955" &gt; /sys/fs/cgroup/cpu/Example/cgroup.procs</strong></span>

or

# <span class="strong strong"><strong>echo "6955" &gt; /sys/fs/cgroup/cpu/Example/tasks</strong></span></pre></div></div><p class="simpara">
						The previous command ensures that a desired application becomes a member of the <code class="literal">Example</code> control group and hence does not exceed the CPU limits configured for the <code class="literal">Example</code> control group. The PID should represent an existing process in the system. The <code class="literal">PID 6955</code> here was assigned to process <code class="literal">sha1sum /dev/zero &amp;</code>, used to illustrate the use-case of the <code class="literal">cpu</code> controller.
					</p></li><li class="listitem"><p class="simpara">
						Verify that the application runs in the specified control group:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ycfk8qu"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /proc/6955/cgroup</strong></span>
12:cpuset:/
11:hugetlb:/
10:net_cls,net_prio:/
9:memory:/user.slice/user-1000.slice/user@1000.service
8:devices:/user.slice
7:blkio:/
6:freezer:/
5:rdma:/
4:pids:/user.slice/user-1000.slice/user@1000.service
3:perf_event:/
2:cpu,cpuacct:/Example
1:name=systemd:/user.slice/user-1000.slice/user@1000.service/gnome-terminal-server.service</pre></div></div><p class="simpara">
						The example output above shows that the process of the desired application runs in the <code class="literal">Example</code> control group, which applies CPU limits to the applications process.
					</p></li><li class="listitem"><p class="simpara">
						Identify the current CPU consumption of your throttled application:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--tlmtri6"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>top</strong></span>
top - 12:28:42 up  1:06,  1 user,  load average: 1.02, 1.02, 1.00
Tasks: 266 total,   6 running, 260 sleeping,   0 stopped,   0 zombie
%Cpu(s): 11.0 us,  1.2 sy,  0.0 ni, 87.5 id,  0.0 wa,  0.2 hi,  0.0 si,  0.2 st
MiB Mem :   1826.8 total,    287.1 free,   1054.4 used,    485.3 buff/cache
MiB Swap:   1536.0 total,   1396.7 free,    139.2 used.    608.3 avail Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
 6955 root      20   0  228440   1752   1472 R  <span class="strong strong"><strong>20.6</strong></span>   0.1  47:11.43 sha1sum
 5760 jdoe      20   0 3604956 208832  65316 R   2.3  11.2   0:43.50 gnome-shell
 6448 jdoe      20   0  743836  31736  19488 S   0.7   1.7   0:08.25 gnome-terminal-
  505 root      20   0       0      0      0 I   0.3   0.0   0:03.39 kworker/u4:4-events_unbound
 4217 root      20   0   74192   1612   1320 S   0.3   0.1   0:01.19 spice-vdagentd
...</pre></div></div><p class="simpara">
						Notice that the CPU consumption of the <code class="literal">PID 6955</code> has decreased from 99% to 20%.
					</p></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The <code class="literal">cgroups-v2</code> counterpart for <code class="literal">cpu.cfs_period_us</code> and <code class="literal">cpu.cfs_quota_us</code> is the <code class="literal">cpu.max</code> file. The <code class="literal">cpu.max</code> file is available through the <code class="literal">cpu</code> controller.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#understanding-control-groups_setting-limits-for-applications" title="15.1.&nbsp;Introducing control groups">Understanding control groups</a>
					</li><li class="listitem">
						<a class="link" href="#what-kernel-resource-controllers-are_setting-limits-for-applications" title="15.2.&nbsp;Introducing kernel resource controllers">What kernel resource controllers are</a>
					</li><li class="listitem">
						<code class="literal">cgroups(7)</code>, <code class="literal">sysfs(5)</code> manual pages
					</li></ul></div></section></section><section class="chapter" id="analyzing-system-performance-with-bpf-compiler_collection_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 17. Analyzing system performance with BPF Compiler Collection</h1></div></div></div><p class="_abstract _abstract">
			As a system administrator, you can use the BPF Compiler Collection 
(BCC) library to create tools for analyzing the performance of your 
Linux operating system and gathering information, which could be 
difficult to obtain through other interfaces.
		</p><section class="section" id="installing-the-bcc-tools-package_analyzing-system-performance-with-bpf-compiler_collection"><div class="titlepage"><div><div><h2 class="title">17.1. Installing the bcc-tools package</h2></div></div></div><p class="_abstract _abstract">
				Install the <code class="literal">bcc-tools</code> package, which also installs the BPF Compiler Collection (BCC) library as a dependency.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install <code class="literal">bcc-tools</code>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bp0dm1j"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"><code class="literal">#</code> <code class="literal command"><span class="strong strong"><strong>dnf install bcc-tools</strong></span></code></pre></div></div><p class="simpara">
						The BCC tools are installed in the <code class="literal">/usr/share/bcc/tools/</code> directory.
					</p></li><li class="listitem"><p class="simpara">
						Optionally, inspect the tools:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--o9h1hxn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"><code class="literal">#</code> <code class="literal command"><span class="strong strong"><strong>ll /usr/share/bcc/tools/</strong></span></code>
...
-rwxr-xr-x. 1 root root  4198 Dec 14 17:53 dcsnoop
-rwxr-xr-x. 1 root root  3931 Dec 14 17:53 dcstat
-rwxr-xr-x. 1 root root 20040 Dec 14 17:53 deadlock_detector
-rw-r--r--. 1 root root  7105 Dec 14 17:53 deadlock_detector.c
drwxr-xr-x. 3 root root  8192 Mar 11 10:28 doc
-rwxr-xr-x. 1 root root  7588 Dec 14 17:53 execsnoop
-rwxr-xr-x. 1 root root  6373 Dec 14 17:53 ext4dist
-rwxr-xr-x. 1 root root 10401 Dec 14 17:53 ext4slower
...</pre></div></div><p class="simpara">
						The <code class="literal systemitem">doc</code> directory in the listing above contains documentation for each tool.
					</p></li></ol></div></section><section class="section" id="using-selected-bcc-tools-for-performance-analyses_analyzing-system-performance-with-bpf-compiler_collection"><div class="titlepage"><div><div><h2 class="title">17.2. Using selected bcc-tools for performance analyses</h2></div></div></div><p class="_abstract _abstract">
				Use certain pre-created programs from the BPF Compiler Collection 
(BCC) library to efficiently and securely analyze the system performance
 on the per-event basis. The set of pre-created programs in the BCC 
library can serve as examples for creation of additional programs.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#installing-the-bcc-tools-package_analyzing-system-performance-with-bpf-compiler_collection" title="17.1.&nbsp;Installing the bcc-tools package">Installed bcc-tools package</a>
					</li><li class="listitem">
						Root permissions
					</li></ul></div><h4 id="using_execsnoop_to_examine_the_system_processes">Using execsnoop to examine the system processes</h4><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the <code class="literal">execsnoop</code> program in one terminal:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--f60pyle"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>/usr/share/bcc/tools/execsnoop</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						In another terminal run, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--oj20j8g"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>ls /usr/share/bcc/tools/doc/</strong></span></pre></div></div><p class="simpara">
						The above creates a short-lived process of the <code class="literal">ls</code> command.
					</p></li><li class="listitem"><p class="simpara">
						The terminal running <code class="literal">execsnoop</code> shows the output similar to the following:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--goz7tc4"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">PCOMM	PID    PPID   RET ARGS
ls   	8382   8287     0 /usr/bin/ls --color=auto /usr/share/bcc/tools/doc/
...</pre></div></div><p class="simpara">
						The <code class="literal">execsnoop</code> program prints a line 
of output for each new process, which consumes system resources. It even
 detects processes of programs that run very shortly, such as <code class="literal">ls</code>, and most monitoring tools would not register them.
					</p><p class="simpara">
						The <code class="literal">execsnoop</code> output displays the following fields:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>PCOMM</strong></span> - The parent process name. (<code class="literal">ls</code>)
							</li><li class="listitem">
								<span class="strong strong"><strong>PID</strong></span> - The process ID. (<code class="literal">8382</code>)
							</li><li class="listitem">
								<span class="strong strong"><strong>PPID</strong></span> - The parent process ID. (<code class="literal">8287</code>)
							</li><li class="listitem">
								<span class="strong strong"><strong>RET</strong></span> - The return value of the <code class="literal">exec()</code> system call (<code class="literal">0</code>), which loads program code into new processes.
							</li><li class="listitem">
								<span class="strong strong"><strong>ARGS</strong></span> - The location of the started program with arguments.
							</li></ul></div></li></ol></div><p>
				To see more details, examples, and options for <code class="literal">execsnoop</code>, refer to the <code class="literal">/usr/share/bcc/tools/doc/execsnoop_example.txt</code> file.
			</p><p>
				For more information about <code class="literal">exec()</code>, see <code class="literal">exec(3)</code> manual pages.
			</p><h4 id="using_opensnoop_to_track_what_files_a_command_opens">Using opensnoop to track what files a command opens</h4><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the <code class="literal">opensnoop</code> program in one terminal:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--er3gzsu"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>/usr/share/bcc/tools/opensnoop -n uname</strong></span></pre></div></div><p class="simpara">
						The above prints output for files, which are opened only by the process of the <code class="literal">uname</code> command.
					</p></li><li class="listitem"><p class="simpara">
						In another terminal, enter:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--plhg01r"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"><span class="strong strong"><strong>$ uname</strong></span></pre></div></div><p class="simpara">
						The command above opens certain files, which are captured in the next step.
					</p></li><li class="listitem"><p class="simpara">
						The terminal running <code class="literal">opensnoop</code> shows the output similar to the following:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5hyxt4n"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">PID    COMM 	FD ERR PATH
8596   uname 	3  0   /etc/ld.so.cache
8596   uname 	3  0   /lib64/libc.so.6
8596   uname 	3  0   /usr/lib/locale/locale-archive
...</pre></div></div><p class="simpara">
						The <code class="literal">opensnoop</code> program watches the <code class="literal">open()</code> system call across the whole system, and prints a line of output for each file that <code class="literal">uname</code> tried to open along the way.
					</p><p class="simpara">
						The <code class="literal">opensnoop</code> output displays the following fields:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>PID</strong></span> - The process ID. (<code class="literal">8596</code>)
							</li><li class="listitem">
								<span class="strong strong"><strong>COMM</strong></span> - The process name. (<code class="literal">uname</code>)
							</li><li class="listitem">
								<span class="strong strong"><strong>FD</strong></span> - The file descriptor - a value that <code class="literal">open()</code> returns to refer to the open file. (<code class="literal">3</code>)
							</li><li class="listitem">
								<span class="strong strong"><strong>ERR</strong></span> - Any errors.
							</li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>PATH</strong></span> - The location of files that <code class="literal">open()</code> tried to open.
							</p><p class="simpara">
								If a command tries to read a non-existent file, then the <code class="literal">FD</code> column returns <code class="literal">-1</code> and the <code class="literal">ERR</code> column prints a value corresponding to the relevant error. As a result, <code class="literal">opensnoop</code> can help you identify an application that does not behave properly.
							</p></li></ul></div></li></ol></div><p>
				To see more details, examples, and options for <code class="literal">opensnoop</code>, refer to the <code class="literal">/usr/share/bcc/tools/doc/opensnoop_example.txt</code> file.
			</p><p>
				For more information about <code class="literal">open()</code>, see <code class="literal">open(2)</code> manual pages.
			</p><h4 id="using_biotop_to_examine_the_i_o_operations_on_the_disk">Using biotop to examine the I/O operations on the disk</h4><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the <code class="literal">biotop</code> program in one terminal:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--o30f2fb"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>/usr/share/bcc/tools/biotop 30</strong></span></pre></div></div><p class="simpara">
						The command enables you to monitor the top processes, which 
perform I/O operations on the disk. The argument ensures that the 
command will produce a 30 second summary.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When no argument provided, the output screen by default refreshes every 1 second.
						</p></div></div></li><li class="listitem"><p class="simpara">
						In another terminal enter, for example :
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--tz4j234"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dd if=/dev/vda of=/dev/zero</strong></span></pre></div></div><p class="simpara">
						The command above reads the content from the local hard disk device and writes the output to the <code class="literal">/dev/zero</code> file. This step generates certain I/O traffic to illustrate <code class="literal">biotop</code>.
					</p></li><li class="listitem"><p class="simpara">
						The terminal running <code class="literal">biotop</code> shows the output similar to the following:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ulhpr0x"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">PID    COMM             D MAJ MIN DISK       I/O  Kbytes     AVGms
9568   dd               R 252 0   vda      16294 14440636.0  3.69
48     kswapd0          W 252 0   vda       1763 120696.0    1.65
7571   gnome-shell      R 252 0   vda        834 83612.0     0.33
1891   gnome-shell      R 252 0   vda       1379 19792.0     0.15
7515   Xorg             R 252 0   vda        280  9940.0     0.28
7579   llvmpipe-1       R 252 0   vda        228  6928.0     0.19
9515   gnome-control-c  R 252 0   vda         62  6444.0     0.43
8112   gnome-terminal-  R 252 0   vda         67  2572.0     1.54
7807   gnome-software   R 252 0   vda         31  2336.0     0.73
9578   awk              R 252 0   vda         17  2228.0     0.66
7578   llvmpipe-0       R 252 0   vda        156  2204.0     0.07
9581   pgrep            R 252 0   vda         58  1748.0     0.42
7531   InputThread      R 252 0   vda         30  1200.0     0.48
7504   gdbus            R 252 0   vda          3  1164.0     0.30
1983   llvmpipe-1       R 252 0   vda         39   724.0     0.08
1982   llvmpipe-0       R 252 0   vda         36   652.0     0.06
...</pre></div></div><p class="simpara">
						The <code class="literal">biotop</code> output displays the following fields:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>PID</strong></span> - The process ID. (<code class="literal">9568</code>)
							</li><li class="listitem">
								<span class="strong strong"><strong>COMM</strong></span> - The process name. (<code class="literal">dd</code>)
							</li><li class="listitem">
								<span class="strong strong"><strong>DISK</strong></span> - The disk performing the read operations. (<code class="literal">vda</code>)
							</li><li class="listitem">
								<span class="strong strong"><strong>I/O</strong></span> - The number of read operations performed. (16294)
							</li><li class="listitem">
								<span class="strong strong"><strong>Kbytes</strong></span> - The amount of Kbytes reached by the read operations. (14,440,636)
							</li><li class="listitem">
								<span class="strong strong"><strong>AVGms</strong></span> - The average I/O time of read operations. (3.69)
							</li></ul></div></li></ol></div><p>
				To see more details, examples, and options for <code class="literal">biotop</code>, refer to the <code class="literal">/usr/share/bcc/tools/doc/biotop_example.txt</code> file.
			</p><p>
				For more information about <code class="literal">dd</code>, see <code class="literal">dd(1)</code> manual pages.
			</p><h4 id="using_xfsslower_to_expose_unexpectedly_slow_file_system_operations">Using xfsslower to expose unexpectedly slow file system operations</h4><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the <code class="literal">xfsslower</code> program in one terminal:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--cf4thy7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>/usr/share/bcc/tools/xfsslower 1</strong></span></pre></div></div><p class="simpara">
						The command above measures the time the XFS file system spends in performing read, write, open or sync (<code class="literal">fsync</code>) operations. The <code class="literal">1</code> argument ensures that the program shows only the operations that are slower than 1 ms.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When no arguments provided, <code class="literal">xfsslower</code> by default displays operations slower than 10 ms.
						</p></div></div></li><li class="listitem"><p class="simpara">
						In another terminal enter, for example, the following:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1coar6a"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>vim text</strong></span></pre></div></div><p class="simpara">
						The command above creates a text file in the <code class="literal">vim</code> editor to initiate certain interaction with the XFS file system.
					</p></li><li class="listitem"><p class="simpara">
						The terminal running <code class="literal">xfsslower</code> shows something similar upon saving the file from the previous step:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8qfds9r"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">TIME     COMM           PID    T BYTES   OFF_KB   LAT(ms) FILENAME
13:07:14 b'bash'        4754   R 256     0           7.11 b'vim'
13:07:14 b'vim'         4754   R 832     0           4.03 b'libgpm.so.2.1.0'
13:07:14 b'vim'         4754   R 32      20          1.04 b'libgpm.so.2.1.0'
13:07:14 b'vim'         4754   R 1982    0           2.30 b'vimrc'
13:07:14 b'vim'         4754   R 1393    0           2.52 b'getscriptPlugin.vim'
13:07:45 b'vim'         4754   S 0       0           6.71 b'text'
13:07:45 b'pool'        2588   R 16      0           5.58 b'text'
...</pre></div></div><p class="simpara">
						Each line above represents an operation in the file system, which took more time than a certain threshold. <code class="literal">xfsslower</code> is good at exposing possible file system problems, which can take form of unexpectedly slow operations.
					</p><p class="simpara">
						The <code class="literal">xfsslower</code> output displays the following fields:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>COMM</strong></span> - The process name. (<code class="literal">bbash'</code>)
							</li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>T</strong></span> - The operation type. (<code class="literal">R</code>)
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<span class="strong strong"><strong>R</strong></span>ead
									</li><li class="listitem">
										<span class="strong strong"><strong>W</strong></span>rite
									</li><li class="listitem">
										<span class="strong strong"><strong>S</strong></span>ync
									</li></ul></div></li><li class="listitem">
								<span class="strong strong"><strong>OFF_KB</strong></span> - The file offset in KB. (0)
							</li><li class="listitem">
								<span class="strong strong"><strong>FILENAME</strong></span> - The file being read, written, or synced.
							</li></ul></div></li></ol></div><p>
				To see more details, examples, and options for <code class="literal">xfsslower</code>, refer to the <code class="literal">/usr/share/bcc/tools/doc/xfsslower_example.txt</code> file.
			</p><p>
				For more information about <code class="literal">fsync</code>, see <code class="literal">fsync(2)</code> manual pages.
			</p></section></section><section class="chapter" id="installing-kdump_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 18. Installing kdump</h1></div></div></div><p class="_abstract _abstract">
			The <code class="literal">kdump</code> service is installed and activated by default on the new Red Hat Enterprise Linux installations. Learn about <code class="literal">kdump</code> and how to install <code class="literal">kdump</code> when it is not enabled by default.
		</p><section class="section" id="what-is-kdumpinstalling-kdump"><div class="titlepage"><div><div><h2 class="title">18.1. What is kdump</h2></div></div></div><p class="_abstract _abstract">
				<code class="literal service">kdump</code> is a service which 
provides a crash dumping mechanism. The service enables you to save the 
contents of the system memory for analysis. <code class="literal service">kdump</code> uses the <code class="literal">kexec</code> system call to boot into the second kernel (a <span class="emphasis"><em>capture kernel</em></span>) without rebooting; and then captures the contents of the crashed kernels memory (a <span class="emphasis"><em>crash dump</em></span> or a <span class="emphasis"><em>vmcore</em></span>) and saves it into a file. The second kernel resides in a reserved part of the system memory.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					A kernel crash dump can be the only information available in the 
event of a system failure (a critical bug). Therefore, operational <code class="literal service">kdump</code> is important in mission-critical environments. Red&nbsp;Hat advise that system administrators regularly update and test <code class="literal package">kexec-tools</code> in your normal kernel update cycle. This is especially important when new kernel features are implemented.
				</p></div></div><p>
				You can enable <code class="literal service">kdump</code> for all 
installed kernels on a machine or only for specified kernels. This is 
useful when there are multiple kernels used on a machine, some of which 
are stable enough that there is no concern that they could crash.
			</p><p>
				When <code class="literal">kdump</code> is installed, a default <code class="literal">/etc/kdump.conf</code> file is created. The file includes the default minimum <code class="literal">kdump</code> configuration. You can edit this file to customize the <code class="literal">kdump</code> configuration, but it is not required.
			</p></section><section class="section" id="installing-kdump-anacondainstalling-kdump"><div class="titlepage"><div><div><h2 class="title">18.2. Installing kdump using Anaconda</h2></div></div></div><p class="_abstract _abstract">
				The <span class="strong strong"><strong>Anaconda</strong></span> installer provides a graphical interface screen for <code class="literal">kdump</code> configuration during an interactive installation. The installer screen is titled as <span class="strong strong"><strong>KDUMP</strong></span> and is available from the main <span class="strong strong"><strong>Installation Summary</strong></span> screen. You can enable <code class="literal">kdump</code> and reserve the required amount of memory.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Go to the <code class="literal">Kdump</code> field.
					</li><li class="listitem"><p class="simpara">
						Enable <code class="literal">kdump</code> if not already enabled.
					</p><div class="informalfigure"><div class="mediaobject"><a href="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US/images/fbcc3f2b9cf5da0a83354ba150a2d3d6/installation-summary-kdump-9.png" class="rh_docs--zoom" title="Enable kdump during RHEL installation"><img src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/installation-summary-kdump-9.png" alt="Enable kdump during RHEL installation"></a></div></div></li><li class="listitem"><p class="simpara">
						Define how much memory should be reserved for <code class="literal">kdump</code>.
					</p><div class="informalfigure"><div class="mediaobject"><a href="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US/images/ac2185ad8e440a64e56373d5d3dbad24/kdump-memory-reservation-9.png" class="rh_docs--zoom" title="Memory setting"><img src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/kdump-memory-reservation-9.png" alt="Memory setting"></a></div></div></li></ol></div></section><section class="section" id="installing-kdump-command-lineinstalling-kdump"><div class="titlepage"><div><div><h2 class="title">18.3. Installing kdump on the command line</h2></div></div></div><p class="_abstract _abstract">
				Some installation options, such as custom <span class="strong strong"><strong>Kickstart</strong></span> installations, in some cases do <span class="strong strong"><strong>not</strong></span> install or enable <code class="literal">kdump</code> by default. If this is your case, follow the procedure below.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						An active RHEL subscription
					</li><li class="listitem">
						The <span class="strong strong"><strong>kexec-tools</strong></span> package
					</li><li class="listitem">
						Fulfilled requirements for <code class="literal">kdump</code> configurations and targets. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#supported-kdump-configurations-and-targets_managing-monitoring-and-updating-the-kernel">Supported kdump configurations and targets</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check whether <code class="literal">kdump</code> is installed on your system:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--69frskn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>rpm -q kexec-tools</strong></span></pre></div></div><p class="simpara">
						Output if the package is installed:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--j1h6ies"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># kexec-tools-2.0.22-13.el9.x86_64</pre></div></div><p class="simpara">
						Output if the package is not installed:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ojn1ztj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">package kexec-tools is not installed</pre></div></div></li><li class="listitem"><p class="simpara">
						Install <code class="literal">kdump</code> and other necessary packages by:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--snwr796"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf install kexec-tools</strong></span></pre></div></div></li></ol></div></section></section><section class="chapter" id="configuring-kdump-on-the-command-line_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 19. Configuring kdump on the command line</h1></div></div></div><p class="_abstract _abstract">
			Plan and build your <code class="literal">kdump</code> environment.
		</p><section class="section" id="estimating-the-kdump-size_configuring-kdump-on-the-command-line"><div class="titlepage"><div><div><h2 class="title">19.1. Estimating the kdump size</h2></div></div></div><p class="_abstract _abstract">
				When planning and building your <code class="literal">kdump</code> environment, it is important to know how much space the crash dump file requires.
			</p><p>
				The <code class="literal">makedumpfile --mem-usage</code> command 
estimates how much space the crash dump file requires. It generates a 
memory usage report. The report helps you determine the dump level and 
which pages are safe to be excluded.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Execute the following command to generate a memory usage report:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--82sgj3t"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>makedumpfile --mem-usage /proc/kcore</strong></span>


TYPE        PAGES    EXCLUDABLE    DESCRIPTION
-------------------------------------------------------------
ZERO          501635      yes        Pages filled with zero
CACHE         51657       yes        Cache pages
CACHE_PRIVATE 5442        yes        Cache pages + private
USER          16301       yes        User process pages
FREE          77738211    yes        Free pages
KERN_DATA     1333192     no         Dumpable kernel data</pre></div></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The <code class="literal">makedumpfile --mem-usage</code> command 
reports required memory in pages. This means that you must calculate the
 size of memory in use against the kernel page size.
				</p><p>
					By default the RHEL kernel uses 4 KB sized pages on AMD64 and Intel
 64 CPU architectures, and 64 KB sized pages on IBM POWER architectures.
				</p></div></div></section><section class="section" id="configuring-kdump-memory-usage_configuring-kdump-on-the-command-line"><div class="titlepage"><div><div><h2 class="title">19.2. Configuring kdump memory usage</h2></div></div></div><p class="_abstract _abstract">
				The memory reservation for <code class="literal">kdump</code> occurs
 during the system boot. The memory size is set in the systems Grand 
Unified Bootloader (GRUB) configuration. The memory size depends on the 
value of the <code class="literal">crashkernel=</code> option specified in the configuration file and the size of the system physical memory.
			</p><p>
				You can define the <code class="literal">crashkernel=</code> option in many ways. You can specify the <code class="literal">crashkernel=</code> value or configure the <code class="literal">auto</code> option. The <code class="literal">crashkernel=auto</code>
 parameter reserves memory automatically, based on the total amount of 
physical memory in the system. When configured, the kernel automatically
 reserves an appropriate amount of required memory for the capture 
kernel. This helps to prevent Out-of-Memory (OOM) errors.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The automatic memory allocation for <code class="literal">kdump</code> varies based on system hardware architecture and available memory size.
				</p><p>
					For example, on AMD64 and Intel 64, the <code class="literal">crashkernel=auto</code>
 parameter works only when the available memory is more than 1GB. The 
64-bit ARM architecture and IBM Power Systems needs more than 2 GB of 
available memory.
				</p><p>
					If the system has less than the minimum memory threshold for 
automatic allocation, you can configure the amount of reserved memory 
manually.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions on the system.
					</li><li class="listitem">
						Fulfilled requirements for <code class="literal">kdump</code> configurations and targets. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#supported-kdump-configurations-and-targets_managing-monitoring-and-updating-the-kernel">Supported kdump configurations and targets</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Prepare the <code class="literal option">crashkernel=</code> option.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								For example, to reserve 128&nbsp;MB of memory, use the following:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1fcgvmc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crashkernel=128M</pre></div></div></li><li class="listitem"><p class="simpara">
								Alternatively, you can set the amount of reserved memory to a 
variable depending on the total amount of installed memory. The syntax 
for memory reservation into a variable is <code class="literal option">crashkernel=<span class="emphasis"><em>&lt;range1&gt;</em></span>:<span class="emphasis"><em>&lt;size1&gt;</em></span>,<span class="emphasis"><em>&lt;range2&gt;</em></span>:<span class="emphasis"><em>&lt;size2&gt;</em></span></code>. For example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--lay8uzx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crashkernel=512M-2G:64M,2G-:128M</pre></div></div><p class="simpara">
								The command reserves 64&nbsp;MB of memory if the total amount of
 system memory is in the range of 512&nbsp;MB and 2 GB. If the total 
amount of memory is more than 2&nbsp;GB, the memory reserve is 
128&nbsp;MB.
							</p></li><li class="listitem"><p class="simpara">
								Offset the reserved memory.
							</p><p class="simpara">
								Some systems require to reserve memory with a certain fixed offset because the <code class="literal option">crashkernel</code>
 reservation happens early, and you may need to reserve more memory for 
special usage. When you define an offset, the reserved memory begins 
there. To offset the reserved memory, use the following syntax:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wtq8ndz"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crashkernel=128M@16M</pre></div></div><p class="simpara">
								In this example, <code class="literal">kdump</code> reserves 128&nbsp;MB of memory starting at 16&nbsp;MB (physical address <code class="literal">0x01000000</code>). If you set the offset parameter to 0 or omit entirely, <code class="literal">kdump</code>
 offsets the reserved memory automatically. You can also use this syntax
 when setting a variable memory reservation. In that case, the offset is
 always specified last. For example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--iho7qpm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crashkernel=512M-2G:64M,2G-:128M@16M</pre></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Apply the <code class="literal option">crashkernel=</code> option to your boot loader configuration:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bhczw3f"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=ALL --args="crashkernel=<span class="emphasis"><em>&lt;value&gt;</em></span>"</strong></span></pre></div></div><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;value&gt;</em></span></code> with the value of the <code class="literal option">crashkernel=</code> option that you prepared in the previous step.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#memory-requirements-for-kdump_supported-kdump-configurations-and-targets">Memory requirements for kdump</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_monitoring_and_updating_the_kernel/configuring-kernel-command-line-parameters_managing-monitoring-and-updating-the-kernel">Configuring kernel command-line parameters</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/32726">How to manually modify the boot parameter in grub before the system boots</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/3938081">How to install and boot custom kernels in Red Hat Enterprise Linux 8</a>
					</li><li class="listitem">
						<code class="literal">grubby(8)</code> manual page
					</li></ul></div></section><section class="section" id="configuring-the-kdump-target_configuring-kdump-on-the-command-line"><div class="titlepage"><div><div><h2 class="title">19.3. Configuring the kdump target</h2></div></div></div><p class="_abstract _abstract">
				The crash dump is usually stored as a file in a local file system, 
written directly to a device. Alternatively, you can set up for the 
crash dump to be sent over a network using the <code class="literal">NFS</code> or <code class="literal">SSH</code>
 protocols. Only one of these options to preserve a crash dump file can 
be set at a time. The default behavior is to store it in the <code class="literal">/var/crash/</code> directory of the local file system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">Root</code> permissions.
					</li><li class="listitem">
						Fulfilled requirements for <code class="literal">kdump</code> configurations and targets. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#supported-kdump-configurations-and-targets_managing-monitoring-and-updating-the-kernel">Supported kdump configurations and targets</a>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To store the crash dump file in <code class="literal">/var/crash/</code> directory of the local file system, edit the <code class="literal">/etc/kdump.conf</code> file and specify the path:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--gsnekxt"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">path /var/crash</pre></div></div><p class="simpara">
						The option <code class="literal">path /var/crash</code> represents the path to the file system in which <code class="literal">kdump</code> saves the crash dump file.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									When you specify a dump target in the <code class="literal">/etc/kdump.conf</code> file, then the path is <span class="strong strong"><strong>relative</strong></span> to the specified dump target.
								</li><li class="listitem">
									When you do not specify a dump target in the <code class="literal">/etc/kdump.conf</code> file, then the path represents the <span class="strong strong"><strong>absolute</strong></span> path from the root directory.
								</li></ul></div></div></div><p class="simpara">
						Depending on what is mounted in the current system, the dump target and the adjusted dump path are taken automatically.
					</p><div class="example" id="idm139983845098992"><p class="title">Example 19.1. The kdump target configuration</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--l8kpdnb"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grep -v ^# /etc/kdump.conf | grep -v ^$</strong></span>
ext4 /dev/mapper/vg00-varcrashvol
path /var/crash
core_collector makedumpfile -c --message-level 1 -d 31</pre></div></div><p>
							Here, the dump target is specified (<code class="literal">ext4 /dev/mapper/vg00-varcrashvol</code>), and thus mounted at <code class="literal">/var/crash</code>. The <code class="literal">path</code> option is also set to <code class="literal">/var/crash</code>, so the <code class="literal">kdump</code> saves the <code class="literal">vmcore</code> file in the <code class="literal">/var/crash/var/crash</code> directory.
						</p></div></div></li><li class="listitem"><p class="simpara">
						To change the local directory in which the crash dump is to be saved, as <code class="literal">root</code>, edit the <code class="literal">/etc/kdump.conf</code> configuration file:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Remove the hash sign ("#") from the beginning of the <code class="literal">#path /var/crash</code> line.
							</li><li class="listitem"><p class="simpara">
								Replace the value with the intended directory path. For example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jmf0u6d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">path /usr/local/cores</pre></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
									In RHEL 9, the directory defined as the kdump target using the <code class="literal">path</code> directive must exist when the <code class="literal">kdump</code> <code class="literal">systemd</code> service is started - otherwise the service fails.
								</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						To write the file to a different partition, edit the <code class="literal">/etc/kdump.conf</code> configuration file:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Remove the hash sign ("#") from the beginning of the <code class="literal">#ext4</code> line, depending on your choice.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										device name (the <code class="literal">#ext4 /dev/vg/lv_kdump</code> line)
									</li><li class="listitem">
										file system label (the <code class="literal">#ext4 LABEL=/boot</code> line)
									</li><li class="listitem">
										UUID (the <code class="literal">#ext4 UUID=03138356-5e61-4ab3-b58e-27507ac41937</code> line)
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Change the file system type as well as the device name, label or UUID to the desired values. For example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sqgthyy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ext4 UUID=03138356-5e61-4ab3-b58e-27507ac41937</pre></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">NOTE</span></dt><dd><p class="simpara">
											The correct syntax for specifying UUID values is both <code class="literal">UUID="correct-uuid"</code> and <code class="literal">UUID=correct-uuid</code>.
										</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
												It is recommended to specify storage devices using a <code class="literal">LABEL=</code> or <code class="literal">UUID=</code>. Disk device names such as <code class="literal">/dev/sda3</code> are not guaranteed to be consistent across reboot.
											</p></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
												When dumping to Direct Access Storage Device (DASD) on IBM Z
 hardware, it is essential that the dump devices are correctly specified
 in <code class="literal">/etc/dasd.conf</code> before proceeding.
											</p></div></div></dd></dl></div></li></ol></div></li><li class="listitem"><p class="simpara">
						To write the crash dump directly to a device, edit the <code class="literal">/etc/kdump.conf</code> configuration file:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Remove the hash sign ("#") from the beginning of the <code class="literal">#raw /dev/vg/lv_kdump</code> line.
							</li><li class="listitem"><p class="simpara">
								Replace the value with the intended device name. For example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--lv2ifhc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">raw /dev/sdb1</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						To store the crash dump to a remote machine using the <code class="literal">NFS</code> protocol:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Remove the hash sign ("#") from the beginning of the <code class="literal">#nfs my.server.com:/export/tmp</code> line.
							</li><li class="listitem"><p class="simpara">
								Replace the value with a valid hostname and directory path. For example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--afy0ft5"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">nfs penguin.example.com:/export/cores</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						To store the crash dump to a remote machine using the <code class="literal">SSH</code> protocol:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Remove the hash sign ("#") from the beginning of the <code class="literal">#ssh user@my.server.com</code> line.
							</li><li class="listitem">
								Replace the value with a valid username and hostname.
							</li><li class="listitem"><p class="simpara">
								Include your <code class="literal">SSH</code> key in the configuration.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Remove the hash sign from the beginning of the <code class="literal">#sshkey /root/.ssh/kdump_id_rsa</code> line.
									</li><li class="listitem"><p class="simpara">
										Change the value to the location of a key valid on the server you are trying to dump to. For example:
									</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--lgi2dk2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ssh john@penguin.example.com
sshkey /root/.ssh/mykey</pre></div></div></li></ul></div></li></ol></div></li></ul></div></section><section class="section" id="configuring-the-kdump-core-collectorconfiguring-kdump-on-the-command-line"><div class="titlepage"><div><div><h2 class="title">19.4. Configuring the kdump core collector</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">kdump</code> service uses a <code class="literal">core_collector</code> program to capture the crash dump image. In RHEL, the <code class="literal">makedumpfile</code> utility is the default core collector. It helps shrink the dump file by:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Compressing the size of a crash dump file and copying only necessary pages using various dump levels
					</li><li class="listitem">
						Excluding unnecessary crash dump pages
					</li><li class="listitem">
						Filtering the page types to be included in the crash dump.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Syntax</strong></p><p>
					
</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qb162sg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">core_collector makedumpfile -l --message-level 1 -d 31</pre></div></div>

				<p></p></div><div class="itemizedlist"><p class="title"><strong>Options</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">-c</code>, <code class="literal">-l</code> or <code class="literal">-p</code>: specify compress dump file format by each page using either, <code class="literal">zlib</code> for <code class="literal">-c</code> option, <code class="literal">lzo</code> for <code class="literal">-l</code> option or <code class="literal">snappy</code> for <code class="literal">-p</code> option.
					</li><li class="listitem">
						<code class="literal">-d</code> <code class="literal">(dump_level)</code>: excludes pages so that they are not copied to the dump file.
					</li><li class="listitem">
						<code class="literal">--message-level</code> : specify the message types. You can restrict outputs printed by specifying <code class="literal">message_level</code> with this option. For example, specifying 7 as <code class="literal">message_level</code> prints common messages and error messages. The maximum value of <code class="literal">message_level</code> is 31
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root permissions on the system.
					</li><li class="listitem">
						Fulfilled requirements for <code class="literal">kdump</code> configurations and targets. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#supported-kdump-configurations-and-targets_managing-monitoring-and-updating-the-kernel">Supported kdump configurations and targets</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						As <code class="literal">root</code>, edit the <code class="literal">/etc/kdump.conf</code> configuration file and remove the hash sign ("#") from the beginning of the <code class="literal">#core_collector makedumpfile -l --message-level 1 -d 31</code>.
					</li><li class="listitem">
						To enable crash dump file compression, execute:
					</li></ol></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--oel96kw"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">core_collector makedumpfile -l --message-level 1 -d 31</pre></div></div><p>
				The <code class="literal">-l</code> option specifies the <code class="literal">dump</code> compressed file format. The <code class="literal">-d</code> option specifies dump level as 31. The <code class="literal">--message-level</code> option specifies message level as 1.
			</p><p>
				Also, consider following examples with the <code class="literal">-c</code> and <code class="literal">-p</code> options:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						To compress a crash dump file using <code class="literal">-c</code>:
					</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--l698pga"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">core_collector makedumpfile -c -d 31 --message-level 1</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						To compress a crash dump file using <code class="literal">-p</code>:
					</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5d4v3ga"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">core_collector makedumpfile -p -d 31 --message-level 1</pre></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">makedumpfile(8)</code> man page
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#configuration-file-for-kdump_configuring-kdump-on-the-command-line">Configuration file for kdump</a>
					</li></ul></div></section><section class="section" id="configuring-the-kdump-default-failure-responses_configuring-kdump-on-the-command-line"><div class="titlepage"><div><div><h2 class="title">19.5. Configuring the kdump default failure responses</h2></div></div></div><p class="_abstract _abstract">
				By default, when <code class="literal">kdump</code> fails to create a
 crash dump file at the configured target location, the system reboots 
and the dump is lost in the process. To change this behavior, follow the
 procedure below.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Root permissions.
					</li><li class="listitem">
						Fulfilled requirements for <code class="literal">kdump</code> configurations and targets. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#supported-kdump-configurations-and-targets_managing-monitoring-and-updating-the-kernel">Supported kdump configurations and targets</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						As <code class="literal">root</code>, remove the hash sign ("#") from the beginning of the <code class="literal">#failure_action</code> line in the <code class="literal">/etc/kdump.conf</code> configuration file.
					</li><li class="listitem"><p class="simpara">
						Replace the value with a desired action.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7n1rs2p"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"><span class="strong strong"><strong>failure_action poweroff</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#configuring-the-kdump-target_configuring-kdump-on-the-command-line">Configuring the kdump target</a>
					</li></ul></div></section><section class="section" id="configuration-file-for-kdump_configuring-kdump-on-the-command-line"><div class="titlepage"><div><div><h2 class="title">19.6. Configuration file for kdump</h2></div></div></div><p class="_abstract _abstract">
				The configuration file for <code class="literal">kdump</code> kernel is <code class="literal">/etc/sysconfig/kdump</code>. This file controls the <code class="literal">kdump</code>
 kernel command line parameters. For most configurations, use the 
default options. However, in some scenarios you might need to modify 
certain parameters to control the <code class="literal">kdump</code> kernel behavior. For example, modifying the <code class="literal">KDUMP_COMMANDLINE_APPEND</code> option to append the <code class="literal">kdump</code> kernel command-line to obtain a detailed debugging output or the <code class="literal">KDUMP_COMMANDLINE_REMOVE</code> option to remove arguments from the <code class="literal">kdump</code> command line.
			</p><p>
				For information about additional configuration options refer to <code class="literal">Documentation/admin-guide/kernel-parameters.txt</code> or the <code class="literal">/etc/sysconfig/kdump</code> file.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">KDUMP_COMMANDLINE_REMOVE</code>
					</p><p class="simpara">
						This option removes arguments from the current <code class="literal">kdump</code> command line. It removes parameters that may cause <code class="literal">kdump</code> errors or <code class="literal">kdump</code> kernel boot failures. These parameters may have been parsed from the previous <code class="literal">KDUMP_COMMANDLINE</code> process or inherited from the <code class="literal">/proc/cmdline</code> file. When this variable is not configured, it inherits all values from the <code class="literal">/proc/cmdline</code> file. Configuring this option also provides information that is helpful in debugging an issue.
					</p><p class="simpara">
						<span class="strong strong"><strong>Example</strong></span>
					</p><p class="simpara">
						To remove certain arguments, add them to <code class="literal">KDUMP_COMMANDLINE_REMOVE</code> as follows:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wlfsvkh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">KDUMP_COMMANDLINE_REMOVE="hugepages hugepagesz slub_debug quiet log_buf_len swiotlb"</pre></div></div></li><li class="listitem"><p class="simpara">
						<code class="literal">KDUMP_COMMANDLINE_APPEND</code>
					</p><p class="simpara">
						This option appends arguments to the current command line. These arguments may have been parsed by the previous <code class="literal">KDUMP_COMMANDLINE_REMOVE</code> variable.
					</p><p class="simpara">
						For the <code class="literal">kdump</code> kernel, disabling certain modules such as <code class="literal">mce</code>, <code class="literal">cgroup</code>, <code class="literal">numa</code>, <code class="literal">hest_disable</code> can help prevent kernel errors. These modules may consume a significant portion of the kernel memory reserved for <code class="literal">kdump</code> or cause <code class="literal">kdump</code> kernel boot failures.
					</p><p class="simpara">
						<span class="strong strong"><strong>Example</strong></span>
					</p><p class="simpara">
						To disable memory <code class="literal">cgroups</code> on the <code class="literal">kdump</code> kernel command line, run the command as follows:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8zkxz97"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">KDUMP_COMMANDLINE_APPEND="cgroup_disable=memory"</pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">Documentation/admin-guide/kernel-parameters.txt</code> file
					</li><li class="listitem">
						The <code class="literal">/etc/sysconfig/kdump</code> file
					</li></ul></div></section><section class="section" id="testing-the-kdump-configuration_configuring-kdump-on-the-command-line"><div class="titlepage"><div><div><h2 class="title">19.7. Testing the kdump configuration</h2></div></div></div><p class="_abstract _abstract">
				Testing the <code class="literal">kdump</code> configuration 
validates the configuration and also records the time taken for a crash 
dump to complete with the specified workload.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The commands to test <code class="literal">kdump</code> 
configuration will cause the kernel to crash with loss of data. Follow 
the instructions with care and do not use an active production system to
 test the <code class="literal">kdump</code> configuration.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Reboot the system with <code class="literal">kdump</code> enabled.
					</li><li class="listitem"><p class="simpara">
						Check if <code class="literal">kdump</code> is active.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--f7c2m8s"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl is-active kdump</strong></span>
active</pre></div></div></li><li class="listitem"><p class="simpara">
						Force a kernel crash.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5cufdgv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><span class="strong strong"><strong>echo 1 &gt; /proc/sys/kernel/sysrq</strong></span>
<span class="strong strong"><strong>echo c &gt; /proc/sysrq-trigger</strong></span></pre></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							The command causes the kernel to crash and reboots the kernel if required.
						</p></div></div><p class="simpara">
						On a kernel reboot, the <code class="literal"><span class="emphasis"><em>address</em></span>-<span class="emphasis"><em>YYYY-MM-DD</em></span>-<span class="emphasis"><em>HH:MM:SS</em></span>/vmcore</code> file is created at the location you have specified in the <code class="literal">/etc/kdump.conf</code> file (by default to <code class="literal">/var/crash/</code>).
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#configuring-the-kdump-target_configuring-kdump-on-the-command-line">Configuring the kdump target</a>
					</li></ul></div></section></section><section class="chapter" id="enabling-kdumpmanaging-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 20. Enabling kdump</h1></div></div></div><p class="_abstract _abstract">
			By using the procedure, you can enable or disable the <code class="literal">kdump</code> service for all installed kernels or for a specific kernel.
		</p><section class="section" id="enabling-kdump-for-all-installed-kernels_enabling-kdump"><div class="titlepage"><div><div><h2 class="title">20.1. Enabling kdump for all installed kernels</h2></div></div></div><p class="_abstract _abstract">
				You can enable and start the <code class="literal service">kdump</code> service for all kernels installed on the machine.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the <code class="literal">crashkernel=auto</code> command-line parameter to all installed kernels:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sssmk01"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=ALL --args="crashkernel=auto"</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Enable the <code class="literal">kdump</code> service.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ddezmid"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl enable --now kdump.service</strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">kdump</code> service is running:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jfy4pyp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl status kdump.service</strong></span>

 kdump.service - Crash recovery kernel arming
     Loaded: loaded (/usr/lib/systemd/system/kdump.service; enabled; vendor preset: disabled)
     Active: active (live)</pre></div></div></li></ul></div></section><section class="section" id="enabling-kdump-for-a-specific-installed-kernel_enabling-kdump"><div class="titlepage"><div><div><h2 class="title">20.2. Enabling kdump for a specific installed kernel</h2></div></div></div><p class="_abstract _abstract">
				You can enable the <code class="literal service">kdump</code> service for a specific kernel on the machine.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Administrator privileges
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List the kernels installed on the machine.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--n9mvpv3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ls -a /boot/vmlinuz-</strong></span>*
<span class="strong strong"><strong>/boot/vmlinuz-0-rescue-2930657cd0dc43c2b75db480e5e5b4a9 /boot/vmlinuz-4.18.0-330.el8.x86_64 /boot/vmlinuz-4.18.0-330.rt7.111.el8.x86_64</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Add a specific <code class="literal">kdump</code> kernel to the systems Grand Unified Bootloader (GRUB) configuration file.
					</p><p class="simpara">
						For example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9vytenu"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=vmlinuz-4.18.0-330.el8.x86_64 --args="crashkernel=auto"</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Enable the <code class="literal">kdump</code> service.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--i4fh281"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl enable --now kdump.service</strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">kdump</code> service is running:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bm6dioj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl status kdump.service</strong></span>

 kdump.service - Crash recovery kernel arming
     Loaded: loaded (/usr/lib/systemd/system/kdump.service; enabled; vendor preset: disabled)
     Active: active (live)</pre></div></div></li></ul></div></section><section class="section" id="disabling-the-kdump-service_enabling-kdump"><div class="titlepage"><div><div><h2 class="title">20.3. Disabling the kdump service</h2></div></div></div><p class="_abstract _abstract">
				To disable the <code class="literal">kdump</code> service at boot time, follow the procedure below.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Fulfilled requirements for <code class="literal">kdump</code> configurations and targets. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/managing_monitoring_and_updating_the_kernel/index#supported-kdump-configurations-and-targets_managing-monitoring-and-updating-the-kernel">Supported kdump configurations and targets</a>.
					</li><li class="listitem">
						All configurations for installing <code class="literal">kdump</code> are set up according to your needs. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_monitoring_and_updating_the_kernel/installing-kdump_managing-monitoring-and-updating-the-kernel">Installing kdump</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To stop the <code class="literal">kdump</code> service in the current session:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jyjg73x"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl stop kdump.service</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						To disable the <code class="literal">kdump</code> service:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--y8wfonf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>systemctl disable kdump.service</strong></span></pre></div></div></li></ol></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					It is recommended to set <code class="literal">kptr_restrict=1</code>. In that case, the <code class="literal">kdumpctl</code> service loads the crash kernel regardless of Kernel Address Space Layout (KASLR) being enabled or not.
				</p></div></div><div class="formalpara"><p class="title"><strong>Troubleshooting step</strong></p><p>
					When <code class="literal">kptr_restrict</code> is not set to (1), and if KASLR is enabled, the contents of <code class="literal">/proc/kcore</code> file are generated as all zeros. Consequently, the <code class="literal">kdumpctl</code> service fails to access the <code class="literal">/proc/kcore</code> and load the crash kernel.
				</p></div><p>
				To work around this problem, the <code class="literal">/usr/share/doc/kexec-tools/kexec-kdump-howto.txt</code> file displays a warning message, which recommends the <code class="literal">kptr_restrict=1</code> setting.
			</p><p>
				To ensure that <code class="literal">kdumpctl</code> service loads the crash kernel, verify that <code class="literal">kernel.kptr_restrict = 1</code> is listed in the <code class="literal">sysctl.conf</code> file.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_basic_system_settings/index#managing-system-services-with-systemctl_configuring-basic-system-settings">Managing system services with systemctl</a>
					</li></ul></div></section></section><section class="chapter" id="supported-kdump-configurations-and-targets_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 21. Supported kdump configurations and targets</h1></div></div></div><section class="section" id="memory-requirements-for-kdump_supported-kdump-configurations-and-targets"><div class="titlepage"><div><div><h2 class="title">21.1. Memory requirements for kdump</h2></div></div></div><p class="_abstract _abstract">
				In order for <code class="literal">kdump</code> to be able to 
capture a kernel crash dump and save it for further analysis, a part of 
the system memory has to be permanently reserved for the capture kernel.
 When reserved, this part of the system memory is not available to the 
main kernel.
			</p><p>
				The memory requirements vary based on certain system parameters. One
 of the major factors is the systems hardware architecture. To find out
 the exact machine architecture (such as Intel 64 and AMD64, also known 
as x86_64) and print it to standard output, use the following command:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--180egif"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"><code class="literal command">$ <span class="strong strong"><strong>uname -m</strong></span></code></pre></div></div><p>
				With the stated list of minimum memory requirements, you set the 
appropriate memory size to automatically reserve a memory for <code class="literal">kdump</code> on the latest available versions. The memory size depends on the systems architecture and total available physical memory.
			</p><div class="table" id="idm139983843365808"><p class="title">Table 21.1. Minimum amount of reserved memory required for kdump</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="7y8iamo" id="rh-table--7y8iamo" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th id="idm139983843359696" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Architecture</th><th id="idm139983843358608" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Available Memory</th><th id="idm139983843357520" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">Minimum Reserved Memory</th></tr></thead><tbody><tr><td rowspan="4" headers="idm139983843359696" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								AMD64 and Intel&nbsp;64 (<code class="literal">x86_64</code>)
							</p>
							 </td><td headers="idm139983843358608" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								1&nbsp;GB to 4&nbsp;GB
							</p>
							 </td><td headers="idm139983843357520" data-row="2" data-col="3" class="content--md" valign="top" align="left"> <p>
								160&nbsp;MB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								4&nbsp;GB to 64&nbsp;GB
							</p>
							 </td><td headers="idm139983843357520" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								192&nbsp;MB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								64&nbsp;GB to 1&nbsp;TB
							</p>
							 </td><td headers="idm139983843357520" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								256 MB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								1 TB and more
							</p>
							 </td><td headers="idm139983843357520" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								512&nbsp;MB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843359696" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								64-bit ARM architecture (<code class="literal">arm64</code>)
							</p>
							 </td><td headers="idm139983843358608" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								2&nbsp;GB and more
							</p>
							 </td><td headers="idm139983843357520" data-row="6" data-col="3" class="content--md" valign="top" align="left"> <p>
								448&nbsp;MB of RAM.
							</p>
							 </td></tr><tr><td rowspan="5" headers="idm139983843359696" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								IBM Power Systems (<code class="literal">ppc64le</code>)
							</p>
							 </td><td headers="idm139983843358608" data-row="7" data-col="2" class="content--md" valign="top" align="left"> <p>
								2&nbsp;GB to 4&nbsp;GB
							</p>
							 </td><td headers="idm139983843357520" data-row="7" data-col="3" class="content--md" valign="top" align="left"> <p>
								384&nbsp;MB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								4&nbsp;GB to 16&nbsp;GB
							</p>
							 </td><td headers="idm139983843357520" data-row="8" data-col="2" class="content--md" valign="top" align="left"> <p>
								512&nbsp;MB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="9" data-col="1" class="content--md" valign="top" align="left"> <p>
								16&nbsp;GB to 64&nbsp;GB
							</p>
							 </td><td headers="idm139983843357520" data-row="9" data-col="2" class="content--md" valign="top" align="left"> <p>
								1&nbsp;GB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="10" data-col="1" class="content--md" valign="top" align="left"> <p>
								64&nbsp;GB to 128&nbsp;GB
							</p>
							 </td><td headers="idm139983843357520" data-row="10" data-col="2" class="content--md" valign="top" align="left"> <p>
								2&nbsp;GB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="11" data-col="1" class="content--md" valign="top" align="left"> <p>
								128&nbsp;GB and more
							</p>
							 </td><td headers="idm139983843357520" data-row="11" data-col="2" class="content--md" valign="top" align="left"> <p>
								4&nbsp;GB of RAM.
							</p>
							 </td></tr><tr><td rowspan="4" headers="idm139983843359696" data-row="12" data-col="1" class="content--md" valign="top" align="left"> <p>
								IBM&nbsp;Z (<code class="literal">s390x</code>)
							</p>
							 </td><td headers="idm139983843358608" data-row="12" data-col="2" class="content--md" valign="top" align="left"> <p>
								1&nbsp;GB to 4&nbsp;GB
							</p>
							 </td><td headers="idm139983843357520" data-row="12" data-col="3" class="content--md" valign="top" align="left"> <p>
								160&nbsp;MB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="13" data-col="1" class="content--md" valign="top" align="left"> <p>
								4&nbsp;GB to 64&nbsp;GB
							</p>
							 </td><td headers="idm139983843357520" data-row="13" data-col="2" class="content--md" valign="top" align="left"> <p>
								192&nbsp;MB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="14" data-col="1" class="content--md" valign="top" align="left"> <p>
								64&nbsp;GB to 1&nbsp;TB
							</p>
							 </td><td headers="idm139983843357520" data-row="14" data-col="2" class="content--md" valign="top" align="left"> <p>
								256&nbsp;MB of RAM.
							</p>
							 </td></tr><tr><td headers="idm139983843358608" data-row="15" data-col="1" class="content--md" valign="top" align="left"> <p>
								1&nbsp;TB and more
							</p>
							 </td><td headers="idm139983843357520" data-row="15" data-col="2" class="content--md" valign="top" align="left"> <p>
								512&nbsp;MB of RAM.
							</p>
							 </td></tr></tbody></table></rh-table></div><p>
				On many systems, <code class="literal">kdump</code> is able to 
estimate the amount of required memory and reserve it automatically. The
 automatic memory reservation mechanism is enabled by default and 
requires the systems to have available memory more than the minimum 
threshold, which varies based on the system architecture.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The configuration of reserved memory based on the total amount of 
memory in the system is a best effort estimation. The actual required 
memory may vary due to other factors such as I/O devices. Using not 
enough of memory might cause that a debug kernel is not able to boot as a
 capture kernel in case of a kernel panic. To avoid this problem, 
sufficiently increase the crash kernel memory.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/5907911">How has the crashkernel parameter changed between RHEL8 minor releases?</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/rhel-limits++">Technology capabilities and limits tables</a>
					</li></ul></div></section><section class="section" id="minimum-threshold-for-memory-reservation_supported-kdump-configurations-and-targets"><div class="titlepage"><div><div><h2 class="title">21.2. Minimum threshold for memory reservation</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">kexec-tools</code> utility, by default, configures the <code class="literal">crashkernel</code> command line parameter and reserves a certain amount of memory for <code class="literal">kdump</code>.
 For the default memory reservation to work, a certain amount of total 
memory must be available in the system. The amount of memory required 
differs based on the systems architecture.If the system has memory less
 than the specified threshold value, you must configure the memory 
manually.
			</p><div class="table" id="idm139983845603280"><p class="title">Table 21.2. Minimum amount of memory required for memory reservation</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="vq09qe4" id="rh-table--vq09qe4"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm139983845598400" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Architecture</th><th id="idm139983845597312" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Required Memory</th></tr></thead><tbody><tr><td headers="idm139983845598400" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								AMD64 and Intel&nbsp;64 (<code class="literal">x86_64</code>)
							</p>
							 </td><td headers="idm139983845597312" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								1&nbsp;GB
							</p>
							 </td></tr><tr><td headers="idm139983845598400" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								IBM Power Systems (<code class="literal">ppc64le</code>)
							</p>
							 </td><td headers="idm139983845597312" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								2&nbsp;GB
							</p>
							 </td></tr><tr><td headers="idm139983845598400" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								IBM &nbsp;Z (<code class="literal">s390x</code>)
							</p>
							 </td><td headers="idm139983845597312" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								1&nbsp;GB
							</p>
							 </td></tr><tr><td headers="idm139983845598400" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								ARM (aarch64)
							</p>
							 </td><td headers="idm139983845597312" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								2 GB
							</p>
							 </td></tr></tbody></table></rh-table></div></section><section class="section" id="supported-kdump-targets_supported-kdump-configurations-and-targets"><div class="titlepage"><div><div><h2 class="title">21.3. Supported kdump targets</h2></div></div></div><p class="_abstract _abstract">
				When a kernel crash is captured, the <code class="literal">vmcore</code>
 dump file can be saved directly to a device, stored as a file on a 
local file system, or sent over a network. With the list of dump 
targets, you can understand the targets that are currently supported or 
explicitly unsupported by <code class="literal">kdump</code>.
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="9bn54cv" id="rh-table--9bn54cv" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th id="idm139983845570064" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Type</th><th id="idm139983845568976" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Supported Targets</th><th id="idm139983845567888" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">Unsupported Targets</th></tr></thead><tbody><tr><td headers="idm139983845570064" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								Raw device
							</p>
							 </td><td headers="idm139983845568976" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								All locally attached raw disks and partitions.
							</p>
							 </td><td headers="idm139983845567888" data-row="2" data-col="3" class="content--sm" valign="top" align="left">&nbsp;</td></tr><tr><td headers="idm139983845570064" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								Local file system
							</p>
							 </td><td headers="idm139983845568976" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								<code class="literal">ext2</code>, <code class="literal">ext3</code>, <code class="literal">ext4</code>, and <code class="literal">xfs</code> file systems on directly attached disk drives, hardware RAID logical drives, LVM devices, and <code class="literal">mdraid</code> arrays.
							</p>
							 </td><td headers="idm139983845567888" data-row="3" data-col="3" class="content--lg" valign="top" align="left"> <p>
								Any local file system not explicitly listed as supported in this table, including the <code class="literal">auto</code> type (automatic file system detection).
							</p>
							 </td></tr><tr><td headers="idm139983845570064" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								Remote directory
							</p>
							 </td><td headers="idm139983845568976" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Remote directories accessed using the <code class="literal">NFS</code> or <code class="literal">SSH</code> protocol over <code class="literal">IPv4</code>.
							</p>
							 </td><td headers="idm139983845567888" data-row="4" data-col="3" class="content--lg" valign="top" align="left"> <p>
								Remote directories on the <code class="literal">rootfs</code> file system accessed using the <code class="literal">NFS</code> protocol.
							</p>
							 </td></tr><tr><td headers="idm139983845570064" data-row="5" data-col="1" class="content--lg" valign="top" align="left"> <p>
								Remote directories accessed using the <code class="literal">iSCSI</code> protocol over both hardware and software initiators.
							</p>
							 </td><td headers="idm139983845568976" data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Remote directories accessed using the <code class="literal">iSCSI</code> protocol on <code class="literal">be2iscsi</code> hardware.
							</p>
							 </td><td headers="idm139983845567888" data-row="5" data-col="3" class="content--md" valign="top" align="left"> <p>
								Multipath-based storages.
							</p>
							 </td></tr><tr><td colspan="2" headers="idm139983845570064 idm139983845568976" data-row="6" data-col="1" class="content--sm" valign="top" align="center">&nbsp;</td><td headers="idm139983845567888" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Remote directories accessed over <code class="literal">IPv6</code>.
							</p>
							 </td></tr><tr><td colspan="2" headers="idm139983845570064 idm139983845568976" data-row="7" data-col="1" class="content--sm" valign="top" align="center">&nbsp;</td><td headers="idm139983845567888" data-row="7" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Remote directories accessed using the <code class="literal">SMB</code> or <code class="literal">CIFS</code> protocol.
							</p>
							 </td></tr><tr><td colspan="2" headers="idm139983845570064 idm139983845568976" data-row="8" data-col="1" class="content--sm" valign="top" align="center">&nbsp;</td><td headers="idm139983845567888" data-row="8" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Remote directories accessed using the <code class="literal">FCoE</code> (<span class="emphasis"><em>Fibre Channel over Ethernet</em></span>) protocol.
							</p>
							 </td></tr><tr><td colspan="2" headers="idm139983845570064 idm139983845568976" data-row="9" data-col="1" class="content--sm" valign="top" align="center">&nbsp;</td><td headers="idm139983845567888" data-row="9" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Remote directories accessed using wireless network interfaces.
							</p>
							 </td></tr></tbody></table></rh-table><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Utilizing firmware assisted dump (<code class="literal">fadump</code>) to capture a vmcore and store it to a remote machine using SSH or NFS protocol causes renaming of the network interface to <code class="literal">kdump-&lt;interface-name&gt;</code>. The renaming happens if the <code class="literal">&lt;interface-name&gt;</code> is generic, for example <code class="literal">*eth#</code>, <code class="literal">net#</code>, and so on. This problem occurs because the vmcore capture scripts in the initial RAM disk (<code class="literal">initrd</code>) add the <span class="emphasis"><em>kdump-</em></span> prefix to the network interface name to secure persistent naming. Since the same <code class="literal">initrd</code> is used also for a regular boot, the interface name is changed for the production kernel too.
				</p></div></div></section><section class="section" id="supported-kdump-filtering-levels_supported-kdump-configurations-and-targets"><div class="titlepage"><div><div><h2 class="title">21.4. Supported kdump filtering levels</h2></div></div></div><p class="_abstract _abstract">
				To reduce the size of the dump file, <code class="literal">kdump</code> uses the <code class="literal command">makedumpfile</code>
 core collector to compress the data and optionally to omit unwanted 
information. With the list of filtering levels, you can understand the 
levels that are currently supported by the <code class="literal command">makedumpfile</code> utility.
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="zasolpz" id="rh-table--zasolpz"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm139983843162768" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Option</th><th id="idm139983843161680" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm139983843162768" data-row="2" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<code class="literal option">1</code>
							</p>
							 </td><td headers="idm139983843161680" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								Zero pages
							</p>
							 </td></tr><tr><td headers="idm139983843162768" data-row="3" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<code class="literal option">2</code>
							</p>
							 </td><td headers="idm139983843161680" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								Cache pages
							</p>
							 </td></tr><tr><td headers="idm139983843162768" data-row="4" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<code class="literal option">4</code>
							</p>
							 </td><td headers="idm139983843161680" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								Cache private
							</p>
							 </td></tr><tr><td headers="idm139983843162768" data-row="5" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<code class="literal option">8</code>
							</p>
							 </td><td headers="idm139983843161680" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								User pages
							</p>
							 </td></tr><tr><td headers="idm139983843162768" data-row="6" data-col="1" class="content--sm" valign="top" align="left"> <p>
								<code class="literal option">16</code>
							</p>
							 </td><td headers="idm139983843161680" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Free pages
							</p>
							 </td></tr></tbody></table></rh-table><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal command">makedumpfile</code> command 
supports removal of transparent huge pages and hugetlbfs pages. Consider
 both these types of hugepages User Pages and remove them using the <code class="literal option">-8</code> level.
				</p></div></div></section><section class="section" id="supported-default-failure-responses_supported-kdump-configurations-and-targets"><div class="titlepage"><div><div><h2 class="title">21.5. Supported default failure responses</h2></div></div></div><p class="_abstract _abstract">
				By default, when <code class="literal">kdump</code> fails to create a core dump, the operating system reboots. You can, however, configure <code class="literal">kdump</code>
 to perform a different operation in case it fails to save the core dump
 to the primary target. With the lists of default actions, you can 
understand the responses that are currently supported.
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="9k354cn" id="rh-table--9k354cn" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm139983843126784" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Option</th><th id="idm139983843125696" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm139983843126784" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal option">dump_to_rootfs</code>
							</p>
							 </td><td headers="idm139983843125696" data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Attempt to save the core dump to the root file system. This 
option is especially useful in combination with a network target: if the
 network target is unreachable, this option configures kdump to save the
 core dump locally. The system is rebooted afterwards.
							</p>
							 </td></tr><tr><td headers="idm139983843126784" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal option">reboot</code>
							</p>
							 </td><td headers="idm139983843125696" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Reboot the system, losing the core dump in the process.
							</p>
							 </td></tr><tr><td headers="idm139983843126784" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal option">halt</code>
							</p>
							 </td><td headers="idm139983843125696" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Halt the system, losing the core dump in the process.
							</p>
							 </td></tr><tr><td headers="idm139983843126784" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal option">poweroff</code>
							</p>
							 </td><td headers="idm139983843125696" data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Power off the system, losing the core dump in the process.
							</p>
							 </td></tr><tr><td headers="idm139983843126784" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal option">shell</code>
							</p>
							 </td><td headers="idm139983843125696" data-row="6" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Run a shell session from within the initramfs, allowing the user to record the core dump manually.
							</p>
							 </td></tr><tr><td headers="idm139983843126784" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">final_action</code>
							</p>
							 </td><td headers="idm139983843125696" data-row="7" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Enable additional operations such as <code class="literal">reboot</code>, <code class="literal">halt</code>, and <code class="literal">poweroff</code> actions after a successful <code class="literal">kdump</code> or when <code class="literal">shell</code> or <code class="literal">dump_to_rootfs</code> failure action completes. The default <code class="literal">final_action</code> option is <code class="literal">reboot</code>.
							</p>
							 </td></tr><tr><td headers="idm139983843126784" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">failure_action</code>
							</p>
							 </td><td headers="idm139983843125696" data-row="8" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Specifies the action to perform when a dump might fail in the event of a kernel crash. The default <code class="literal">failure_action</code> option is <code class="literal">reboot</code>.
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="using-final_action-parameter_supported-kdump-configurations-and-targets"><div class="titlepage"><div><div><h2 class="title">21.6. Using final_action parameter</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">final_action</code> parameter enables you to use certain additional operations such as <code class="literal">reboot</code>, <code class="literal">halt</code>, and <code class="literal">poweroff</code> actions after a successful <code class="literal">kdump</code> or when an invoked <code class="literal">failure_action</code> mechanism using <code class="literal">shell</code> or <code class="literal">dump_to_rootfs</code> completes. If the <code class="literal">final_action</code> option is not specified, it defaults to <code class="literal">reboot</code>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To configure <code class="literal">final_action</code>, edit the <code class="literal">/etc/kdump.conf</code> file and add one of the following options:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--irlvjxx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>final_action &lt;reboot | halt | poweroff&gt;</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">kdump</code> service for the changes to take effect:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--hticlxy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kdumpctl restart</strong></span></pre></div></div></li></ol></div></section><section class="section" id="proc_using-failure_action-parameter_supported-kdump-configurations-and-targets"><div class="titlepage"><div><div><h2 class="title">21.7. Using failure_action parameter</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">failure_action</code> parameter specifies the action to perform when a dump fails in the event of a kernel crash. The default action for <code class="literal">failure_action</code> is <code class="literal">reboot</code>, which reboots the system.
			</p><p>
				<code class="literal">failure_action</code> specifies one of the following actions to take:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">reboot</code>: reboots the system after a dump failure.
					</li><li class="listitem">
						<code class="literal">dump_to_rootfs</code>: saves the dump file on a root file system when a non-root dump target is configured.
					</li><li class="listitem">
						<code class="literal">halt</code>: halts the system.
					</li><li class="listitem">
						<code class="literal">poweroff</code>: stops the running operations on the system.
					</li><li class="listitem">
						<code class="literal">shell</code>: starts a shell session inside <code class="literal">initramfs</code>, from which you can manually perform additional recovery actions.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure:</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To configure an action to take if the dump fails, edit the <code class="literal">/etc/kdump.conf</code> file and specify one of the <code class="literal">failure_action</code> options:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--anejpdr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>failure_action &lt;reboot | halt | poweroff | shell | dump_to_rootfs&gt;</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">kdump</code> service for the changes to take effect:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--dilw3hl"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kdumpctl restart</strong></span></pre></div></div></li></ol></div></section></section><section class="chapter" id="firmware-assisted-dump-mechanisms_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 22. Firmware assisted dump mechanisms</h1></div></div></div><p class="_abstract _abstract">
			Firmware assisted dump (fadump) is a dump capturing mechanism, provided as an alternative to the <code class="literal">kdump</code> mechanism on IBM POWER systems. The <code class="literal">kexec</code> and <code class="literal">kdump</code>
 mechanisms are useful for capturing core dumps on AMD64 and Intel 64 
systems. However, some hardware such as mini systems and mainframe 
computers, leverage the onboard firmware to isolate regions of memory 
and prevent any accidental overwriting of data that is important to the 
crash analysis. The <code class="literal">fadump</code> utility, is optimized for the <code class="literal">fadump</code> mechanisms and their integration with RHEL on IBM POWER systems.
		</p><section class="section" id="firmware-assisted-dump-on-ibm-powerpc-hardware_firmware-assisted-dump-mechanisms"><div class="titlepage"><div><div><h2 class="title">22.1. Firmware assisted dump on IBM PowerPC hardware</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">fadump</code> utility captures the <code class="literal">vmcore</code>
 file from a fully-reset system with PCI and I/O devices. This mechanism
 uses firmware to preserve memory regions during a crash and then reuses
 the <code class="literal">kdump</code> userspace scripts to save the <code class="literal">vmcore</code>
 file. The memory regions consist of all system memory contents, except 
the boot memory, system registers, and hardware Page Table Entries 
(PTEs).
			</p><p>
				The <code class="literal">fadump</code> mechanism offers improved 
reliability over the traditional dump type, by rebooting the partition 
and using a new kernel to dump the data from the previous kernel crash. 
The <code class="literal">fadump</code> requires an IBM POWER6 processor-based or later version hardware platform.
			</p><p>
				For further details about the <code class="literal">fadump</code> mechanism, including PowerPC specific methods of resetting hardware, see the <code class="literal">/usr/share/doc/kexec-tools/fadump-howto.txt</code> file.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The area of memory that is not preserved, known as boot memory, is 
the amount of RAM required to successfully boot the kernel after a crash
 event. By default, the boot memory size is 256MB or 5% of total system 
RAM, whichever is larger.
				</p></div></div><p>
				Unlike <code class="literal">kexec-initiated</code> event, the <code class="literal">fadump</code>
 mechanism uses the production kernel to recover a crash dump. When 
booting after a crash, PowerPC hardware makes the device node <code class="literal">/proc/device-tree/rtas/ibm.kernel-dump</code> available to the <code class="literal">proc</code> filesystem (<code class="literal">procfs</code>). The <code class="literal">fadump-aware kdump</code> scripts, check for the stored <code class="literal">vmcore</code>, and then complete the system reboot cleanly.
			</p></section><section class="section" id="enabling-firmware-assisted-dump-mechanism_firmware-assisted-dump-mechanisms"><div class="titlepage"><div><div><h2 class="title">22.2. Enabling firmware assisted dump mechanism</h2></div></div></div><p class="_abstract _abstract">
				You can enhance the crash dumping capabilities of IBM POWER systems by enabling the firmware assisted dump (<code class="literal">fadump</code>) mechanism.
			</p><p>
				In the Secure Boot environment, the <code class="literal">GRUB2</code>
 boot loader allocates a boot memory region, known as the Real Mode Area
 (RMA). The RMA has a size of 512 MB, which is divided among the boot 
components and, if a component exceeds its size allocation, <code class="literal">GRUB2</code> fails with an out-of-memory (<code class="literal">OOM</code>) error.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Do not enable firmware assisted dump (<code class="literal">fadump</code>) mechanism in the Secure Boot environment on RHEL 9.1 and early versions. The <code class="literal">GRUB2</code> boot loader fails with the following error:
				</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--gy8buor"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">error: ../../grub-core/kern/mm.c:376:out of memory.
Press any key to continue</pre></div></div><p>
					The system is recoverable only if you increase the default <code class="literal">initramfs</code> size due to the <code class="literal">fadump</code> configuration.
				</p><p>
					For information about workaround methods to recover the system, see the <a class="link" href="https://www.ibm.com/support/pages/node/6846531">System boot ends in GRUB Out of Memory (OOM)</a> article.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root privileges.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Install the <code class="literal package">kexec-tools</code> package.
					</li><li class="listitem"><p class="simpara">
						Configure the default value for <code class="literal">crashkernel</code>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--cawy99i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>kdumpctl reset-crashkernel fadump=on --kernel=ALL</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						(Optional) Reserve boot memory instead of the default value.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qc203wn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel ALL --args=fadump=on crashkernel=xxM"</strong></span></pre></div></div><p class="simpara">
						where, <code class="literal">xx</code> is the required memory size in megabytes.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When specifying boot configuration options, test the configurations by rebooting the kernel with <code class="literal">kdump</code> enabled. If the <code class="literal">kdump</code> kernel fails to boot, increase the <code class="literal">crashkernel</code> value gradually to set an appropriate value.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Reboot for changes to take effect.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--emaa1go"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>reboot</strong></span></pre></div></div></li></ol></div></section><section class="section" id="firmware-assisted-dump-mechanisms-on-ibm-z-hardware_firmware-assisted-dump-mechanisms"><div class="titlepage"><div><div><h2 class="title">22.3. Firmware assisted dump mechanisms on IBM Z hardware</h2></div></div></div><p class="_abstract _abstract">
				IBM Z systems supports two firmware assisted dump mechanisms: Stand-alone dump (<code class="literal">sadump</code>) and <code class="literal">VMDUMP</code> dump file.
			</p><p>
				The <code class="literal">kdump</code> infrastructure is supported and utilized on IBM Z systems. However, using one of the firmware assisted dump (<code class="literal">fadump</code>) methods for IBM Z can provide various benefits:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">sadump</code> mechanism is initiated and controlled from the system console, and is stored on an <code class="literal">IPL</code> bootable device.
					</li><li class="listitem">
						The <code class="literal">VMDUMP</code> mechanism is similar to <code class="literal">sadump</code>.
 This tool is initiated from the system console, but retrieves the 
resulting dump from hardware and copies it to the system for analysis.
					</li><li class="listitem">
						These methods, similar to other hardware-based dump mechanisms, 
have the ability to capture the state of a machine in the early boot 
phase, before the <code class="literal">kdump</code> service starts.
					</li><li class="listitem">
						Although <code class="literal">VMDUMP</code> contains a mechanism to receive the dump file into a Red Hat Enterprise Linux system, the configuration and control of <code class="literal">VMDUMP</code> is managed from the IBM Z Hardware console.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://www.ibm.com/docs/en/linux-on-systems?topic=tools-red-hat-enterprise-linux-85">Using the Dump Tools on Red Hat Enterprise Linux 8.5</a>
					</li><li class="listitem">
						<a class="link" href="https://www.ibm.com/docs/en/zos/2.3.0?topic=aids-stand-alone-dump">Stand-alone dump</a>
					</li><li class="listitem">
						<a class="link" href="https://www.ibm.com/docs/en/linux-on-systems?topic=tools-zvm-dump-vmdump">Creating dumps on z/VM with VMDUMP</a>
					</li></ul></div></section><section class="section" id="using-sadump-on-fujitsu-primequest-systems_firmware-assisted-dump-mechanisms"><div class="titlepage"><div><div><h2 class="title">22.4. Using sadump on Fujitsu PRIMEQUEST systems</h2></div></div></div><p class="_abstract _abstract">
				The Fujitsu <code class="literal">sadump</code> mechanism is designed to provide a <code class="literal">fallback</code> dump capture in an event when <code class="literal">kdump</code> is unable to complete successfully. The <code class="literal">sadump</code> mechanism is invoked manually from the system Management Board (MMB) interface. Using MMB, configure <code class="literal">kdump</code> like for an Intel 64 or AMD 64 server and then proceed to enable <code class="literal">sadump</code>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add or edit the following lines in the <code class="literal">/etc/sysctl.conf</code> file to ensure that <code class="literal">kdump</code> starts as expected for <code class="literal">sadump</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xv1lvc9"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">kernel.panic=0
kernel.unknown_nmi_panic=1</pre></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							In particular, ensure that after <code class="literal">kdump</code>, the system does not reboot. If the system reboots after <code class="literal">kdump</code> has fails to save the <code class="literal">vmcore</code> file, then it is not possible to invoke the <code class="literal">sadump</code>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Set the <code class="literal">failure_action</code> parameter in <code class="literal">/etc/kdump.conf</code> appropriately as <code class="literal">halt</code> or <code class="literal">shell</code>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6jeyna3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">failure_action shell</pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The FUJITSU Server PRIMEQUEST 2000 Series Installation Manual
					</li></ul></div></section></section><section class="chapter" id="analyzing-a-core-dump_managing-monitoring-and-updating-the-kernel"><div class="titlepage"><div><div><h1 class="title">Chapter 23. Analyzing a core dump</h1></div></div></div><p class="_abstract _abstract">
			To determine the cause of the system crash, you can use the <span class="strong strong"><strong><span class="application application">crash</span></strong></span>
 utility, which provides an interactive prompt very similar to the GNU 
Debugger (GDB). This utility allows you to interactively analyze a core 
dump created by <code class="literal">kdump</code>, <code class="literal">netdump</code>, <code class="literal">diskdump</code> or <code class="literal">xendump</code> as well as a running Linux system. Alternatively, you have the option to use Kernel Oops Analyzer or the Kdump Helper tool.
		</p><section class="section" id="installing-the-crash-utility_analyzing-a-core-dump"><div class="titlepage"><div><div><h2 class="title">23.1. Installing the crash utility</h2></div></div></div><p class="_abstract _abstract">
				Install the <span class="strong strong"><strong><span class="application application">crash</span></strong></span> tool to obtain the core analysis suite.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enable the relevant repositories:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vqx42id"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>subscription-manager repos --enable <span class="emphasis"><em>baseos repository</em></span></strong></span></code></pre></div></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qnfwmqt"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>subscription-manager repos --enable <span class="emphasis"><em>appstream repository</em></span></strong></span></code></pre></div></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--s5q7qqm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>subscription-manager repos --enable <span class="emphasis"><em>rhel-9-for-x86_64-baseos-debug-rpms</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Install the <code class="literal package">crash</code> package:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ojvaqyx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>dnf install crash</strong></span></code></pre></div></div></li><li class="listitem"><p class="simpara">
						Install the <code class="literal package">kernel-debuginfo</code> package:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pq9fp3v"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>dnf install kernel-debuginfo</strong></span></code></pre></div></div><p class="simpara">
						The package corresponds to the running kernel and provides the data necessary for the dump analysis.
					</p></li></ol></div></section><section class="section" id="running-and-exiting-the-crash-utility_analyzing-a-core-dump"><div class="titlepage"><div><div><h2 class="title">23.2. Running and exiting the crash utility</h2></div></div></div><p class="_abstract _abstract">
				Start the <code class="literal">crash</code> utility for analyzing the cause of the system crash.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Identify the currently running kernel (for example <code class="literal">5.14.0-1.el9.x86_64</code>).
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To start the <code class="literal">crash</code> utility, two necessary parameters need to be passed to the command:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The debug-info (a decompressed vmlinuz image), for example <code class="literal">/usr/lib/debug/lib/modules/5.14.0-1.el9.x86_64/vmlinux</code> provided through a specific <code class="literal">kernel-debuginfo</code> package.
							</li><li class="listitem"><p class="simpara">
								The actual vmcore file, for example <code class="literal">/var/crash/127.0.0.1-2021-09-13-14:05:33/vmcore</code>
							</p><p class="simpara">
								The resulting <code class="literal command">crash</code> command then looks like this:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bdnwmdw"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"><code class="literal command"># <span class="strong strong"><strong>crash /usr/lib/debug/lib/modules/5.14.0-1.el9.x86_64/vmlinux /var/crash/127.0.0.1-2021-09-13-14:05:33/vmcore</strong></span></code></pre></div></div><p class="simpara">
								Use the same <span class="emphasis"><em>&lt;kernel&gt;</em></span> version that was captured by <code class="literal">kdump</code>.
							</p><div class="example" id="idm139983843510560"><p class="title">Example 23.1. Running the crash utility</p><div class="example-contents"><p>
									The following example shows analyzing a core dump created on 
September 13 2021 at 14:05 PM, using the 5.14.0-1.el9.x86_64 kernel.
								</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--176taob"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">...
WARNING: kernel relocated [202MB]: patching 90160 gdb minimal_symbol values

      KERNEL: /usr/lib/debug/lib/modules/5.14.0-1.el9.x86_64/vmlinux
    DUMPFILE: /var/crash/127.0.0.1-2021-09-13-14:05:33/vmcore  [PARTIAL DUMP]
        CPUS: 2
        DATE: Mon Sep 13 14:05:16 2021
      UPTIME: 01:03:57
LOAD AVERAGE: 0.00, 0.00, 0.00
       TASKS: 586
    NODENAME: localhost.localdomain
     RELEASE: 5.14.0-1.el9.x86_64
     VERSION: #1 SMP Wed Aug 29 11:51:55 UTC 2018
     MACHINE: x86_64  (2904 Mhz)
      MEMORY: 2.9 GB
       PANIC: "sysrq: SysRq : Trigger a crash"
         PID: 10635
     COMMAND: "bash"
        TASK: ffff8d6c84271800  [THREAD_INFO: ffff8d6c84271800]
         CPU: 1
       STATE: TASK_RUNNING (SYSRQ)

crash&gt;</pre></div></div></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						To exit the interactive prompt and terminate <code class="literal application">crash</code>, type <code class="literal command">exit</code> or <code class="literal command">q</code>.
					</p><div class="example" id="idm139983841717760"><p class="title">Example 23.2. Exiting the crash utility</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3eo4ihv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crash&gt; <span class="strong strong"><strong>exit</strong></span>
~]#</pre></div></div></div></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal command">crash</code> command can also be 
used as a powerful tool for debugging a live system. However use it with
 caution so as not to break your system.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/206873">A Guide to Unexpected System Restarts</a>
					</li></ul></div></section><section class="section" id="displaying-various-indicators-in-the-crash-utility_analyzing-a-core-dump"><div class="titlepage"><div><div><h2 class="title">23.3. Displaying various indicators in the crash utility</h2></div></div></div><p class="_abstract _abstract">
				Use the <code class="literal">crash</code> utility to display 
various indicators, such as a kernel message buffer, a backtrace, a 
process status, virtual memory information and open files.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Displaying the message buffer</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To display the kernel message buffer, type the <code class="literal command">log</code> command at the interactive prompt as displayed in the example below:
								</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nfzzx1w"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crash&gt; <span class="strong strong"><strong>log</strong></span>
<span class="strong strong"><strong>... several lines omitted ...</strong></span>
EIP: 0060:[&lt;c068124f&gt;] EFLAGS: 00010096 CPU: 2
EIP is at sysrq_handle_crash+0xf/0x20
EAX: 00000063 EBX: 00000063 ECX: c09e1c8c EDX: 00000000
ESI: c0a09ca0 EDI: 00000286 EBP: 00000000 ESP: ef4dbf24
 DS: 007b ES: 007b FS: 00d8 GS: 00e0 SS: 0068
Process bash (pid: 5591, ti=ef4da000 task=f196d560 task.ti=ef4da000)
Stack:
 c068146b c0960891 c0968653 00000003 00000000 00000002 efade5c0 c06814d0
&lt;0&gt; fffffffb c068150f b7776000 f2600c40 c0569ec4 ef4dbf9c 00000002 b7776000
&lt;0&gt; efade5c0 00000002 b7776000 c0569e60 c051de50 ef4dbf9c f196d560 ef4dbfb4
Call Trace:
 [&lt;c068146b&gt;] ? __handle_sysrq+0xfb/0x160
 [&lt;c06814d0&gt;] ? write_sysrq_trigger+0x0/0x50
 [&lt;c068150f&gt;] ? write_sysrq_trigger+0x3f/0x50
 [&lt;c0569ec4&gt;] ? proc_reg_write+0x64/0xa0
 [&lt;c0569e60&gt;] ? proc_reg_write+0x0/0xa0
 [&lt;c051de50&gt;] ? vfs_write+0xa0/0x190
 [&lt;c051e8d1&gt;] ? sys_write+0x41/0x70
 [&lt;c0409adc&gt;] ? syscall_call+0x7/0xb
Code: a0 c0 01 0f b6 41 03 19 d2 f7 d2 83 e2 03 83 e0 cf c1 e2 04 09 d0 88 41 03 f3 c3 90 c7 05 c8 1b 9e c0 01 00 00 00 0f ae f8 89 f6 &lt;c6&gt; 05 00 00 00 00 01 c3 89 f6 8d bc 27 00 00 00 00 8d 50 d0 83
EIP: [&lt;c068124f&gt;] sysrq_handle_crash+0xf/0x20 SS:ESP 0068:ef4dbf24
CR2: 0000000000000000</pre></div></div><p class="simpara">
							Type <code class="literal command">help log</code> for more information about the command usage.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The kernel message buffer includes the most essential 
information about the system crash and, as such, it is always dumped 
first in to the <code class="literal">vmcore-dmesg.txt</code> file. This is useful when an attempt to get the full <code class="literal">vmcore</code> file failed, for example because of lack of space on the target location. By default, <code class="literal">vmcore-dmesg.txt</code> is located in the <code class="literal">/var/crash/</code> directory.
							</p></div></div></dd><dt><span class="term">Displaying a backtrace</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To display the kernel stack trace, use the <code class="literal command">bt</code> command.
								</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--aml6eaa"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crash&gt; <span class="strong strong"><strong>bt</strong></span>
PID: 5591   TASK: f196d560  CPU: 2   COMMAND: "bash"
 #0 [ef4dbdcc] crash_kexec at c0494922
 #1 [ef4dbe20] oops_end at c080e402
 #2 [ef4dbe34] no_context at c043089d
 #3 [ef4dbe58] bad_area at c0430b26
 #4 [ef4dbe6c] do_page_fault at c080fb9b
 #5 [ef4dbee4] error_code (via page_fault) at c080d809
    EAX: 00000063  EBX: 00000063  ECX: c09e1c8c  EDX: 00000000  EBP: 00000000
    DS:  007b      ESI: c0a09ca0  ES:  007b      EDI: 00000286  GS:  00e0
    CS:  0060      EIP: c068124f  ERR: ffffffff  EFLAGS: 00010096
 #6 [ef4dbf18] sysrq_handle_crash at c068124f
 #7 [ef4dbf24] __handle_sysrq at c0681469
 #8 [ef4dbf48] write_sysrq_trigger at c068150a
 #9 [ef4dbf54] proc_reg_write at c0569ec2
#10 [ef4dbf74] vfs_write at c051de4e
#11 [ef4dbf94] sys_write at c051e8cc
#12 [ef4dbfb0] system_call at c0409ad5
    EAX: ffffffda  EBX: 00000001  ECX: b7776000  EDX: 00000002
    DS:  007b      ESI: 00000002  ES:  007b      EDI: b7776000
    SS:  007b      ESP: bfcb2088  EBP: bfcb20b4  GS:  0033
    CS:  0073      EIP: 00edc416  ERR: 00000004  EFLAGS: 00000246</pre></div></div><p class="simpara">
							Type <code class="literal command">bt <span class="emphasis"><em>&lt;pid&gt;</em></span></code> to display the backtrace of a specific process or type <code class="literal command">help bt</code> for more information about <code class="literal command">bt</code> usage.
						</p></dd><dt><span class="term">Displaying a process status</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To display the status of processes in the system, use the <code class="literal command">ps</code> command.
								</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ylizyk1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crash&gt; <code class="literal command"><span class="strong strong"><strong>ps</strong></span></code>
   PID    PPID  CPU   TASK    ST  %MEM     VSZ    RSS  COMM
&gt;     0      0   0  c09dc560  RU   0.0       0      0  [swapper]
&gt;     0      0   1  f7072030  RU   0.0       0      0  [swapper]
      0      0   2  f70a3a90  RU   0.0       0      0  [swapper]
&gt;     0      0   3  f70ac560  RU   0.0       0      0  [swapper]
      1      0   1  f705ba90  IN   0.0    2828   1424  init
<span class="strong strong"><strong>... several lines omitted ...</strong></span>
   5566      1   1  f2592560  IN   0.0   12876    784  auditd
   5567      1   2  ef427560  IN   0.0   12876    784  auditd
   5587   5132   0  f196d030  IN   0.0   11064   3184  sshd
&gt;  5591   5587   2  f196d560  RU   0.0    5084   1648  bash</pre></div></div><p class="simpara">
							Use <code class="literal command">ps <span class="emphasis"><em>&lt;pid&gt;</em></span></code> to display the status of a single specific process. Use <span class="emphasis"><em>help ps</em></span> for more information about <code class="literal command">ps</code> usage.
						</p></dd><dt><span class="term">Displaying virtual memory information</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To display basic virtual memory information, type the <code class="literal command">vm</code> command at the interactive prompt.
								</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--kgd36wv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crash&gt; <span class="strong strong"><strong>vm</strong></span>
PID: 5591   TASK: f196d560  CPU: 2   COMMAND: "bash"
   MM       PGD      RSS    TOTAL_VM
f19b5900  ef9c6000  1648k    5084k
  VMA       START      END    FLAGS  FILE
f1bb0310    242000    260000 8000875  /lib/ld-2.12.so
f26af0b8    260000    261000 8100871  /lib/ld-2.12.so
efbc275c    261000    262000 8100873  /lib/ld-2.12.so
efbc2a18    268000    3ed000 8000075  /lib/libc-2.12.so
efbc23d8    3ed000    3ee000 8000070  /lib/libc-2.12.so
efbc2888    3ee000    3f0000 8100071  /lib/libc-2.12.so
efbc2cd4    3f0000    3f1000 8100073  /lib/libc-2.12.so
efbc243c    3f1000    3f4000 100073
efbc28ec    3f6000    3f9000 8000075  /lib/libdl-2.12.so
efbc2568    3f9000    3fa000 8100071  /lib/libdl-2.12.so
efbc2f2c    3fa000    3fb000 8100073  /lib/libdl-2.12.so
f26af888    7e6000    7fc000 8000075  /lib/libtinfo.so.5.7
f26aff2c    7fc000    7ff000 8100073  /lib/libtinfo.so.5.7
efbc211c    d83000    d8f000 8000075  /lib/libnss_files-2.12.so
efbc2504    d8f000    d90000 8100071  /lib/libnss_files-2.12.so
efbc2950    d90000    d91000 8100073  /lib/libnss_files-2.12.so
f26afe00    edc000    edd000 4040075
f1bb0a18   8047000   8118000 8001875  /bin/bash
f1bb01e4   8118000   811d000 8101873  /bin/bash
f1bb0c70   811d000   8122000 100073
f26afae0   9fd9000   9ffa000 100073
<span class="strong strong"><strong>... several lines omitted ...</strong></span></pre></div></div><p class="simpara">
							Use <code class="literal command">vm <span class="emphasis"><em>&lt;pid&gt;</em></span></code> to display information about a single specific process, or use <code class="literal command">help vm</code> for more information about <code class="literal command">vm</code> usage.
						</p></dd><dt><span class="term">Displaying open files</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									To display information about open files, use the <code class="literal command">files</code> command.
								</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pxldibm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">crash&gt; <code class="literal command"><span class="strong strong"><strong>files</strong></span></code>
PID: 5591   TASK: f196d560  CPU: 2   COMMAND: "bash"
ROOT: /    CWD: /root
 FD    FILE     DENTRY    INODE    TYPE  PATH
  0  f734f640  eedc2c6c  eecd6048  CHR   /pts/0
  1  efade5c0  eee14090  f00431d4  REG   /proc/sysrq-trigger
  2  f734f640  eedc2c6c  eecd6048  CHR   /pts/0
 10  f734f640  eedc2c6c  eecd6048  CHR   /pts/0
255  f734f640  eedc2c6c  eecd6048  CHR   /pts/0</pre></div></div><p class="simpara">
							Use <code class="literal command">files <span class="emphasis"><em>&lt;pid&gt;</em></span></code> to display files opened by only one selected process, or use <code class="literal command">help files</code> for more information about <code class="literal command">files</code> usage.
						</p></dd></dl></div></section><section class="section" id="using-kernel-oops-analyzer_analyzing-a-core-dump"><div class="titlepage"><div><div><h2 class="title">23.4. Using Kernel Oops Analyzer</h2></div></div></div><p class="_abstract _abstract">
				The Kernel Oops Analyzer tool analyzes the crash dump by comparing 
the oops messages with known issues in the knowledge base.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Secure an oops message to feed the Kernel Oops Analyzer.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Access the Kernel Oops Analyzer tool.
					</li><li class="listitem"><p class="simpara">
						To diagnose a kernel crash issue, upload a kernel oops log generated in <code class="literal">vmcore</code>.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Alternatively you can also diagnose a kernel crash issue by providing a text message or a <code class="literal">vmcore-dmesg.txt</code> as an input.
							</p><div class="informalfigure"><div class="mediaobject"><a href="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Managing_monitoring_and_updating_the_kernel-en-US/images/4aa73ecfc28ceef99ea1d2f7ffde1649/2KernelOopsAnalyzer.png" class="rh_docs--zoom" title="Kernel oops analyzer"><img src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/2KernelOopsAnalyzer.png" alt="Kernel oops analyzer"></a></div></div></li></ul></div></li><li class="listitem">
						Click <code class="literal">DETECT</code> to compare the oops message based on information from the <code class="literal command">makedumpfile</code> against known solutions.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/labs/kerneloopsanalyzer/">The Kernel Oops Analyzer</a> article
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/206873">A Guide to Unexpected System Restarts</a>
					</li></ul></div></section><section class="section" id="the-kdump-helper-tool_analyzing-a-core-dump"><div class="titlepage"><div><div><h2 class="title">23.5. The Kdump Helper tool</h2></div></div></div><p class="_abstract _abstract">
				The Kdump Helper tool helps to set up the <code class="literal">kdump</code>
 using the provided information. Kdump Helper generates a configuration 
script based on your preferences. Initiating and running the script on 
your server sets up the <code class="literal">kdump</code> service.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/labs/kdumphelper/wizard">Kdump Helper</a>
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm139983853182880"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span> 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat
 under a Creative Commons AttributionShare Alike 3.0 Unported license 
("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>.
 In accordance with CC-BY-SA, if you distribute this document or an 
adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to 
enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest
 extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat 
logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are 
trademarks of Red Hat, Inc., registered in the United States and other 
countries.
	</div><div class="para">
		<span class="trademark">Linux</span> is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span> is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span> is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span> is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span> is an official trademark of 
Joyent. Red Hat is not formally related to or endorsed by the official 
Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span> Word Mark and OpenStack 
logo are either registered trademarks/service marks or 
trademarks/service marks of the OpenStack Foundation, in the United 
States and other countries and are used with the OpenStack Foundation's 
permission. We are not affiliated with, endorsed or sponsored by the 
OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div>


  <nav class="pvof-doc__book-nav">
  <ol class="book-nav__list">
              </ol>
</nav>


          </div>
              </div>
              <div id="comments-footer" class="book-comments">
          

  

        </div>
          </div>
  </article>
<meta itemscope="" itemref="md1">



    </div>
      <!-- CP_PRIMER_FOOTER -->            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto affix-top" href="#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com/">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path class="rh-logo-hat" d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"></path>
                      <path class="rh-logo-band" d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"></path>
                      <path class="rh-logo-type" d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"></path>
                  </svg>
                </a>
              </div>

              <div role="navigation" aria-label="quick">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                      <li><a class="manage-subscriptions" href="https://access.redhat.com/management">Subscriptions</a></li>
                      <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                      <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                      <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="help">
                  <h3>Help</h3>
                  <ul>
                      <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                      <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                      <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="site">
                  <h3>Site Info</h3>
                  <ul>
                      <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                      <li><a class="browser-support-policy" href="https://www.redhat.com/en/about/browser-support">Browser Support Policy</a></li>
                      <li><a class="accessibility" href="https://www.redhat.com/en/about/digital-accessibility">Accessibility</a></li>
                      <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                      <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="other">
                  <h3>Related Sites</h3>
                  <ul>
                      <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                      <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                      <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                      <li><a href="https://cloud.redhat.com/" class="cloud-com">cloud.redhat.com</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="about">
                  <h3>About</h3>
                  <ul>
                      <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                      <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                      <li><a href="http://jobs.redhat.com/" class="about-jobs">Red Hat Jobs</a></li>
                  </ul>
              </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a href="https://status.redhat.com/" class="status-page-widget">
                        <span class="status-description">All systems operational</span>
                        <span class="status-dot shape-circle shape-dash-lime"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright  2023 Red Hat, Inc.</div>

                        <div role="navigation" aria-label="legal" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://www.redhat.com/en/about/terms-use" class="terms-of-use">Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                                <li><a id="teconsent" consent="0,1,2"><a role="link" id="icon-id010549507267107272" tabindex="0" aria-haspopup="dialog" aria-label="Cookie Preferences, opens a dedicated popup modal window" class="truste_cursor_pointer" lang="en">Cookie preferences</a></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                        <img src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh-summit-red-a.svg" alt="Red Hat Summit"> <span class="offscreen">Red Hat Summit</span>
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHat" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>                        
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- TrustArc -->
    <div id="consent_blackbar"></div> 
    <!--googleon: all-->
</div>
<!-- /CP_PRIMER_FOOTER -->


  </div>

    
  

<script>_satellite["_runScript2"](function(event, target, Promise) {
window._sdi=window._sdi||{},window._sdi.addEventHandler=window.addEventListener?function(e,i,t){e.addEventListener(i,t,!1)}:function(e,i,t){e.attachEvent("on"+i,t)},window._sdi.addEventHandler(window,"message",(function(e){var i={},t=0;(-1!==e.origin.indexOf("loop=1")||e.srcElement&&e.srcElement.playerOptions&&1==e.srcElement.playerOptions.loop)&&(t=1);var a=0;if(e.srcElement&&e.srcElement.playerOptions&&1==e.srcElement.playerOptions.autoplay&&(a=1),e.origin.match(/youtube\.com/)&&"undefined"!=typeof JSON&&!t&&!a){i=JSON.parse(e.data);var n=window._sdi.yt.videos;if("infoDelivery"==i.event){var d,o={};for(var r in i.info.videoData&&((o=n[d=i.info.videoData.video_id]||{}).info=i.info,o.id=i.id,n[d]=o),window._sdi.yt.videos){(c=window._sdi.yt.videos[r]).id==i.id&&(o=c)}var s=window._sdi.yt.sc||{};o.info&&(Math.abs(i.info.currentTime-o.info.currentTime)>1.5&&!0===s.track&&(s.s().Media.stop(o.info.videoData.title,o.info.currentTime),"paused"!=o.state&&s.s().Media.play(o.info.videoData.title,i.info.currentTime)),o.info.currentTime=i.info.currentTime),2==i.info.playerState&&(s.s().Media.stop(o.info.videoData.title,o.info.currentTime),o.state="paused"),1==i.info.playerState&&(o.started?!0===s.track&&s.s().Media.play(o.info.videoData.title,o.info.currentTime):(o.started=!0,!0===s.track&&(s.s().Media.open(o.info.videoData.title,o.info.duration,"youtube"),s.s().Media.play(o.info.videoData.title,o.info.currentTime))),o.state="playing"),3==i.info.playerState&&o.started&&(!0===s.track&&s.s().Media.stop(o.info.videoData.title,o.info.currentTime),o.state="paused"),0===i.info.playerState&&(!0===s.track&&(s.s().Media.stop(o.info.videoData.title,o.info.currentTime),s.s().Media.close(o.info.videoData.title)),o.state="completed")}else if("onStateChange"==i.event){for(var r in window._sdi.yt.videos){var c;(c=window._sdi.yt.videos[r]).id==i.id&&(o=c)}s=window._sdi.yt.sc||{};1==i.info&&(o.started?!0===s.track&&s.s().Media.play(o.info.videoData.title,o.info.currentTime):(o.started=!0,!0===s.track&&(s.s().Media.open(o.info.videoData.title,o.info.duration,"youtube"),"paused"!=o.state&&s.s().Media.play(o.info.videoData.title,i.info.currentTime))),o.state="playing"),2==i.info&&(!0===s.track&&s.s().Media.stop(o.info.videoData.title,o.info.currentTime),o.state="paused"),3==i.info&&o.started&&(!0===s.track&&s.s().Media.stop(o.info.videoData.title,o.info.currentTime),o.state="paused"),0===i.info&&(!0===s.track&&(s.s().Media.stop(o.info.videoData.title,o.info.currentTime),s.s().Media.close(o.info.videoData.title)),o.state="completed")}}})),window._sdi.loadScript=function(e,i){var t=document.createElement("script");t.type="text/javascript",i&&"function"==typeof i&&(t.readyState?t.onreadystatechange=function(){"loaded"!==t.readyState&&"complete"!==t.readyState||(t.onreadystatechange=null,i())}:t.onload=function(){i()}),t.src=e,document.getElementsByTagName("head")[0].appendChild(t)},window._sdi.yt={stages:{},players:{},sc:{track:!0,s:function(){return window.s}},init:function(){for(var e=document.getElementsByTagName("script"),i=!1,t=(window._sdi.yt.videos,0);t<e.length;t++){(e[t].src||"").match(/youtube\.com\/iframe_api/)&&(i=!0)}!1===i?window._sdi.loadScript("//www.youtube.com/iframe_api",(function(){window._sdi.yt.ready("api")})):window._sdi.yt.ready("api")},ready:function(e){window._sdi.yt.stages[e]=!0,window._sdi.yt.stages.dom&&window._sdi.yt.stages.api&&window._sdi.yt.checkIframes()},checkIframes:function(){var e=window._sdi.yt.videos,i=1e3,t=0;document.querySelectorAll("iframe[src*=youtube][data-sdiyt]").forEach((a=>{if("true"==a.dataset.sdiyt)return!1;if(-1!=a.src.indexOf("loop=1"))var n=null;else{var d;n=a.src.match(/h?t?t?p?s?\:?\/\/www\.youtube(-nocookie)?\.com\/embed\/([\w-]{11})(?:\?.*)?/)}if(n){d=n.length>2?n[2]:"",a.id||(a.id=d+t,t++);var o=!1;if(a.src.match(/enablejsapi=1/)||(a.src+=(a.src.indexOf("?")>-1?"&":"?")+"enablejsapi=1",o=!0),o){var r=a.cloneNode(!0);r.src=a.src,r.id=a.id,a.replaceWith(r)}else"undefined"!=typeof YT&&void 0!==YT.get?(ready=!0,e[d]={},(!YT.get(a.id)||void 0===YT.get(a.id).v&&void 0!==YT.get(a.id).v.videoId)&&(e[d].player=new YT.Player(a.id,{events:{onReady:function(){},onStateChange:function(){},videoId:a.id}})),a.setAttribute("data-sdiyt","true")):i=100}})),setTimeout((function(){window._sdi.yt.checkIframes()}),i)},videos:{}},void 0!==window._sdi&&void 0!==window._sdi.addEventHandler&&window._sdi.addEventHandler(window,"load",(function(){document.querySelectorAll('iframe[src*="youtube"]').length>=1?(window._sdi.yt.init(),window._sdi.yt.ready("dom")):window._sdi.ytinterval=setInterval((function(){document.querySelectorAll('iframe[src*="youtube"]').length>=1&&(window._sdi.yt.init(),window._sdi.yt.ready("dom"),clearInterval(window._sdi.ytinterval))}),500)}));
});</script><script>_satellite["_runScript3"](function(event, target, Promise) {
var dataLayerName="appEventData",reservedAttributes=["event"],internalDomains=[],downloadExtensions=["doc","docx","eps","jpg","png","svg","xls","ppt","pptx","pdf","xlsx","tab","csv","zip","txt","vsd","vxd","xml","js","css","rar","exe","wma","mov","avi","wmv","mp3","wav","m4v"],parseAttributes=function(t){var e={};for(var n in t.dataset)if("analytics"===n.substr(0,9)){var a=n.replace("analytics","");e[a[0]?a[0].toLocaleLowerCase()+a.slice(1):""]=t.dataset[n]}return e},addAttributes=function(t,e){return isJavascript(t)&&(e.isJavascript=!0),isDownload(t)&&(e.isDownload=!0),isCrossPropertyDomain(t)&&(e.isCrossPropertyDomain=!0,e.linkTypeName="cross property link"),isCta(t)&&(e.isCta=!0,e.linkTypeName="cta link"),isExitLink(t)&&(e.isExitLink=!0,e.linkTypeName="exit link"),isFooter(t)&&(e.isFooter=!0),isInternalCampaign(t)&&(e.isInternalCampaign=!0),isPromoSection(t)&&(e.isPromoSection=!0),isSearchContainer(t)&&(e.isSearchContainer=!0),e.targetHost=getHostName(t.href),e.internalCampaign=window._sdi.util.getQueryParam("icid",t.href)||window._sdi.util.getQueryParam("intcmp",t.href),e},getLinkText=function(t){return t.getAttribute("data-analytics-text")||t.getAttribute("sObjectId")||t.getAttribute("s-object-id")||t.getAttribute("sObjectID")||t.getAttribute("data-s-object-id")||t.innerText&&""!==t.innerText.trim()&&t.innerText.trim()||t.textContent&&""!==t.textContent.trim()&&t.textContent.trim()||t.querySelector("[alt]")&&t.querySelector("[alt]").getAttribute("alt")||t.querySelector("[title]")&&t.querySelector("[title]").getAttribute("title")||t.getAttribute("aria-label")||t.href||"unknown"},getRegions=function(t,e){if(e=e||[],!t)return e;var n=t.closest("[data-analytics-region]");return n?(e.push(n.dataset.analyticsRegion),e=getRegions(n.parentElement,e)):e},removeReservedAttributes=function(t){return reservedAttributes.forEach((function(e){delete t[e]})),t},redactEmail=function(t){return t.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,6}/gi,"email_address_redacted")},buildDataObject=function(t,e,n){return n=n||getRegions(t),{event:buildEventName(t,e,n),linkInfo:Object.assign({href:t.href,regions:n.reverse().join("|"),text:redactEmail(getLinkText(t))},removeReservedAttributes(e))}},buildEventName=function(t,e,n){if(e.event)return e.event;var a={};if(n=n||getRegions(t))for(var i=0;i<n.length;i++)if(a[n[i]])return a[n[i]];return"Master Link Clicked"},findRootElement=function(t){if(t)return t.closest("a, [data-analytics-event]")},isJavascript=function(t){return new RegExp("^javascript:","i").test(t.href)},isDownload=function(t){return new RegExp(".("+downloadExtensions.join("|")+")$","i").test(t.href)},isInternalDomain=function(t){return new RegExp(internalDomains.join("|"),"i").test(t.href)},isExitLink=function(t){return!!t.href&&!new RegExp(_satellite.getVar("exitExclusionArray").join("|"),"i").test(t.href)},isCrossPropertyDomain=function(t){return document.location.hostname!==getHostName(t.href)&&"access.cdn.redhat.com"!==getHostName(t.href)&&new RegExp(_satellite.getVar("redHatDomains").join("|"),"i").test(getHostName(t.href))},isCta=function(t){return!(!t.classList.contains("cta-primary")&&"primary"!=t.getAttribute("data-rh-cta-type")&&"primary"!=t.getAttribute("data-ux-cta-type"))},isTab=function(t){return!!(t.classList.contains('[data-toggle="tab"]')||t.classList.contains("pfe-accordion-header")||t.classList.contains('[role="tab"]')||t.classList.contains("ux-vtab-nav-link")||t.classList.contains("ux-tile-nav-link")||t.classList.contains("btn-brick")||t.classList.contains("ux-htab-nav-link")||t.classList.contains("ux-horizontal-tab-nav-link")||t.classList.contains("ux-oss-hub-filter-type-text")||t.classList.contains("ux-htabb-nav-link")||"tab"==t.getAttribute("data-toggle")||"PFE-ACCORDION-HEADER"==t.tagName||"tab"==t.getAttribute("role"))},isFooter=function(t){return el=t.closest("footer"),"undefined"!=typeof el&&null!=el},isInternalCampaign=function(t){return(""!=window._sdi.util.getQueryParam("icid",t.href)||""!=window._sdi.util.getQueryParam("intcmp",t.href))&&(linkRole=t.getAttribute("role")||"",_satellite.logger.log("isInternalCampaign: linkRole:",linkRole),"tab"!==linkRole||void 0)},isPromoSection=function(t){return el=t.closest("div.band-hero"),"undefined"!=typeof el&&null!=el},isSearchContainer=function(t){return _satellite.logger.log("isSearchContainer ran"),el=t.closest("div.cp-sidebar")||t.closest("div.cp-search-results"),_satellite.logger.log("isSearchContainer el",el),_satellite.logger.log("isSearchContainer return","undefined"!=typeof el&&null!=el&&document.location.href.indexOf("search")>-1),"undefined"!=typeof el&&null!=el&&document.location.href.indexOf("search")>-1},getHostName=function(e){return t=document.createElement("a"),t.href=e,t.hostname},pushEvent=function(t){window.appEventData=window.appEventData||[],console.info("Pushing to the dataLayer",t);var e=window[dataLayerName];Array.isArray(e)&&e.push(t)};window.analyticsHelper=window.analyticsHelper||{},window.analyticsHelper.parseCustomEvent=function(t,e,n){_satellite.logger.log("target:",t);var a=parseAttributes(t),i=null,r=getRegions(t);if(e)i=e.closest("[data-analytics-region]");else{var s=t.getRootNode();s&&s.host&&(i=t.getRootNode().host.closest("[data-analytics-region]"))}i&&(r=r.concat(getRegions(i))),"expand"===n&&r.includes("mega menu")&&(a.event="Mega Menu Expanded"),"expand"===n&&r.includes("site-switcher")&&(a.event="Site Switcher Expanded"),"true"!==a.istab&&"true"!==a.isTab||(a.event="Tab Link Clicked",tabHref=t.getAttribute("href")||getLinkText(t)||"",tabHref=tabHref.trim(),a.tabHref=tabHref),_satellite.logger.log("attributes",a),_satellite.logger.log("event type",n),_satellite.logger.log("regions",r),a=addAttributes(t,a);var o=buildDataObject(t,a,r);o.event&&pushEvent(o)};var clickHandler=function(t){if(!(t.target&&t.target.tagName&&t.target.tagName.indexOf("-")>0)){var e=findRootElement(t.target);if(e){var n=parseAttributes(e);isTab(e)&&(n.event="Tab Link Clicked",tabHref=e.getAttribute("href")||getLinkText(e)||"",tabHref=tabHref.trim(),n.tabHref=tabHref),n=addAttributes(e,n);var a=buildDataObject(e,n);a.event&&pushEvent(a)}}};document.addEventListener("click",clickHandler,!0),document.addEventListener("pfe-tabs:shown-tab",(function(t){if(window.analyticsHelper&&"function"==typeof window.analyticsHelper.parseCustomEvent){var e=t.target.closest("pfe-content-set")||t.target.closest("pfe-tabs"),n=null;if(e){if("PFE-CONTENT-SET"===e.tagName){var a=t.detail.tab.querySelector("slot");if(a)(n=e.getSlot(a.getAttribute("name")))&&(n=e.getSlot(t.detail.tab.querySelector("slot").getAttribute("name"))[0])}else n=t.detail.tab;n?(n.setAttribute("data-analytics-isTab","true"),_satellite.logger.info("Called pfe-tabs:shown-tab:parseCustomEvent clicked"),window.analyticsHelper.parseCustomEvent(n,e,"clicked")):console.warn("Wasn't able to find the tabTextWrapper")}else console.warn("Wasn't able to find the componentParent")}})),document.addEventListener("pfe-accordion:change",(function(t){if(window.analyticsHelper&&"function"==typeof window.analyticsHelper.parseCustomEvent){var e=t.target.closest("pfe-content-set")||t.target.closest("pfe-accordion");if(t.detail.expanded){var n="PFE-ACCORDION-HEADER"===t.target.tagName?t.target:t.path[0];if(e&&"PFE-CONTENT-SET"===e.tagName){var a=n.querySelector("slot");if(a){var i=e.getSlot(a.getAttribute("name"));i&&i[0]&&(n=i[0])}}n&&n.setAttribute("data-analytics-isTab","true"),_satellite.logger.info("Called pfe-accordion:change:parseCustomEvent expand"),window.analyticsHelper.parseCustomEvent(n,e,"expand")}}})),document.addEventListener("pfe-shadow-dom-event",(function(t){window.analyticsHelper&&"function"==typeof window.analyticsHelper.parseCustomEvent&&window.analyticsHelper.parseCustomEvent(t.detail.target,t.detail.parentComponent,"click")})),document.addEventListener("pfe-navigation:expanded-item",(function(t){window.analyticsHelper&&"function"==typeof window.analyticsHelper.parseCustomEvent&&window.analyticsHelper.parseCustomEvent(t.detail.toggle,t.target,"expand")}));
});</script><div id="ZN_bCxD2jjWRr4bfVQ"></div><script type="text/javascript" src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/Untitled.js"></script><script src="Managing,%20monitoring,%20and%20updating%20the%20kernel%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/CoreModule.js" defer="defer"></script><script>_satellite["_runScript4"](function(event, target, Promise) {
_satellite.getVar("eloqua_Tag");
});</script><script>_satellite["_runScript5"](function(event, target, Promise) {
var body=document.body,html=document.documentElement,pageHeight=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight),viewportHeight=window.innerHeight,initialPercent=viewportHeight/pageHeight,maxInterval=0;initialPercent=initialPercent>1?100:Math.round(100*initialPercent);var maxScroll=Math.floor(initialPercent);_satellite.cookie.set("sat_ppv",maxScroll,{domain:".redhat.com"});var ticking=!1,s=window.scrollY;document.addEventListener("scroll",(()=>{ticking||(window.requestAnimationFrame((()=>{var t=document.body,e=document.documentElement;s=window.scrollY;var i=Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight),o=window.innerHeight,l=s/(i-o)*100;l>maxScroll&&(maxScroll=Math.floor(l)),_satellite.cookie.set("sat_ppv",maxScroll,{domain:".redhat.com"}),ticking=!1})),ticking=!0)}),{passive:!0});
});</script><script>
if("yes"==_satellite.getVar("tagsAllowedFunc")){var profileID=_satellite.getVar("profileID")||"";if(profileID)try{!function(e){!function(t,n,i,a,o){var c,l,r,f,s;for((o=t[a]=t[a]||{})._q=[],l=0,r=(c=["initialize","identify","updateOptions","pageLoad"]).length;l<r;++l)!function(e){o[e]=o[e]||function(){o._q[e===c[0]?"unshift":"push"]([e].concat([].slice.call(arguments,0)))}}(c[l]);(f=n.createElement(i)).async=!0,f.src="https://cdn.pendo.io/agent/static/"+e+"/pendo.js",(s=n.getElementsByTagName(i)[0]).parentNode.insertBefore(f,s)}(window,document,"script","pendo"),setTimeout((function(){"undefined"!=typeof pendo&&pendo.initialize({visitor:{id:_satellite.getVar("profileID"),internal:"",lang:""},account:{id:_satellite.getVar("accountID"),account_number:_satellite.getVar("accountID")}})}),2e3)}("f210c485-387f-43ad-4eee-f55bab22507f")}catch(e){}}
</script></body></html>