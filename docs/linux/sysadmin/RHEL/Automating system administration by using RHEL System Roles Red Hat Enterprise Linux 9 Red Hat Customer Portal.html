<!DOCTYPE html>
<html dir="ltr" prefix="og: https://ogp.me/ns#" class=" js supports cssanimations flexbox csstransforms csstransforms3d" style="" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style>body {transition: opacity ease-in 0.2s; } 
body[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } 
</style><style type="text/css">.truste_cursor_pointer {cursor: pointer;}.truste_border_none {border: none;}</style>
    <meta charset="utf-8">
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<meta property="og:site_name" content="Red Hat Customer Portal">
<meta property="og:type" content="article">
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<meta property="og:title" content="Automating system administration by using RHEL System Roles Red Hat Enterprise Linux 9 | Red Hat Customer Portal">
<meta property="og:description" content="The Red Hat Enterprise Linux (RHEL) System Roles are a collection of Ansible roles, modules, and playbooks that help automate the consistent and repeatable administration of RHEL systems. With RHEL System Roles, you can efficiently manage large inventories of systems by running configuration playbooks from a single system.">
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="The Red Hat Enterprise Linux (RHEL) System Roles are a collection of Ansible roles, modules, and playbooks that help automate the consistent and repeatable administration of RHEL systems. With RHEL System Roles, you can efficiently manage large inventories of systems by running configuration playbooks from a single system.">
<meta name="twitter:title" content="Automating system administration by using RHEL System Roles Red Hat Enterprise Linux 9 | Red Hat Customer Portal">
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<meta name="twitter:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png">
<meta name="title" content="Automating system administration by using RHEL System Roles Red Hat Enterprise Linux 9 | Red Hat Customer Portal">
<link rel="alternate" hreflang="en" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="ko" href="https://access.redhat.com/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="zh-hans" href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="ja" href="https://access.redhat.com/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="es" href="https://access.redhat.com/documentation/es-es/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="ru" href="https://access.redhat.com/documentation/ru-ru/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="pt-br" href="https://access.redhat.com/documentation/pt-br/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="it" href="https://access.redhat.com/documentation/it-it/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="de" href="https://access.redhat.com/documentation/de-de/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="fr" href="https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<link rel="alternate" hreflang="zh-hant" href="https://access.redhat.com/documentation/zh-tw/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)">
<meta name="MobileOptimized" content="width">
<meta name="HandheldFriendly" content="true">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="revision" product="0ad2e1c5-8cc7-4fb9-8e05-1c2d8c07d005" title="3aa9e5f3-aed2-44a8-a43e-3e0c17114a85" page="6ac19fc8-9d3d-4dd5-974a-3c0196a8ca8a" revision="a1d6f776a474db605bfb9204eeda3a8d91a6d5f1:en-us" body="40ef5fb7f2890e73fbe186a6758f6dfb.html" toc="32cb6e0446dc6976aef1b06eba429589.json">

    <title>Automating system administration by using RHEL System Roles Red Hat Enterprise Linux 9 | Red Hat Customer Portal</title>
    <link rel="stylesheet" media="all" href="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/css_87GMcmxT1ib8ziQiU2KUAnTDFtZQV6iP-KGslA9LigM.css">
<link rel="stylesheet" media="all" href="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/css__Xq4GfgPDJw9K_yYJFmlRZGJeCENu3R3r4s0K7Tr_9g.css">

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"documentation\/en-us\/red_hat_enterprise_linux\/9\/html-single\/automating_system_administration_by_using_rhel_system_roles\/index","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"red_hat_jwt":{"client_id":"customer-portal","cookie_name":"rh_jwt","leeway":"0","realm":"redhat-external","sso_host":"https:\/\/sso.redhat.com\/","user_integration":1,"user_plugin":"drupal_user_auth","use_external_js":0,"use_internal_js":0,"use_in_admin":0},"user":{"uid":0,"permissionsHash":"e301988aec96403b7b03860ee81161237ee18c188536caa2bfab8701012b505e"}}</script>
<script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/js_EQWKo9EokWkWS99x_e1oM-NEM0zlKyTkp_83mGdm5Ks.js"></script>

    <!-- CP_PRIMER_HEAD -->  <!-- TrustArc & DTM -->
  <script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/trustarc.js"></script><script type="text/javascript" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/notice" id="truste_0.30287038108378683"></script>
  <script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/dtm.js"></script><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/AppMeasurement.min.js" async=""></script><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/AppMeasurement_Module_ActivityMap.min.js" async=""></script><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/AppMeasurement_Module_AudienceManagement.min.js" async=""></script><script id="mktgJS" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh.mktg.js"></script><script>_satellite["_runScript1"](function(event, target, Promise) {
var targetWaitAttempts = 0;

var awaitBody = function(offer){
	//mbox call has returned, ensure <body> exists, then add the mbox DIV
	var docBody  = document.getElementsByTagName("body"),
		int_mbox;
	if(docBody.length){
		int_mbox = document.createElement("div");
		docBody = docBody[0];
		int_mbox.id = "int_mbox";
		int_mbox.classList.add("mboxDefault");
		int_mbox.style.display = "none";
		//place mbox DIV as first tag within BODY
		docBody.insertBefore(int_mbox, docBody.firstChild);
	
		//now that receiving DIV is in place, inject the offer code
		adobe.target.applyOffer({
			"mbox": "int_mbox",
			"selector": "#int_mbox",
			"offer": offer
		});
	
		//and then un-hide the mbox DIV
		int_mbox.style.display = "block";
	}else{
		setTimeout(function(){awaitBody(offer)},100);
	}
}

var awaitTarget = function(){
	if (typeof adobe !== "undefined" && typeof adobe.target !== "undefined" && typeof adobe.target.getOffer !== "undefined") {
		//First get the mbox call going out
		adobe.target.getOffer({
			"mbox": "int_mbox",
			"success": function(offer) {
				awaitBody(offer);
			},
			// Handle errors gracefully
			"error": function(status, error) {}
		});
	}else{
		if(++targetWaitAttempts < 50){
			setTimeout(awaitTarget,100);
		}
	}
}
awaitTarget();
});</script><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/v1.7-920" async="async" crossorigin="" importance="high"></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="dxp-kbase-prod-138-57cf79cd99-wkvtp">
<meta name="avalon-version" content="eb0593bd">
<meta name="cp-chrome-build-date" content="2023-09-01T18:06:20.591Z">

<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml">
<!-- title -->
<title>Red Hat Customer Portal - Access to 24x7 support and knowledge</title>
<!-- /title -->
<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en", 
        version   : "eb0593bd",
        builddate : "2023-09-01T18:06:20.591Z",        fetchdate : "2023-09-03T14:30:08-0400",        nrid      : "NOLONGERSUPPORTED",
        nrlk      : "NOLONGERSUPPORTED"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="https://access.redhat.com/webassets/avalon/g/favicon.ico"><link media="all" rel="stylesheet" type="text/css" href="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/bootstrap.css">
<link media="all" rel="stylesheet" type="text/css" href="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/bootstrap-grid.css">
<link media="all" rel="stylesheet" type="text/css" href="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/main.css">



<link href="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/chosen.css" rel="stylesheet" type="text/css">

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]--><noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>
<link media="all" rel="stylesheet" type="text/css" href="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-navigation--lightdom.min.css">
<!-- /cssInclude -->
<script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/ie-polyfills.js"></script>

<script async="">
  if (!HTMLScriptElement.supports || !HTMLScriptElement.supports('importmap')) {
    import("https://www.redhatstatic.com/dx/v1-alpha/es-module-shims@1.7.3.js");
  }
</script>
<script type="importmap">
{
  "imports": {
    "@patternfly/elements/" : "https://www.redhatstatic.com/dx/v1-alpha/@patternfly/elements@2.2.2/",
    "@rhds/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/elements/",
    "@rhds/elements/lib/":"https://www.redhatstatic.com/dx/v1-alpha/@rhds/elements@1.1.0/lib/",
    "@cpelements/elements/":"https://www.redhatstatic.com/dx/v1-alpha/@cpelements/elements@2.0.0-alpha.7/elements/"
  }
}
</script><script type="text/javascript" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/require.js" data-main="/webassets/avalon/j/"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
<script type="text/javascript" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/new-nav.js"></script>
<!-- /CP_PRIMER_HEAD -->

  <script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RC89cb5efc622a491caa02ca11adc4672f-source.min.js" async=""></script><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RC4291db99e867433ca8496d298dca09cb-source.min.js" async=""></script><link href="data:text/css,%5Bid*%3D'google_ads_iframe'%5D%2C%5Bid*%3D'taboola-'%5D%2C.taboolaHeight%2C.taboola-placeholder%2C%23credential_picker_container%2C%23credentials-picker-container%2C%23credential_picker_iframe%2C%5Bid*%3D'google-one-tap-iframe'%5D%2C%23google-one-tap-popup-container%2C.google-one-tap-modal-div%2C%23amp_floatingAdDiv%2C%23ez-content-blocker-container%2C%23notify-adblock%7Bdisplay%3Anone!important%3Bmin-height%3A0!important%3Bheight%3A0!important%3B%7D" rel="stylesheet" type="text/css"><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/prompt.js"></script><script charset="utf-8" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/12.2158c5447122fa995560.chunk.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="https://access.redhat.com/webassets/avalon/j/lib/require-css/require.css.min.js" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/require.css.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="rhn-modal" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rhn-modal.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="status-widget" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/status-widget.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="avatars" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/avatars.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="cookie-monster" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/cookie-monster.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="pfe" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="wc" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/wc.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nimbus/searchbar" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/searchbar.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="webcomponentsjs/custom-elements-es5-adapter" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/custom-elements-es5-adapter.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="webcomponentsjs/webcomponents-bundle" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/webcomponents-bundle.js"></script><link rel="stylesheet" media="all" href="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh-table--lightdom.min.css"><script charset="utf-8" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/7.41dc96447e48575a0cfd.chunk.js"></script><script charset="utf-8" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/1.e4bb9861ae9a0d936559.chunk.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="data-action" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/data-action.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nimbus/tour" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/tour.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="introjs" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/introjs.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="moment" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/moment.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-icon/dist/pfe-icon.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-icon.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-cta/dist/pfe-cta.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-cta.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-avatar/dist/pfe-avatar.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-avatar.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/cp-search-autocomplete/dist/cp-search-autocomplete.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/cp-search-autocomplete.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/rh-site-switcher/dist/site-switcher.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/site-switcher.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/pfe-navigation/dist/pfe-navigation.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-navigation.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfelement/dist/pfelement.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfelement.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-autocomplete/dist/pfe-autocomplete.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-autocomplete.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-button/dist/pfe-button.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-button.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-primary-detail/dist/pfe-primary-detail.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-primary-detail.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/rh-table/dist/rh-table.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh-table.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="ieSVGfix" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/ieSVGfix.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@cpelements/rh-account-dropdown/dist/rh-account-dropdown.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh-account-dropdown.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="public_modules/@patternfly/pfe-clipboard/dist/pfe-clipboard.umd.min" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/pfe-clipboard.umd.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="prism" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/prism.js"></script><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RC1badf0bc400d462b892df3a5874c0bc4-source.min.js" async=""></script><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RCb1afac0346e94d81bf645b608336061e-source.min.js" async=""></script><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/RCa65a5b793a1a4b4abe76ffa69f30f470-source.min.js" async=""></script></head>
  <body class="en loggedOut">
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas="">
      <!-- CP_PRIMER_HEADER -->
<div id="page-wrap" class="page-wrap">
    <div id="pers-top-page-wrap" class="top-page-wrap pers-loader-bg">

      <div id="hero-bg-top-left" class="summit-bg-shapes"></div>
      <div id="hero-bg-top-right" class="summit-bg-shapes"></div>

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden">Skip to navigation</a>
            <a href="#doc-wrapper" class="skip-link visually-hidden">Skip to main content</a>            <nav id="portal-utility-nav" class="utility-navigation utility-navigation--bar hidden-at-mobile" data-analytics-region="utility" aria-labelledby="nav__utility-nav--desktop">
                <h3 id="nav__utility-nav--desktop" class="element-invisible">Utilities
                </h3>
                <ul aria-labelledby="nav__utility-nav--desktop">
                    <li id="nav-subscription" data-portal-tour-1="1">
                        <a class="top-nav-subscriptions" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Subscription" href="https://access.redhat.com/management/">Subscriptions
                        </a>
                    </li>
                    <li id="nav-downloads" data-portal-tour-1="2">
                        <a class="top-nav-downloads" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/">Downloads
                        </a>
                    </li>
                    <li id="nav-containers">
                        <a class="top-nav-containers" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/">Containers
                        </a>
                    </li>
                    <li id="nav-support" data-portal-tour-1="3">
                        <a class="top-nav-support-cases" data-analytics-level="2" data-analytics-category="Utilities" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/">Support Cases
                        </a>
                    </li>
                </ul>
            </nav>

            <pfe-navigation id="pfe-navigation" data-analytics-region="mega menu" pfelement="" class="PFElement pfe-navigation--processed pfe-navigation--has-search pfe-navigation--custom-dropdowns--processed" type="combo" has_search="" has_account="" breakpoint="desktop" lang="en">
                <div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper">
                    <a href="https://access.redhat.com/" class="pfe-navigation__logo-link" data-analytics-text="logo" data-analytics-category="MM|logo">
                        <img class="pfe-navigation__logo-image" alt="Red Hat Customer Portal" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/red-hat-customer-portal.svg">
                    </a>
                </div>

                <nav class="pfe-navigation" aria-label="Main Navigation" data-analytics-region="main nav">
                    <ul class="pfe-navigation__menu" id="pfe-navigation__menu">                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-subscription--mobile" data-portal-tour-1="1">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Subscription" href="https://access.redhat.com/management/">Subscriptions
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-downloads--mobile" data-portal-tour-1="2">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Downloads" href="https://access.redhat.com/downloads/">Downloads
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-containers--mobile">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Containers" href="https://catalog.redhat.com/software/containers/explore/">Containers
                            </a>
                        </li>
                        <li class="pfe-navigation__menu-item hidden-at-tablet hidden-at-desktop" id="nav-support--mobile" data-portal-tour-1="3">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Support Cases" href="https://access.redhat.com/support/cases/">Support Cases
                            </a>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Products and Services">Products &amp; Services
                            </a>
                            <div class="pfe-navigation__dropdown has-primary-detail">                                <div class="desktop-col-span-2 tablet-col-span-all">
                                    <h3>
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Products" href="https://access.redhat.com/products/">Products
                                        </a>
                                    </h3>
                                    <slot name="main-menu__dropdown--product__product-listing"></slot>
                                </div>                                <div>
                                    <h3 id="nav__products__support">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Support" href="https://access.redhat.com/support">Support
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__support">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Production Support" href="https://access.redhat.com/support/offerings/production/">Production Support
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Development Support" href="https://access.redhat.com/support/offerings/developer/">Development Support
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Support" data-analytics-text="Product Life Cycles" href="https://access.redhat.com/product-life-cycles/">Product Life Cycles
                                                    </a></li>
                                    </ul>

                                    <h3 id="nav__products__services">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Services" href="https://www.redhat.com/en/services">Services
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__services">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Consulting" href="https://www.redhat.com/en/services/consulting">Consulting
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Technical Account Management" href="https://access.redhat.com/support/offerings/tam/">Technical Account Management
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Services" data-analytics-text="Training and Certifications" href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__products__documentation">
                                        <a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Documentation" href="https://access.redhat.com/documentation">Documentation
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__products__documentation">
                                        <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform
                                                        </a></li>
                                    </ul>
                                    <pfe-cta pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Products and Services|Documentation" data-analytics-text="All Documentation" data-analytics-linktype="cta" href="https://access.redhat.com/documentation">All Documentation
                                        </a>
                                    </pfe-cta>

                                    <h3 id="nav__products__catalog"><a data-analytics-level="2" data-analytics-category="Products and Services" data-analytics-text="Ecosystem Catalog" href="https://catalog.redhat.com/">Ecosystem Catalog
                                        </a></h3>
                                        <ul aria-labelledby="nav__products__catalog">
                                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Red Hat Partner Ecosystem" href="https://access.redhat.com/ecosystem/">Red Hat Partner Ecosystem
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Products and Services|Ecosystem Catalog" data-analytics-text="Partner Resources" href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources
                                                    </a></li>
                                        </ul>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Tools" href="https://access.redhat.com/labs/">Tools
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__tools__tools" data-analytics-level="2" data-analytics-text="Tools" data-analytics-category="Tools">Tools
                                    </h3>
                                    <ul aria-labelledby="nav__tools__tools">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Solution Engine" href="https://access.redhat.com/support/cases/#/troubleshoot">Troubleshoot a product issue
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Packages" href="https://access.redhat.com/downloads/content/package-browser">Packages
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Tools" data-analytics-text="Errata" href="https://access.redhat.com/errata/">Errata
                                                    </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__tools__labs">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Customer Portal Labs" href="https://access.redhat.com/labs/">Customer Portal Labs
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__tools__labs">
                                        <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Configuration" href="https://access.redhat.com/labs/#!?type=config">Configuration
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Deployment" href="https://access.redhat.com/labs/#!?type=deploy">Deployment
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Security" href="https://access.redhat.com/labs/#!?type=security">Security
                                                    </a></li>                                                    <li><a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="Troubleshooting" href="https://access.redhat.com/labs/#!?type=troubleshoot">Troubleshoot
                                                        </a></li>
                                    </ul>
                                    <pfe-cta pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Tools|Customer Portal Labs" data-analytics-text="All Labs" data-analytics-linktype="cta" href="https://access.redhat.com/labs/">All labs
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h4 id="nav__tools__red-hat-insights">
                                        <a data-analytics-level="2" data-analytics-category="Tools" data-analytics-text="Red Hat Insights" href="https://www.redhat.com/en/technologies/management/insights">Red Hat Insights
                                        </a>
                                    </h4>
                                    <p>Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Learn more" href="https://www.redhat.com/en/technologies/management/insights">Learn More
                                    </a>
                                    <br>
                                    <a data-analytics-level="3" data-analytics-category="Tools|Red Hat Insights" data-analytics-text="Go to Insights" href="https://cloud.redhat.com/insights">Go to Insights
                                    </a>
                                </div>
                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Security" href="https://access.redhat.com/security/">Security
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="security__security-center">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Red Hat Product Security Center" href="https://access.redhat.com/security">Red Hat Product Security Center
                                        </a>
                                    </h3>
                                    <p>Engage with our Red Hat Product 
Security team, access security updates, and ensure your environments are
 not exposed to any known security vulnerabilities.
                                    </p>
                                    <pfe-cta pfe-priority="primary" priority="primary" pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Security|Red Hat Product Security Center" data-analytics-text="Product Security Center" data-analytics-linktype="cta" href="https://access.redhat.com/security/">Product Security Center
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__updates" data-analytics-level="2" data-analytics-text="Security Updates" data-analytics-category="Security">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Security Updates" href="https://access.redhat.com/security">Security Updates
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__updates">
                                        <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Advisories" href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Red Hat CVE Database" href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="Security Labs" href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs
                                                    </a></li>
                                    </ul>
                                    <p class="margin-top-xl">Keep your systems secure with Red Hat's specialized responses to security vulnerabilities.
                                    </p>
                                    <pfe-cta pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Security|Security Updates" data-analytics-text="View Responses" data-analytics-linktype="cta" href="https://access.redhat.com/security/vulnerability">View Responses
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__security__resources">
                                        <a data-analytics-level="2" data-analytics-category="Security" data-analytics-text="Resources" href="https://access.redhat.com/security/overview">Resources
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__security__resources">                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Blog" href="https://redhat.com/en/blog/channel/security">Security Blog
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Security Measurement" href="https://www.redhat.com/security/data/metrics/">Security Measurement
                                                    </a></li>
                                                    <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Severity Ratings" href="https://access.redhat.com/security/updates/classification/">Severity Ratings
                                                        </a></li>
                                                        <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Backporting Policies" href="https://access.redhat.com/security/updates/backporting/">Backporting Policies
                                                            </a></li>
                                                            <li><a data-analytics-level="3" data-analytics-category="Security|Resources" data-analytics-text="Product Signing (GPG) Keys" href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys
                                                                </a></li>
                                    </ul>
                                </div>

                            </div>
                        </li>                        <li class="pfe-navigation__menu-item">
                            <a href="https://access.redhat.com/community/" class="pfe-navigation__menu-link" data-analytics-level="1" data-analytics-text="Community">Community
                            </a>
                            <div class="pfe-navigation__dropdown pfe-navigation__dropdown--3-column">                                <div>
                                    <h3 id="nav__community__cp-community">
                                        <a href="https://access.redhat.com/community" data-analytics-level="2" data-analytics-text="Customer Portal Community" data-analytics-category="Community">Customer Portal Community
                                        </a>
                                    </h3>
                                    <ul aria-labelledby="nav__community__cp-community">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Discussions" href="https://access.redhat.com/discussions">Discussions
                                            </a></li>                                                <li><a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Private Groups" href="https://access.redhat.com/groups/">Private Groups
                                                    </a></li>
                                    </ul>

                                    <pfe-cta pfe-priority="primary" priority="primary" pfelement="" class="PFElement" has_link="">
                                        <a data-analytics-level="3" data-analytics-category="Community|Customer Portal Community" data-analytics-text="Community Activity" data-analytics-linktype="cta" href="https://access.redhat.com/community/">Community Activity
                                        </a>
                                    </pfe-cta>
                                </div>                                <div>
                                    <h3 id="nav__community__events" data-analytics-level="2" data-analytics-text="Customer Events" data-analytics-category="Community">Customer Events
                                    </h3>
                                    <ul aria-labelledby="nav__community__events">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Convergence" href="https://access.redhat.com/convergence/">Red Hat Convergence
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-category="Community|Customer Events" data-analytics-text="Red Hat Summit" href="http://www.redhat.com/summit/">Red Hat Summit
                                                </a></li>
                                    </ul>
                                </div>                                <div>
                                    <h3 id="nav__community__stories" data-analytics-level="2" data-analytics-text="Stories" data-analytics-category="Community">Stories
                                    </h3>
                                    <ul aria-labelledby="nav__community__stories">
                                        <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Red Hat Subscription Value" href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value
                                            </a></li>
                                            <li><a data-analytics-level="3" data-analytics-text="You Asked. We Acted." data-analytics-category="Community|Stories" href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.
                                                </a></li>
                                                <li><a data-analytics-level="3" data-analytics-category="Community|Stories" data-analytics-text="Open Source Communities" href="http://www.redhat.com/en/open-source">Open Source Communities
                                                    </a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>                </nav>                <div id="site-search" slot="search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <cp-search-autocomplete class="push-bottom PFElement" path="/webassets/avalon/j/data.json" num-items="5" placeholder="Enter your search term" pfelement="" type="container"></cp-search-autocomplete>                            <div>Or <a href="https://access.redhat.com/support/cases/#/troubleshoot">troubleshoot an issue</a>.
                            </div>
                        </form>
                    </div>
                </div>


                <div slot="secondary-links" id="localesMenu" class="pfe-navigation__custom-dropdown__wrapper--single-column pfe-navigation__custom-dropdown__wrapper">
                    <button class="pfe-navigation__secondary-link" id="pfe-navigation__secondary-link--English" aria-controls="pfe-navigation__custom-dropdown--English" aria-expanded="false">
                        <pfe-icon icon="web-icon-globe" size="sm" aria-hidden="true" pfelement="" class="PFElement" on="light" type="content"></pfe-icon>English
                    </button>

                    
                <div id="pfe-navigation__custom-dropdown--English" class="pfe-navigation__dropdown-wrapper pfe-navigation__custom-dropdown--single-column pfe-navigation__dropdown-wrapper--invisible" aria-hidden="true" tabindex="-1"><pfe-navigation-dropdown dropdown-width="single" pfelement="" class="PFElement pfe-navigation__dropdown" type="container" data-id-suffix="English">
                        <h2 class="utility-header">Select Your Language
                        </h2>
                        <ul class="reset">
                            <li><a href="https://access.redhat.com/changeLanguage?language=en&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index" data-lang="en" id="en" data-analytics-text="English" class="selected">English</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ko&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index" data-lang="ko" id="ko" data-analytics-text="Korean">한국어</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=ja&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index" data-lang="ja" id="ja" data-analytics-text="Japanese">日本語</a></li>
                            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index" data-lang="zh_CN" id="zh_CN" data-analytics-text="Chinese">中文 (中国)</a></li>
                        </ul>

                    </pfe-navigation-dropdown></div></div>                <rh-account-dropdown slot="account" pfelement="" class="PFElement" type="content" login-link="https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/auth?client_id=customer-portal&amp;redirect_uri=https%3A%2F%2Faccess.redhat.com%2Fwebassets%2Favalon%2Fj%2Fincludes%2Fsession%2Fscribe%2F%3FredirectTo%3Dhttps%253A%252F%252Faccess.redhat.com%252Fdocumentation%252Fen-us%252Fred_hat_enterprise_linux%252F9%252Fhtml-single%252Fautomating_system_administration_by_using_rhel_system_roles%252Findex&amp;state=f1211539-ccf5-40ce-bb06-c71a61495370&amp;nonce=0eccd6e7-33d1-4549-93bc-c2378a1ab49c&amp;response_mode=fragment&amp;response_type=code&amp;scope=openid" lang="en"></rh-account-dropdown>                <pfe-primary-detail breakpoint-width="600" class="main-menu__dropdown--product__product-listing PFElement" slot="main-menu__dropdown--product__product-listing" consistent-height="" aria-orientation="vertical" role="tablist" pfelement="" on="&quot;light&quot;" type="container" has_details="" breakpoint="compact">
                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-asg1pno5d" data-index="0" aria-controls="pfe-detail-z2p4nv1fz" aria-expanded="false">Infrastructure and Management                    </button>
                    <div slot="details" data-index="0" id="pfe-detail-z2p4nv1fz" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-asg1pno5d" data-processed="true" aria-hidden="true" hidden="">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Enterprise Linux" href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Satellite" href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Subscription Management" href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Insights" href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights
                                </a>
                            </li>
                            <li><a data-analytics-level="3" data-analytics-category="Products and Services|Products:Infrastructure and Management" data-analytics-text="Red Hat Ansible Automation Platform" href="https://access.redhat.com/products/red-hat-ansible-automation-platform/">Red Hat Ansible Automation Platform
                                </a></li>
                        </ul>
                    </div>

                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-x3npil9jx" data-index="1" aria-controls="pfe-detail-bbzc99gjz" aria-expanded="false">Cloud Computing                    </button>
                    <div slot="details" data-index="1" id="pfe-detail-bbzc99gjz" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-x3npil9jx" data-processed="true" aria-hidden="true" hidden="">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift" href="https://access.redhat.com/products/openshift">Red Hat OpenShift
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenStack Platform" href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Container Platform" href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat OpenShift Data Science" href="https://access.redhat.com/products/red-hat-openshift-data-science/">Red Hat OpenShift Data Science
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Dedicated" href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing Platform" data-analytics-text="Red Hat Advanced Cluster Security for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/">Red Hat Advanced Cluster Security for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Advanced Cluster Management for Kubernetes" href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat Quay" href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat CodeReady Workspaces" href="https://access.redhat.com/products/red-hat-codeready-workspaces/">OpenShift Dev Spaces
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Cloud Computing" data-analytics-text="Red Hat OpenShift Service on AWS" href="https://access.redhat.com/products/red-hat-openshift-service-aws">Red Hat OpenShift Service on AWS
                                </a>
                            </li>
                        </ul>
                    </div>

                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-xccjuoltb" data-index="2" aria-controls="pfe-detail-05u6yghan" aria-expanded="false">Storage                    </button>
                    <div slot="details" data-index="2" id="pfe-detail-05u6yghan" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-xccjuoltb" data-processed="true" aria-hidden="true" hidden="">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Gluster Storage" href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Hyperconverged Infrastructure" href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Ceph Storage" href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Storage" data-analytics-text="Red Hat Openshift Container Storage" href="https://access.redhat.com/products/red-hat-openshift-data-foundation">Red Hat OpenShift Data Foundation
                                </a>
                            </li>
                        </ul>
                    </div>

                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-4rxlcn7m9" data-index="3" aria-controls="pfe-detail-7dpoj0eri" aria-expanded="false">Runtimes                    </button>
                    <div slot="details" data-index="3" id="pfe-detail-7dpoj0eri" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-4rxlcn7m9" data-processed="true" aria-hidden="true" hidden="">
                        <ul>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Runtimes" href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Enterprise Application Platform" href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Data Grid" href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat JBoss Web Server" href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat Single Sign On" href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat support for Spring Boot" href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Node.js" href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js
                                </a>
                            </li>                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Runtimes" data-analytics-text="Red Hat build of Quarkus" href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus
                                </a>
                            </li>
                        </ul>
                    </div>

                    <button role="tab" slot="details-nav" data-was-tag="H3" id="pfe-detail-toggle-kqhhc6u1x" data-index="4" aria-controls="pfe-detail-b9t8u7on1" aria-expanded="false">Integration and Automation                    </button>
                    <div slot="details" data-index="4" id="pfe-detail-b9t8u7on1" role="tabpanel" tabindex="-1" aria-labelledby="pfe-detail-toggle-kqhhc6u1x" data-processed="true" aria-hidden="true" hidden="">
                        <ul class="border-bottom" id="portal-menu-border-bottom">
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Application Foundations" href="https://access.redhat.com/products/red-hat-application-foundations/">Red Hat Application Foundations
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat Fuse" href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat AMQ" href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ
                                </a>
                            </li>
                            <li>
                                <a data-analytics-level="3" data-analytics-category="Products and Services|Products:Integration and Automation" data-analytics-text="Red Hat 3scale API Management" href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div slot="details-nav--footer">
                        <pfe-cta pfe-priority="primary" priority="primary" pfelement="" class="PFElement" on="&quot;light&quot;" has_link="">
                            <a href="https://access.redhat.com/products/" class="pfe-navigation__menu-link" data-analytics-level="2" data-analytics-text="All Products" data-analytics-category="Products and Services|Products:" data-analytics-linktype="cta">All Products
                            </a>
                        </pfe-cta>
                    </div>
                </pfe-primary-detail>

            <div slot="secondary-links" class="pfe-navigation__site-switcher pfe-navigation__custom-dropdown__wrapper--full pfe-navigation__custom-dropdown__wrapper" mobile-slider=""><button class="pfe-navigation__secondary-link" id="pfe-navigation__secondary-link--All-Red-Hat" aria-controls="pfe-navigation__custom-dropdown--All-Red-Hat" aria-expanded="false"><pfe-icon icon="web-icon-grid-3x3" size="sm" aria-hidden="true" pfelement="" class="PFElement" on="light" type="content"></pfe-icon>All Red Hat</button> <div id="pfe-navigation__custom-dropdown--All-Red-Hat" class="pfe-navigation__dropdown-wrapper pfe-navigation__custom-dropdown--full pfe-navigation__dropdown-wrapper--invisible" aria-hidden="true" tabindex="-1"><pfe-navigation-dropdown dropdown-width="full" pfelement="" class="PFElement pfe-navigation__dropdown" type="container" data-id-suffix="All-Red-Hat"><div class="pfe-navigation__site-switcher__back-wrapper"><button class="pfe-navigation__site-switcher__back-button" aria-label="Close undefined and return to menu">Back to menu</button></div><site-switcher pfelement="" class="PFElement" type="content" lang="en"><article class="node-355871 node node-page clearfix">


    <div class="field field-name-body field-type-text-with-summary field-label-hidden">
        <div class="field-items">
            <div class="field-item even">
                <!--linking to stylesheets so /cms/ajax/site-switcher will load with styles -->
  <link type="text/css" rel="stylesheet" href="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/site-switcher.css" media="all">
  
  <!-- overriding css variables to get the redhat.com logo box and text to change style indicating you are on this site-->

                <style>
                    :root {
                        --rhdc--logo: var(--rhdc--logo--you-are-here);
                        --rhdc--backgroundColor: var(--background--you-are-here);
                        --rhdc--label: var(--label--you-are-here);
                        --rhdc--margin-top: 0px;
                    }
                </style>

                <section class="site-switcher-tray" data-analytics-region="site-switcher">
                    <div class="content">
                        <div class="container">
                            <section class="site-switcher-container">
                                <ul class="site-switcher-primary-list">
                                    <li class="rhdc">
                                        <a href="https://www.redhat.com/?intcmp=701f20000012k69AAA" data-analytics-category="Websites" data-analytics-text="redhat">
                                            <p class="location-label">You are here</p>
                                            <div class="tntLogo">
                                                <div class="image"></div>
                                            </div>
                                            <h3>Red Hat</h3>
                                            <p>Learn about our open source products, services, and company.</p>
                                        </a>
                                    </li>
                                    <li class="customer-portal">
                                        <a href="https://access.redhat.com/?intcmp=701f20000012k6EAAQ" data-analytics-category="Websites" data-analytics-text="access_redhat">
                                            <p class="location-label">You are here</p>
                                            <div class="tntLogo">
                                                <!-- Customer portal -->
                                                <div class="image"></div>
                                            </div>
                                            <h3>Red Hat Customer Portal</h3>
                                            <p>Get product support and knowledge from the open source experts.</p>
                                        </a>
                                    </li>
                                    <li class="developers">
                                        <a href="https://developers.redhat.com/?intcmp=701f20000012k6JAAQ" data-analytics-category="Websites" data-analytics-text="developers_redhat">
                                            <p class="location-label">You are here</p>
                                            <div class="tntLogo">
                                                <!-- Red Hat Developer -->
                                                <div class="image"></div>
                                            </div>
                                            <h3>Red Hat Developer</h3>
                                            <p>Read developer tutorials and download Red Hat software for cloud
                                                application development.</p>
                                        </a>
                                    </li>
                                    <li class="connect">
                                        <a href="https://connect.redhat.com/" data-analytics-category="Websites" data-analytics-text="connect_redhat">
                                            <p class="location-label">You are here</p>
                                            <div class="tntLogo">
                                                <!-- Red Hat Partner Connect -->
                                                <div class="image"></div>
                                            </div>
                                            <h3>Red Hat Partner Connect</h3>
                                            <p>Become a Red Hat partner and get support in building customer solutions.
                                            </p>
                                        </a>
                                    </li>
                                </ul>
                                <hr>

                                <ul class="site-switcher-secondary-list">
                                    <li>
                                        <h2>Products</h2>
                                        <ul>
                                            <li><a href="https://www.ansible.com/?intcmp=701f20000012k6TAAQ" data-analytics-category="Websites" data-analytics-text="ansible">
                                                    <h3>Ansible.com</h3>
                                                </a>Learn about and try our IT automation product.</li>

                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Try, Buy, Sell</h2>
                                        <ul>
                                            <li><a href="https://cloud.redhat.com/" data-analytics-category="Websites" data-analytics-text="hybrid-cloud">
                                                    <h3>Red Hat Hybrid Cloud</h3>
                                                </a>Access technical how-tos, tutorials, and learning paths focused on
                                                Red Hat’s hybrid cloud managed services.</li>

                                            <li><a href="https://www.redhat.com/store?intcmp=701f20000012k6nAAA" data-analytics-category="Websites" data-analytics-text="store">
                                                    <h3>Red Hat Store</h3>
                                                </a>Buy select Red Hat products and services online.</li>

                                            <li><a href="https://marketplace.redhat.com/" data-analytics-category="Websites" data-analytics-text="marketplace">
                                                    <h3>Red Hat Marketplace</h3>
                                                </a>Try, buy, sell, and manage certified enterprise software for
                                                container-based environments.</li>

                                        </ul>
                                    </li>
                                    <li>
                                        <h2>Community &amp; Open Source</h2>
                                        <ul>
                                            <li><a href="https://enterprisersproject.com/?intcmp=701f20000012k6sAAA" data-analytics-category="Websites" data-analytics-text="enterprisersproject">
                                                    <h3>The Enterprisers Project</h3>
                                                </a>Read analysis and advice articles written by CIOs, for CIOs.</li>
                                            <li><a href="https://opensource.com/?intcmp=701f20000012k6OAAQ" data-analytics-category="Websites" data-analytics-text="opensource">
                                                    <h3>Opensource.com</h3>
                                                </a>Read articles on a range of topics about open source.</li>
                                        </ul>
                                    </li>
                                    <li>
                                        <h2>&nbsp;</h2>
                                        <ul>
                                            <li><a href="https://www.redhat.com/summit?intcmp=701f20000012k6xAAA" data-analytics-category="Websites" data-analytics-text="summit">
                                                    <h3>Red Hat Summit</h3>
                                                </a>Register for and learn about our annual open source IT industry
                                                event.</li>
                                            <li><a href="https://catalog.redhat.com/" data-analytics-category="Websites" data-analytics-text="catalog">
                                                    <h3>Red Hat Ecosystem Catalog</h3>
                                                </a>Find hardware, software, and cloud providers―and download container
                                                images―certified to perform with Red Hat technologies.</li>
                                        </ul>
                                    </li>
                                </ul>
                            </section>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>



</article></site-switcher></pfe-navigation-dropdown></div></div></pfe-navigation>

            <div id="scroll-anchor"></div>

            <!--[if IE 8]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>
                You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
                </div>
            <![endif]-->
            <!--[if IE 9]>
                <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                <span class="icon-warning alert-icon" aria-hidden="true"></span>As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
                </div>
            <![endif]-->
            <div id="site-section"></div>
        <div class="breadcrumbs"><div id="breadcrumbs" class="container"><ul><li><a href="https://access.redhat.com/products/">Products &amp; Services</a></li><li><a href="https://access.redhat.com/documentation">Product Documentation</a></li><li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red&nbsp;Hat Enterprise Linux</a></li><li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9">9</a></li><li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles">Automating system administration by using RHEL System Roles</a></li><li>Automating system administration by using RHEL System Roles</li></ul></div></div></header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">                            <!-- /CP_PRIMER_HEADER -->

      <div class="container">
        

                                                                                                        <script>breadcrumbs = [["Products & Services","\/products\/"],["Product Documentation","\/documentation"],["Red Hat Enterprise Linux","\/documentation\/en-us\/red_hat_enterprise_linux"],["9","\/documentation\/en-us\/red_hat_enterprise_linux\/9"],["Automating system administration by using RHEL System Roles","\/documentation\/en-us\/red_hat_enterprise_linux\/9\/html\/automating_system_administration_by_using_rhel_system_roles"],["Automating system administration by using RHEL System Roles","\/documentation\/en-us\/red_hat_enterprise_linux\/9\/html\/automating_system_administration_by_using_rhel_system_roles\/--single-page-document--"]]</script>

<div data-drupal-messages-fallback="" class="hidden"></div>


    </div>
        <div class="j-chrome-content-container">
        

  

  


  <article class="pvof-doc__content-wrapper__outer">
    <script>
      'use strict';

            var $outerWrapper = document.querySelector('.pvof-doc__content-wrapper__outer');
      if ($outerWrapper && $outerWrapper.closest) {
        var $containerWrapper = $outerWrapper.closest('.container');
        if ($containerWrapper) {
          $containerWrapper.classList.remove('container');
          $containerWrapper.classList.add('j-chrome-content-container');
        }
      }

            var cssRemoved = false;
      try {
        var $crapCss = document.querySelectorAll(
          'link[href*="/chrome_themes/nimbus/css/pages.css"], link[href*="/chrome_themes/nimbus/css/components.css"]'
        );
        if ($crapCss.length) {
          for (let index = 0; index < $crapCss.length; index++) {
            const $stylesheet = $crapCss[index];
            $stylesheet.remove();
          }
        }
        cssRemoved = true;
      }
      catch (error) {
        console.error('Ran into an issue while trying to retheme page', error);
        cssRemoved = false;
      }

            if (cssRemoved) {
        var $pvofOuterWrapper = document.querySelector('.pvof-doc__content-wrapper__outer--css-not-removed');
        if ($pvofOuterWrapper) {
          $pvofOuterWrapper.classList.remove('pvof-doc__content-wrapper__outer--css-not-removed');
        }
      }
    </script>
    <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
    <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
    <div class="pvof-doc__content-wrapper pvof-doc__content-wrapper--has-sidebar">
                                <div class="pvof-doc__content-wrapper__inner j-superdoc j-superdoc--has-nav j-reading-mode-initialized">
                            <div class="pvof-sidebar__wrapper j-doc-nav j-superdoc__nav">
            <div class="j-sidebar__menu-container j-sidebar__menu-container--processed">
              <button class="j-sidebar__menu-trigger content-expander__trigger content-expander__trigger--processed" aria-expanded="true" aria-controls="content-expander-q9pmpki">
                <span class="j-sidebar__menu-trigger__open-text">Jump To</span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>

              <div class="pvof-sidebar__inner-wrapper j-doc-nav__wrapper content-expander content-expander--processed" id="content-expander-q9pmpki" open="">
                <div class="j-sidebar__menu-details-container">
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--expand">
                    Expand all
                  </button>
                  <button class="j-sidebar__menu-details-button j-sidebar__menu-details-button--collapse">
                    Collapse all
                  </button>
                </div>
                

  <nav id="pvof-doc__toc" class="pvof-doc__toc">
  <h2 class="j-doc-nav__title" id="j-doc-nav__title">
    Table of contents
  </h2>
  <div class="pvof-doc__toc-inner">
              <ol class="j-doc-nav__list" aria-labelledby="j-doc-nav__title">
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#doc-wrapper" class="j-doc-nav__link is-active">
    Automating system administration by using RHEL System Roles
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#making-open-source-more-inclusive" class="j-doc-nav__link ">
    Making open source more inclusive
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#proc_providing-feedback-on-red-hat-documentation_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link ">
    Providing feedback on Red Hat documentation
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link ">
    1. Introduction to RHEL&nbsp;System&nbsp;Roles
  </a>
  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    2. Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-gqbzqh2">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "2. Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "2. Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-gqbzqh2" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles" class="j-doc-nav__link ">
    2.1. Preparing a control node on RHEL 9
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles" class="j-doc-nav__link ">
    2.2. Preparing a managed node
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#installing-and-using-collections_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    3. Installing and Using Collections
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-xerarpw">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "3. Installing and Using Collections"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "3. Installing and Using Collections"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-xerarpw" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-ansible-collections_installing-and-using-collections" class="j-doc-nav__link ">
    3.1. Introduction to Ansible Collections
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#collections-structure_installing-and-using-collections" class="j-doc-nav__link ">
    3.2. Collections structure
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#installing-collections_installing-and-using-collections" class="j-doc-nav__link ">
    3.3. Installing Collections by using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#installing-collections-from-automation-hub_installing-and-using-collections" class="j-doc-nav__link ">
    3.4. Installing Collections from Automation Hub
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#deploying-the-tlog-rhel-system-role-using-collections_installing-and-using-collections" class="j-doc-nav__link ">
    3.5. Deploying the tlog RHEL System Role using Collections
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    4. Ansible IPMI modules in RHEL
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-wmqxh5c">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "4. Ansible IPMI modules in RHEL"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "4. Ansible IPMI modules in RHEL"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-wmqxh5c" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#ref_the-rhel_mgmt-collection_assembly_ansible-ipmi-modules-in-rhel" class="j-doc-nav__link ">
    4.1. The rhel_mgmt collection
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_installing-the-rhel-mgmt-collection-by-using-the-cli_assembly_ansible-ipmi-modules-in-rhel" class="j-doc-nav__link ">
    4.2. Installing the rhel mgmt Collection using the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_example-using-the-ipmi_boot-module_assembly_ansible-ipmi-modules-in-rhel" class="j-doc-nav__link ">
    4.3. Example using the ipmi_boot module
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_example-using-the-ipmi_power-module_assembly_ansible-ipmi-modules-in-rhel" class="j-doc-nav__link ">
    4.4. Example using the ipmi_power module
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    5. The Redfish modules in RHEL
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-si8ezb6">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "5. The Redfish modules in RHEL"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "5. The Redfish modules in RHEL"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-si8ezb6" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#con_the-redfish-modules_assembly_the-redfish-modules-in-rhel" class="j-doc-nav__link ">
    5.1. The Redfish modules
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#ref_redfish-modules-parameters_assembly_the-redfish-modules-in-rhel" class="j-doc-nav__link ">
    5.2. Redfish modules parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_using-the-redfish-info-module_assembly_the-redfish-modules-in-rhel" class="j-doc-nav__link ">
    5.3. Using the redfish_info module
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_using-the-redfish-command-module_assembly_the-redfish-modules-in-rhel" class="j-doc-nav__link ">
    5.4. Using the redfish_command module
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_using-the-redfish-config-module_assembly_the-redfish-modules-in-rhel" class="j-doc-nav__link ">
    5.5. Using the redfish_config module
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    6. Configuring kernel parameters permanently by using the kernel_settings RHEL System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-gb4jt6e">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "6. Configuring kernel parameters permanently by using the kernel_settings RHEL System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "6. Configuring kernel parameters permanently by using the kernel_settings RHEL System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-gb4jt6e" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role" class="j-doc-nav__link ">
    6.1. Introduction to the kernel_settings role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role" class="j-doc-nav__link ">
    6.2. Applying selected kernel parameters using the kernel_settings role
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    7. Using the rhc System Role to register the system
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-7365msj">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "7. Using the rhc System Role to register the system"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "7. Using the rhc System Role to register the system"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-7365msj" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.1. Introduction to the rhc System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#registering-system-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.2. Registering a system by using the rhc System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#registering-system-with-satellite-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.3. Registering a system with Satellite by using the rhc System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-insights-connection-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.4. Disabling the connection to Insights after the registration by using the rhc System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-repositories-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.5. Enabling repositories by using the rhc System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#setting-release-versions-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.6. Setting release versions by using the rhc system role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-proxy-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.7. Using a proxy server when registering the host by using the rhc System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-auto-updates-insights-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.8. Disabling auto updates of Insights rules by using the rhc System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-insights-remediations-using-rhel-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.9. Disabling Insights remediations by using the rhc RHEL System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-insights-tags-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.10. Configuring Insights tags by using the rhc system role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#unregistering-a-system-using-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system" class="j-doc-nav__link ">
    7.11. Unregistering a system by using the RHC System Role
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    8. Configuring network settings by using RHEL&nbsp;System&nbsp;Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-ruufw9q">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "8. Configuring network settings by using RHEL&nbsp;System&nbsp;Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "8. Configuring network settings by using RHEL&nbsp;System&nbsp;Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-ruufw9q" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.1. Configuring an Ethernet connection with a static IP address by 
using the network RHEL&nbsp;System&nbsp;Role with an interface name
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.2. Configuring an Ethernet connection with a static IP address by 
using the network RHEL&nbsp;System&nbsp;Role with a device path
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.3. Configuring an Ethernet connection with a dynamic IP address by
 using the network RHEL&nbsp;System&nbsp;Role with an interface name
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.4. Configuring an Ethernet connection with a dynamic IP address by
 using the network RHEL&nbsp;System&nbsp;Role with a device path
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-vlan-tagging-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.5. Configuring VLAN tagging by using the network RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-a-network-bridge-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.6. Configuring a network bridge by using the network RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_configuring-a-network-bond-by-using-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.7. Configuring a network bond by using the network RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-an-ipoib-connection-by-using-the-network-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.8. Configuring an IPoIB connection by using the network RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_routing-traffic-from-a-specific-subnet-to-a-different-default-gateway-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.9. Routing traffic from a specific subnet to a different default gateway by using the network RHEL System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-a-static-ethernet-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.10. Configuring a static Ethernet connection with 802.1X network 
authentication by using the network RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_configuring-a-wifi-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.11. Configuring a wifi connection with 802.1X network authentication by using the network RHEL System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_setting-the-default-gateway-on-an-existing-connection-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.12. Setting the default gateway on an existing connection by using the network RHEL System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_configuring-a-static-route-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.13. Configuring a static route by using the network RHEL System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_configuring-an-ethtool-offload-feature-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.14. Configuring an ethtool offload feature by using the network RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#ref_network-states-for-the-network-rhel-system-roles_assembly_configuring-network-settings-by-using-rhel-system-roles" class="j-doc-nav__link ">
    8.15. Network states for the network RHEL System role
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    9. Configuring firewalld by using RHEL&nbsp;System&nbsp;Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-v6hkb38">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "9. Configuring firewalld by using RHEL&nbsp;System&nbsp;Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "9. Configuring firewalld by using RHEL&nbsp;System&nbsp;Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-v6hkb38" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#con_introduction-to-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles" class="j-doc-nav__link ">
    9.1. Introduction to the firewall RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_resetting-the-firewalld-settings-using-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles" class="j-doc-nav__link ">
    9.2. Resetting the firewalld settings by using a RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_forwarding-incoming-traffic-from-one-local-port-to-a-different-local-port_assembly_configuring-firewalld-using-system-roles" class="j-doc-nav__link ">
    9.3. Forwarding incoming traffic in firewalld from one local port to
 a different local port by using a RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-ports-using-system-roles_assembly_configuring-firewalld-using-system-roles" class="j-doc-nav__link ">
    9.4. Managing ports in firewalld by using a RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-a-dmz-firewalld-zone-by-using-the-firewalld-rhel-system-role_assembly_configuring-firewalld-using-system-roles" class="j-doc-nav__link ">
    9.5. Configuring a firewalld DMZ zone by using a RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_postfix-role-variables-in-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    10. Variables of the postfix role in System Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-50fm2e0">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "10. Variables of the postfix role in System Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "10. Variables of the postfix role in System Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-50fm2e0" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#additional_resources" class="j-doc-nav__link ">
    10.1. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    11. Configuring SELinux using System Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-u5l65nt">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "11. Configuring SELinux using System Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "11. Configuring SELinux using System Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-u5l65nt" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-the-selinux-system-role_configuring-selinux-using-system-roles" class="j-doc-nav__link ">
    11.1. Introduction to the selinux System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_configuring-selinux-using-system-roles" class="j-doc-nav__link ">
    11.2. Using the selinux System Role to apply SELinux settings on multiple systems
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    12. Configuring logging by using RHEL System Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-ukbivs2">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12. Configuring logging by using RHEL System Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12. Configuring logging by using RHEL System Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-ukbivs2" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-logging-system-role_configuring-logging-by-using-rhel-system-roles" class="j-doc-nav__link ">
    12.1. The logging System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#logging-system-role-parameters_configuring-logging-by-using-rhel-system-roles" class="j-doc-nav__link ">
    12.2. logging System Role parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#applying-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles" class="j-doc-nav__link ">
    12.3. Applying a local logging System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_filtering-logs-in-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles" class="j-doc-nav__link ">
    12.4. Filtering logs in a local logging System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#applying-a-remote-logging-solution-using-the-logging-system-role_configuring-logging-by-using-rhel-system-roles" class="j-doc-nav__link ">
    12.5. Applying a remote logging solution using the logging System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="#assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    12.6. Using the logging System Role with TLS
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-5m16qj8">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12.6. Using the logging System Role with TLS"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12.6. Using the logging System Role with TLS"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-5m16qj8" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls" class="j-doc-nav__link ">
    12.6.1. Configuring client logging with TLS
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls" class="j-doc-nav__link ">
    12.6.2. Configuring server logging with TLS
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="#assembly_using-the-logging-system-roles-with-relp" class="j-doc-nav__link j-doc-nav__link--has-children">
    12.7. Using the logging System Roles with RELP
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-qwtiz4k">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "12.7. Using the logging System Roles with RELP"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "12.7. Using the logging System Roles with RELP"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-qwtiz4k" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" class="j-doc-nav__link ">
    12.7.1. Configuring client logging with RELP
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" class="j-doc-nav__link ">
    12.7.2. Configuring server logging with RELP
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#additional_resources_2" class="j-doc-nav__link ">
    12.8. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-the-systemd-journal-by-using-the-journald-RHEL-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    13. Configuring the systemd journal by using the journald RHEL System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-fowxcpv">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "13. Configuring the systemd journal by using the journald RHEL System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "13. Configuring the systemd journal by using the journald RHEL System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-fowxcpv" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#variables-for-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role" class="j-doc-nav__link ">
    13.1. Variables for the journald RHEL System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-persistent-logging-by-using-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role" class="j-doc-nav__link ">
    13.2. Configuring persistent logging by using the journald System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#additional_resources_3" class="j-doc-nav__link ">
    13.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    14. Configuring secure communication by using the ssh and sshd RHEL System Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-kfa5g11">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "14. Configuring secure communication by using the ssh and sshd RHEL System Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "14. Configuring secure communication by using the ssh and sshd RHEL System Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-kfa5g11" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#sshd-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" class="j-doc-nav__link ">
    14.1. ssh Server System Role variables
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" class="j-doc-nav__link ">
    14.2. Configuring OpenSSH servers using the sshd System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#ref_ssh-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" class="j-doc-nav__link ">
    14.3. ssh System Role variables
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" class="j-doc-nav__link ">
    14.4. Configuring OpenSSH clients using the ssh System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" class="j-doc-nav__link ">
    14.5. Using the sshd System Role for non-exclusive configuration
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    15. Configuring VPN connections with IPsec by using the vpn RHEL&nbsp;System&nbsp;Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-5jmhlh1">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "15. Configuring VPN connections with IPsec by using the vpn RHEL&nbsp;System&nbsp;Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "15. Configuring VPN connections with IPsec by using the vpn RHEL&nbsp;System&nbsp;Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-5jmhlh1" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" class="j-doc-nav__link ">
    15.1. Creating a host-to-host VPN with IPsec using the vpn System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" class="j-doc-nav__link ">
    15.2. Creating an opportunistic mesh VPN connection with IPsec by using the vpn System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#additional_resources_4" class="j-doc-nav__link ">
    15.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    16. Setting a custom cryptographic policy by using the crypto-policies RHEL System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-w9kzd9h">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "16. Setting a custom cryptographic policy by using the crypto-policies RHEL System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "16. Setting a custom cryptographic policy by using the crypto-policies RHEL System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-w9kzd9h" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#crypto-policies-system-role-variables_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role" class="j-doc-nav__link ">
    16.1. crypto_policies System Role variables and facts
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role" class="j-doc-nav__link ">
    16.2. Setting a custom cryptographic policy using the crypto_policies System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#additional_resources_5" class="j-doc-nav__link ">
    16.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    17. Configuring NBDE by using RHEL System Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-quhh1y2">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "17. Configuring NBDE by using RHEL System Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "17. Configuring NBDE by using RHEL System Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-quhh1y2" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-the-clevis-and-tang-system-roles_configuring-nbde-by-using-rhel-system-roles" class="j-doc-nav__link ">
    17.1. Introduction to the nbde_client and nbde_server System Roles (Clevis and Tang)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles" class="j-doc-nav__link ">
    17.2. Using the nbde_server System Role for setting up multiple Tang servers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles" class="j-doc-nav__link ">
    17.3. Using the nbde_client System Role for setting up multiple Clevis clients
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    18. Requesting certificates using RHEL&nbsp;System&nbsp;Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-3ffw0i4">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "18. Requesting certificates using RHEL&nbsp;System&nbsp;Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "18. Requesting certificates using RHEL&nbsp;System&nbsp;Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-3ffw0i4" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-certificate-system-role_requesting-certificates-using-rhel-system-roles" class="j-doc-nav__link ">
    18.1. The certificate System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" class="j-doc-nav__link ">
    18.2. Requesting a new self-signed certificate using the certificate System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" class="j-doc-nav__link ">
    18.3. Requesting a new certificate from IdM CA using the certificate System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#specifying-commands-to-run-before-or-after-certificate-issuance-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" class="j-doc-nav__link ">
    18.4. Specifying commands to run before or after certificate issuance using the certificate System Role
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    19. Configuring automatic crash dumps by using the kdump RHEL System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-et4htzn">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "19. Configuring automatic crash dumps by using the kdump RHEL System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "19. Configuring automatic crash dumps by using the kdump RHEL System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-et4htzn" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-the-kdump-role_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role" class="j-doc-nav__link ">
    19.1. The kdump RHEL System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#kdump-role-parameters_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role" class="j-doc-nav__link ">
    19.2. kdump role parameters
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-kdump-using-rhel-system-roles_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role" class="j-doc-nav__link ">
    19.3. Configuring kdump using RHEL&nbsp;System&nbsp;Roles
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    20. Managing local storage using RHEL&nbsp;System&nbsp;Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-g9a1x1l">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "20. Managing local storage using RHEL&nbsp;System&nbsp;Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "20. Managing local storage using RHEL&nbsp;System&nbsp;Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-g9a1x1l" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#storage-role-intro_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.1. Introduction to the storage RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#parameters-that-identify-a-storage-device-in-the-storage-system-role_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.2. Parameters that identify a storage device in the storage RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#an-example-ansible-playbook-to-create-an-xfs-file-system_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.3. Example Ansible playbook to create an XFS file system on a block device
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#an-example-ansible-playbook-to-persistently-mount-a-file-system_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.4. Example Ansible playbook to persistently mount a file system
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#an-example-playbook-to-manage-logical-volumes_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.5. Example Ansible playbook to manage logical volumes
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#an-example-ansible-playbook-to-enable-online-block-discard_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.6. Example Ansible playbook to enable online block discard
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#an-example-playbook-to-create-mount-an-ext4-file-system_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.7. Example Ansible playbook to create and mount an Ext4 file system
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#an-example-ansible-playbook-to-create-mount-ext3-file-system_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.8. Example Ansible playbook to create and mount an ext3 file system
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#example-ansible-playbook-to-resize-an-existing-file-system-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.9. Example Ansible playbook to resize an existing Ext4 or Ext3 file system using the storage RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#example-ansible-playbook-to-resize-an-existing-lvm-file-system-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.10. Example Ansible playbook to resize an existing file system on LVM using the storage RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#example-ansible-playbook-to-create-a-swap-partition-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.11. Example Ansible playbook to create a swap volume using the storage RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-a-raid-volume-using-the-storage-system-role_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.12. Configuring a RAID volume using the storage System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-lvm-pool-with-raid-using-storage-system-role_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.13. Configuring an LVM pool with RAID using the storage RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#example-ansible-playbook-to-compress-and-deduplicate-a-vdo-volume-on-lvm-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.14. Example Ansible playbook to compress and deduplicate a VDO volume on LVM using the storage RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#creating-a-luks2-encrypted-volume-using-the-storage-role_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.15. Creating a LUKS2 encrypted volume using the storage RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#example-ansible-playbook-to-express-pool-volume-sizes-as-percentage-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" class="j-doc-nav__link ">
    20.16. Example Ansible playbook to express pool volume sizes as percentage using the storage RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#additional_resources_6" class="j-doc-nav__link ">
    20.17. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    21. Configuring time synchronization by using the timesync RHEL System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-aimzhf4">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "21. Configuring time synchronization by using the timesync RHEL System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "21. Configuring time synchronization by using the timesync RHEL System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-aimzhf4" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-timesync-system-role_configuring-time-synchronization-using-system-roles" class="j-doc-nav__link ">
    21.1. The timesync RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#applying-the-timesync-system-role-for-a-single-pool-of-servers_configuring-time-synchronization-using-system-roles" class="j-doc-nav__link ">
    21.2. Applying the timesync System Role for a single pool of servers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#applying-the-timesync-system-role-on-client-servers_configuring-time-synchronization-using-system-roles" class="j-doc-nav__link ">
    21.3. Applying the timesync System Role on client servers
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#timesync-system-roles-variables_configuring-time-synchronization-using-system-roles" class="j-doc-nav__link ">
    21.4. timesync System Roles variables
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    22. Monitoring performance by using the metrics RHEL System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-u312gno">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "22. Monitoring performance by using the metrics RHEL System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "22. Monitoring performance by using the metrics RHEL System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-u312gno" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#introduction-to-the-metrics-role_monitoring-performance-by-using-the-metrics-rhel-system-role" class="j-doc-nav__link ">
    22.1. Introduction to the metrics System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-the-metrics-role-to-monitor-your-local-system-with-visualization_monitoring-performance-by-using-the-metrics-rhel-system-role" class="j-doc-nav__link ">
    22.2. Using the metrics System Role to monitor your local system with visualization
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-the-metrics-role-to-monitor-a-fleet-of-machines-remotely_monitoring-performance-by-using-the-metrics-rhel-system-role" class="j-doc-nav__link ">
    22.3. Using the metrics System Role to set up a fleet of individual systems to monitor themselves
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-the-metrics-role-to-monitor-a-fleet-of-machines-centrally-via-your-local-machine_monitoring-performance-by-using-the-metrics-rhel-system-role" class="j-doc-nav__link ">
    22.4. Using the metrics System Role to monitor a fleet of machines centrally via your local machine
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#setting-up-authentication-while-monitoring-a-system-using-the-metrics-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role" class="j-doc-nav__link ">
    22.5. Setting up authentication while monitoring a system using the metrics System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#using-the-metrics-system-role-to-configure-and-enable-metrics-collection-for-sql-server_monitoring-performance-by-using-the-metrics-rhel-system-role" class="j-doc-nav__link ">
    22.6. Using the metrics System Role to configure and enable metrics collection for SQL Server
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    23. Configuring a system for session recording using the tlog RHEL&nbsp;System&nbsp;Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-l0uz5cm">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "23. Configuring a system for session recording using the tlog RHEL&nbsp;System&nbsp;Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "23. Configuring a system for session recording using the tlog RHEL&nbsp;System&nbsp;Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-l0uz5cm" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" class="j-doc-nav__link ">
    23.1. The tlog System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#components-and-parameters-of-the-tlog-system-roles_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" class="j-doc-nav__link ">
    23.2. Components and parameters of the tlog System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#deploying-the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" class="j-doc-nav__link ">
    23.3. Deploying the tlog RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#deploying-the-tlog-rhel-system-role-for-excluding-lists-of-groups-or-users_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" class="j-doc-nav__link ">
    23.4. Deploying the tlog RHEL&nbsp;System&nbsp;Role for excluding lists of groups or users
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#recording-a-session-using-the-deployed-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" class="j-doc-nav__link ">
    23.5. Recording a session using the deployed tlog System Role in the CLI
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#watching-a-user-recorded-session-using-the-cli_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" class="j-doc-nav__link ">
    23.6. Watching a recorded session using the CLI
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    24. Configuring a high-availability cluster by using the ha_cluster RHEL System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-1icrgkc">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "24. Configuring a high-availability cluster by using the ha_cluster RHEL System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "24. Configuring a high-availability cluster by using the ha_cluster RHEL System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-1icrgkc" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#ha-system-role-variables_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link ">
    24.1. ha_cluster System Role variables
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link j-doc-nav__link--has-children">
    24.2. Specifying an inventory for the ha_cluster System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-c4gl486">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "24.2. Specifying an inventory for the ha_cluster System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "24.2. Specifying an inventory for the ha_cluster System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-c4gl486" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring_node_names_and_addresses_in_an_inventory" class="j-doc-nav__link ">
    24.2.1. Configuring node names and addresses in an inventory
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring_watchdog_and_sbd_devices_in_an_inventory_rhel_9_1_and_later" class="j-doc-nav__link ">
    24.2.2. Configuring watchdog and SBD devices in an inventory (RHEL 9.1 and later)
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link ">
    24.3. Creating pcsd TLS certificates and key files for a high availability cluster (RHEL 9.2 and later)
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-no-resource-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link ">
    24.4. Configuring a high availability cluster running no resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link ">
    24.5. Configuring a high availability cluster with fencing and resources
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link ">
    24.6. Configuring a high availability cluster with resource constraints
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link ">
    24.7. Configuring Corosync values in a high availability cluster
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-ha-cluster-with-sbd_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link ">
    24.8. Configuring a high availability cluster with SBD node fencing
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                          

    <a href="#configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link j-doc-nav__link--has-children">
    24.9. Configuring a high availability cluster using a quorum device (RHEL 9.2 and later)
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-gqxow12">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "24.9. Configuring a high availability cluster using a quorum device (RHEL 9.2 and later)"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "24.9. Configuring a high availability cluster using a quorum device (RHEL 9.2 and later)"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-gqxow12" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring_a_quorum_device" class="j-doc-nav__link ">
    24.9.1. Configuring a quorum device
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring_a_cluster_to_use_a_quorum_device" class="j-doc-nav__link ">
    24.9.2. Configuring a cluster to use a quorum device
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#configuring-http-ha-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="j-doc-nav__link ">
    24.10. Configuring an Apache HTTP server in a high availability cluster with the ha_cluster System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#additional_resources_7" class="j-doc-nav__link ">
    24.11. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    25. Installing and configuring web console with the cockpit RHEL System Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-ewvcqgf">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "25. Installing and configuring web console with the cockpit RHEL System Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "25. Installing and configuring web console with the cockpit RHEL System Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-ewvcqgf" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#con_the-cockpit-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role" class="j-doc-nav__link ">
    25.1. The cockpit System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#ref_variables-for-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role" class="j-doc-nav__link ">
    25.2. Variables for the cockpit RHEL System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#proc_installing-the-web-console-by-using-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role" class="j-doc-nav__link ">
    25.3. Installing the web console by using the cockpit RHEL System Role
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    26. Managing containers by using the podman RHEL&nbsp;System&nbsp;Role
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-9ocugas">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "26. Managing containers by using the podman RHEL&nbsp;System&nbsp;Role"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "26. Managing containers by using the podman RHEL&nbsp;System&nbsp;Role"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-9ocugas" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-podman-system-role_managing-containers-by-using-the-podman-rhel-system-role" class="j-doc-nav__link ">
    26.1. The podman RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#variables-for-the-podman-rhel-system-role_managing-containers-by-using-the-podman-rhel-system-role" class="j-doc-nav__link ">
    26.2. Variables for the podman RHEL&nbsp;System&nbsp;Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#additional_resources_8" class="j-doc-nav__link ">
    26.3. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                      

    <a href="#integrating-rhel-systems-directly-with-ad-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" class="j-doc-nav__link j-doc-nav__link--has-children">
    27. Integrating RHEL systems directly with AD using RHEL System Roles
  </a>
                    <button class="j-doc-nav__children-toggle content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-gvi0b6q">
        <span class="visually-hidden j-doc-nav__children-toggle__expand-text">
          Expand section "27. Integrating RHEL systems directly with AD using RHEL System Roles"
        </span>
        <span class="visually-hidden  j-doc-nav__children-toggle__collapse-text">
          Collapse section "27. Integrating RHEL systems directly with AD using RHEL System Roles"
        </span>
      </button>

      <ol class="j-doc-nav__subnav j-superdoc-subnav content-expander content-expander--processed" id="content-expander-gvi0b6q" aria-hidden="true">
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#the-ad-integration-system-role_integrating-rhel-systems-directly-with-ad-using-rhel-system-roles" class="j-doc-nav__link ">
    27.1. The ad_integration System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#variables-for-the-ad-integration-rhel-system-role_integrating-rhel-systems-directly-with-ad-using-rhel-system-roles" class="j-doc-nav__link ">
    27.2. Variables for the ad_integration RHEL System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-directly-with-ad-using-rhel-system-roles" class="j-doc-nav__link ">
    27.3. Connecting a RHEL system directly to AD using the ad_integration System Role
  </a>
  
          </li>
                  <li class="j-superdoc-subnav__item">
                        

    <a href="#additional_resources_9" class="j-doc-nav__link ">
    27.4. Additional resources
  </a>
  
          </li>
              </ol>

  
          </li>
                  <li class="j-doc-nav__list-item">
                                    

    <a href="#idm140604752031664" class="j-doc-nav__link ">
    Legal Notice
  </a>
  
          </li>
              </ol>
    
  </div>
</nav>


              </div>
            </div>
            <div class="j-options-container j-options-container--mobile">
              <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--options content-expander__trigger content-expander__trigger--processed" aria-expanded="false" aria-controls="content-expander-you0cak">
                <span class="j-sidebar__menu-trigger__open-headline">
                  Settings
                </span>
                <span class="j-sidebar__menu-trigger__close-text">Close</span>
              </button>
              

  <ul class="j-doc-options__list content-expander content-expander--processed" id="content-expander-you0cak" aria-hidden="true">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language">
        Language:
      </label>
      <select id="j-doc-language" class="j-doc-option__select" data-ddg-inputtype="unknown">
                  <option value="/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">
            한국어
          </option>
                  <option value="/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">
            简体中文
          </option>
                  <option value="/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">
            日本語
          </option>
                  <option value="/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles" selected="selected">
            English
          </option>
                  <option value="/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">
            Français
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">한국어</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">简体中文</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">日本語</a>
            </li>
                      <li>
              <a href="/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">English</a>
            </li>
                      <li>
              <a href="/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">Français</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode" class="j-doc-option__select" data-ddg-inputtype="unknown">
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles" class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles" selected="selected" class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/pdf/automating_system_administration_by_using_rhel_system_roles/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_System_Roles-en-US.pdf" class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/red_hat_enterprise_linux/9/pdf/automating_system_administration_by_using_rhel_system_roles/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_System_Roles-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


              </div>
          </div>
                <div class="pvof-doc__tertiary-sidebar j-doc__tertiary-sidebar j-doc__tertiary-sidebar--sticky">
          <div class="pvof-doc__tertiary-sidebar__inner j-doc__tertiary-sidebar__inner"><div id="j-reading-mode-toggle" class="j-switch__wrapper j-reading-mode__toggle"><input type="checkbox" name="reading-mode" value="false" id="reading-mode-checkbox" class="j-reading-mode j-switch__input visually-hidden"><label for="reading-mode-checkbox" class="j-switch__label">Focus mode<span class="j-reading-mode__shortcut-hint" hidden=""><kbd>F</kbd></span><div class="j-switch"></div></label></div>
            <div class="j-doc__doc-options">
              <div class="j-options-container j-options-container--desktop j-options-container--desktop--processed">
                <button class="j-sidebar__menu-trigger j-sidebar__menu-trigger--tablet content-expander__trigger content-expander__trigger--processed" aria-expanded="true" aria-controls="content-expander-tu11cqt">
                  <span class="j-sidebar__menu-trigger-icon"></span>
                  <h2 class="visually-hidden">Language and Page Formatting Options</h2>
                </button>
                  

  <ul class="j-doc-options__list content-expander content-expander--processed" id="content-expander-tu11cqt" open="">
    <li class="j-doc-options__item">
          <label class="j-doc-option__label j-doc-option__label--language" for="j-doc-language--2">
        Language:
      </label>
      <select id="j-doc-language--2" class="j-doc-option__select" data-ddg-inputtype="unknown">
                  <option value="/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">
            한국어
          </option>
                  <option value="/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">
            简体中文
          </option>
                  <option value="/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">
            日本語
          </option>
                  <option value="/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles" selected="selected">
            English
          </option>
                  <option value="/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">
            Français
          </option>
              </select>

            <noscript>
        <div class="j-doc-option__label j-doc-option__label--language" id="j-doc-option__label--language--nojs">
          Language:
        </div>
        <ul aria-labelledby="j-doc-option__label--language--nojs" class="j-doc-option__languages-list">
                      <li>
              <a href="/documentation/ko-kr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">한국어</a>
            </li>
                      <li>
              <a href="/documentation/zh-cn/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">简体中文</a>
            </li>
                      <li>
              <a href="/documentation/ja-jp/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">日本語</a>
            </li>
                      <li>
              <a href="/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">English</a>
            </li>
                      <li>
              <a href="/documentation/fr-fr/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">Français</a>
            </li>
                  </ul>
      </noscript>

      </li>

    <li class="j-doc-options__item">
    <label for="j-doc-mode--2" class="j-doc-option__label j-doc-option__label--format">
      Format:
    </label>
    <select id="j-doc-mode--2" class="j-doc-option__select" data-ddg-inputtype="unknown">
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles" class="j-doc-options__option j-doc-options__option--multi-page">
          Multi-page
        </option>
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles" selected="selected" class="j-doc-options__option j-doc-options__option--single-page">
          Single-page
        </option>
              <option value="/documentation/en-us/red_hat_enterprise_linux/9/pdf/automating_system_administration_by_using_rhel_system_roles/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_System_Roles-en-US.pdf" class="j-doc-options__option j-doc-options__option--pdf">
          PDF
        </option>
          </select>

        <noscript>
      <div class="j-doc-option__label j-doc-option__label--format" id="j-doc-option__label--format--nojs">
        Format:
      </div>
      <ul class="j-doc-option__format-list" aria-labelledby="j-doc-option__label--format--nojs">
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--multi-page"><a href="/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles">Multi-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--single-page"><a href="/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles">Single-page</a></li>
                  <li class="j-doc-mode-no-js__link j-doc-mode-no-js__link--pdf"><a href="/documentation/en-us/red_hat_enterprise_linux/9/pdf/automating_system_administration_by_using_rhel_system_roles/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_System_Roles-en-US.pdf">PDF</a></li>
              </ul>
    </noscript>
  </li>
</ul>


                </div>
              </div>
          </div>
        </div>

                  <div class="doc-wrapper pvof-doc__wrapper j-superdoc__content-wrapper" id="doc-wrapper">
            

  <div class="pane-page-title">
    <h1 class="title" itemprop="name">Automating system administration by using RHEL System Roles</h1>
  </div>


  <div xml:lang="en-US" class="book" id="idm140604752862672"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red&nbsp;Hat Enterprise&nbsp;Linux</span> <span class="productnumber">9</span></div><div><h2 class="subtitle">Consistent
 and repeatable configuration of RHEL deployments across multiple hosts 
with Red Hat Ansible Automation Platform playbooks</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red&nbsp;Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="#idm140604752031664">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				The Red Hat Enterprise Linux (RHEL) System Roles are a collection of
 Ansible roles, modules, and playbooks that help automate the consistent
 and repeatable administration of RHEL systems. With RHEL System Roles, 
you can efficiently manage large inventories of systems by running 
configuration playbooks from a single system.
			</div></div></div></div><hr></div><section class="preface" id="making-open-source-more-inclusive"><div class="titlepage"><div><div><h1 class="title">Making open source more inclusive</h1></div></div></div><p class="_abstract _abstract">
			Red Hat is committed to replacing problematic language in our code, 
documentation, and web properties. We are beginning with these four 
terms: master, slave, blacklist, and whitelist. Because of the enormity 
of this endeavor, these changes will be implemented gradually over 
several upcoming releases. For more details, see <a class="link" href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language">our CTO Chris Wright’s message</a>.
		</p></section><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Providing feedback on Red Hat documentation</h1></div></div></div><p class="_abstract _abstract">
			We appreciate your feedback on our documentation. Let us know how we can improve it.
		</p><div class="orderedlist"><p class="title"><strong>Submitting comments on specific passages</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					View the documentation in the <span class="strong strong"><strong>Multi-page HTML</strong></span> format and ensure that you see the <span class="strong strong"><strong>Feedback</strong></span> button in the upper right corner after the page fully loads.
				</li><li class="listitem">
					Use your cursor to highlight the part of the text that you want to comment on.
				</li><li class="listitem">
					Click the <span class="strong strong"><strong>Add Feedback</strong></span> button that appears near the highlighted text.
				</li><li class="listitem">
					Add your feedback and click <span class="strong strong"><strong>Submit</strong></span>.
				</li></ol></div><div class="orderedlist"><p class="title"><strong>Submitting feedback through Bugzilla (account required)</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Log in to the <a class="link" href="https://bugzilla.redhat.com/enter_bug.cgi?product=Red%20Hat%20Enterprise%20Linux%209&amp;component=Documentation">Bugzilla</a> website.
				</li><li class="listitem">
					Select the correct version from the <span class="strong strong"><strong>Version</strong></span> menu.
				</li><li class="listitem">
					Enter a descriptive title in the <span class="strong strong"><strong>Summary</strong></span> field.
				</li><li class="listitem">
					Enter your suggestion for improvement in the <span class="strong strong"><strong>Description</strong></span> field. Include links to the relevant parts of the documentation.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Submit Bug</strong></span>.
				</li></ol></div></section><section class="chapter" id="intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Introduction to RHEL System Roles</h1></div></div></div><p class="_abstract _abstract">
			RHEL&nbsp;System&nbsp;Roles is a collection of Ansible roles and 
modules. By using RHEL&nbsp;System&nbsp;Roles, you can remotely manage 
the system configurations of multiple RHEL systems across major versions
 of RHEL. To use it to configure systems, you must use the following 
components:
		</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Control node</span></dt><dd>
						A control node is the system from which you run Ansible commands 
and playbooks. Your control node can be an Ansible Automation Platform, 
Red Hat Satellite, or a RHEL 9, 8, or 7 host. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</dd><dt><span class="term">Managed node</span></dt><dd>
						Managed nodes are the servers and network devices that you manage 
with Ansible. Managed nodes are also sometimes called hosts. Ansible 
does not have to be installed on managed nodes. For more information, 
see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a managed node</a>.
					</dd><dt><span class="term">Ansible playbook</span></dt><dd>
						In a playbook, you define the configuration you want to achieve on
 your managed nodes or a set of steps for the system on the managed node
 to perform. Playbooks are Ansible’s configuration, deployment, and 
orchestration language.
					</dd><dt><span class="term">Inventory</span></dt><dd>
						In an inventory file, you list the managed nodes and specify 
information such as IP address for each managed node. In the inventory, 
you can also organize the managed nodes by creating and nesting groups 
for easier scaling. An inventory file is also sometimes called a 
hostfile.
					</dd></dl></div><p>
			On Red&nbsp;Hat Enterprise&nbsp;Linux 9, you can use the following roles provided by the <code class="literal">rhel-system-roles</code> package, which is available in the <code class="literal">AppStream</code> repository:
		</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="xzy1f3z" id="rh-table--xzy1f3z" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th id="idm140604755199408" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Role name</th><th id="idm140604755198320" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Role description</th><th id="idm140604755197232" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">Chapter title</th></tr></thead><tbody><tr><td headers="idm140604755199408" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">certificate</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
							Certificate Issuance and Renewal
						</p>
						 </td><td headers="idm140604755197232" data-row="2" data-col="3" class="content--md" valign="top" align="left"> <p>
							Requesting certificates using RHEL System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">cockpit</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
							Web console
						</p>
						 </td><td headers="idm140604755197232" data-row="3" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Installing and configuring web console with the cockpit RHEL System Role
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">crypto_policies</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
							System-wide cryptographic policies
						</p>
						 </td><td headers="idm140604755197232" data-row="4" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Setting a custom cryptographic policy across systems
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">firewall</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
							Firewalld
						</p>
						 </td><td headers="idm140604755197232" data-row="5" data-col="3" class="content--md" valign="top" align="left"> <p>
							Configuring firewalld by using System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">ha_cluster</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
							HA Cluster
						</p>
						 </td><td headers="idm140604755197232" data-row="6" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Configuring a high-availability cluster using System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="7" data-col="1" class="content--sm" valign="top" align="left"> <p>
							<code class="literal">kdump</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="7" data-col="2" class="content--md" valign="top" align="left"> <p>
							Kernel Dumps
						</p>
						 </td><td headers="idm140604755197232" data-row="7" data-col="3" class="content--md" valign="top" align="left"> <p>
							Configuring kdump using RHEL System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">kernel_settings</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="8" data-col="2" class="content--md" valign="top" align="left"> <p>
							Kernel Settings
						</p>
						 </td><td headers="idm140604755197232" data-row="8" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Using Ansible roles to permanently configure kernel parameters
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="9" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">logging</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="9" data-col="2" class="content--md" valign="top" align="left"> <p>
							Logging
						</p>
						 </td><td headers="idm140604755197232" data-row="9" data-col="3" class="content--md" valign="top" align="left"> <p>
							Using the logging System Role
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="10" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">metrics</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="10" data-col="2" class="content--md" valign="top" align="left"> <p>
							Metrics (PCP)
						</p>
						 </td><td headers="idm140604755197232" data-row="10" data-col="3" class="content--md" valign="top" align="left"> <p>
							Monitoring performance using RHEL System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="11" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">network</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="11" data-col="2" class="content--md" valign="top" align="left"> <p>
							Networking
						</p>
						 </td><td headers="idm140604755197232" data-row="11" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Using the network RHEL System Role to manage InfiniBand connections
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="12" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">nbde_client</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="12" data-col="2" class="content--md" valign="top" align="left"> <p>
							Network Bound Disk Encryption client
						</p>
						 </td><td headers="idm140604755197232" data-row="12" data-col="3" class="content--md" valign="top" align="left"> <p>
							Using the nbde_client and nbde_server System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="13" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">nbde_server</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="13" data-col="2" class="content--md" valign="top" align="left"> <p>
							Network Bound Disk Encryption server
						</p>
						 </td><td headers="idm140604755197232" data-row="13" data-col="3" class="content--md" valign="top" align="left"> <p>
							Using the nbde_client and nbde_server System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="14" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">postfix</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="14" data-col="2" class="content--md" valign="top" align="left"> <p>
							Postfix
						</p>
						 </td><td headers="idm140604755197232" data-row="14" data-col="3" class="content--md" valign="top" align="left"> <p>
							Variables of the postfix role in System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="15" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">selinux</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="15" data-col="2" class="content--md" valign="top" align="left"> <p>
							SELinux
						</p>
						 </td><td headers="idm140604755197232" data-row="15" data-col="3" class="content--md" valign="top" align="left"> <p>
							Configuring SELinux using System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="16" data-col="1" class="content--sm" valign="top" align="left"> <p>
							<code class="literal">ssh</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="16" data-col="2" class="content--md" valign="top" align="left"> <p>
							SSH client
						</p>
						 </td><td headers="idm140604755197232" data-row="16" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Configuring secure communication with the ssh System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="17" data-col="1" class="content--sm" valign="top" align="left"> <p>
							<code class="literal">sshd</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="17" data-col="2" class="content--md" valign="top" align="left"> <p>
							SSH server
						</p>
						 </td><td headers="idm140604755197232" data-row="17" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Configuring secure communication with the ssh System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="18" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">storage</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="18" data-col="2" class="content--md" valign="top" align="left"> <p>
							Storage
						</p>
						 </td><td headers="idm140604755197232" data-row="18" data-col="3" class="content--md" valign="top" align="left"> <p>
							Managing local storage using RHEL System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="19" data-col="1" class="content--sm" valign="top" align="left"> <p>
							<code class="literal">tlog</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="19" data-col="2" class="content--md" valign="top" align="left"> <p>
							Terminal Session Recording
						</p>
						 </td><td headers="idm140604755197232" data-row="19" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Configuring a system for session recording using the tlog RHEL System Role
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="20" data-col="1" class="content--md" valign="top" align="left"> <p>
							<code class="literal">timesync</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="20" data-col="2" class="content--md" valign="top" align="left"> <p>
							Time Synchronization
						</p>
						 </td><td headers="idm140604755197232" data-row="20" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Configuring time synchronization using RHEL System Roles
						</p>
						 </td></tr><tr><td headers="idm140604755199408" data-row="21" data-col="1" class="content--sm" valign="top" align="left"> <p>
							<code class="literal">vpn</code>
						</p>
						 </td><td headers="idm140604755198320" data-row="21" data-col="2" class="content--sm" valign="top" align="left"> <p>
							VPN
						</p>
						 </td><td headers="idm140604755197232" data-row="21" data-col="3" class="content--lg" valign="top" align="left"> <p>
							Configuring VPN connections with IPsec by using the vpn RHEL System Role
						</p>
						 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<a class="link" href="https://access.redhat.com/articles/3050101">Red Hat Enterprise Linux (RHEL) System Roles</a>
				</li><li class="listitem">
					<code class="literal filename">/usr/share/doc/rhel-system-roles/</code> provided by the <code class="literal">rhel-system-roles</code> package
				</li></ul></div></section><section class="chapter" id="assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Preparing a control node and managed nodes to use RHEL System Roles</h1></div></div></div><p>
			Before you can use individual RHEL&nbsp;System&nbsp;Roles to manage 
services and settings, you must prepare the control node and managed 
nodes.
		</p><section class="section" id="proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">2.1. Preparing a control node on RHEL 9</h2></div></div></div><p>
				Before using RHEL System Roles, you must configure a control node. 
This system then configures the managed hosts from the inventory 
according to the playbooks.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						RHEL 8.6 or later is installed. For more information about installing RHEL, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/performing_a_standard_rhel_9_installation/index">Performing a standard RHEL 9 installation</a>.
					</li><li class="listitem">
						The system is registered to the Customer Portal.
					</li><li class="listitem">
						A <code class="literal">Red Hat Enterprise Linux Server</code> subscription is attached to the system.
					</li><li class="listitem">
						If available in your Customer Portal account, an <code class="literal">Ansible Automation Platform</code> subscription is attached to the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">rhel-system-roles</code> package:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--s0hyu3p"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[root@control-node]# <span class="strong strong"><strong>dnf install rhel-system-roles</strong></span></pre></div></div><p class="simpara">
						This command installs the <code class="literal">ansible-core</code> package as a dependency.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							In RHEL 8.5 and earlier versions, Ansible packages were provided 
through Ansible Engine instead of Ansible Core, and with a different 
level of support. Do not use Ansible Engine because the packages might 
not be compatible with Ansible automation content in RHEL 8.6 and later.
 For more information, see <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a>.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Create a user named <code class="literal">ansible</code> to manage and run playbooks:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--iuwh7ac"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[root@control-node]# <span class="strong strong"><strong>useradd ansible</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Switch to the newly created <code class="literal">ansible</code> user:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--aniip6b"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[root@control-node]# <span class="strong strong"><strong>su - ansible</strong></span></pre></div></div><p class="simpara">
						Perform the rest of the procedure as this user.
					</p></li><li class="listitem"><p class="simpara">
						Create an SSH public and private key:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--y8r3m7m"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[ansible@control-node]$ <span class="strong strong"><strong>ssh-keygen</strong></span>
Generating public/private rsa key pair.
Enter file in which to save the key (/home/ansible/.ssh/id_rsa): <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>
...</pre></div></div><p class="simpara">
						Use the suggested default location for the key file.
					</p></li><li class="listitem">
						Optional: To prevent Ansible from prompting you for the SSH key 
password each time you establish a connection, configure an SSH agent.
					</li><li class="listitem"><p class="simpara">
						Create the <code class="literal">~/.ansible.cfg</code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--kj63q4q"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"><span class="strong strong"><strong>[defaults]</strong></span>
<span class="strong strong"><strong>inventory = <span class="emphasis"><em>/home/ansible/inventory</em></span></strong></span>
<span class="strong strong"><strong>remote_user = ansible</strong></span>

<span class="strong strong"><strong>[privilege_escalation]</strong></span>
<span class="strong strong"><strong>become = <span class="emphasis"><em>True</em></span></strong></span>
<span class="strong strong"><strong>become_method = <span class="emphasis"><em>sudo</em></span></strong></span>
<span class="strong strong"><strong>become_user = <span class="emphasis"><em>root</em></span></strong></span>
<span class="strong strong"><strong>become_ask_pass = <span class="emphasis"><em>True</em></span></strong></span></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Settings in the <code class="literal">~/.ansible.cfg</code> file have a higher priority and override settings from the global <code class="literal">/etc/ansible/ansible.cfg</code> file.
						</p></div></div><p class="simpara">
						With these settings, Ansible performs the following actions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Manages hosts in the specified inventory file.
							</li><li class="listitem">
								Uses the account set in the <code class="literal">remote_user</code> parameter when it establishes SSH connections to managed nodes.
							</li><li class="listitem">
								Uses the <code class="literal">sudo</code> utility to execute tasks on managed nodes as the <code class="literal">root</code> user.
							</li><li class="listitem">
								Prompts for the root password of the remote user every time you 
apply a playbook. This is recommended for security reasons.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Create an <code class="literal">~/inventory</code> file in INI or 
YAML format that lists the hostnames of managed hosts. You can also 
define groups of hosts in the inventory file. For example, the following
 is an inventory file in the INI format with three hosts and one host 
group named <code class="literal">US</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--despcg2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"><span class="strong strong"><strong>managed-node-01.example.com</strong></span>

<span class="strong strong"><strong>[US]</strong></span>
<span class="strong strong"><strong>managed-node-02.example.com ansible_host=192.0.2.100</strong></span>
<span class="strong strong"><strong>managed-node-03.example.com</strong></span></pre></div></div><p class="simpara">
						Note that the control node must be able to resolve the hostnames. 
If the DNS server cannot resolve certain hostnames, add the <code class="literal">ansible_host</code> parameter next to the host entry to specify its IP address.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Prepare the managed nodes. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a managed node</a>.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/253273">How to register and subscribe a system to the Red Hat Customer Portal using subscription-manager</a>
					</li><li class="listitem">
						The <code class="literal">ssh-keygen(1)</code> man page
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks#connecting-to-remote-machines-with-ssh-keys-using-ssh-agent_assembly_using-secure-communications-between-two-systems-with-openssh">Connecting to remote machines with SSH keys using ssh-agent</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/2.9/reference_appendices/config.html">Ansible configuration settings</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/2.9/user_guide/intro_inventory.html">How to build your inventory</a>
					</li></ul></div></section><section class="section" id="proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">2.2. Preparing a managed node</h2></div></div></div><p>
				Managed nodes are the systems listed in the inventory and which will
 be configured by the control node according to the playbook. You do not
 have to install Ansible on managed hosts.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You prepared the control node. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li><li class="listitem"><p class="simpara">
						You have SSH access from the control node.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							Direct SSH access as the <code class="literal">root</code> user is a security risk. To reduce this risk, you will create a local user on this node and configure a <code class="literal">sudo</code>
 policy when preparing a managed node. Ansible on the control node can 
then use the local user account to log in to the managed node and run 
playbooks as different users, such as <code class="literal">root</code>.
						</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a user named <code class="literal">ansible</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1z242by"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[root@managed-node-01]# <span class="strong strong"><strong>useradd ansible</strong></span></pre></div></div><p class="simpara">
						The control node later uses this user to establish an SSH connection to this host.
					</p></li><li class="listitem"><p class="simpara">
						Set a password for the <code class="literal">ansible</code> user:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vo51vis"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[root@managed-node-01]# <span class="strong strong"><strong>passwd ansible</strong></span>
Changing password for user ansible.
New password: <span class="emphasis"><em>&lt;password&gt;</em></span>
Retype new password: <span class="emphasis"><em>&lt;password&gt;</em></span>
passwd: all authentication tokens updated successfully.</pre></div></div><p class="simpara">
						You must enter this password when Ansible uses <code class="literal">sudo</code> to perform tasks as the <code class="literal">root</code> user.
					</p></li><li class="listitem"><p class="simpara">
						Install the <code class="literal">ansible</code> user’s SSH public key on the managed node:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Log in to the control node as the <code class="literal">ansible</code> user, and copy the SSH public key to the managed node:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wfeugo4"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[ansible@control-node]$ <span class="strong strong"><strong>ssh-copy-id managed-node-01.example.com</strong></span>
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/ansible/.ssh/id_rsa.pub"
The authenticity of host '<span class="emphasis"><em>managed-node-01.example.com</em></span> (<span class="emphasis"><em>192.0.2.100</em></span>)' can't be established.
<span class="emphasis"><em>ECDSA</em></span> key fingerprint is <span class="emphasis"><em>SHA256:9bZ33GJNODK3zbNhybokN/6Mq7hu3vpBXDrCxe7NAvo</em></span>.</pre></div></div></li><li class="listitem"><p class="simpara">
								When prompted, connect by entering <code class="literal">yes</code>:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1tr2wm2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">Are you sure you want to continue connecting (yes/no/[fingerprint])? <span class="strong strong"><strong>yes</strong></span>
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</pre></div></div></li><li class="listitem"><p class="simpara">
								When prompted, enter the password:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vmq4ane"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">ansible@<span class="emphasis"><em>managed-node-01.example.com</em></span>'s password: <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh '<span class="emphasis"><em>&lt;managed-node-01.example.com&gt;</em></span>'"
and check to make sure that only the key(s) you wanted were added.</pre></div></div></li><li class="listitem"><p class="simpara">
								Verify the SSH connection by remotely executing a command on the control node:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bvz7xha"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[ansible@control-node]$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>&lt;managed-node-01.example.com&gt;</em></span> whoami</strong></span>
ansible</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Create a <code class="literal">sudo</code> configuration for the <code class="literal">ansible</code> user:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create and edit the <code class="literal">/etc/sudoers.d/ansible</code> file by using the <code class="literal">visudo</code> command:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jlycmro"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[root@managed-node-01]# <span class="strong strong"><strong>visudo /etc/sudoers.d/ansible</strong></span></pre></div></div><p class="simpara">
								The benefit of using <code class="literal">visudo</code> over a normal editor is that this utility provides basic sanity checks and checks for parse errors before installing the file.
							</p></li><li class="listitem"><p class="simpara">
								Configure a <code class="literal">sudoers</code> policy in the <code class="literal">/etc/sudoers.d/ansible</code> file that meets your requirements, for example:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										To grant permissions to the <code class="literal">ansible</code> user to run all commands as any user and group on this host after entering the <code class="literal">ansible</code> user’s password, use:
									</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xe8cckx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"><span class="strong strong"><strong>ansible ALL=(ALL) ALL</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
										To grant permissions to the <code class="literal">ansible</code> user to run all commands as any user and group on this host without entering the <code class="literal">ansible</code> user’s password, use:
									</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--h6geiuu"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"><span class="strong strong"><strong>ansible ALL=(ALL) NOPASSWD: ALL</strong></span></pre></div></div></li></ul></div></li></ol></div><p class="simpara">
						Alternatively, configure a more fine-granular policy that matches your security requirements. For further details on <code class="literal">sudoers</code> policies, see the <code class="literal">sudoers(5)</code> man page.
					</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that you can execute commands from the control node on an all managed nodes:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1sgmkyw"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[ansible@control-node]$ <span class="strong strong"><strong>ansible all -m ping</strong></span>
BECOME password: <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>
managed-node-01.example.com | <span class="strong strong"><strong>SUCCESS</strong></span> =&gt; {
    	"ansible_facts": {
    	    "discovered_interpreter_python": "/usr/bin/python3"
    	},
    	"changed": false,
    	"ping": "pong"
}
...</pre></div></div><p class="simpara">
						The hard-coded all group dynamically contains all hosts listed in the inventory file.
					</p></li><li class="listitem"><p class="simpara">
						Verify that privilege escalation works correctly by running the <code class="literal">whoami</code> utility on a managed host by using the Ansible <code class="literal">command</code> module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--j95cnhg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">[ansible@control-node]$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a whoami</strong></span>
BECOME password: <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
<span class="strong strong"><strong>root</strong></span></pre></div></div><p class="simpara">
						If the command returns root, you configured <code class="literal">sudo</code> on the managed nodes correctly.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li><li class="listitem">
						The <code class="literal">sudoers(5)</code> man page
					</li></ul></div></section></section><section class="chapter" id="installing-and-using-collections_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Installing and Using Collections</h1></div></div></div><section class="section" id="introduction-to-ansible-collections_installing-and-using-collections"><div class="titlepage"><div><div><h2 class="title">3.1. Introduction to Ansible Collections</h2></div></div></div><p class="_abstract _abstract">
				Ansible Collections are the new way of distributing, maintaining, 
and consuming automation. By combining multiple types of Ansible content
 such as playbooks, roles, modules, and plugins, you can benefit from 
improvements in flexibility and scalability.
			</p><p>
				The Ansible Collections are an option to the traditional 
RHEL&nbsp;System&nbsp;Roles format. Using the 
RHEL&nbsp;System&nbsp;Roles in the Ansible Collection format is almost 
the same as using it in the traditional RHEL&nbsp;System&nbsp;Roles 
format. The difference is that Ansible Collections use the concept of a <code class="literal">fully qualified collection name</code> (FQCN), which consists of a <code class="literal">namespace</code> and the <code class="literal">collection name</code>. The <code class="literal">namespace</code> we use is <code class="literal">redhat</code> and the <code class="literal">collection name</code> is <code class="literal">rhel_system_roles</code>. So, while the traditional RHEL&nbsp;System&nbsp;Roles format for the <code class="literal">kernel_settings</code> role is presented as <code class="literal">rhel-system-roles.kernel_settings</code> (with dashes), using the Collection <code class="literal">fully qualified collection name</code> for the <code class="literal">kernel_settings</code> role would be presented as <code class="literal">redhat.rhel_system_roles.kernel_settings</code> (with underscores).
			</p><p>
				The combination of a <code class="literal">namespace</code> and a <code class="literal">collection name</code>
 guarantees that the objects are unique. It also ensures that objects 
are shared across the Ansible Collections and namespaces without any 
conflicts.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						To use the Red Hat Certified Collections by accessing the <a class="link" href="https://console.redhat.com/ansible/automation-hub/repo/published/redhat/rhel_system_roles/docs">Automation Hub</a>, you must have an Ansible Automation Platform (AAP subscription).
					</li></ul></div></section><section class="section" id="collections-structure_installing-and-using-collections"><div class="titlepage"><div><div><h2 class="title">3.2. Collections structure</h2></div></div></div><p class="_abstract _abstract">
				Collections are a package format for Ansible content. The data structure is as below:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						docs/: local documentation for the collection, with examples, if the role provides the documentation
					</li><li class="listitem">
						galaxy.yml: source data for the MANIFEST.json that will be part of the Ansible Collection package
					</li><li class="listitem"><p class="simpara">
						playbooks/: playbooks are available here
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								tasks/: this holds 'task list files' for include_tasks/import_tasks usage
							</li></ul></div></li><li class="listitem"><p class="simpara">
						plugins/: all Ansible plugins and modules are available here, each in its subdirectory
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								modules/: Ansible modules
							</li><li class="listitem">
								modules_utils/: common code for developing modules
							</li><li class="listitem">
								lookup/: search for a plugin
							</li><li class="listitem">
								filter/: Jinja2 filter plugin
							</li><li class="listitem">
								connection/: connection plugins required if not using the default
							</li></ul></div></li><li class="listitem">
						roles/: directory for Ansible roles
					</li><li class="listitem">
						tests/: tests for the collection’s content
					</li></ul></div></section><section class="section" id="installing-collections_installing-and-using-collections"><div class="titlepage"><div><div><h2 class="title">3.3. Installing Collections by using the CLI</h2></div></div></div><p class="_abstract _abstract">
				Collections are a distribution format for Ansible content that can include playbooks, roles, modules, and plugins.
			</p><p>
				You can install Collections through Ansible Galaxy, through the browser, or by using the command line.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li><li class="listitem">
								An inventory file which lists the managed nodes.
							</li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Install the collection via RPM package:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--p2fb4lh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf install rhel-system-roles</strong></span></pre></div></div></li></ul></div><p>
				After the installation is finished, the roles are available as <code class="literal">redhat.rhel_system_roles.&lt;role_name&gt;</code>. Additionally, you can find the documentation for each role at <code class="literal">/usr/share/ansible/collections/ansible_collections/redhat/rhel_system_roles/roles/&lt;role_name&gt;/README.md</code>.
			</p><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					To verify the installation, run the <code class="literal">kernel_settings</code> role with <code class="literal">check</code> mode on your localhost. You must also use the <code class="literal">--become</code> parameter because it is necessary for the Ansible <code class="literal">package</code> module. However, the parameter will not change your system:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the following command:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nny9v4a"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"><span class="strong strong"><strong>$ ansible-playbook -c local -i localhost, --check --become /usr/share/ansible/collections/ansible_collections/redhat/rhel_system_roles/tests/kernel_settings/tests_default.yml</strong></span></pre></div></div></li></ol></div><p>
				The last line of the command output should contain the value <code class="literal">failed=0</code>.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The comma after <code class="literal">localhost</code> is mandatory. You must add it even if there is only one host on the list. Without it, <code class="literal">ansible-playbook</code> would identify <code class="literal">localhost</code> as a file or a directory.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">ansible-playbook</code> man page.
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-i">The <code class="literal">-i</code> option of the <code class="literal">ansible-playbook</code> command</a>
					</li></ul></div></section><section class="section" id="installing-collections-from-automation-hub_installing-and-using-collections"><div class="titlepage"><div><div><h2 class="title">3.4. Installing Collections from Automation Hub</h2></div></div></div><p class="_abstract _abstract">
				If you are using the Automation Hub, you can install the 
RHEL&nbsp;System&nbsp;Roles Collection hosted on the Automation Hub.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li><li class="listitem">
								An inventory file which lists the managed nodes.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Define Red Hat Automation Hub as the default source for content in the <code class="literal">ansible.cfg</code> configuration file. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/1.2/html/getting_started_with_red_hat_ansible_automation_hub/proc-configure-automation-hub-server">Configuring Red Hat Automation Hub as the primary source for content</a> .
					</li><li class="listitem"><p class="simpara">
						Install the <code class="literal">redhat.rhel_system_roles</code> collection from the Automation Hub:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--tsdftge"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-galaxy collection install redhat.rhel_system_roles</strong></span></pre></div></div><p class="simpara">
						After the installation is finished, the roles are available as <code class="literal">redhat.rhel_system_roles.&lt;role_name&gt;</code>. Additionally, you can find the documentation for each role at <code class="literal">/usr/share/ansible/collections/ansible_collections/redhat/rhel_system_roles/roles/&lt;role_name&gt;/README.md</code>.
					</p></li></ol></div><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					To verify the install, run the <code class="literal">kernel_settings</code> role with <code class="literal">check</code> mode on your localhost. You must also use the <code class="literal">--become</code> parameter because it is necessary for the Ansible <code class="literal">package</code> module. However, the parameter will not change your system:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the following command:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--k81sllc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"><span class="strong strong"><strong>$ ansible-playbook -c local -i localhost, --check --become /usr/share/ansible/collections/ansible_collections/redhat/rhel_system_roles/tests/kernel_settings/tests_default.yml</strong></span></pre></div></div></li></ol></div><p>
				The last line of the command output should contain the value <code class="literal">failed=0</code>.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The comma after <code class="literal">localhost</code> is mandatory. You must add it even if there is only one host on the list. Without it, <code class="literal">ansible-playbook</code> would identify <code class="literal">localhost</code> as a file or a directory.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">ansible-playbook</code> man page.
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/cli/ansible-playbook.html#cmdoption-ansible-playbook-i">The <code class="literal">-i</code> option of the <code class="literal">ansible-playbook</code> command</a>
					</li></ul></div></section><section class="section" id="deploying-the-tlog-rhel-system-role-using-collections_installing-and-using-collections"><div class="titlepage"><div><div><h2 class="title">3.5. Deploying the tlog RHEL System Role using Collections</h2></div></div></div><p class="_abstract _abstract">
				Following is an example using Collections to prepare and apply a 
playbook to deploy a logging solution on a set of separate machines.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A Galaxy collection is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--d79wibx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Deploy session recording
  hosts: all
  vars:
    tlog_scope_sssd: some
    tlog_users_sssd:
      - recordeduser

  roles:
    - redhat.rhel-system-roles.tlog</pre></div></div><p class="simpara">
						Where,
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<code class="literal">tlog_scope_sssd</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">some</code> specifies you want to record only certain users and groups, not <code class="literal">all</code> or <code class="literal">none</code>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<code class="literal">tlog_users_sssd</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">recordeduser</code> specifies the user 
you want to record a session from. Note that this does not add the user 
for you. You must set the user by yourself.
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Optionally, verify the playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zs77n58"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2jtqhxw"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>IP_Address</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span> -v</pre></div></div></li></ol></div><p>
				As a result, the playbook installs the <code class="literal">tlog</code>
 role on the system you specified. It also creates an SSSD configuration
 drop file that can be used by the users and groups that you define. 
SSSD parses and reads these users and groups to overlay <code class="literal">tlog</code> session as the shell user. Additionally, if the <code class="literal">cockpit</code> package is installed on the system, the playbook also installs the <code class="literal">cockpit-session-recording</code> package, which is a <code class="literal">Cockpit</code> module that allows you to view and play recordings in the web console interface.
			</p><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Test the syntax of the <code class="literal">/etc/rsyslog.conf</code> file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--o7qgfck"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># rsyslogd -N 1
rsyslogd: version 8.1911.0-6.el8, config validation run (level 1), master config /etc/rsyslog.conf
rsyslogd: End of config validation run. Bye.</pre></div></div></li><li class="listitem">
						Verify that the system sends messages to the log:
					</li></ol></div><p>
				To verify that the SSSD configuration drop file is created in the system, perform the following steps:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the folder where the SSSD configuration drop file is created:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ode03ol"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cd /etc/sssd/conf.d</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Check the file content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--esmo4p6"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat sssd-session-recording.conf</strong></span></pre></div></div></li></ol></div><p>
				You can see that the file contains the parameters you set in the playbook.
			</p></section></section><section class="chapter" id="assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Ansible IPMI modules in RHEL</h1></div></div></div><section class="section" id="ref_the-rhel_mgmt-collection_assembly_ansible-ipmi-modules-in-rhel"><div class="titlepage"><div><div><h2 class="title">4.1. The rhel_mgmt collection</h2></div></div></div><p class="_abstract _abstract">
				The Intelligent Platform Management Interface (IPMI) is a 
specification for a set of standard protocols to communicate with 
baseboard management controller (BMC) devices. The <code class="literal">IPMI</code> modules allow you to enable and support hardware management automation. The <code class="literal">IPMI</code> modules are available in:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">rhel_mgmt</code> Collection. The package name is <code class="literal">ansible-collection-redhat-rhel_mgmt</code>.
					</li><li class="listitem">
						The RHEL 8 AppStream, as part of the new <code class="literal">ansible-collection-redhat-rhel_mgmt</code> package.
					</li></ul></div><p>
				The following IPMI modules are available in the rhel_mgmt collection:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ipmi_boot</code>: Management of boot device order
					</li><li class="listitem">
						<code class="literal">ipmi_power</code>: Power management for machine
					</li></ul></div><p>
				The mandatory parameters used for the IPMI Modules are:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ipmi_boot</code> parameters:
					</li></ul></div><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="a19pveg" id="rh-table--a19pveg" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604758180624" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Module name</th><th id="idm140604758179536" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604758180624" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								name
							</p>
							 </td><td headers="idm140604758179536" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								Hostname or ip address of the BMC
							</p>
							 </td></tr><tr><td headers="idm140604758180624" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								password
							</p>
							 </td><td headers="idm140604758179536" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								Password to connect to the BMC
							</p>
							 </td></tr><tr><td headers="idm140604758180624" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								bootdev
							</p>
							 </td><td headers="idm140604758179536" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Device to be used on next boot
							</p>
							 <p>
								* network
							</p>
							 <p>
								* floppy
							</p>
							 <p>
								* hd
							</p>
							 <p>
								* safe
							</p>
							 <p>
								* optical
							</p>
							 <p>
								* setup
							</p>
							 <p>
								* default
							</p>
							 </td></tr><tr><td headers="idm140604758180624" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								User
							</p>
							 </td><td headers="idm140604758179536" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								Username to connect to the BMC
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ipmi_power</code> parameters:
					</li></ul></div><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="u7xx4w4" id="rh-table--u7xx4w4" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604748067120" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Module name</th><th id="idm140604748066032" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604748067120" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								name
							</p>
							 </td><td headers="idm140604748066032" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								BMC Hostname or IP address
							</p>
							 </td></tr><tr><td headers="idm140604748067120" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								password
							</p>
							 </td><td headers="idm140604748066032" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								Password to connect to the BMC
							</p>
							 </td></tr><tr><td headers="idm140604748067120" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								user
							</p>
							 </td><td headers="idm140604748066032" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								Username to connect to the BMC
							</p>
							 </td></tr><tr><td headers="idm140604748067120" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								State
							</p>
							 </td><td headers="idm140604748066032" data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Check if the machine is on the desired status
							</p>
							 <p>
								* on
							</p>
							 <p>
								* off
							</p>
							 <p>
								* shutdown
							</p>
							 <p>
								* reset
							</p>
							 <p>
								* boot
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="proc_installing-the-rhel-mgmt-collection-by-using-the-cli_assembly_ansible-ipmi-modules-in-rhel"><div class="titlepage"><div><div><h2 class="title">4.2. Installing the rhel mgmt Collection using the CLI</h2></div></div></div><p class="_abstract _abstract">
				You can install the <code class="literal">rhel_mgmt</code> Collection using the command line.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">ansible-core</code> package is installed.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Install the collection via RPM package:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wmd9hdq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>yum install ansible-collection-redhat-rhel_mgmt</strong></span></pre></div></div><p class="simpara">
						After the installation is finished, the IPMI modules are available in the <code class="literal">redhat.rhel_mgmt</code> Ansible collection.
					</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">ansible-playbook</code> man page.
					</li></ul></div></section><section class="section" id="proc_example-using-the-ipmi_boot-module_assembly_ansible-ipmi-modules-in-rhel"><div class="titlepage"><div><div><h2 class="title">4.3. Example using the ipmi_boot module</h2></div></div></div><p class="_abstract _abstract">
				The following example shows how to use the <code class="literal">ipmi_boot</code>
 module in a playbook to set a boot device for the next boot. For 
simplicity, the examples use the same host as the Ansible control host 
and managed host, thus executing the modules on the same host where the 
playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The rhel_mgmt collection is installed.
					</li><li class="listitem"><p class="simpara">
						The <code class="literal">pyghmi</code> library in the <code class="literal">python3-pyghmi</code> package is installed in one of the following locations:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The host where you execute the playbook.
							</li><li class="listitem">
								The managed host. If you use localhost as the managed host, install the <code class="literal">python3-pyghmi</code> package on the host where you execute the playbook instead.
							</li></ul></div></li><li class="listitem">
						The IPMI BMC that you want to control is accessible via network 
from the host where you execute the playbook, or the managed host (if 
not using localhost as the managed host). Note that the host whose BMC 
is being configured by the module is generally different from the host 
where the module is executing (the Ansible managed host), as the module 
contacts the BMC over the network using the IPMI protocol.
					</li><li class="listitem">
						You have credentials to access BMC with an appropriate level of access.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <span class="emphasis"><em>playbook.yml</em></span> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vp4k1mg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Sets which boot device will be used on next boot
  hosts: localhost
    tasks:
    - redhat.rhel_mgmt.ipmi_boot:
       name: bmc.host.example.com
         user: admin_user
         password: basics
         bootdev: hd</pre></div></div></li><li class="listitem"><p class="simpara">
						Execute the playbook against localhost:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wp4bd6i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook playbook.yml</strong></span></pre></div></div></li></ol></div><p>
				As a result, the output returns the value “success”.
			</p></section><section class="section" id="proc_example-using-the-ipmi_power-module_assembly_ansible-ipmi-modules-in-rhel"><div class="titlepage"><div><div><h2 class="title">4.4. Example using the ipmi_power module</h2></div></div></div><p class="_abstract _abstract">
				This example shows how to use the <code class="literal">ipmi_boot</code>
 module in a playbook to check if the system is turned on. For 
simplicity, the examples use the same host as the Ansible control host 
and managed host, thus executing the modules on the same host where the 
playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The rhel_mgmt collection is installed.
					</li><li class="listitem"><p class="simpara">
						The <code class="literal">pyghmi</code> library in the <code class="literal">python3-pyghmi</code> package is installed in one of the following locations:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The host where you execute the playbook.
							</li><li class="listitem">
								The managed host. If you use localhost as the managed host, install the <code class="literal">python3-pyghmi</code> package on the host where you execute the playbook instead.
							</li></ul></div></li><li class="listitem">
						The IPMI BMC that you want to control is accessible via network 
from the host where you execute the playbook, or the managed host (if 
not using localhost as the managed host). Note that the host whose BMC 
is being configured by the module is generally different from the host 
where the module is executing (the Ansible managed host), as the module 
contacts the BMC over the network using the IPMI protocol.
					</li><li class="listitem">
						You have credentials to access BMC with an appropriate level of access.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <span class="emphasis"><em>playbook.yml</em></span> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--088gxck"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Turn the host on
  hosts: localhost
    tasks:
    - redhat.rhel_mgmt.ipmi_power:
       name: bmc.host.example.com
         user: admin_user
         password: basics
         state: on</pre></div></div></li><li class="listitem"><p class="simpara">
						Execute the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--u45urqd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook playbook.yml</strong></span></pre></div></div></li></ol></div><p>
				The output returns the value “true”.
			</p></section></section><section class="chapter" id="assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 5. The Redfish modules in RHEL</h1></div></div></div><p>
			The Redfish modules for remote management of devices are now part of the <code class="literal">redhat.rhel_mgmt</code>
 Ansible collection. With the Redfish modules, you can easily use 
management automation on bare-metal servers and platform hardware by 
getting information about the servers or control them through an 
Out-Of-Band (OOB) controller, using the standard HTTPS transport and 
JSON format.
		</p><section class="section" id="con_the-redfish-modules_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h2 class="title">5.1. The Redfish modules</h2></div></div></div><p>
				The <code class="literal">redhat.rhel_mgmt</code> Ansible collection provides the Redfish modules to support hardware management in Ansible over Redfish. The <code class="literal">redhat.rhel_mgmt</code> collection is available in the <code class="literal">ansible-collection-redhat-rhel_mgmt</code> package. To install it, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_installing-the-rhel-mgmt-collection-by-using-the-cli_assembly_ansible-ipmi-modules-in-rhel">Installing the redhat.rhel_mgmt Collection using the CLI</a>.
			</p><p>
				The following Redfish modules are available in the <code class="literal">redhat.rhel_mgmt</code> collection:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>redfish_info</strong></span></code>: The <code class="literal">redfish_info</code> module retrieves information about the remote Out-Of-Band (OOB) controller such as systems inventory.
					</li><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>redfish_command</strong></span></code>: The <code class="literal">redfish_command</code>
 module performs Out-Of-Band (OOB) controller operations like log 
management and user management, and power operations such as system 
restart, power on and off.
					</li><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>redfish_config</strong></span></code>: The <code class="literal">redfish_config</code> module performs OOB controller operations such as changing OOB configuration, or setting the BIOS configuration.
					</li></ol></div></section><section class="section" id="ref_redfish-modules-parameters_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h2 class="title">5.2. Redfish modules parameters</h2></div></div></div><p>
				The parameters used for the Redfish modules are:
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="7svwoxq" id="rh-table--7svwoxq" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604756914592" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left"><code class="literal">redfish_info</code> parameters:</th><th id="idm140604756913184" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604756914592" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">baseuri</code>
							</p>
							 </td><td headers="idm140604756913184" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								(Mandatory) - Base URI of OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604756914592" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">category</code>
							</p>
							 </td><td headers="idm140604756913184" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								(Mandatory) - List of categories to execute on OOB controller. The default value is ["Systems"].
							</p>
							 </td></tr><tr><td headers="idm140604756914592" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">command</code>
							</p>
							 </td><td headers="idm140604756913184" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								(Mandatory) - List of commands to execute on OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604756914592" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">username</code>
							</p>
							 </td><td headers="idm140604756913184" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								Username for authentication to OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604756914592" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">password</code>
							</p>
							 </td><td headers="idm140604756913184" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Password for authentication to OOB controller.
							</p>
							 </td></tr></tbody></table></rh-table><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="9yer6f2" id="rh-table--9yer6f2" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604748946464" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left"><code class="literal">redfish_command</code> parameters:</th><th id="idm140604748945056" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604748946464" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">baseuri</code>
							</p>
							 </td><td headers="idm140604748945056" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								(Mandatory) - Base URI of OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604748946464" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">category</code>
							</p>
							 </td><td headers="idm140604748945056" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								(Mandatory) - List of categories to execute on OOB controller. The default value is ["Systems"].
							</p>
							 </td></tr><tr><td headers="idm140604748946464" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">command</code>
							</p>
							 </td><td headers="idm140604748945056" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								(Mandatory) - List of commands to execute on OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604748946464" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">username</code>
							</p>
							 </td><td headers="idm140604748945056" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								Username for authentication to OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604748946464" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">password</code>
							</p>
							 </td><td headers="idm140604748945056" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Password for authentication to OOB controller.
							</p>
							 </td></tr></tbody></table></rh-table><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="hzoejj3" id="rh-table--hzoejj3" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604751803536" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left"><code class="literal">redfish_config</code> parameters:</th><th id="idm140604751802128" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604751803536" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">baseuri</code>
							</p>
							 </td><td headers="idm140604751802128" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								(Mandatory) - Base URI of OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604751803536" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">category</code>
							</p>
							 </td><td headers="idm140604751802128" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								(Mandatory) - List of categories to execute on OOB controller. The default value is ["Systems"].
							</p>
							 </td></tr><tr><td headers="idm140604751803536" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">command</code>
							</p>
							 </td><td headers="idm140604751802128" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								(Mandatory) - List of commands to execute on OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604751803536" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">username</code>
							</p>
							 </td><td headers="idm140604751802128" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								Username for authentication to OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604751803536" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">password</code>
							</p>
							 </td><td headers="idm140604751802128" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Password for authentication to OOB controller.
							</p>
							 </td></tr><tr><td headers="idm140604751803536" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">bios_attributes</code>
							</p>
							 </td><td headers="idm140604751802128" data-row="7" data-col="2" class="content--md" valign="top" align="left"> <p>
								BIOS attributes to update.
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="proc_using-the-redfish-info-module_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h2 class="title">5.3. Using the redfish_info module</h2></div></div></div><p>
				The following example shows how to use the <code class="literal">redfish_info</code>
 module in a playbook to get information about the CPU inventory. For 
simplicity, the example uses the same host as the Ansible control host 
and managed host, thus executing the modules on the same host where the 
playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">redhat.rhel_mgmt</code> collection is installed.
					</li><li class="listitem">
						The <code class="literal">pyghmi</code> library in the <code class="literal">python3-pyghmi</code> package is installed on the managed host. If you use localhost as the managed host, install the <code class="literal">python3-pyghmi</code> package on the host where you execute the playbook.
					</li><li class="listitem">
						OOB controller access details.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <span class="emphasis"><em>playbook.yml</em></span> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--u021cos"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Get CPU inventory
  hosts: localhost
  tasks:
    - redhat.rhel_mgmt.redfish_info:
        baseuri: "{{ baseuri }}"
        username: "{{ username }}"
        password: "{{ password }}"
        category: Systems
        command: GetCpuInventory
      register: result</pre></div></div></li><li class="listitem"><p class="simpara">
						Execute the playbook against localhost:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--19j7ewa"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># ansible-playbook playbook.yml</pre></div></div></li></ol></div><p>
				As a result, the output returns the CPU inventory details.
			</p></section><section class="section" id="proc_using-the-redfish-command-module_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h2 class="title">5.4. Using the redfish_command module</h2></div></div></div><p>
				The following example shows how to use the <code class="literal">redfish_command</code>
 module in a playbook to turn on a system. For simplicity, the example 
uses the same host as the Ansible control host and managed host, thus 
executing the modules on the same host where the playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">redhat.rhel_mgmt</code> collection is installed.
					</li><li class="listitem">
						The <code class="literal">pyghmi</code> library in the <code class="literal">python3-pyghmi</code> package is installed on the managed host. If you use localhost as the managed host, install the <code class="literal">python3-pyghmi</code> package on the host where you execute the playbook.
					</li><li class="listitem">
						OOB controller access details.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <span class="emphasis"><em>playbook.yml</em></span> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--z65j58b"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Power on system
  hosts: localhost
  tasks:
    - redhat.rhel_mgmt.redfish_command:
        baseuri: "{{ baseuri }}"
        username: "{{ username }}"
        password: "{{ password }}"
        category: Systems
        command: PowerOn</pre></div></div></li><li class="listitem"><p class="simpara">
						Execute the playbook against localhost:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ld1vos5"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># ansible-playbook playbook.yml</pre></div></div></li></ol></div><p>
				As a result, the system powers on.
			</p></section><section class="section" id="proc_using-the-redfish-config-module_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h2 class="title">5.5. Using the redfish_config module</h2></div></div></div><p>
				The following example shows how to use the <code class="literal">redfish_config</code>
 module in a playbook to configure a system to boot with UEFI. For 
simplicity, the example uses the same host as the Ansible control host 
and managed host, thus executing the modules on the same host where the 
playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">redhat.rhel_mgmt</code> collection is installed.
					</li><li class="listitem">
						The <code class="literal">pyghmi</code> library in the <code class="literal">python3-pyghmi</code> package is installed on the managed host. If you use localhost as the managed host, install the <code class="literal">python3-pyghmi</code> package on the host where you execute the playbook.
					</li><li class="listitem">
						OOB controller access details.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <span class="emphasis"><em>playbook.yml</em></span> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--62px57x"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: "Set BootMode to UEFI"
  hosts: localhost
  tasks:
    - redhat.rhel_mgmt.redfish_config:
        baseuri: "{{ baseuri }}"
        username: "{{ username }}"
        password: "{{ password }}"
        category: Systems
        command: SetBiosAttributes
        bios_attributes:
          BootMode: Uefi</pre></div></div></li><li class="listitem"><p class="simpara">
						Execute the playbook against localhost:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--t4j3f1d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># ansible-playbook playbook.yml</pre></div></div></li></ol></div><p>
				As a result, the system boot mode is set to UEFI.
			</p></section></section><section class="chapter" id="configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Configuring kernel parameters permanently by using the kernel_settings RHEL System Role</h1></div></div></div><p class="_abstract _abstract">
			You can use the <code class="literal">kernel_settings</code> role to configure kernel parameters on multiple clients at once. This solution:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Provides a friendly interface with efficient input setting.
				</li><li class="listitem">
					Keeps all intended kernel parameters in one place.
				</li></ul></div><p>
			After you run the <code class="literal">kernel_settings</code> role from the control machine, the kernel parameters are applied to the managed systems immediately and persist across reboots.
		</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				Note that RHEL&nbsp;System&nbsp;Role delivered over RHEL channels 
are available to RHEL customers as an RPM package in the default 
AppStream repository. RHEL&nbsp;System&nbsp;Role are also available as a
 collection to customers with Ansible subscriptions over Ansible 
Automation Hub.
			</p></div></div><section class="section" id="introduction-to-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">6.1. Introduction to the kernel_settings role</h2></div></div></div><p class="_abstract _abstract">
				RHEL&nbsp;System&nbsp;Roles is a set of roles that provide a 
consistent configuration interface to remotely manage multiple systems.
			</p><p>
				RHEL&nbsp;System&nbsp;Roles were introduced for automated configurations of the kernel using the <code class="literal">kernel_settings</code> System Role. The <code class="literal">rhel-system-roles</code> package contains this system role, and also the reference documentation.
			</p><p>
				To apply the kernel parameters on one or more systems in an automated fashion, use the <code class="literal">kernel_settings</code>
 role with one or more of its role variables of your choice in a 
playbook. A playbook is a list of one or more plays that are 
human-readable, and are written in the YAML format.
			</p><p>
				With the <code class="literal">kernel_settings</code> role you can configure:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The kernel parameters using the <code class="literal">kernel_settings_sysctl</code> role variable
					</li><li class="listitem">
						Various kernel subsystems, hardware devices, and device drivers using the <code class="literal">kernel_settings_sysfs</code> role variable
					</li><li class="listitem">
						The CPU affinity for the <code class="literal">systemd</code> service manager and processes it forks using the <code class="literal">kernel_settings_systemd_cpu_affinity</code> role variable
					</li><li class="listitem">
						The kernel memory subsystem transparent hugepages using the <code class="literal">kernel_settings_transparent_hugepages</code> and <code class="literal">kernel_settings_transparent_hugepages_defrag</code> role variables
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">README.md</code> and <code class="literal">README.html</code> files in the <code class="literal">/usr/share/doc/rhel-system-roles/kernel_settings/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks.html">Working with playbooks</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html">How to build your inventory</a>
					</li></ul></div></section><section class="section" id="applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">6.2. Applying selected kernel parameters using the kernel_settings role</h2></div></div></div><p class="_abstract _abstract">
				Follow these steps to prepare and apply an Ansible playbook to 
remotely configure kernel parameters with persisting effect on multiple 
managed operating systems.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> permissions.
					</li><li class="listitem">
						Entitled by your RHEL subscription, you installed the <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages on the control machine.
					</li><li class="listitem">
						An inventory of managed hosts is present on the control machine and Ansible is able to connect to them.
					</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0 - 8.5 provided access to a separate Ansible repository 
that contains Ansible Engine 2.9 for automation based on Ansible. 
Ansible Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>; connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>; and the entire world of plugins and modules. For information about how to obtain and install Ansible Engine, refer to <a class="link" href="https://access.redhat.com/articles/3174981">How do I Download and Install Red Hat Ansible Engine?</a>.
				</p><p>
					RHEL 8.6 and 9.0 has introduced Ansible Core (provided as <code class="literal">ansible-core</code>
 RPM), which contains the Ansible command-line utilities, commands, and a
 small set of built-in Ansible plugins. The AppStream repository 
provides <code class="literal">ansible-core</code>, which has a limited scope of support. You can learn more by reviewing <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the ansible-core package included in the RHEL 9 AppStream</a>.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optionally, review the <code class="literal">inventory</code> file for illustration purposes:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yw66u4v"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>cat /home/jdoe/&lt;<span class="emphasis"><em>ansible_project_name</em></span>&gt;/inventory</strong></span>
[testingservers]
pdoe@192.168.122.98
fdoe@192.168.122.226

[db-servers]
db1.example.com
db2.example.com

[webservers]
web1.example.com
web2.example.com
192.0.2.42</pre></div></div><p class="simpara">
						The file defines the <code class="literal">[testingservers]</code> group and other groups. It allows you to run Ansible more effectively against a specific set of systems.
					</p></li><li class="listitem"><p class="simpara">
						Create a configuration file to set defaults and privilege escalation for Ansible operations.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new YAML file and open it in a text editor, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8vplgly"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>vi /home/jdoe/&lt;<span class="emphasis"><em>ansible_project_name</em></span>&gt;/ansible.cfg</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Insert the following content into the file:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--t5txi8c"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">[defaults]
inventory = ./inventory

[privilege_escalation]
become = true
become_method = sudo
become_user = root
become_ask_pass = true</pre></div></div><p class="simpara">
								The <code class="literal">[defaults]</code> section specifies a path to the inventory file of managed hosts. The <code class="literal">[privilege_escalation]</code> section defines that user privileges be shifted to <code class="literal">root</code>
 on the specified managed hosts. This is necessary for successful 
configuration of kernel parameters. When Ansible playbook is run, you 
will be prompted for user password. The user automatically switches to <code class="literal">root</code> by means of <code class="literal">sudo</code> after connecting to a managed host.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook that uses the <code class="literal">kernel_settings</code> role.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new YAML file and open it in a text editor, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vl3guqr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>vi /home/jdoe/&lt;<span class="emphasis"><em>ansible_project_name</em></span>&gt;/kernel-roles.yml</strong></span></pre></div></div><p class="simpara">
								This file represents a playbook and usually contains an ordered list of tasks, also called <span class="emphasis"><em>plays</em></span>, that are run against specific managed hosts selected from your <code class="literal">inventory</code> file.
							</p></li><li class="listitem"><p class="simpara">
								Insert the following content into the file:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--h8aeiza"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">---
-
  hosts: testingservers
  name: "Configure kernel settings"
  roles:
    - rhel-system-roles.kernel_settings
  vars:
    kernel_settings_sysctl:
      - name: fs.file-max
        value: 400000
      - name: kernel.threads-max
        value: 65536
    kernel_settings_sysfs:
      - name: /sys/class/net/lo/mtu
        value: 65000
    kernel_settings_transparent_hugepages: madvise</pre></div></div><p class="simpara">
								The <code class="literal">name</code> key is optional. It associates an arbitrary string with the play as a label and identifies what the play is for. The <code class="literal">hosts</code>
 key in the play specifies the hosts against which the play is run. The 
value or values for this key can be provided as individual names of 
managed hosts or as groups of hosts as defined in the <code class="literal">inventory</code> file.
							</p><p class="simpara">
								The <code class="literal">vars</code> section represents a list of variables containing selected kernel parameter names and values to which they have to be set.
							</p><p class="simpara">
								The <code class="literal">roles</code> key specifies what system role is going to configure the parameters and values mentioned in the <code class="literal">vars</code> section.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You can modify the kernel parameters and their values in the playbook to fit your needs.
								</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Optionally, verify that the syntax in your play is correct.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--91y4mkd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>ansible-playbook --syntax-check kernel-roles.yml</strong></span>

playbook: kernel-roles.yml</pre></div></div><p class="simpara">
						This example shows the successful verification of a playbook.
					</p></li><li class="listitem"><p class="simpara">
						Execute your playbook.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--g6xj81p"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">#  <span class="strong strong"><strong>ansible-playbook kernel-roles.yml</strong></span>

...

BECOME password:

PLAY [Configure kernel settings] **********************************************************************************



PLAY RECAP ********************************************************************************************************
fdoe@192.168.122.226       : ok=10   changed=4    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0
pdoe@192.168.122.98        : ok=10   changed=4    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0</pre></div></div><p class="simpara">
						Before Ansible runs your playbook, you are going to be prompted 
for your password and so that a user on managed hosts can be switched to
 <code class="literal">root</code>, which is necessary for configuring kernel parameters.
					</p><p class="simpara">
						The recap section shows that the play finished successfully (<code class="literal">failed=0</code>) for all managed hosts, and that 4 kernel parameters have been applied (<code class="literal">changed=4</code>).
					</p></li><li class="listitem">
						Restart your managed hosts and check the affected kernel 
parameters to verify that the changes have been applied and persist 
across reboots.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL System Roles</a>
					</li><li class="listitem">
						<code class="literal">README.html</code> and <code class="literal">README.md</code> files in the <code class="literal">/usr/share/doc/rhel-system-roles/kernel_settings/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/network/getting_started/first_inventory.html">Build Your Inventory</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_configuration.html">Configuring Ansible</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks.html">Working With Playbooks</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html">Using Variables</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html">Roles</a>
					</li></ul></div></section></section><section class="chapter" id="using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Using the rhc System Role to register the system</h1></div></div></div><p>
			The <code class="literal">rhc</code> RHEL&nbsp;System&nbsp;Role 
enables administrators to automate the registration of multiple systems 
with Red Hat Subscription Management (RHSM) and Satellite servers. The 
role also supports Insights-related configuration and management tasks 
by using Ansible.
		</p><section class="section" id="introduction-to-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.1. Introduction to the rhc System Role</h2></div></div></div><p>
				RHEL&nbsp;System&nbsp;Role is a set of roles that provides a 
consistent configuration interface to remotely manage multiple systems. 
The remote host configuration (<code class="literal">rhc</code>) System 
Role enables administrators to easily register RHEL systems to Red Hat 
Subscription Management (RHSM) and Satellite servers. By default, when 
you register a system by using the <code class="literal">rhc</code> System Role, the system is connected to Insights. Additionally, with the <code class="literal">rhc</code> System Role, you can:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Configure connections to Red Hat Insights
					</li><li class="listitem">
						Enable and disable repositories
					</li><li class="listitem">
						Configure the proxy to use for the connection
					</li><li class="listitem">
						Configure insights remediations and, auto updates
					</li><li class="listitem">
						Set the release of the system
					</li><li class="listitem">
						Configure insights tags
					</li></ul></div></section><section class="section" id="registering-system-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.2. Registering a system by using the rhc System Role</h2></div></div></div><p>
				You can register your system to Red Hat by using the <code class="literal">rhc</code> RHEL&nbsp;System&nbsp;Role. By default, the <code class="literal">rhc</code> RHEL&nbsp;System&nbsp;Role connects the system to Red Hat Insights when you register it.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a vault to save the sensitive information:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--iqsuoj6"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault create <span class="emphasis"><em>secrets.yml</em></span>
New Vault password: <span class="emphasis"><em>password</em></span>
Confirm New Vault password: <span class="emphasis"><em>password</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						The <code class="literal">ansible-vault create</code> command 
creates an encrypted vault file and opens it in an editor. Enter the 
sensitive data you want to save in the vault, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--98hk7ya"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">activationKey: <span class="emphasis"><em>activation_key</em></span>
username: <span class="emphasis"><em>username</em></span>
password: <span class="emphasis"><em>password</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Save the changes, and close the editor. Ansible encrypts the data in the vault.
					</p><p class="simpara">
						You can later edit the data in the vault by using the <code class="literal">ansible-vault edit <span class="emphasis"><em>secrets.yml</em></span></code> command.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Display the vault content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--89aah56"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault view <code class="literal">secrets.yml</code></pre></div></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/registration.yml</code>, and use one of the following options depending on the action you want to perform:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								To register by using an activation key and organization ID (recommended), use the following playbook:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--fdblocy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Registering system using activation key and organization ID
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">vars_files</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> secrets.yml
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_auth</span><span class="token punctuation">:</span>
      <span class="token key atrule">activation_keys</span><span class="token punctuation">:</span>
        <span class="token key atrule">keys</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span>  <span class="token string">"{{ activationKey }}"</span>
     <span class="token key atrule">rhc_organization</span><span class="token punctuation">:</span> <span class="emphasis"><em>organizationID</em></span>
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
								To register by using a username and password, use the following playbook:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--z3ndh8j"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Registering system with username and password
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span>  <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">vars_files</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> secrets.yml
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_auth</span><span class="token punctuation">:</span>
      <span class="token key atrule">login</span><span class="token punctuation">:</span>
        <span class="token key atrule">username</span><span class="token punctuation">:</span> <span class="token string">"{{ username }}"</span>
        <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">"{{ password }}"</span>
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--fe9j584"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook ~/registration.yml --ask-vault-pass</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li></ul></div></section><section class="section" id="registering-system-with-satellite-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.3. Registering a system with Satellite by using the rhc System Role</h2></div></div></div><p>
				When organizations use Satellite to manage systems, it is necessary 
to register the system through Satellite. You can remotely register your
 system with Satellite by using the <code class="literal">rhc</code> RHEL&nbsp;System&nbsp;Role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a vault to save the sensitive information:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jdgjbyz"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault create <span class="emphasis"><em>secrets.yml</em></span>
New Vault password: <span class="emphasis"><em>password</em></span>
Confirm New Vault password: <span class="emphasis"><em>password</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						The <code class="literal">ansible-vault create</code> command 
creates an encrypted file and opens it in an editor. Enter the sensitive
 data you want to save in the vault, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--anqcg1x"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">activationKey: <span class="emphasis"><em>activation_key</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Save the changes, and close the editor. Ansible encrypts the data in the vault.
					</p><p class="simpara">
						You can later edit the data in the vault by using the <code class="literal">ansible-vault edit <span class="emphasis"><em>secrets.yml</em></span></code> command.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Display the vault content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--cn1n8pg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault view <code class="literal">secrets.yml</code></pre></div></div></li><li class="listitem">
						Create a playbook file, for example <code class="literal">~/registration-sat.yml</code>.
					</li><li class="listitem"><p class="simpara">
						Use the following text in <code class="literal">~/registration-sat.yml</code> to register the system by using an activation key and organization ID:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--24bmtbd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Register to the custom registration server and CDN
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">vars_files</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> secrets.yml
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_auth</span><span class="token punctuation">:</span>
      <span class="token key atrule">login</span><span class="token punctuation">:</span>
        <span class="token key atrule">activation_keys</span><span class="token punctuation">:</span>
          <span class="token key atrule">keys</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">"{{ activationKey }}"</span>
        <span class="token key atrule">rhc_organization</span><span class="token punctuation">:</span> <span class="emphasis"><em>organizationID</em></span>
    <span class="token key atrule">rhc_server</span><span class="token punctuation">:</span>
      <span class="token key atrule">hostname</span><span class="token punctuation">:</span> <span class="emphasis"><em>example.com</em></span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number"><span class="emphasis"><em>443</em></span></span>
        <span class="token key atrule">prefix</span><span class="token punctuation">:</span> /rhsm
    <span class="token key atrule">rhc_baseurl</span><span class="token punctuation">:</span> <span class="emphasis"><em>http<span class="token punctuation">:</span>//example.com/pulp/content</em></span>
   <span class="token key atrule">roles</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6crcefv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook ~/registration-sat.yml --ask-vault-pass</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-insights-connection-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.4. Disabling the connection to Insights after the registration by using the rhc System Role</h2></div></div></div><p>
				When you register a system by using the <code class="literal">rhc</code> RHEL&nbsp;System&nbsp;Role, the role by default, enables the connection to Red Hat Insights. You can disable it by using the <code class="literal">rhc</code> System Role, if not required.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li><li class="listitem">
						The system is already registered.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/dis-insights.yml</code> and add the following content in it:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--deceqrv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Disable Insights connection
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_insights</span><span class="token punctuation">:</span>
      <span class="token key atrule">state</span><span class="token punctuation">:</span> <span class="emphasis"><em>absent</em></span>
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--a1iuv1f"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook ~/dis-insights.yml</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-repositories-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.5. Enabling repositories by using the rhc System Role</h2></div></div></div><p>
				You can remotely enable or disable repositories on managed nodes by using the <code class="literal">rhc</code> RHEL&nbsp;System&nbsp;Role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You have details of the repositories which you want to enable or disable on the managed nodes.
					</li><li class="listitem">
						You have registered the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/configure-repos.yml</code>:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								To enable a repository:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--lsir66p"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Enable repository
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_repositories</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>RepositoryName</em></span>"</span><span class="token punctuation">,</span> <span class="token key atrule">state</span><span class="token punctuation">:</span> <span class="emphasis"><em>enabled</em></span><span class="token punctuation">}</span>
   <span class="token key atrule">roles</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
								To disable a repository:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sjx8wbx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Disable repository
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_repositories</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token punctuation">{</span><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>RepositoryName</em></span>"</span><span class="token punctuation">,</span> <span class="token key atrule">state</span><span class="token punctuation">:</span> disabled<span class="token punctuation">}</span>
   <span class="token key atrule">roles</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zduedqu"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook ~/configure-repos.yml</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li></ul></div></section><section class="section" id="setting-release-versions-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.6. Setting release versions by using the rhc system role</h2></div></div></div><p>
				You can limit the system to use only repositories for a particular 
minor RHEL version instead of the latest one. This way, you can lock 
your system to a specific minor RHEL version.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the minor RHEL version to which you want to lock the 
system. Note that you can only lock the system to the RHEL minor version
 that the host currently runs or a later minor version.
					</li><li class="listitem">
						You have registered the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/release.yml</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7n3dqbj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set Release
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_release</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>8.6</em></span>"</span>
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--slyl9hf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook ~/release.yml</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-proxy-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.7. Using a proxy server when registering the host by using the rhc System Role</h2></div></div></div><p>
				If your security restrictions allow access to the Internet only 
through a proxy server, you can specify the proxy’s settings in the 
playbook when you register the system using the <code class="literal">rhc</code> RHEL&nbsp;System&nbsp;Role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a vault to save the sensitive information:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ncllfb0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault create <span class="emphasis"><em>secrets.yml</em></span>
New Vault password: <span class="emphasis"><em>password</em></span>
Confirm New Vault password: <span class="emphasis"><em>password</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						The <code class="literal">ansible-vault create</code> command 
creates an encrypted file and opens it in an editor. Enter the sensitive
 data you want to save in the vault, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mpdaxrw"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">username: <span class="emphasis"><em>username</em></span>
password: <span class="emphasis"><em>password</em></span>
proxy_username: <span class="emphasis"><em>proxyusernme</em></span>
proxy_password: <span class="emphasis"><em>proxypassword</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Save the changes, and close the editor. Ansible encrypts the data in the vault.
					</p><p class="simpara">
						You can later edit the data in the vault by using the <code class="literal">ansible-vault edit <span class="emphasis"><em>secrets.yml</em></span></code> command.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Display the vault content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ylw2xqw"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault view <code class="literal">secrets.yml</code></pre></div></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/configure-proxy.yml</code>:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								To register to the RHEL customer portal by using a proxy:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--t8enzma"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Register using proxy
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">vars_files</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> secrets.yml
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_auth</span><span class="token punctuation">:</span>
      <span class="token key atrule">login</span><span class="token punctuation">:</span>
        <span class="token key atrule">username</span><span class="token punctuation">:</span> <span class="token string">"{{ username }}"</span>
        <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">"{{ password }}"</span>
    <span class="token key atrule">rhc_proxy</span><span class="token punctuation">:</span>
      <span class="token key atrule">hostname</span><span class="token punctuation">:</span> <span class="emphasis"><em>proxy.example.com</em></span>
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number"><span class="emphasis"><em>3128</em></span></span>
      <span class="token key atrule">username</span><span class="token punctuation">:</span> <span class="token string">"{{ proxy_username }}"</span>
      <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">"{{ proxy_password }}"</span>
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
								To remove the proxy server from the configuration of the Red Hat Subscription Manager service:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--oucjivk"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> To stop using proxy server for registration
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">vars_files</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> secrets.yml
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_auth</span><span class="token punctuation">:</span>
      <span class="token key atrule">login</span><span class="token punctuation">:</span>
        <span class="token key atrule">username</span><span class="token punctuation">:</span> <span class="token string">"{{ username }}"</span>
        <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">"{{ password }}"</span>
     <span class="token key atrule">rhc_proxy</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>"state"<span class="token punctuation">:</span><span class="token string">"absent"</span><span class="token punctuation">}</span>
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--4izw5dc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook ~/configure-proxy.yml --ask-vault-pass</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-auto-updates-insights-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.8. Disabling auto updates of Insights rules by using the rhc System Role</h2></div></div></div><p>
				You can disable the automatic collection rule updates for Red Hat Insights by using the <code class="literal">rhc</code>
 RHEL&nbsp;System&nbsp;Role. By default, when you connect your system to
 Red Hat Insights, this option is enabled. You can disable it by using 
the <code class="literal">rhc</code> RHEL&nbsp;System&nbsp;Role.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					If you disable this feature, you risk using outdated rule 
definition files and not getting the most recent validation updates.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li><li class="listitem">
						You have registered the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a vault to save the sensitive information:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--e0ikn9z"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault create <span class="emphasis"><em>secrets.yml</em></span>
New Vault password: <span class="emphasis"><em>password</em></span>
Confirm New Vault password: <span class="emphasis"><em>password</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						The <code class="literal">ansible-vault create</code> command 
creates an encrypted file and opens it in an editor. Enter the sensitive
 data you want to save in the vault, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8w078tj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">username: <span class="emphasis"><em>username</em></span>
password: <span class="emphasis"><em>password</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Save the changes, and close the editor. Ansible encrypts the data in the vault.
					</p><p class="simpara">
						You can later edit the data in the vault by using the <code class="literal">ansible-vault edit <span class="emphasis"><em>secrets.yml</em></span></code> command.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Display the vault content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yxwbcmr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault view <code class="literal">secrets.yml</code></pre></div></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/auto-update.yml</code> and add following content to it:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bel7cfi"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
 <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Disable Red Hat Insights autoupdates
   <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
   <span class="token key atrule">vars_files</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> secrets.yml
   <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_auth</span><span class="token punctuation">:</span>
      <span class="token key atrule">login</span><span class="token punctuation">:</span>
        <span class="token key atrule">username</span><span class="token punctuation">:</span> <span class="token string">"{{ username }}"</span>
        <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">"{{ password }}"</span>
    <span class="token key atrule">rhc_insights</span><span class="token punctuation">:</span>
       <span class="token key atrule">autoupdate</span><span class="token punctuation">:</span> <span class="token boolean important"><span class="emphasis"><em>false</em></span></span>
       <span class="token key atrule">state</span><span class="token punctuation">:</span> <span class="emphasis"><em>present</em></span>
    <span class="token key atrule">roles</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2ysf2j9"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook ~/auto-update.yml --ask-vault-pass</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-insights-remediations-using-rhel-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.9. Disabling Insights remediations by using the rhc RHEL System Role</h2></div></div></div><p>
				You can configure systems to automatically update the dynamic configuration by using the <code class="literal">rhc</code>
 RHEL&nbsp;System&nbsp;Role. When you connect your system to Red hat 
Insights, it is enabled by default. You can disable it, if not required.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Enabling remediation with the <code class="literal">rhc</code> 
System Role ensures your system is ready to be remediated when connected
 directly to Red Hat. For systems connected to a Satellite, or Capsule, 
enabling remediation must be achieved differently. For more information 
about Red Hat Insights remediations, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/red_hat_insights_remediations_guide/index">Red Hat Insights Remediations Guide</a>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You have Insights remediations enabled.
					</li><li class="listitem">
						You have registered the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To enable the remediation, create a playbook file, for example <code class="literal">~/remediation.yml</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--c5lurpc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Disable remediation
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_insights</span><span class="token punctuation">:</span>
      <span class="token key atrule">remediation</span><span class="token punctuation">:</span> <span class="emphasis"><em>absent</em></span>
      <span class="token key atrule">state</span><span class="token punctuation">:</span> <span class="emphasis"><em>present</em></span>
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8fsl2yy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook ~/remediation.yml</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-insights-tags-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.10. Configuring Insights tags by using the rhc system role</h2></div></div></div><p>
				You can use tags for system filtering and grouping. You can also customize tags based on the requirements.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a vault to save the sensitive information:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--a71pk14"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault create <span class="emphasis"><em>secrets.yml</em></span>
New Vault password: <span class="emphasis"><em>password</em></span>
Confirm New Vault password: <span class="emphasis"><em>password</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						The <code class="literal">ansible-vault create</code> command 
creates an encrypted file and opens it in an editor. Enter the sensitive
 data you want to save in the vault, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ckcpzjf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">username: <span class="emphasis"><em>username</em></span>
password: <span class="emphasis"><em>password</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Save the changes, and close the editor. Ansible encrypts the data in the vault.
					</p><p class="simpara">
						You can later edit the data in the vault by using the <code class="literal">ansible-vault edit <span class="emphasis"><em>secrets.yml</em></span></code> command.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Display the vault content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--g3pbgnw"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">$ ansible-vault view <code class="literal">secrets.yml</code></pre></div></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/tags.yml</code>, and add following content to it:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--b37qbaa"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Creating tags
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">vars_files</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> secrets.yml
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_auth</span><span class="token punctuation">:</span>
      <span class="token key atrule">login</span><span class="token punctuation">:</span>
        <span class="token key atrule">username</span><span class="token punctuation">:</span> <span class="token string">"{{ username }}"</span>
        <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">"{{ password }}"</span>
    <span class="token key atrule">rhc_insights</span><span class="token punctuation">:</span>
      <span class="token key atrule">tags</span><span class="token punctuation">:</span>
        <span class="token key atrule">group</span><span class="token punctuation">:</span> group<span class="token punctuation">-</span>name<span class="token punctuation">-</span>value
          <span class="token key atrule">location</span><span class="token punctuation">:</span> location<span class="token punctuation">-</span>name<span class="token punctuation">-</span>value
          <span class="token key atrule">description</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> RHEL8
            <span class="token punctuation">-</span> SAP
           <span class="emphasis"><em>sample_key<span class="token punctuation">:</span>value</em></span>
        <span class="token key atrule">state</span><span class="token punctuation">:</span> <span class="emphasis"><em>present</em></span>
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yqjh4lh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook ~/remediation.yml --ask-vault-pass</strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/client_configuration_guide_for_red_hat_insights/con-insights-client-tagging-overview_insights-cg-adding-tags">System Filtering and groups Red Hat Insights</a>.
					</li></ul></div></section><section class="section" id="unregistering-a-system-using-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h2 class="title">7.11. Unregistering a system by using the RHC System Role</h2></div></div></div><p>
				You can unregister the system from Red Hat if you no longer need the subscription service.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The system is already registered.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To unregister, create a playbook file, for example, <code class="literal">~/unregister.yml</code> and add the following content to it:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rj7ju2d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Unregister the system
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">rhc_state</span><span class="token punctuation">:</span> <span class="emphasis"><em>absent</em></span>
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">role</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.rhc</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ndplvae"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># ansible-playbook ~/unregister.yml</pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li></ul></div></section></section><section class="chapter" id="assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Configuring network settings by using RHEL System Roles</h1></div></div></div><p>
			Administrators can automate network-related configuration and management tasks by using the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role.
		</p><section class="section" id="configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.1. Configuring an Ethernet connection with a static IP address by using the network RHEL System Role with an interface name</h2></div></div></div><p class="_abstract _abstract">
				You can remotely configure an Ethernet connection by using the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A physical or virtual Ethernet device exists in the server’s configuration.
					</li><li class="listitem">
						The managed nodes use NetworkManager to configure the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/ethernet-static-IP.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rnszjkt"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure an Ethernet connection with static IP
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> yes
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 192.0.2.1/24
              <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>1/64
            <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> 192.0.2.254
            <span class="token key atrule">gateway6</span><span class="token punctuation">:</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>fffe
            <span class="token key atrule">dns</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 192.0.2.200
              <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>ffbb
            <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> example.com
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div><p class="simpara">
						These settings define an Ethernet connection profile for the <code class="literal">enp1s0</code> device with the following settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A static IPv4 address - <code class="literal">192.0.2.1</code> with a <code class="literal">/24</code> subnet mask
							</li><li class="listitem">
								A static IPv6 address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
							</li><li class="listitem">
								An IPv4 default gateway - <code class="literal">192.0.2.254</code>
							</li><li class="listitem">
								An IPv6 default gateway - <code class="literal">2001:db8:1::fffe</code>
							</li><li class="listitem">
								An IPv4 DNS server - <code class="literal">192.0.2.200</code>
							</li><li class="listitem">
								An IPv6 DNS server - <code class="literal">2001:db8:1::ffbb</code>
							</li><li class="listitem">
								A DNS search domain - <code class="literal">example.com</code>
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zzhgq2t"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/ethernet-static-IP.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.2. Configuring an Ethernet connection with a static IP address by using the network RHEL System Role with a device path</h2></div></div></div><p class="_abstract _abstract">
				You can remotely configure an Ethernet connection using the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role.
			</p><p>
				You can identify the device path with the following command:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--123boxz"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>udevadm info /sys/class/net/<span class="emphasis"><em>&lt;device_name&gt;</em></span> | grep ID_PATH=</strong></span></pre></div></div><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A physical or virtual Ethernet device exists in the server’s configuration.
					</li><li class="listitem">
						The managed nodes use NetworkManager to configure the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/ethernet-static-IP.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--q6aqy38"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure an Ethernet connection with static IP
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="emphasis"><em>example</em></span>
          <span class="token key atrule">match</span><span class="token punctuation">:</span>
            <span class="token key atrule">path</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>pci<span class="token punctuation">-</span>0000<span class="token punctuation">:</span>00<span class="token punctuation">:</span>0<span class="token punctuation">[</span>1<span class="token punctuation">-</span><span class="token number">3</span><span class="token punctuation">]</span>.0</em></span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>&amp;<span class="token tag">!pci-0000:00:</span><span class="token number">02.0</span></em><span class="token number"></span></span><span class="token number"></span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> <span class="emphasis"><em>yes</em></span>
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>192.0.2.1/24</em></span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>1/64</em></span>
            <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> <span class="emphasis"><em>192.0.2.254</em></span>
            <span class="token key atrule">gateway6</span><span class="token punctuation">:</span> <span class="emphasis"><em>2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>fffe</em></span>
            <span class="token key atrule">dns</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>192.0.2.200</em></span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>ffbb</em></span>
            <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>example.com</em></span>
          <span class="token key atrule">state</span><span class="token punctuation">:</span> <span class="emphasis"><em>up</em></span></pre></div></div><p class="simpara">
						These settings define an Ethernet connection profile with the following settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A static IPv4 address - <code class="literal">192.0.2.1</code> with a <code class="literal">/24</code> subnet mask
							</li><li class="listitem">
								A static IPv6 address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
							</li><li class="listitem">
								An IPv4 default gateway - <code class="literal">192.0.2.254</code>
							</li><li class="listitem">
								An IPv6 default gateway - <code class="literal">2001:db8:1::fffe</code>
							</li><li class="listitem">
								An IPv4 DNS server - <code class="literal">192.0.2.200</code>
							</li><li class="listitem">
								An IPv6 DNS server - <code class="literal">2001:db8:1::ffbb</code>
							</li><li class="listitem">
								A DNS search domain - <code class="literal">example.com</code>
							</li></ul></div><p class="simpara">
						The <code class="literal">match</code> parameter in this example defines that Ansible applies the play to devices that match PCI ID <code class="literal">0000:00:0[1-3].0</code>, but not <code class="literal">0000:00:02.0</code>. For further details about special modifiers and wild cards you can use, see the <code class="literal">match</code> parameter description in the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xit970q"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/ethernet-static-IP.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.3. Configuring an Ethernet connection with a dynamic IP address by using the network RHEL System Role with an interface name</h2></div></div></div><p class="_abstract _abstract">
				You can remotely configure an Ethernet connection using the <code class="literal">network</code>
 RHEL&nbsp;System&nbsp;Role. For connections with dynamic IP address 
settings, NetworkManager requests the IP settings for the connection 
from a DHCP server.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A physical or virtual Ethernet device exists in the server’s configuration.
					</li><li class="listitem">
						A DHCP server is available in the network
					</li><li class="listitem">
						The managed nodes use NetworkManager to configure the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/ethernet-dynamic-IP.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zpscpxk"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure an Ethernet connection with dynamic IP
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> yes
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">dhcp4</span><span class="token punctuation">:</span> yes
            <span class="token key atrule">auto6</span><span class="token punctuation">:</span> yes
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div><p class="simpara">
						These settings define an Ethernet connection profile for the <code class="literal">enp1s0</code>
 device. The connection retrieves IPv4 addresses, IPv6 addresses, 
default gateway, routes, DNS servers, and search domains from a DHCP 
server and IPv6 stateless address autoconfiguration (SLAAC).
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bqzbve1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/ethernet-dynamic-IP.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.4. Configuring an Ethernet connection with a dynamic IP address by using the network RHEL System Role with a device path</h2></div></div></div><p class="_abstract _abstract">
				You can remotely configure an Ethernet connection using the <code class="literal">network</code>
 RHEL&nbsp;System&nbsp;Role. For connections with dynamic IP address 
settings, NetworkManager requests the IP settings for the connection 
from a DHCP server.
			</p><p>
				You can identify the device path with the following command:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ancspud"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>udevadm info /sys/class/net/<span class="emphasis"><em>&lt;device_name&gt;</em></span> | grep ID_PATH=</strong></span></pre></div></div><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A physical or virtual Ethernet device exists in the server’s configuration.
					</li><li class="listitem">
						A DHCP server is available in the network.
					</li><li class="listitem">
						The managed hosts use NetworkManager to configure the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/ethernet-dynamic-IP.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--npey5gn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure an Ethernet connection with dynamic IP
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> example
          <span class="token key atrule">match</span><span class="token punctuation">:</span>
            <span class="token key atrule">path</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> pci<span class="token punctuation">-</span>0000<span class="token punctuation">:</span>00<span class="token punctuation">:</span>0<span class="token punctuation">[</span>1<span class="token punctuation">-</span><span class="token number">3</span><span class="token punctuation">]</span>.0
              <span class="token punctuation">-</span> &amp;<span class="token tag">!pci-0000:00:</span><span class="token number">02.0</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> yes
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">dhcp4</span><span class="token punctuation">:</span> yes
            <span class="token key atrule">auto6</span><span class="token punctuation">:</span> yes
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div><p class="simpara">
						These settings define an Ethernet connection profile. The 
connection retrieves IPv4 addresses, IPv6 addresses, default gateway, 
routes, DNS servers, and search domains from a DHCP server and IPv6 
stateless address autoconfiguration (SLAAC).
					</p><p class="simpara">
						The <code class="literal">match</code> parameter in this example defines that Ansible applies the play to devices that match PCI ID <code class="literal">0000:00:0[1-3].0</code>, but not <code class="literal">0000:00:02.0</code>. For further details about special modifiers and wild cards you can use, see the <code class="literal">match</code> parameter description in the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--dt51rls"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/ethernet-dynamic-IP.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-vlan-tagging-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.5. Configuring VLAN tagging by using the network RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role to configure VLAN tagging. This example adds an Ethernet connection and a VLAN with ID <code class="literal command">10</code>
 on top of this Ethernet connection. As the child device, the VLAN 
connection contains the IP, default gateway, and DNS configurations.
			</p><p>
				Depending on your environment, adjust the play accordingly. For example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						To use the VLAN as a port in other connections, such as a bond, omit the <code class="literal">ip</code> attribute, and set the IP configuration in the child configuration.
					</li><li class="listitem">
						To use team, bridge, or bond devices in the VLAN, adapt the <code class="literal">interface_name</code> and <code class="literal">type</code> attributes of the ports you use in the VLAN.
					</li></ul></div><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/vlan-ethernet.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6hi06qz"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure a VLAN that uses an Ethernet connection
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token comment"># Add an Ethernet profile for the underlying device of the VLAN</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> yes
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">dhcp4</span><span class="token punctuation">:</span> no
            <span class="token key atrule">auto6</span><span class="token punctuation">:</span> no

        <span class="token comment"># Define the VLAN profile</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp1s0.10
          <span class="token key atrule">type</span><span class="token punctuation">:</span> vlan
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token string">"192.0.2.1/24"</span>
              <span class="token punctuation">-</span> <span class="token string">"2001:db8:1::1/64"</span>
            <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> 192.0.2.254
            <span class="token key atrule">gateway6</span><span class="token punctuation">:</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>fffe
            <span class="token key atrule">dns</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 192.0.2.200
              <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>ffbb
            <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> example.com
          <span class="token key atrule">vlan_id</span><span class="token punctuation">:</span> <span class="token number">10</span>
          <span class="token key atrule">parent</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div><p class="simpara">
						These settings define a VLAN to operate on top of the <code class="literal">enp1s0</code> device. The VLAN interface has the following settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A static IPv4 address - <code class="literal">192.0.2.1</code> with a <code class="literal">/24</code> subnet mask
							</li><li class="listitem">
								A static IPv6 address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
							</li><li class="listitem">
								An IPv4 default gateway - <code class="literal">192.0.2.254</code>
							</li><li class="listitem">
								An IPv6 default gateway - <code class="literal">2001:db8:1::fffe</code>
							</li><li class="listitem">
								An IPv4 DNS server - <code class="literal">192.0.2.200</code>
							</li><li class="listitem">
								An IPv6 DNS server - <code class="literal">2001:db8:1::ffbb</code>
							</li><li class="listitem">
								A DNS search domain - <code class="literal">example.com</code>
							</li><li class="listitem">
								VLAN ID - <code class="literal">10</code>
							</li></ul></div><p class="simpara">
						The <code class="literal">parent</code> attribute in the VLAN profile configures the VLAN to operate on top of the <code class="literal">enp1s0</code> device. As the child device, the VLAN connection contains the IP, default gateway, and DNS configurations.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rosukf8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/vlan-ethernet.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-a-network-bridge-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.6. Configuring a network bridge by using the network RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can remotely configure a network bridge by using the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Two or more physical or virtual network devices are installed on the server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/bridge-ethernet.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--w78rzk7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure a network bridge that uses two Ethernet ports
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token comment"># Define the bridge profile</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> bridge0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> bridge
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> bridge0
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token string">"192.0.2.1/24"</span>
              <span class="token punctuation">-</span> <span class="token string">"2001:db8:1::1/64"</span>
            <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> 192.0.2.254
            <span class="token key atrule">gateway6</span><span class="token punctuation">:</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>fffe
            <span class="token key atrule">dns</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 192.0.2.200
              <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>ffbb
            <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> example.com
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up

        <span class="token comment"># Add an Ethernet profile to the bridge</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> bridge0<span class="token punctuation">-</span>port1
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp7s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">controller</span><span class="token punctuation">:</span> bridge0
          <span class="token key atrule">port_type</span><span class="token punctuation">:</span> bridge
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up

        <span class="token comment"># Add a second Ethernet profile to the bridge</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> bridge0<span class="token punctuation">-</span>port2
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp8s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">controller</span><span class="token punctuation">:</span> bridge0
          <span class="token key atrule">port_type</span><span class="token punctuation">:</span> bridge
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div><p class="simpara">
						These settings define a network bridge with the following settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A static IPv4 address - <code class="literal">192.0.2.1</code> with a <code class="literal">/24</code> subnet mask
							</li><li class="listitem">
								A static IPv6 address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
							</li><li class="listitem">
								An IPv4 default gateway - <code class="literal">192.0.2.254</code>
							</li><li class="listitem">
								An IPv6 default gateway - <code class="literal">2001:db8:1::fffe</code>
							</li><li class="listitem">
								An IPv4 DNS server - <code class="literal">192.0.2.200</code>
							</li><li class="listitem">
								An IPv6 DNS server - <code class="literal">2001:db8:1::ffbb</code>
							</li><li class="listitem">
								A DNS search domain - <code class="literal">example.com</code>
							</li><li class="listitem"><p class="simpara">
								Ports of the bridge - <code class="literal">enp7s0</code> and <code class="literal">enp8s0</code>
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Set the IP configuration on the bridge and not on the ports of the Linux bridge.
								</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--k0u8pl3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/bridge-ethernet.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="proc_configuring-a-network-bond-by-using-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.7. Configuring a network bond by using the network RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can remotely configure a network bond by using the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Two or more physical or virtual network devices are installed on the server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/bond-ethernet.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--iqzdze4"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure a network bond that uses two Ethernet ports
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token comment"># Define the bond profile</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> bond0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> bond
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> bond0
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token string">"192.0.2.1/24"</span>
              <span class="token punctuation">-</span> <span class="token string">"2001:db8:1::1/64"</span>
            <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> 192.0.2.254
            <span class="token key atrule">gateway6</span><span class="token punctuation">:</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>fffe
            <span class="token key atrule">dns</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 192.0.2.200
              <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>ffbb
            <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> example.com
          <span class="token key atrule">bond</span><span class="token punctuation">:</span>
            <span class="token key atrule">mode</span><span class="token punctuation">:</span> active<span class="token punctuation">-</span>backup
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up

        <span class="token comment"># Add an Ethernet profile to the bond</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> bond0<span class="token punctuation">-</span>port1
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp7s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">controller</span><span class="token punctuation">:</span> bond0
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up

        <span class="token comment"># Add a second Ethernet profile to the bond</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> bond0<span class="token punctuation">-</span>port2
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp8s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">controller</span><span class="token punctuation">:</span> bond0
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div><p class="simpara">
						These settings define a network bond with the following settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A static IPv4 address - <code class="literal">192.0.2.1</code> with a <code class="literal">/24</code> subnet mask
							</li><li class="listitem">
								A static IPv6 address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
							</li><li class="listitem">
								An IPv4 default gateway - <code class="literal">192.0.2.254</code>
							</li><li class="listitem">
								An IPv6 default gateway - <code class="literal">2001:db8:1::fffe</code>
							</li><li class="listitem">
								An IPv4 DNS server - <code class="literal">192.0.2.200</code>
							</li><li class="listitem">
								An IPv6 DNS server - <code class="literal">2001:db8:1::ffbb</code>
							</li><li class="listitem">
								A DNS search domain - <code class="literal">example.com</code>
							</li><li class="listitem">
								Ports of the bond - <code class="literal">enp7s0</code> and <code class="literal">enp8s0</code>
							</li><li class="listitem"><p class="simpara">
								Bond mode - <code class="literal">active-backup</code>
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Set the IP configuration on the bond and not on the ports of the Linux bond.
								</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--datm532"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/bond-ethernet.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-an-ipoib-connection-by-using-the-network-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.8. Configuring an IPoIB connection by using the network RHEL System Role</h2></div></div></div><p>
				You can use the <code class="literal">network</code> 
RHEL&nbsp;System&nbsp;Role to remotely create NetworkManager connection 
profiles for IP over InfiniBand (IPoIB) devices. For example, remotely 
add an InfiniBand connection for the <code class="literal">mlx4_ib0</code> interface with the following settings by running an Ansible playbook:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An IPoIB device - <code class="literal">mlx4_ib0.8002</code>
					</li><li class="listitem">
						A partition key <code class="literal">p_key</code> - <code class="literal">0x8002</code>
					</li><li class="listitem">
						A static <code class="literal">IPv4</code> address - <code class="literal">192.0.2.1</code> with a <code class="literal">/24</code> subnet mask
					</li><li class="listitem">
						A static <code class="literal">IPv6</code> address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
					</li></ul></div><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An InfiniBand device named <code class="literal">mlx4_ib0</code> is installed in the managed nodes.
					</li><li class="listitem">
						The managed nodes use NetworkManager to configure the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/IPoIB.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--x5n7xbv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">---
- name: Configure the network
  hosts: <span class="emphasis"><em>managed-node-01.example.com</em></span>
  tasks:
  - name: Configure IPoIB
    include_role:
      name: rhel-system-roles.network

    vars:
      network_connections:

        # InfiniBand connection mlx4_ib0
        - name: mlx4_ib0
          interface_name: mlx4_ib0
          type: infiniband

        # IPoIB device mlx4_ib0.8002 on top of mlx4_ib0
        - name: mlx4_ib0.8002
          type: infiniband
          autoconnect: yes
          infiniband:
            p_key: 0x8002
            transport_mode: datagram
          parent: mlx4_ib0
          ip:
            address:
              - 192.0.2.1/24
              - 2001:db8:1::1/64
          state: up</pre></div></div><p class="simpara">
						If you set a <code class="literal">p_key</code> parameter as in this example, do not set an <code class="literal">interface_name</code> parameter on the IPoIB device.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--gftaqvr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/IPoIB.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the <code class="literal">managed-node-01.example.com</code> host, display the IP settings of the <code class="literal">mlx4_ib0.8002</code> device:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5pmygza"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ip address show <span class="emphasis"><em>mlx4_ib0.8002</em></span></strong></span>
...
inet <span class="emphasis"><em>192.0.2.1/24 brd 192.0.2.255</em></span> scope global noprefixroute ib0.8002
   valid_lft forever preferred_lft forever
inet6 <span class="emphasis"><em>2001:db8:1::1/64</em></span> scope link tentative noprefixroute
   valid_lft forever preferred_lft forever</pre></div></div></li><li class="listitem"><p class="simpara">
						Display the partition key (P_Key) of the <code class="literal">mlx4_ib0.8002</code> device:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zqg5ap2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /sys/class/net/<span class="emphasis"><em>mlx4_ib0.8002</em></span>/pkey</strong></span>
0x8002</pre></div></div></li><li class="listitem"><p class="simpara">
						Display the mode of the <code class="literal">mlx4_ib0.8002</code> device:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1srjw8y"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /sys/class/net/<span class="emphasis"><em>mlx4_ib0.8002</em></span>/mode</strong></span>
datagram</pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="proc_routing-traffic-from-a-specific-subnet-to-a-different-default-gateway-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.9. Routing traffic from a specific subnet to a different default gateway by using the network RHEL System Role</h2></div></div></div><p>
				You can use policy-based routing to configure a different default 
gateway for traffic from certain subnets. For example, you can configure
 RHEL as a router that, by default, routes all traffic to internet 
provider A using the default route. However, traffic received from the 
internal workstations subnet is routed to provider B.
			</p><p>
				To configure policy-based routing remotely and on multiple nodes, you can use the RHEL <code class="literal">network</code> System Role. Perform this procedure on the Ansible control node.
			</p><p>
				This procedure assumes the following network topology:
			</p><p>
				<span class="inlinemediaobject"><a href="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_System_Roles-en-US/images/13d0843cf47a810942ae325682f70d0c/policy-based-routing.png" class="rh_docs--zoom" title="policy based routing"><img src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/policy-based-routing.png" alt="policy based routing"></a></span>

			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on the them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The managed nodes uses the <code class="literal">NetworkManager</code> and <code class="literal">firewalld</code> services.
					</li><li class="listitem"><p class="simpara">
						The managed nodes you want to configure has four network interfaces:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">enp7s0</code> interface is connected to the network of provider A. The gateway IP in the provider’s network is <code class="literal">198.51.100.2</code>, and the network uses a <code class="literal">/30</code> network mask.
							</li><li class="listitem">
								The <code class="literal">enp1s0</code> interface is connected to the network of provider B. The gateway IP in the provider’s network is <code class="literal">192.0.2.2</code>, and the network uses a <code class="literal">/30</code> network mask.
							</li><li class="listitem">
								The <code class="literal">enp8s0</code> interface is connected to the <code class="literal">10.0.0.0/24</code> subnet with internal workstations.
							</li><li class="listitem">
								The <code class="literal">enp9s0</code> interface is connected to the <code class="literal">203.0.113.0/24</code> subnet with the company’s servers.
							</li></ul></div></li><li class="listitem">
						Hosts in the internal workstations subnet use <code class="literal">10.0.0.1</code> as the default gateway. In the procedure, you assign this IP address to the <code class="literal">enp8s0</code> network interface of the router.
					</li><li class="listitem">
						Hosts in the server subnet use <code class="literal">203.0.113.1</code> as the default gateway. In the procedure, you assign this IP address to the <code class="literal">enp9s0</code> network interface of the router.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/pbr.yml</code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wnokcev"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configuring policy<span class="token punctuation">-</span>based routing
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Routing traffic from a specific subnet to a different default gateway
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Provider<span class="token punctuation">-</span>A
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp7s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 198.51.100.1/30
            <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> 198.51.100.2
            <span class="token key atrule">dns</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 198.51.100.200
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up
          <span class="token key atrule">zone</span><span class="token punctuation">:</span> external

        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Provider<span class="token punctuation">-</span>B
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 192.0.2.1/30
            <span class="token key atrule">route</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token key atrule">network</span><span class="token punctuation">:</span> 0.0.0.0
                <span class="token key atrule">prefix</span><span class="token punctuation">:</span> <span class="token number">0</span>
                <span class="token key atrule">gateway</span><span class="token punctuation">:</span> 192.0.2.2
                <span class="token key atrule">table</span><span class="token punctuation">:</span> <span class="token number">5000</span>
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up
          <span class="token key atrule">zone</span><span class="token punctuation">:</span> external

        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Internal<span class="token punctuation">-</span>Workstations
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp8s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 10.0.0.1/24
            <span class="token key atrule">route</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token key atrule">network</span><span class="token punctuation">:</span> 10.0.0.0
                <span class="token key atrule">prefix</span><span class="token punctuation">:</span> <span class="token number">24</span>
                <span class="token key atrule">table</span><span class="token punctuation">:</span> <span class="token number">5000</span>
            <span class="token key atrule">routing_rule</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token number">5</span>
                <span class="token key atrule">from</span><span class="token punctuation">:</span> 10.0.0.0/24
                <span class="token key atrule">table</span><span class="token punctuation">:</span> <span class="token number">5000</span>
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up
          <span class="token key atrule">zone</span><span class="token punctuation">:</span> trusted

        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Servers
          <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp9s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> <span class="token boolean important">True</span>
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 203.0.113.1/24
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up
          <span class="token key atrule">zone</span><span class="token punctuation">:</span> trusted</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5oa9bqm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/pbr.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On a RHEL host in the internal workstation subnet:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Install the <code class="literal">traceroute</code> package:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--4zyokmh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf install traceroute</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Use the <code class="literal">traceroute</code> utility to display the route to a host on the internet:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--4dag7c2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>traceroute redhat.com</strong></span>
traceroute to redhat.com (209.132.183.105), 30 hops max, 60 byte packets
 1  10.0.0.1 (10.0.0.1)     0.337 ms  0.260 ms  0.223 ms
 2  192.0.2.1 (192.0.2.1)   0.884 ms  1.066 ms  1.248 ms
 ...</pre></div></div><p class="simpara">
								The output of the command displays that the router sends packets over <code class="literal">192.0.2.1</code>, which is the network of provider B.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						On a RHEL host in the server subnet:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Install the <code class="literal">traceroute</code> package:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--o6fw9mb"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>dnf install traceroute</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Use the <code class="literal">traceroute</code> utility to display the route to a host on the internet:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--z0mrg8v"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>traceroute redhat.com</strong></span>
traceroute to redhat.com (209.132.183.105), 30 hops max, 60 byte packets
 1  203.0.113.1 (203.0.113.1)    2.179 ms  2.073 ms  1.944 ms
 2  198.51.100.2 (198.51.100.2)  1.868 ms  1.798 ms  1.549 ms
 ...</pre></div></div><p class="simpara">
								The output of the command displays that the router sends packets over <code class="literal">198.51.100.2</code>, which is the network of provider A.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						On the RHEL router that you configured using the RHEL System Role:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Display the rule list:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1a179c8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ip rule list</strong></span>
0:      from all lookup local
<span class="strong strong"><strong>5</strong></span>:    <span class="strong strong"><strong>from 10.0.0.0/24 lookup 5000</strong></span>
32766:  from all lookup main
32767:  from all lookup default</pre></div></div><p class="simpara">
								By default, RHEL contains rules for the tables <code class="literal">local</code>, <code class="literal">main</code>, and <code class="literal">default</code>.
							</p></li><li class="listitem"><p class="simpara">
								Display the routes in table <code class="literal">5000</code>:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--o9jwca0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ip route list table 5000</strong></span>
0.0.0.0/0 via 192.0.2.2 dev enp1s0 proto static metric 100
10.0.0.0/24 dev enp8s0 proto static scope link src 192.0.2.1 metric 102</pre></div></div></li><li class="listitem"><p class="simpara">
								Display the interfaces and firewall zones:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--dkonjbo"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>firewall-cmd --get-active-zones</strong></span>
external
  interfaces: enp1s0 enp7s0
trusted
  interfaces: enp8s0 enp9s0</pre></div></div></li><li class="listitem"><p class="simpara">
								Verify that the <code class="literal">external</code> zone has masquerading enabled:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--i3oy8la"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>firewall-cmd --info-zone=external</strong></span>
external (active)
  target: default
  icmp-block-inversion: no
  interfaces: enp1s0 enp7s0
  sources:
  services: ssh
  ports:
  protocols:
  <span class="strong strong"><strong>masquerade: yes</strong></span>
  ...</pre></div></div></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="configuring-a-static-ethernet-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.10. Configuring a static Ethernet connection with 802.1X network authentication by using the network RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can remotely configure an Ethernet connection with 802.1X network authentication by using the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The network supports 802.1X network authentication.
					</li><li class="listitem">
						The managed nodes uses NetworkManager.
					</li><li class="listitem"><p class="simpara">
						The following files required for TLS authentication exist on the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The client key is stored in the <code class="literal">/srv/data/client.key</code> file.
							</li><li class="listitem">
								The client certificate is stored in the <code class="literal">/srv/data/client.crt</code> file.
							</li><li class="listitem">
								The Certificate Authority (CA) certificate is stored in the <code class="literal">/srv/data/ca.crt</code> file.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/enable-802.1x.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--djm8o2z"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure an Ethernet connection with 802.1X authentication
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Copy client key for 802.1X authentication
      <span class="token key atrule">copy</span><span class="token punctuation">:</span>
        <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"/srv/data/client.key"</span>
        <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"/etc/pki/tls/private/client.key"</span>
        <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token number">0600</span>

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Copy client certificate for 802.1X authentication
      <span class="token key atrule">copy</span><span class="token punctuation">:</span>
        <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"/srv/data/client.crt"</span>
        <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"/etc/pki/tls/certs/client.crt"</span>

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Copy CA certificate for 802.1X authentication
      <span class="token key atrule">copy</span><span class="token punctuation">:</span>
        <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"/srv/data/ca.crt"</span>
        <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"/etc/pki/ca-trust/source/anchors/ca.crt"</span>

    <span class="token punctuation">-</span> <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

      <span class="token key atrule">vars</span><span class="token punctuation">:</span>
        <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp1s0
            <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
            <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> yes
            <span class="token key atrule">ip</span><span class="token punctuation">:</span>
              <span class="token key atrule">address</span><span class="token punctuation">:</span>
                <span class="token punctuation">-</span> 192.0.2.1/24
                <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>1/64
              <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> 192.0.2.254
              <span class="token key atrule">gateway6</span><span class="token punctuation">:</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>fffe
              <span class="token key atrule">dns</span><span class="token punctuation">:</span>
                <span class="token punctuation">-</span> 192.0.2.200
                <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>ffbb
              <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
                <span class="token punctuation">-</span> example.com
            <span class="token key atrule">ieee802_1x</span><span class="token punctuation">:</span>
              <span class="token key atrule">identity</span><span class="token punctuation">:</span> <span class="emphasis"><em>user_name</em></span>
              <span class="token key atrule">eap</span><span class="token punctuation">:</span> tls
              <span class="token key atrule">private_key</span><span class="token punctuation">:</span> <span class="token string">"/etc/pki/tls/private/client.key"</span>
              <span class="token key atrule">private_key_password</span><span class="token punctuation">:</span> <span class="token string">"password"</span>
              <span class="token key atrule">client_cert</span><span class="token punctuation">:</span> <span class="token string">"/etc/pki/tls/certs/client.crt"</span>
              <span class="token key atrule">ca_cert</span><span class="token punctuation">:</span> <span class="token string">"/etc/pki/ca-trust/source/anchors/ca.crt"</span>
              <span class="token key atrule">domain_suffix_match</span><span class="token punctuation">:</span> <span class="emphasis"><em>example.com</em></span>
            <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div><p class="simpara">
						These settings define an Ethernet connection profile for the <code class="literal">enp1s0</code> device with the following settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A static IPv4 address - <code class="literal">192.0.2.1</code> with a <code class="literal">/24</code> subnet mask
							</li><li class="listitem">
								A static IPv6 address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
							</li><li class="listitem">
								An IPv4 default gateway - <code class="literal">192.0.2.254</code>
							</li><li class="listitem">
								An IPv6 default gateway - <code class="literal">2001:db8:1::fffe</code>
							</li><li class="listitem">
								An IPv4 DNS server - <code class="literal">192.0.2.200</code>
							</li><li class="listitem">
								An IPv6 DNS server - <code class="literal">2001:db8:1::ffbb</code>
							</li><li class="listitem">
								A DNS search domain - <code class="literal">example.com</code>
							</li><li class="listitem">
								802.1X network authentication using the <code class="literal">TLS</code> Extensible Authentication Protocol (EAP)
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--k0lth55"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/enable-802.1x.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="proc_configuring-a-wifi-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.11. Configuring a wifi connection with 802.1X network authentication by using the network RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				Using RHEL System Roles, you can automate the creation of a wifi 
connection. For example, you can remotely add a wireless connection 
profile for the <code class="literal">wlp1s0</code> interface using an 
Ansible playbook. The created profile uses the 802.1X standard to 
authenticate the client to a wifi network. The playbook configures the 
connection profile to use DHCP. To configure static IP settings, adapt 
the parameters in the <code class="literal">ip</code> dictionary accordingly.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The network supports 802.1X network authentication.
					</li><li class="listitem">
						You installed the <code class="literal package">wpa_supplicant</code> package on the managed node.
					</li><li class="listitem">
						DHCP is available in the network of the managed node.
					</li><li class="listitem"><p class="simpara">
						The following files required for TLS authentication exist on the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The client key is stored in the <code class="literal filename">/srv/data/client.key</code> file.
							</li><li class="listitem">
								The client certificate is stored in the <code class="literal filename">/srv/data/client.crt</code> file.
							</li><li class="listitem">
								The CA certificate is stored in the <code class="literal filename">/srv/data/ca.crt</code> file.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/enable-802.1x.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--98trz7i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="emphasis"><em>Configure a wifi connection with 802.1X authentication</em></span>
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="emphasis"><em>Copy client key for 802.1X authentication</em></span>
      <span class="token key atrule">copy</span><span class="token punctuation">:</span>
        <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>/srv/data/client.key</em></span>"</span>
        <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>/etc/pki/tls/private/client.key</em></span>"</span>
        <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token number">0400</span>

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="emphasis"><em>Copy client certificate for 802.1X authentication</em></span>
      <span class="token key atrule">copy</span><span class="token punctuation">:</span>
        <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>/srv/data/client.crt</em></span>"</span>
        <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>/etc/pki/tls/certs/client.crt</em></span>"</span>

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="emphasis"><em>Copy CA certificate for 802.1X authentication</em></span>
      <span class="token key atrule">copy</span><span class="token punctuation">:</span>
        <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>/srv/data/ca.crt</em></span>"</span>
        <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>/etc/pki/ca-trust/source/anchors/ca.crt</em></span>"</span>

    <span class="token punctuation">-</span> <span class="token key atrule">block</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">import_role</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="emphasis"><em>linux<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network</em></span>
          <span class="token key atrule">vars</span><span class="token punctuation">:</span>
            <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="emphasis"><em>Configure the Example<span class="token punctuation">-</span>wifi profile</em></span>
                <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> <span class="emphasis"><em>wlp1s0</em></span>
                <span class="token key atrule">state</span><span class="token punctuation">:</span> up
                <span class="token key atrule">type</span><span class="token punctuation">:</span> wireless
                <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> <span class="emphasis"><em>yes</em></span>
                <span class="token key atrule">ip</span><span class="token punctuation">:</span>
                  <span class="token key atrule">dhcp4</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
                  <span class="token key atrule">auto6</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
                <span class="token key atrule">wireless</span><span class="token punctuation">:</span>
                  <span class="token key atrule">ssid</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>Example-wifi</em></span>"</span>
                  <span class="token key atrule">key_mgmt</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>wpa-eap</em></span>"</span>
                <span class="token key atrule">ieee802_1x</span><span class="token punctuation">:</span>
                  <span class="token key atrule">identity</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>user_name</em></span>"</span>
                  <span class="token key atrule">eap</span><span class="token punctuation">:</span> tls
                  <span class="token key atrule">private_key</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>/etc/pki/tls/client.key</em></span>"</span>
                  <span class="token key atrule">private_key_password</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>password</em></span>"</span>
                  <span class="token key atrule">private_key_password_flags</span><span class="token punctuation">:</span> none
                  <span class="token key atrule">client_cert</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>/etc/pki/tls/client.pem</em></span>"</span>
                  <span class="token key atrule">ca_cert</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>/etc/pki/tls/cacert.pem</em></span>"</span>
                  <span class="token key atrule">domain_suffix_match</span><span class="token punctuation">:</span> <span class="token string">"<span class="emphasis"><em>example.com</em></span>"</span></pre></div></div><p class="simpara">
						These settings define a wifi connection profile for the <code class="literal">wlp1s0</code>
 interface. The profile uses 802.1X standard to authenticate the client 
to the wifi network. The connection retrieves IPv4 addresses, IPv6 
addresses, default gateway, routes, DNS servers, and search domains from
 a DHCP server and IPv6 stateless address autoconfiguration (SLAAC).
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ic1e5cl"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/enable-802.1x.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="proc_setting-the-default-gateway-on-an-existing-connection-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.12. Setting the default gateway on an existing connection by using the network RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role to set the default gateway.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					When you run a play that uses the <code class="literal">network</code>
 RHEL&nbsp;System&nbsp;Role, the system role overrides an existing 
connection profile with the same name if the value of settings does not 
match the ones specified in the play. Therefore, always specify the 
whole configuration of the network connection profile in the play, even 
if, for example, the IP configuration already exists. Otherwise, the 
role resets these values to their defaults.
				</p></div></div><p>
				Depending on whether it already exists, the procedure creates or updates the <code class="literal">enp1s0</code> connection profile with the following settings:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A static IPv4 address - <code class="literal">198.51.100.20</code> with a <code class="literal">/24</code> subnet mask
					</li><li class="listitem">
						A static IPv6 address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
					</li><li class="listitem">
						An IPv4 default gateway - <code class="literal">198.51.100.254</code>
					</li><li class="listitem">
						An IPv6 default gateway - <code class="literal">2001:db8:1::fffe</code>
					</li><li class="listitem">
						An IPv4 DNS server - <code class="literal">198.51.100.200</code>
					</li><li class="listitem">
						An IPv6 DNS server - <code class="literal">2001:db8:1::ffbb</code>
					</li><li class="listitem">
						A DNS search domain - <code class="literal">example.com</code>
					</li></ul></div><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/ethernet-connection.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--iyc5lgb"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure an Ethernet connection with static IP and default gateway
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> yes
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 198.51.100.20/24
              <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>1/64
            <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> 198.51.100.254
            <span class="token key atrule">gateway6</span><span class="token punctuation">:</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>fffe
            <span class="token key atrule">dns</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 198.51.100.200
              <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>ffbb
            <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> example.com
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--snw71sx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/ethernet-connection.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="proc_configuring-a-static-route-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.13. Configuring a static route by using the network RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role to configure static routes.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					When you run a play that uses the <code class="literal">network</code>
 RHEL&nbsp;System&nbsp;Role, the system role overrides an existing 
connection profile with the same name if the value of settings does not 
match the ones specified in the play. Therefore, always specify the 
whole configuration of the network connection profile in the play, even 
if, for example, the IP configuration already exists. Otherwise, the 
role resets these values to their defaults.
				</p></div></div><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/add-static-routes.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qj9pzcq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="emphasis"><em>Configure an Ethernet connection with static IP and additional routes</em></span>
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="emphasis"><em>enp7s0</em></span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="emphasis"><em>ethernet</em></span>
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> <span class="emphasis"><em>yes</em></span>
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>192.0.2.1/24</em></span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>1/64</em></span>
            <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> <span class="emphasis"><em>192.0.2.254</em></span>
            <span class="token key atrule">gateway6</span><span class="token punctuation">:</span> <span class="emphasis"><em>2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>fffe</em></span>
            <span class="token key atrule">dns</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>192.0.2.200</em></span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>ffbb</em></span>
            <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="emphasis"><em>example.com</em></span>
            <span class="token key atrule">route</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token key atrule">network</span><span class="token punctuation">:</span> <span class="emphasis"><em>198.51.100.0</em></span>
                <span class="token key atrule">prefix</span><span class="token punctuation">:</span> <span class="token number"><span class="emphasis"><em>24</em></span></span>
                <span class="token key atrule">gateway</span><span class="token punctuation">:</span> <span class="emphasis"><em>192.0.2.10</em></span>
              <span class="token punctuation">-</span> <span class="token key atrule">network</span><span class="token punctuation">:</span> <span class="emphasis"><em>2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>2<span class="token punctuation">:</span><span class="token punctuation">:</span></em><span class="token punctuation"></span></span><span class="token punctuation"></span>
                <span class="token key atrule">prefix</span><span class="token punctuation">:</span> <span class="token number"><span class="emphasis"><em>64</em></span></span>
                <span class="token key atrule">gateway</span><span class="token punctuation">:</span> <span class="emphasis"><em>2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">10</span></em><span class="token number"></span></span><span class="token number"></span>
          <span class="token key atrule">state</span><span class="token punctuation">:</span> <span class="emphasis"><em>up</em></span></pre></div></div><p class="simpara">
						Depending on whether it already exists, the procedure creates or updates the <code class="literal">enp7s0</code> connection profile with the following settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A static IPv4 address - <code class="literal">192.0.2.1</code> with a <code class="literal">/24</code> subnet mask
							</li><li class="listitem">
								A static IPv6 address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
							</li><li class="listitem">
								An IPv4 default gateway - <code class="literal">192.0.2.254</code>
							</li><li class="listitem">
								An IPv6 default gateway - <code class="literal">2001:db8:1::fffe</code>
							</li><li class="listitem">
								An IPv4 DNS server - <code class="literal">192.0.2.200</code>
							</li><li class="listitem">
								An IPv6 DNS server - <code class="literal">2001:db8:1::ffbb</code>
							</li><li class="listitem">
								A DNS search domain - <code class="literal">example.com</code>
							</li><li class="listitem"><p class="simpara">
								Static routes:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">198.51.100.0/24</code> with gateway <code class="literal">192.0.2.10</code>
									</li><li class="listitem">
										<code class="literal">2001:db8:2::/64</code> with gateway <code class="literal">2001:db8:1::10</code>
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ykoas20"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/add-static-routes.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the managed nodes:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Display the IPv4 routes:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--z021hib"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ip -4 route</strong></span>
...
<span class="emphasis"><em>198.51.100.0/24</em></span> via <span class="emphasis"><em>192.0.2.10</em></span> dev <span class="emphasis"><em>enp7s0</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Display the IPv6 routes:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mqqm7c1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ip -6 route</strong></span>
...
<span class="emphasis"><em>2001:db8:2::/64</em></span> via <span class="emphasis"><em>2001:db8:1::10</em></span> dev <span class="emphasis"><em>enp7s0</em></span> metric <span class="emphasis"><em>1024</em></span> pref <span class="emphasis"><em>medium</em></span></pre></div></div></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="proc_configuring-an-ethtool-offload-feature-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.14. Configuring an ethtool offload feature by using the network RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">network</code> RHEL&nbsp;System&nbsp;Role to configure <code class="literal systemitem">ethtool</code> features of a NetworkManager connection.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					When you run a play that uses the <code class="literal">network</code>
 RHEL&nbsp;System&nbsp;Role, the system role overrides an existing 
connection profile with the same name if the value of settings does not 
match the ones specified in the play. Therefore, always specify the 
whole configuration of the network connection profile in the play, even 
if, for example the IP configuration, already exists. Otherwise the role
 resets these values to their defaults.
				</p></div></div><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/configure-ethernet-device-with-ethtool-features.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xz19y1i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure the network
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure an Ethernet connection with ethtool features
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.network

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
          <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> yes
          <span class="token key atrule">ip</span><span class="token punctuation">:</span>
            <span class="token key atrule">address</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 198.51.100.20/24
              <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>1/64
            <span class="token key atrule">gateway4</span><span class="token punctuation">:</span> 198.51.100.254
            <span class="token key atrule">gateway6</span><span class="token punctuation">:</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>fffe
            <span class="token key atrule">dns</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> 198.51.100.200
              <span class="token punctuation">-</span> 2001<span class="token punctuation">:</span>db8<span class="token punctuation">:</span>1<span class="token punctuation">:</span><span class="token punctuation">:</span>ffbb
            <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> example.com
          <span class="token key atrule">ethtool</span><span class="token punctuation">:</span>
            <span class="token key atrule">features</span><span class="token punctuation">:</span>
              <span class="token key atrule">gro</span><span class="token punctuation">:</span> <span class="token string">"no"</span>
              <span class="token key atrule">gso</span><span class="token punctuation">:</span> <span class="token string">"yes"</span>
              <span class="token key atrule">tx_sctp_segmentation</span><span class="token punctuation">:</span> <span class="token string">"no"</span>
          <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div><p class="simpara">
						Depending on whether it already exists, this playbook creates or updates the <code class="literal">enp1s0</code> connection profile with the following settings:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								A static <code class="literal">IPv4</code> address - <code class="literal">198.51.100.20</code> with a <code class="literal">/24</code> subnet mask
							</li><li class="listitem">
								A static <code class="literal">IPv6</code> address - <code class="literal">2001:db8:1::1</code> with a <code class="literal">/64</code> subnet mask
							</li><li class="listitem">
								An <code class="literal">IPv4</code> default gateway - <code class="literal">198.51.100.254</code>
							</li><li class="listitem">
								An <code class="literal">IPv6</code> default gateway - <code class="literal">2001:db8:1::fffe</code>
							</li><li class="listitem">
								An <code class="literal">IPv4</code> DNS server - <code class="literal">198.51.100.200</code>
							</li><li class="listitem">
								An <code class="literal">IPv6</code> DNS server - <code class="literal">2001:db8:1::ffbb</code>
							</li><li class="listitem">
								A DNS search domain - <code class="literal">example.com</code>
							</li><li class="listitem"><p class="simpara">
								<code class="literal">ethtool</code> features:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Generic receive offload (GRO): disabled
									</li><li class="listitem">
										Generic segmentation offload (GSO): enabled
									</li><li class="listitem">
										TX stream control transmission protocol (SCTP) segmentation: disabled
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zmmxwc7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/configure-ethernet-device-with-ethtool-features.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section><section class="section" id="ref_network-states-for-the-network-rhel-system-roles_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">8.15. Network states for the network RHEL System role</h2></div></div></div><p>
				The <code class="literal">network</code> RHEL system role supports state configurations in playbooks to configure the devices. For this, use the <code class="literal">network_state</code> variable followed by the state configurations.
			</p><p>
				Benefits of using the <code class="literal">network_state</code> variable in a playbook:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Using the declarative method with the state configurations, you 
can configure interfaces, and the NetworkManager creates a profile for 
these interfaces in the background.
					</li><li class="listitem">
						With the <code class="literal">network_state</code> variable, you 
can specify the options that you require to change, and all the other 
options will remain the same as they are. However, with the <code class="literal">network_connections</code> variable, you must specify all settings to change the network connection profile.
					</li></ul></div><p>
				For example, to create an Ethernet connection with dynamic IP address settings, use the following <code class="literal">vars</code> block in your playbook:
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="pox58o7" id="rh-table--pox58o7"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><tbody><tr><td data-row="1" data-col="1" class="content--md" valign="top" align="left"> <p>
								Playbook with state configurations
							</p>
							 </td><td data-row="1" data-col="2" class="content--md" valign="top" align="left"> <p>
								Regular playbook
							</p>
							 </td></tr><tr><td data-row="2" data-col="1" class="content--lg" valign="top" align="left">
<div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3o739yi"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token key atrule">vars</span><span class="token punctuation">:</span>
  <span class="token key atrule">network_state</span><span class="token punctuation">:</span>
    <span class="token key atrule">interfaces</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp7s0
      <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
      <span class="token key atrule">state</span><span class="token punctuation">:</span> up
      <span class="token key atrule">ipv4</span><span class="token punctuation">:</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">auto-dns</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">auto-gateway</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">auto-routes</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">dhcp</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">ipv6</span><span class="token punctuation">:</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">auto-dns</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">auto-gateway</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">auto-routes</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">autoconf</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">dhcp</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></pre></div></div>
							 </td><td data-row="2" data-col="2" class="content--lg" valign="top" align="left">
<div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--c65cdmy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token key atrule">vars</span><span class="token punctuation">:</span>
  <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp7s0
      <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp7s0
      <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
      <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> yes
      <span class="token key atrule">ip</span><span class="token punctuation">:</span>
        <span class="token key atrule">dhcp4</span><span class="token punctuation">:</span> yes
        <span class="token key atrule">auto6</span><span class="token punctuation">:</span> yes
      <span class="token key atrule">state</span><span class="token punctuation">:</span> up</pre></div></div>
							 </td></tr></tbody></table></rh-table><p>
				For example, to only change the connection status of dynamic IP 
address settings that you created as above, use the following <code class="literal">vars</code> block in your playbook:
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="r1cd9js" id="rh-table--r1cd9js"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><tbody><tr><td data-row="1" data-col="1" class="content--md" valign="top" align="left"> <p>
								Playbook with state configurations
							</p>
							 </td><td data-row="1" data-col="2" class="content--md" valign="top" align="left"> <p>
								Regular playbook
							</p>
							 </td></tr><tr><td data-row="2" data-col="1" class="content--lg" valign="top" align="left">
<div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--shidkx1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token key atrule">vars</span><span class="token punctuation">:</span>
  <span class="token key atrule">network_state</span><span class="token punctuation">:</span>
    <span class="token key atrule">interfaces</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp7s0
      <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
      <span class="token key atrule">state</span><span class="token punctuation">:</span> down</pre></div></div>
							 </td><td data-row="2" data-col="2" class="content--lg" valign="top" align="left">
<div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--b09edf2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token key atrule">vars</span><span class="token punctuation">:</span>
  <span class="token key atrule">network_connections</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> enp7s0
      <span class="token key atrule">interface_name</span><span class="token punctuation">:</span> enp7s0
      <span class="token key atrule">type</span><span class="token punctuation">:</span> ethernet
      <span class="token key atrule">autoconnect</span><span class="token punctuation">:</span> yes
      <span class="token key atrule">ip</span><span class="token punctuation">:</span>
        <span class="token key atrule">dhcp4</span><span class="token punctuation">:</span> yes
        <span class="token key atrule">auto6</span><span class="token punctuation">:</span> yes
      <span class="token key atrule">state</span><span class="token punctuation">:</span> down</pre></div></div>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li></ul></div></section></section><section class="chapter" id="assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 9. Configuring firewalld by using RHEL System Roles</h1></div></div></div><p>
			You can use the <code class="literal">firewall</code> System Role to configure settings of the <code class="literal">firewalld</code> service on multiple clients at once. This solution:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Provides an interface with efficient input settings.
				</li><li class="listitem">
					Keeps all intended <code class="literal">firewalld</code> parameters in one place.
				</li></ul></div><p>
			After you run the <code class="literal">firewall</code> role on the control node, the System Role applies the <code class="literal">firewalld</code> parameters to the managed node immediately and makes them persistent across reboots.
		</p><section class="section" id="con_introduction-to-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles"><div class="titlepage"><div><div><h2 class="title">9.1. Introduction to the firewall RHEL System Role</h2></div></div></div><p>
				RHEL&nbsp;System&nbsp;Roles is a set of contents for the Ansible 
automation utility. This content together with the Ansible automation 
utility provides a consistent configuration interface to remotely manage
 multiple systems.
			</p><p>
				The <code class="literal">rhel-system-roles.firewall</code> role from the RHEL&nbsp;System&nbsp;Roles was introduced for automated configurations of the <code class="literal">firewalld</code> service. The <code class="literal">rhel-system-roles</code> package contains this System Role, and also the reference documentation.
			</p><p>
				To apply the <code class="literal">firewalld</code> parameters on one or more systems in an automated fashion, use the <code class="literal">firewall</code> System Role variable in a playbook. A playbook is a list of one or more plays that is written in the text-based YAML format.
			</p><p>
				You can use an inventory file to define a set of systems that you want Ansible to configure.
			</p><p>
				With the <code class="literal">firewall</code> role you can configure many different <code class="literal">firewalld</code> parameters, for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Zones.
					</li><li class="listitem">
						The services for which packets should be allowed.
					</li><li class="listitem">
						Granting, rejection, or dropping of traffic access to ports.
					</li><li class="listitem">
						Forwarding of ports or port ranges for a zone.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">README.md</code> and <code class="literal">README.html</code> files in the <code class="literal">/usr/share/doc/rhel-system-roles/firewall/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks.html">Working with playbooks</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html">How to build your inventory</a>
					</li></ul></div></section><section class="section" id="proc_resetting-the-firewalld-settings-using-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles"><div class="titlepage"><div><div><h2 class="title">9.2. Resetting the firewalld settings by using a RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				With the <code class="literal">firewall</code> RHEL system role, you can reset the <code class="literal">firewalld</code> settings to their default state. If you add the <code class="literal">previous:replaced</code> parameter to the variable list, the System Role removes all existing user-defined settings and resets <code class="literal">firewalld</code> to the defaults. If you combine the <code class="literal">previous:replaced</code> parameter with other settings, the <code class="literal">firewall</code> role removes all existing settings before applying new ones.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on the them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/reset-firewalld.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0k00hxb"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Reset firewalld example
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Reset firewalld
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.firewall

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">firewall</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">previous</span><span class="token punctuation">:</span> replaced</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yyiwiae"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/reset-firewalld.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Run this command as <code class="literal">root</code> on the managed node to check all the zones:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3xcr24d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>firewall-cmd --list-all-zones</strong></span></pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code>
					</li></ul></div></section><section class="section" id="proc_forwarding-incoming-traffic-from-one-local-port-to-a-different-local-port_assembly_configuring-firewalld-using-system-roles"><div class="titlepage"><div><div><h2 class="title">9.3. Forwarding incoming traffic in firewalld from one local port to a different local port by using a RHEL System Role</h2></div></div></div><p>
				With the <code class="literal">firewall</code> role you can remotely configure <code class="literal">firewalld</code> parameters with persisting effect on multiple managed hosts.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on the them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/port_forwarding.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--uytu7as"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure firewalld
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Forward incoming traffic on port 8080 to 443
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.firewall

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">firewall</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">forward_port</span><span class="token punctuation">:</span> 8080/tcp;443;<span class="token punctuation">,</span> <span class="token key atrule">state</span><span class="token punctuation">:</span> enabled<span class="token punctuation">,</span> <span class="token key atrule">runtime</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token punctuation">,</span> <span class="token key atrule">permanent</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token punctuation">}</span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--76ou0ns"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/port_forwarding.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the managed host, display the <code class="literal">firewalld</code> settings:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1w426im"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>firewall-cmd --list-forward-ports</strong></span></pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code>
					</li></ul></div></section><section class="section" id="configuring-ports-using-system-roles_assembly_configuring-firewalld-using-system-roles"><div class="titlepage"><div><div><h2 class="title">9.4. Managing ports in firewalld by using a RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the RHEL <code class="literal">firewall</code> System 
Role to open or close ports in the local firewall for incoming traffic 
and make the new configuration persist across reboots. For example you 
can configure the default zone to permit incoming traffic for the HTTPS 
service.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on the them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/opening-a-port.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0o2lqj6"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure firewalld
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Allow incoming HTTPS traffic to the local host
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.firewall

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">firewall</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> 443/tcp
          <span class="token key atrule">service</span><span class="token punctuation">:</span> http
          <span class="token key atrule">state</span><span class="token punctuation">:</span> enabled
          <span class="token key atrule">runtime</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token key atrule">permanent</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></pre></div></div><p class="simpara">
						The <code class="literal">permanent: true</code> option makes the new settings persistent across reboots.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--uja28xt"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/opening-a-port.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the managed node, verify that the <code class="literal">443/tcp</code> port associated with the <code class="literal">HTTPS</code> service is open:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vo0o92n"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>firewall-cmd --list-ports</strong></span>
443/tcp</pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code>
					</li></ul></div></section><section class="section" id="configuring-a-dmz-firewalld-zone-by-using-the-firewalld-rhel-system-role_assembly_configuring-firewalld-using-system-roles"><div class="titlepage"><div><div><h2 class="title">9.5. Configuring a firewalld DMZ zone by using a RHEL System Role</h2></div></div></div><p>
				As a system administrator, you can use the <code class="literal">firewall</code> System Role to configure a <code class="literal">dmz</code> zone on the <span class="strong strong"><strong>enp1s0</strong></span> interface to permit <code class="literal">HTTPS</code> traffic to the zone. In this way, you enable external users to access your web servers.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on the them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal"><span class="emphasis"><em>~/configuring-a-dmz.yml</em></span></code>, with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3rwzdad"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="programlisting language-yaml codeblock codeblock--processed"><span class="token punctuation">---</span>
<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure firewalld
  <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="emphasis"><em>managed<span class="token punctuation">-</span>node<span class="token punctuation">-</span>01.example.com</em></span>
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Creating a DMZ with access to HTTPS port and masquerading for hosts in DMZ
    <span class="token key atrule">include_role</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> rhel<span class="token punctuation">-</span>system<span class="token punctuation">-</span>roles.firewall

    <span class="token key atrule">vars</span><span class="token punctuation">:</span>
      <span class="token key atrule">firewall</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">zone</span><span class="token punctuation">:</span> dmz
          <span class="token key atrule">interface</span><span class="token punctuation">:</span> enp1s0
          <span class="token key atrule">service</span><span class="token punctuation">:</span> https
          <span class="token key atrule">state</span><span class="token punctuation">:</span> enabled
          <span class="token key atrule">runtime</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token key atrule">permanent</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9v9vikk"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>~/configuring-a-dmz.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the managed node, view detailed information about the <code class="literal">dmz</code> zone:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6sru4u8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>firewall-cmd --zone=dmz --list-all</strong></span>
dmz (active)
  target: default
  icmp-block-inversion: no
  <span class="strong strong"><strong>interfaces: enp1s0</strong></span>
  sources:
  <span class="strong strong"><strong>services: https</strong></span> ssh
  ports:
  protocols:
  forward: no
  masquerade: no
  forward-ports:
  source-ports:
  icmp-blocks:</pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code>
					</li></ul></div></section></section><section class="chapter" id="assembly_postfix-role-variables-in-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 10. Variables of the postfix role in System Roles</h1></div></div></div><p class="_abstract _abstract">
			The <code class="literal">postfix</code> role variables allow the user to install, configure, and start the <code class="literal">postfix</code> Mail Transfer Agent (MTA).
		</p><p>
			The following role variables are defined in this section:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<code class="literal">postfix_conf</code>: It includes key/value pairs of all the supported <code class="literal">postfix</code> configuration parameters. By default, the <code class="literal">postfix_conf</code> does not have a value.
				</li></ul></div><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zodxy7y"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">postfix_conf:
  relayhost: example.com</pre></div></div><p>
			If your scenario requires removing any existing configuration and apply the desired configuration on top of a clean <code class="literal">postfix</code> installation, specify the <code class="literal">previous: replaced</code> option within the <code class="literal">postfix_conf</code> dictionary:
		</p><p>
			An example with the <code class="literal">previous: replaced</code> option:
		</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sctx90k"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">postfix_conf:
  relayhost: example.com
  previous: replaced</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<code class="literal">postfix_check</code>: It determines if a check has been executed before starting the <code class="literal">postfix</code> to verify the configuration changes. The default value is true.
				</li></ul></div><p>
			For example:
		</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--y4w0z1p"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">postfix_check: true</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<code class="literal">postfix_backup</code>: It determines whether a single backup copy of the configuration is created. By default the <code class="literal">postfix_backup</code> value is false.
				</li></ul></div><p>
			To overwrite any previous backup run the following command:
		</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vloqxdu"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># *cp /etc/postfix/main.cf /etc/postfix/main.cf.backup*</pre></div></div><p>
			If the <code class="literal">postfix_backup</code> value is changed to <code class="literal">true</code>, you must also set the <code class="literal">postfix_backup_multiple</code> value to false.
		</p><p>
			For example:
		</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--h3fhatg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">postfix_backup: true
postfix_backup_multiple: false</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<code class="literal">postfix_backup_multiple</code>: It determines if the role will make a timestamped backup copy of the configuration.
				</li></ul></div><p>
			To keep multiple backup copies, run the following command:
		</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zlq8hva"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># *cp /etc/postfix/main.cf /etc/postfix/main.cf.$(date -Isec)*</pre></div></div><p>
			By default the value of <code class="literal">postfix_backup_multiple</code> is true. The <code class="literal">postfix_backup_multiple:true</code> setting overrides <code class="literal">postfix_backup</code>. If you want to use <code class="literal">postfix_backup</code> you must set the <code class="literal">postfix_backup_multiple:false</code>.
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<code class="literal">postfix_manage_firewall</code>: Integrates the <code class="literal">postfix</code> role with the <code class="literal">firewall</code> role to manage port access. By default, the variable is set to <code class="literal">false</code>. If you want to automatically manage port access from the <code class="literal">postfix</code> role, set the variable to <code class="literal">true</code>.
				</li><li class="listitem">
					<code class="literal">postfix_manage_selinux</code>: Integrates the <code class="literal">postfix</code> role with the <code class="literal">selinux</code> role to manage port access. By default, the variable is set to <code class="literal">false</code>. If you want to automatically manage port access from the <code class="literal">postfix</code> role, set the variable to <code class="literal">true</code>.
				</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				The configuration parameters cannot be removed. Before running the <code class="literal">postfix</code> role, set the <code class="literal">postfix_conf</code> to all the required configuration parameters and use the file module to remove <code class="literal">/etc/postfix/main.cf</code>.
			</p></div></div><section class="section _additional-resources" id="additional_resources"><div class="titlepage"><div><div><h2 class="title">10.1. ADDITIONAL RESOURCES</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/postfix/README.md</code>
					</li></ul></div></section></section><section class="chapter" id="configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 11. Configuring SELinux using System Roles</h1></div></div></div><section class="section" id="introduction-to-the-selinux-system-role_configuring-selinux-using-system-roles"><div class="titlepage"><div><div><h2 class="title">11.1. Introduction to the selinux System Role</h2></div></div></div><p class="_abstract _abstract">
				RHEL&nbsp;System&nbsp;Roles is a collection of Ansible roles and 
modules that provide a consistent configuration interface to remotely 
manage multiple RHEL systems. The <code class="literal">selinux</code> System Role enables the following actions:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Cleaning local policy modifications related to SELinux booleans, file contexts, ports, and logins.
					</li><li class="listitem">
						Setting SELinux policy booleans, file contexts, ports, and logins.
					</li><li class="listitem">
						Restoring file contexts on specified files or directories.
					</li><li class="listitem">
						Managing SELinux modules.
					</li></ul></div><p>
				The following table provides an overview of input variables available in the <code class="literal">selinux</code> System Role.
			</p><div class="table" id="idm140604748420496"><p class="title">Table 11.1. selinux System Role variables</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="en1bg89" id="rh-table--en1bg89" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th id="idm140604748327264" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Role variable</th><th id="idm140604748326176" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th><th id="idm140604748325088" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">CLI alternative</th></tr></thead><tbody><tr><td headers="idm140604748327264" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								selinux_policy
							</p>
							 </td><td headers="idm140604748326176" data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Chooses a policy protecting targeted processes or Multi Level Security protection.
							</p>
							 </td><td headers="idm140604748325088" data-row="2" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">SELINUXTYPE</code> in <code class="literal">/etc/selinux/config</code>
							</p>
							 </td></tr><tr><td headers="idm140604748327264" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								selinux_state
							</p>
							 </td><td headers="idm140604748326176" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								Switches SELinux modes.
							</p>
							 </td><td headers="idm140604748325088" data-row="3" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">setenforce</code> and <code class="literal">SELINUX</code> in <code class="literal">/etc/selinux/config</code>.
							</p>
							 </td></tr><tr><td headers="idm140604748327264" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								selinux_booleans
							</p>
							 </td><td headers="idm140604748326176" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								Enables and disables SELinux booleans.
							</p>
							 </td><td headers="idm140604748325088" data-row="4" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">setsebool</code>
							</p>
							 </td></tr><tr><td headers="idm140604748327264" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								selinux_fcontexts
							</p>
							 </td><td headers="idm140604748326176" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								Adds or removes a SELinux file context mapping.
							</p>
							 </td><td headers="idm140604748325088" data-row="5" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">semanage fcontext</code>
							</p>
							 </td></tr><tr><td headers="idm140604748327264" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								selinux_restore_dirs
							</p>
							 </td><td headers="idm140604748326176" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
								Restores SELinux labels in the file-system tree.
							</p>
							 </td><td headers="idm140604748325088" data-row="6" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">restorecon -R</code>
							</p>
							 </td></tr><tr><td headers="idm140604748327264" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								selinux_ports
							</p>
							 </td><td headers="idm140604748326176" data-row="7" data-col="2" class="content--md" valign="top" align="left"> <p>
								Sets SELinux labels on ports.
							</p>
							 </td><td headers="idm140604748325088" data-row="7" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">semanage port</code>
							</p>
							 </td></tr><tr><td headers="idm140604748327264" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								selinux_logins
							</p>
							 </td><td headers="idm140604748326176" data-row="8" data-col="2" class="content--md" valign="top" align="left"> <p>
								Sets users to SELinux user mapping.
							</p>
							 </td><td headers="idm140604748325088" data-row="8" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">semanage login</code>
							</p>
							 </td></tr><tr><td headers="idm140604748327264" data-row="9" data-col="1" class="content--md" valign="top" align="left"> <p>
								selinux_modules
							</p>
							 </td><td headers="idm140604748326176" data-row="9" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Installs, enables, disables, or removes SELinux modules.
							</p>
							 </td><td headers="idm140604748325088" data-row="9" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">semodule</code>
							</p>
							 </td></tr></tbody></table></rh-table></div><p>
				The <code class="literal">/usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml</code> example playbook installed by the <code class="literal">rhel-system-roles</code>
 package demonstrates how to set the targeted policy in enforcing mode. 
The playbook also applies several local policy modifications and 
restores file contexts in the <code class="literal">/tmp/test_dir/</code> directory.
			</p><p>
				For a detailed reference on <code class="literal">selinux</code> role variables, install the <code class="literal">rhel-system-roles</code> package, and see the <code class="literal">README.md</code> or <code class="literal">README.html</code> files in the <code class="literal">/usr/share/doc/rhel-system-roles/selinux/</code> directory.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Introduction to RHEL System Roles</a>
					</li></ul></div></section><section class="section" id="using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_configuring-selinux-using-system-roles"><div class="titlepage"><div><div><h2 class="title">11.2. Using the selinux System Role to apply SELinux settings on multiple systems</h2></div></div></div><p class="_abstract _abstract">
				Follow the steps to prepare and apply an Ansible playbook with your verified SELinux settings.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Prepare your playbook. You can either start from the scratch or modify the example playbook installed as a part of the <code class="literal">rhel-system-roles</code> package:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--e8fpy1a"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cp /usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml <span class="emphasis"><em>my-selinux-playbook.yml</em></span></strong></span>
# <span class="strong strong"><strong>vi <span class="emphasis"><em>my-selinux-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Change the content of the playbook to fit your scenario. For 
example, the following part ensures that the system installs and enables
 the <code class="literal">selinux-local-1.pp</code> SELinux module:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0y8jtgd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">selinux_modules:
- { path: "selinux-local-1.pp", priority: "400" }</pre></div></div></li><li class="listitem">
						Save the changes, and exit the text editor.
					</li><li class="listitem"><p class="simpara">
						Run your playbook on the <span class="emphasis"><em>host1</em></span>, <span class="emphasis"><em>host2</em></span>, and <span class="emphasis"><em>host3</em></span> systems:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--d7rgs56"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>host1</em></span>,<span class="emphasis"><em>host2</em></span>,<span class="emphasis"><em>host3</em></span> <span class="emphasis"><em>my-selinux-playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more information, install the <code class="literal">rhel-system-roles</code> package, and see the <code class="literal">/usr/share/doc/rhel-system-roles/selinux/</code> and <code class="literal">/usr/share/ansible/roles/rhel-system-roles.selinux/</code> directories.
					</li></ul></div></section></section><section class="chapter" id="configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 12. Configuring logging by using RHEL System Roles</h1></div></div></div><p class="_abstract _abstract">
			As a system administrator, you can use the <code class="literal">logging</code> System Role to configure a RHEL host as a logging server to collect logs from many client systems.
		</p><section class="section" id="the-logging-system-role_configuring-logging-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">12.1. The logging System Role</h2></div></div></div><p class="_abstract _abstract">
				With the <code class="literal">logging</code> System Role, you can deploy logging configurations on local and remote hosts.
			</p><p>
				To apply a <code class="literal">logging</code> System Role on one or more systems, you define the logging configuration in a <span class="emphasis"><em>playbook</em></span>.
 A playbook is a list of one or more plays. Playbooks are 
human-readable, and they are written in the YAML format. For more 
information about playbooks, see <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks.html">Working with playbooks</a> in Ansible documentation.
			</p><p>
				The set of systems that you want to configure according to the playbook is defined in an <span class="emphasis"><em>inventory file</em></span>. For more information about creating and using inventories, see <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html">How to build your inventory</a> in Ansible documentation.
			</p><p>
				Logging solutions provide multiple ways of reading logs and multiple logging outputs.
			</p><p>
				For example, a logging system can receive the following inputs:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						local files,
					</li><li class="listitem">
						<code class="literal">systemd/journal</code>,
					</li><li class="listitem">
						another logging system over the network.
					</li></ul></div><p>
				In addition, a logging system can have the following outputs:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						logs stored in the local files in the <code class="literal">/var/log</code> directory,
					</li><li class="listitem">
						logs sent to Elasticsearch,
					</li><li class="listitem">
						logs forwarded to another logging system.
					</li></ul></div><p>
				With the <code class="literal">logging</code> System Role, you can 
combine the inputs and outputs to fit your scenario. For example, you 
can configure a logging solution that stores inputs from <code class="literal">journal</code> in a local file, whereas inputs read from files are both forwarded to another logging system and stored in the local log files.
			</p></section><section class="section" id="logging-system-role-parameters_configuring-logging-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">12.2. logging System Role parameters</h2></div></div></div><p class="_abstract _abstract">
				In a <code class="literal">logging</code> System Role playbook, you define the inputs in the <code class="literal">logging_inputs</code> parameter, outputs in the <code class="literal">logging_outputs</code> parameter, and the relationships between the inputs and outputs in the <code class="literal">logging_flows</code> parameter. The <code class="literal">logging</code>
 System Role processes these variables with additional options to 
configure the logging system. You can also enable encryption or an 
automatic port management.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Currently, the only available logging system in the <code class="literal">logging</code> System Role is <span class="strong strong"><strong>Rsyslog</strong></span>.
				</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<code class="literal">logging_inputs</code>: List of inputs for the logging solution.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">name</code>: Unique name of the input. Used in the <code class="literal">logging_flows</code>: inputs list and a part of the generated <code class="literal">config</code> file name.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">type</code>: Type of the input element. The type specifies a task type which corresponds to a directory name in <code class="literal">roles/rsyslog/{tasks,vars}/inputs/</code>.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem"><p class="simpara">
										<code class="literal">basics</code>: Inputs configuring inputs from <code class="literal">systemd</code> journal or <code class="literal">unix</code> socket.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												<code class="literal">kernel_message</code>: Load <code class="literal">imklog</code> if set to <code class="literal">true</code>. Default to <code class="literal">false</code>.
											</li><li class="listitem">
												<code class="literal">use_imuxsock</code>: Use <code class="literal">imuxsock</code> instead of <code class="literal">imjournal</code>. Default to <code class="literal">false</code>.
											</li><li class="listitem">
												<code class="literal">ratelimit_burst</code>: Maximum number of messages that can be emitted within <code class="literal">ratelimit_interval</code>. Default to <code class="literal">20000</code> if <code class="literal">use_imuxsock</code> is false. Default to <code class="literal">200</code> if <code class="literal">use_imuxsock</code> is true.
											</li><li class="listitem">
												<code class="literal">ratelimit_interval</code>: Interval to evaluate <code class="literal">ratelimit_burst</code>. Default to 600 seconds if <code class="literal">use_imuxsock</code> is false. Default to 0 if <code class="literal">use_imuxsock</code> is true. 0 indicates rate limiting is turned off.
											</li><li class="listitem">
												<code class="literal">persist_state_interval</code>: Journal state is persisted every <code class="literal">value</code> messages. Default to <code class="literal">10</code>. Effective only when <code class="literal">use_imuxsock</code> is false.
											</li></ul></div></li><li class="listitem">
										<code class="literal">files</code>: Inputs configuring inputs from local files.
									</li><li class="listitem">
										<code class="literal">remote</code>: Inputs configuring inputs from the other logging system over network.
									</li></ul></div></li><li class="listitem">
								<code class="literal">state</code>: State of the configuration file. <code class="literal">present</code> or <code class="literal">absent</code>. Default to <code class="literal">present</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">logging_outputs</code>: List of outputs for the logging solution.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">files</code>: Outputs configuring outputs to local files.
							</li><li class="listitem">
								<code class="literal">forwards</code>: Outputs configuring outputs to another logging system.
							</li><li class="listitem">
								<code class="literal">remote_files</code>: Outputs configuring outputs from another logging system to local files.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						<code class="literal">logging_flows</code>: List of flows that define relationships between <code class="literal">logging_inputs</code> and <code class="literal">logging_outputs</code>. The <code class="literal">logging_flows</code> variable has the following keys:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">name</code>: Unique name of the flow
							</li><li class="listitem">
								<code class="literal">inputs</code>: List of <code class="literal">logging_inputs</code> name values
							</li><li class="listitem">
								<code class="literal">outputs</code>: List of <code class="literal">logging_outputs</code> name values.
							</li></ul></div></li><li class="listitem">
						<code class="literal">logging_manage_firewall</code>: If set to <code class="literal">true</code>, the <code class="literal">logging</code> role uses the <code class="literal">firewall</code> role to automatically manage port access.
					</li><li class="listitem">
						<code class="literal">logging_manage_selinux</code>: If set to <code class="literal">true</code>, the <code class="literal">logging</code> role uses the <code class="literal">selinux</code> role to automatically manage port access.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Documentation installed with the <code class="literal">rhel-system-roles</code> package in <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.html</code>
					</li></ul></div></section><section class="section" id="applying-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">12.3. Applying a local logging System Role</h2></div></div></div><p class="_abstract _abstract">
				Prepare and apply an Ansible playbook to configure a logging 
solution on a set of separate machines. Each machine records logs 
locally.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">logging</code> System Role.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li></ul></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0-8.5 provided access to a separate Ansible repository that 
contains Ansible Engine 2.9 for automation based on Ansible. Ansible 
Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>, connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>, and many plugins and modules. For information about how to obtain and install Ansible Engine, see the <a class="link" href="https://access.redhat.com/articles/3174981">How to download and install Red Hat Ansible Engine</a> Knowledgebase article.
				</p><p>
					RHEL 8.6 and 9.0 have introduced Ansible Core (provided as the <code class="literal">ansible-core</code>
 package), which contains the Ansible command-line utilities, commands, 
and a small set of built-in Ansible plugins. RHEL provides this package 
through the AppStream repository, and it has a limited scope of support.
 For more information, see the <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a> Knowledgebase article.
				</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An inventory file which lists the managed nodes.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You do not have to have the <code class="literal">rsyslog</code> package installed, because the System Role installs <code class="literal">rsyslog</code> when deployed.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook that defines the required role:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new YAML file and open it in a text editor, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jmxo8zr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>vi <span class="emphasis"><em>logging-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Insert the following content:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ayjj9d7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Deploying basics input and implicit files output
  hosts: all
  roles:
    - rhel-system-roles.logging
  vars:
    logging_inputs:
      - name: system_input
        type: basics
    logging_outputs:
      - name: files_output
        type: files
    logging_flows:
      - name: flow1
        inputs: [system_input]
        outputs: [files_output]</pre></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Run the playbook on a specific inventory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ph4agff"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory-file</em></span> <span class="emphasis"><em>/path/to/file/logging-playbook.yml</em></span></strong></span></pre></div></div><p class="simpara">
						Where:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal"><span class="emphasis"><em>inventory-file</em></span></code> is the inventory file.
							</li><li class="listitem">
								<code class="literal"><span class="emphasis"><em>logging-playbook.yml</em></span></code> is the playbook you use.
							</li></ul></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Test the syntax of the <code class="literal">/etc/rsyslog.conf</code> file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--hlw3zni"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-6.el8, config validation run...
rsyslogd: End of config validation run. Bye.</pre></div></div></li><li class="listitem"><p class="simpara">
						Verify that the system sends messages to the log:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Send a test message:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5lhybla"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>logger test</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								View the <code class="literal">/var/log/messages</code> log, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--b9r1x9h"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /var/log/messages</strong></span>
Aug  5 13:48:31 <span class="emphasis"><em>hostname</em></span> root[6778]: test</pre></div></div><p class="simpara">
								Where <code class="literal"><span class="emphasis"><em>hostname</em></span></code>
 is the host name of the client system. Note that the log contains the 
user name of the user that entered the logger command, in this case <code class="literal">root</code>.
							</p></li></ol></div></li></ol></div></section><section class="section" id="proc_filtering-logs-in-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">12.4. Filtering logs in a local logging System Role</h2></div></div></div><p class="_abstract _abstract">
				You can deploy a logging solution which filters the logs based on the <code class="literal">rsyslog</code> property-based filter.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">logging</code> System Role.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Red Hat Ansible Core is installed
							</li><li class="listitem">
								The <code class="literal">rhel-system-roles</code> package is installed
							</li><li class="listitem">
								An inventory file which lists the managed nodes.
							</li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You do not have to have the <code class="literal">rsyslog</code> package installed, because the System Role installs <code class="literal">rsyslog</code> when deployed.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--fkjwutq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Deploying files input and configured files output
  hosts: all
  roles:
    - linux-system-roles.logging
  vars:
    logging_inputs:
      - name: files_input
        type: basics
    logging_outputs:
      - name: files_output0
        type: files
        property: msg
        property_op: contains
        property_value: error
        path: /var/log/errors.log
      - name: files_output1
        type: files
        property: msg
        property_op: "!contains"
        property_value: error
        path: /var/log/others.log
    logging_flows:
      - name: flow0
        inputs: [files_input]
        outputs: [files_output0, files_output1]</pre></div></div><p class="simpara">
						Using this configuration, all messages that contain the <code class="literal"><span class="emphasis"><em>error</em></span></code> string are logged in <code class="literal">/var/log/errors.log</code>, and all other messages are logged in <code class="literal">/var/log/others.log</code>.
					</p><p class="simpara">
						You can replace the <code class="literal"><span class="emphasis"><em>error</em></span></code> property value with the string by which you want to filter.
					</p><p class="simpara">
						You can modify the variables according to your preferences.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vp8ypkl"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--tkbhr5p"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Test the syntax of the <code class="literal">/etc/rsyslog.conf</code> file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1qfqp24"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-6.el8, config validation run...
rsyslogd: End of config validation run. Bye.</pre></div></div></li><li class="listitem"><p class="simpara">
						Verify that the system sends messages that contain the <code class="literal">error</code> string to the log:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Send a test message:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--k1d3qrs"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>logger error</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								View the <code class="literal">/var/log/errors.log</code> log, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8xtm9nh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /var/log/errors.log</strong></span>
Aug  5 13:48:31 <span class="emphasis"><em>hostname</em></span> root[6778]: error</pre></div></div><p class="simpara">
								Where <code class="literal"><span class="emphasis"><em>hostname</em></span></code>
 is the host name of the client system. Note that the log contains the 
user name of the user that entered the logger command, in this case <code class="literal">root</code>.
							</p></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Documentation installed with the <code class="literal">rhel-system-roles</code> package in <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.html</code>
					</li></ul></div></section><section class="section" id="applying-a-remote-logging-solution-using-the-logging-system-role_configuring-logging-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">12.5. Applying a remote logging solution using the logging System Role</h2></div></div></div><p class="_abstract _abstract">
				Follow these steps to prepare and apply a Red Hat Ansible Core 
playbook to configure a remote logging solution. In this playbook, one 
or more clients take logs from <code class="literal">systemd-journal</code> and forward them to a remote server. The server receives remote input from <code class="literal">remote_rsyslog</code> and <code class="literal">remote_files</code> and outputs the logs to local files in directories named by remote host names.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">logging</code> System Role.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li><li class="listitem">
								An inventory file which lists the managed nodes.
							</li></ul></div></li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You do not have to have the <code class="literal">rsyslog</code> package installed, because the System Role installs <code class="literal">rsyslog</code> when deployed.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook that defines the required role:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new YAML file and open it in a text editor, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yp6fg5u"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>vi <span class="emphasis"><em>logging-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Insert the following content into the file:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0rla2qq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Deploying remote input and remote_files output
  hosts: server
  roles:
    - rhel-system-roles.logging
  vars:
    logging_inputs:
      - name: remote_udp_input
        type: remote
        udp_ports: [ 601 ]
      - name: remote_tcp_input
        type: remote
        tcp_ports: [ 601 ]
    logging_outputs:
      - name: remote_files_output
        type: remote_files
    logging_flows:
      - name: flow_0
        inputs: [remote_udp_input, remote_tcp_input]
        outputs: [remote_files_output]

- name: Deploying basics input and forwards output
  hosts: clients
  roles:
    - rhel-system-roles.logging
  vars:
    logging_inputs:
      - name: basic_input
        type: basics
    logging_outputs:
      - name: forward_output0
        type: forwards
        severity: info
        target: _host1.example.com_
        udp_port: 601
      - name: forward_output1
        type: forwards
        facility: mail
        target: _host1.example.com_
        tcp_port: 601
    logging_flows:
      - name: flows0
        inputs: [basic_input]
        outputs: [forward_output0, forward_output1]

[basic_input]
[forward_output0, forward_output1]</pre></div></div><p class="simpara">
								Where <code class="literal"><span class="emphasis"><em>host1.example.com</em></span></code> is the logging server.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									You can modify the parameters in the playbook to fit your needs.
								</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
									The logging solution works only with the ports defined in the 
SELinux policy of the server or client system and open in the firewall. 
The default SELinux policy includes ports 601, 514, 6514, 10514, and 
20514. To use a different port, <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux#customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations">modify the SELinux policy on the client and server systems</a>.
								</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Create an inventory file that lists your servers and clients:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new file and open it in a text editor, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wkkv62m"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>vi <span class="emphasis"><em>inventory.ini</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								Insert the following content into the inventory file:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1bzdqcl"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">[servers]
server ansible_host=<span class="emphasis"><em>host1.example.com</em></span>
[clients]
client ansible_host=<span class="emphasis"><em>host2.example.com</em></span></pre></div></div><p class="simpara">
								Where:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal"><span class="emphasis"><em>host1.example.com</em></span></code> is the logging server.
									</li><li class="listitem">
										<code class="literal"><span class="emphasis"><em>host2.example.com</em></span></code> is the logging client.
									</li></ul></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--q43pa9w"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>/path/to/file/inventory.ini</em></span> <span class="emphasis"><em>/path/to/file/_logging-playbook.yml</em></span></strong></span></pre></div></div><p class="simpara">
						Where:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal"><span class="emphasis"><em>inventory.ini</em></span></code> is the inventory file.
							</li><li class="listitem">
								<code class="literal"><span class="emphasis"><em>logging-playbook.yml</em></span></code> is the playbook you created.
							</li></ul></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On both the client and the server system, test the syntax of the <code class="literal">/etc/rsyslog.conf</code> file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qqhwvxp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-6.el8, config validation run (level 1), master config /etc/rsyslog.conf
rsyslogd: End of config validation run. Bye.</pre></div></div></li><li class="listitem"><p class="simpara">
						Verify that the client system sends messages to the server:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								On the client system, send a test message:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5p7l1go"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>logger test</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
								On the server system, view the <code class="literal">/var/log/messages</code> log, for example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--d2olvfx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /var/log/messages</strong></span>
Aug  5 13:48:31 <span class="emphasis"><em>host2.example.com</em></span> root[6778]: test</pre></div></div><p class="simpara">
								Where <code class="literal"><span class="emphasis"><em>host2.example.com</em></span></code>
 is the host name of the client system. Note that the log contains the 
user name of the user that entered the logger command, in this case <code class="literal">root</code>.
							</p></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL System Roles</a>
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rhel-system-roles</code> package in <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.html</code>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/node/3050101">RHEL System Roles</a> KB article
					</li></ul></div></section><section class="section" id="assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">12.6. Using the logging System Role with TLS</h2></div></div></div><p class="_abstract _abstract">
				Transport Layer Security (TLS) is a cryptographic protocol designed to allow secure communication over the computer network.
			</p><p>
				As an administrator, you can use the <code class="literal">logging</code> RHEL&nbsp;System&nbsp;Role to configure a secure transfer of logs using Red Hat Ansible Automation Platform.
			</p><section class="section" id="configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls"><div class="titlepage"><div><div><h3 class="title">12.6.1. Configuring client logging with TLS</h3></div></div></div><p class="_abstract _abstract">
					You can use an Ansible playbook with the <code class="literal">logging</code> System Role to configure logging on RHEL clients and transfer logs to a remote logging system using TLS encryption.
				</p><p>
					This procedure creates a private key and certificate, and 
configures TLS on all hosts in the clients group in the Ansible 
inventory. The TLS protocol encrypts the message transmission for secure
 transfer of logs over the network.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You do not have to call the <code class="literal">certificate</code> System Role in the playbook to create the certificate. The <code class="literal">logging</code> System Role calls it automatically.
					</p><p>
						In order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have permissions to run playbooks on managed nodes on which you want to configure TLS.
						</li><li class="listitem">
							The managed nodes are listed in the inventory file on the control node.
						</li><li class="listitem">
							The <code class="literal">ansible</code> and <code class="literal">rhel-system-roles</code> packages are installed on the control node.
						</li><li class="listitem">
							The managed nodes are enrolled in an IdM domain.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9gjvt6s"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Deploying files input and forwards output with certs
  hosts: clients
  roles:
    - rhel-system-roles.logging
  vars:
    logging_certificates:
      - name: <span class="emphasis"><em>logging_cert</em></span>
        dns: ['localhost', 'www.example.com']
        ca: ipa
    logging_pki_files:
      - ca_cert: <span class="emphasis"><em>/local/path/to/ca_cert.pem</em></span>
        cert: <span class="emphasis"><em>/local/path/to/logging_cert.pem</em></span>
        private_key: <span class="emphasis"><em>/local/path/to/logging_cert.pem</em></span>
    logging_inputs:
      - name: <span class="emphasis"><em>input_name</em></span>
        type: files
        input_log_path: <span class="emphasis"><em>/var/log/containers/*.log</em></span>
    logging_outputs:
      - name: <span class="emphasis"><em>output_name</em></span>
        type: forwards
        target: <span class="emphasis"><em>your_target_host</em></span>
        tcp_port: 514
        tls: true
        pki_authmode: x509/name
        permitted_server: '<span class="emphasis"><em>server.example.com</em></span>'
    logging_flows:
      - name: <span class="emphasis"><em>flow_name</em></span>
        inputs: [<span class="emphasis"><em>input_name</em></span>]
        outputs: [<span class="emphasis"><em>output_name</em></span>]</pre></div></div><p class="simpara">
							The playbook uses the following parameters:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_certificates</code></span></dt><dd>
										The value of this parameter is passed on to <code class="literal">certificate_requests</code> in the <code class="literal">certificate</code> role and used to create a private key and certificate.
									</dd><dt><span class="term"><code class="literal">logging_pki_files</code></span></dt><dd><p class="simpara">
										Using this parameter, you can configure the paths and other 
settings that logging uses to find the CA, certificate, and key files 
used for TLS, specified with one or more of the following 
sub-parameters: <code class="literal">ca_cert</code>, <code class="literal">ca_cert_src</code>, <code class="literal">cert</code>, <code class="literal">cert_src</code>, <code class="literal">private_key</code>, <code class="literal">private_key_src</code>, and <code class="literal">tls</code>.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											If you are using <code class="literal">logging_certificates</code> to create the files on the target node, do not use <code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, and <code class="literal">private_key_src</code>, which are used to copy files not created by <code class="literal">logging_certificates</code>.
										</p></div></div></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to the CA certificate file on the target node. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to the certificate file on the target node. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to the private key file on the target node. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents the path to the CA certificate file on the control 
node which is copied to the target host to the location specified by <code class="literal">ca_cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the path to a certificate file on the control node 
which is copied to the target host to the location specified by <code class="literal">cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the path to a private key file on the control node 
which is copied to the target host to the location specified by <code class="literal">private_key</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd>
										Setting this parameter to <code class="literal">true</code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set <code class="literal">tls: false</code>.
									</dd></dl></div></li><li class="listitem"><p class="simpara">
							Verify playbook syntax:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--egoplrp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
							Run the playbook on your inventory file:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--r1j1shc"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL System Roles</a>.
						</li></ul></div></section><section class="section" id="configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls"><div class="titlepage"><div><div><h3 class="title">12.6.2. Configuring server logging with TLS</h3></div></div></div><p class="_abstract _abstract">
					You can use an Ansible playbook with the <code class="literal">logging</code>
 System Role to configure logging on RHEL servers and set them to 
receive logs from a remote logging system using TLS encryption.
				</p><p>
					This procedure creates a private key and certificate, and 
configures TLS on all hosts in the server group in the Ansible 
inventory.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You do not have to call the <code class="literal">certificate</code> System Role in the playbook to create the certificate. The <code class="literal">logging</code> System Role calls it automatically.
					</p><p>
						In order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.
					</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have permissions to run playbooks on managed nodes on which you want to configure TLS.
						</li><li class="listitem">
							The managed nodes are listed in the inventory file on the control node.
						</li><li class="listitem">
							The <code class="literal">ansible</code> and <code class="literal">rhel-system-roles</code> packages are installed on the control node.
						</li><li class="listitem">
							The managed nodes are enrolled in an IdM domain.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2bnwwr0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Deploying remote input and remote_files output with certs
  hosts: server
  roles:
    - rhel-system-roles.logging
  vars:
    logging_certificates:
      - name: <span class="emphasis"><em>logging_cert</em></span>
        dns: ['localhost', 'www.example.com']
        ca: ipa
    logging_pki_files:
      - ca_cert: <span class="emphasis"><em>/local/path/to/ca_cert.pem</em></span>
        cert: <span class="emphasis"><em>/local/path/to/logging_cert.pem</em></span>
        private_key: <span class="emphasis"><em>/local/path/to/logging_cert.pem</em></span>
    logging_inputs:
      - name: <span class="emphasis"><em>input_name</em></span>
        type: remote
        tcp_ports: 514
        tls: true
        permitted_clients: ['<span class="emphasis"><em>clients.example.com</em></span>']
    logging_outputs:
      - name: <span class="emphasis"><em>output_name</em></span>
        type: remote_files
        remote_log_path: /var/log/remote/%FROMHOST%/%PROGRAMNAME:::secpath-replace%.log
        async_writing: true
        client_count: 20
        io_buffer_size: 8192
    logging_flows:
      - name: <span class="emphasis"><em>flow_name</em></span>
        inputs: [<span class="emphasis"><em>input_name</em></span>]
        outputs: [<span class="emphasis"><em>output_name</em></span>]</pre></div></div><p class="simpara">
							The playbook uses the following parameters:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_certificates</code></span></dt><dd>
										The value of this parameter is passed on to <code class="literal">certificate_requests</code> in the <code class="literal">certificate</code> role and used to create a private key and certificate.
									</dd><dt><span class="term"><code class="literal">logging_pki_files</code></span></dt><dd><p class="simpara">
										Using this parameter, you can configure the paths and other 
settings that logging uses to find the CA, certificate, and key files 
used for TLS, specified with one or more of the following 
sub-parameters: <code class="literal">ca_cert</code>, <code class="literal">ca_cert_src</code>, <code class="literal">cert</code>, <code class="literal">cert_src</code>, <code class="literal">private_key</code>, <code class="literal">private_key_src</code>, and <code class="literal">tls</code>.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											If you are using <code class="literal">logging_certificates</code> to create the files on the target node, do not use <code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, and <code class="literal">private_key_src</code>, which are used to copy files not created by <code class="literal">logging_certificates</code>.
										</p></div></div></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to the CA certificate file on the target node. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to the certificate file on the target node. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to the private key file on the target node. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents the path to the CA certificate file on the control 
node which is copied to the target host to the location specified by <code class="literal">ca_cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the path to a certificate file on the control node 
which is copied to the target host to the location specified by <code class="literal">cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the path to a private key file on the control node 
which is copied to the target host to the location specified by <code class="literal">private_key</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd>
										Setting this parameter to <code class="literal">true</code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set <code class="literal">tls: false</code>.
									</dd></dl></div></li><li class="listitem"><p class="simpara">
							Verify playbook syntax:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xkxrqbd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
							Run the playbook on your inventory file:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7edyb49"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL System Roles</a>.
						</li></ul></div></section></section><section class="section" id="assembly_using-the-logging-system-roles-with-relp"><div class="titlepage"><div><div><h2 class="title">12.7. Using the logging System Roles with RELP</h2></div></div></div><p class="_abstract _abstract">
				Reliable Event Logging Protocol (RELP) is a networking protocol for 
data and message logging over the TCP network. It ensures reliable 
delivery of event messages and you can use it in environments that do 
not tolerate any message loss.
			</p><p>
				The RELP sender transfers log entries in form of commands and the 
receiver acknowledges them once they are processed. To ensure 
consistency, RELP stores the transaction number to each transferred 
command for any kind of message recovery.
			</p><p>
				You can consider a remote logging system in between the RELP Client 
and RELP Server. The RELP Client transfers the logs to the remote 
logging system and the RELP Server receives all the logs sent by the 
remote logging system.
			</p><p>
				Administrators can use the <code class="literal">logging</code> System Role to configure the logging system to reliably send and receive log entries.
			</p><section class="section" id="configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp"><div class="titlepage"><div><div><h3 class="title">12.7.1. Configuring client logging with RELP</h3></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> System Role to
 configure logging in RHEL systems that are logged on a local machine 
and can transfer logs to the remote logging system with RELP by running 
an Ansible playbook.
				</p><p>
					This procedure configures RELP on all hosts in the <code class="literal">clients</code>
 group in the Ansible inventory. The RELP configuration uses Transport 
Layer Security (TLS) to encrypt the message transmission for secure 
transfer of logs over the network.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have permissions to run playbooks on managed nodes on which you want to configure RELP.
						</li><li class="listitem">
							The managed nodes are listed in the inventory file on the control node.
						</li><li class="listitem">
							The <code class="literal">ansible</code> and <code class="literal">rhel-system-roles</code> packages are installed on the control node.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--sm24vu5"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Deploying basic input and relp output
  hosts: clients
  roles:
    - rhel-system-roles.logging
  vars:
    logging_inputs:
      - name: basic_input
        type: basics
    logging_outputs:
      - name: relp_client
        type: relp
        target: <span class="emphasis"><em>logging.server.com</em></span>
        port: 20514
        tls: true
        ca_cert: <span class="emphasis"><em>/etc/pki/tls/certs/ca.pem</em></span>
        cert: <span class="emphasis"><em>/etc/pki/tls/certs/client-cert.pem</em></span>
        private_key: <span class="emphasis"><em>/etc/pki/tls/private/client-key.pem</em></span>
        pki_authmode: name
        permitted_servers:
          - '*.server.example.com'
    logging_flows:
      - name: <span class="emphasis"><em>example_flow</em></span>
        inputs: [basic_input]
        outputs: [relp_client]</pre></div></div><p class="simpara">
							The playbooks uses following settings:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">target</code>: This is a required parameter that specifies the host name where the remote logging system is running.
								</li><li class="listitem">
									<code class="literal">port</code>: Port number the remote logging system is listening.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">tls</code>: Ensures secure transfer of logs over the network. If you do not want a secure wrapper you can set the <code class="literal">tls</code> variable to <code class="literal">false</code>. By default <code class="literal">tls</code> parameter is set to true while working with RELP and requires key/certificates and triplets {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} and/or {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>}.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											If the {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>} triplet is set, the default locations <code class="literal">/etc/pki/tls/certs</code> and <code class="literal">/etc/pki/tls/private</code>
 are used as the destination on the managed node to transfer files from 
control node. In this case, the file names are identical to the original
 ones in the triplet
										</li><li class="listitem">
											If the {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} triplet is set, files are expected to be on the default path before the logging configuration.
										</li><li class="listitem">
											If both triplets are set, files are transferred from local 
path from control node to specific path of the managed node.
										</li></ul></div></li><li class="listitem">
									<code class="literal">ca_cert</code>: Represents the path to CA certificate. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
								</li><li class="listitem">
									<code class="literal">cert</code>: Represents the path to certificate. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
								</li><li class="listitem">
									<code class="literal">private_key</code>: Represents the path to private key. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
								</li><li class="listitem">
									<code class="literal">ca_cert_src</code>: Represents local CA certificate file path which is copied to the target host. If <code class="literal">ca_cert</code> is specified, it is copied to the location.
								</li><li class="listitem">
									<code class="literal">cert_src</code>: Represents the local certificate file path which is copied to the target host. If <code class="literal">cert</code> is specified, it is copied to the location.
								</li><li class="listitem">
									<code class="literal">private_key_src</code>: Represents the local key file path which is copied to the target host. If <code class="literal">private_key</code> is specified, it is copied to the location.
								</li><li class="listitem">
									<code class="literal">pki_authmode</code>: Accepts the authentication mode as <code class="literal">name</code> or <code class="literal">fingerprint</code>.
								</li><li class="listitem">
									<code class="literal">permitted_servers</code>: List of servers that will be allowed by the logging client to connect and send logs over TLS.
								</li><li class="listitem">
									<code class="literal">inputs</code>: List of logging input dictionary.
								</li><li class="listitem">
									<code class="literal">outputs</code>: List of logging output dictionary.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Optional: Verify playbook syntax.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--h09zsc7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--73jzsgb"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li></ol></div></section><section class="section" id="configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp"><div class="titlepage"><div><div><h3 class="title">12.7.2. Configuring server logging with RELP</h3></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> System Role to
 configure logging in RHEL systems as a server and can receive logs from
 the remote logging system with RELP by running an Ansible playbook.
				</p><p>
					This procedure configures RELP on all hosts in the <code class="literal">server</code>
 group in the Ansible inventory. The RELP configuration uses TLS to 
encrypt the message transmission for secure transfer of logs over the 
network.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have permissions to run playbooks on managed nodes on which you want to configure RELP.
						</li><li class="listitem">
							The managed nodes are listed in the inventory file on the control node.
						</li><li class="listitem">
							The <code class="literal">ansible</code> and <code class="literal">rhel-system-roles</code> packages are installed on the control node.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--4nkw416"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Deploying remote input and remote_files output
  hosts: server
  roles:
    - rhel-system-roles.logging
  vars:
    logging_inputs:
      - name: relp_server
        type: relp
        port: 20514
        tls: true
        ca_cert: <span class="emphasis"><em>/etc/pki/tls/certs/ca.pem</em></span>
        cert: <span class="emphasis"><em>/etc/pki/tls/certs/server-cert.pem</em></span>
        private_key: <span class="emphasis"><em>/etc/pki/tls/private/server-key.pem</em></span>
        pki_authmode: name
        permitted_clients:
          - '<span class="emphasis"><em>*example.client.com</em></span>'
    logging_outputs:
      - name: <span class="emphasis"><em>remote_files_output</em></span>
        type: <span class="emphasis"><em>remote_files</em></span>
    logging_flows:
      - name: <span class="emphasis"><em>example_flow</em></span>
        inputs: <span class="emphasis"><em>relp_server</em></span>
        outputs: <span class="emphasis"><em>remote_files_output</em></span></pre></div></div><p class="simpara">
							The playbooks uses the following settings:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">port</code>: Port number the remote logging system is listening.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">tls</code>: Ensures secure transfer of logs over the network. If you do not want a secure wrapper you can set the <code class="literal">tls</code> variable to <code class="literal">false</code>. By default <code class="literal">tls</code> parameter is set to true while working with RELP and requires key/certificates and triplets {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} and/or {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>}.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											If the {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>} triplet is set, the default locations <code class="literal">/etc/pki/tls/certs</code> and <code class="literal">/etc/pki/tls/private</code>
 are used as the destination on the managed node to transfer files from 
control node. In this case, the file names are identical to the original
 ones in the triplet
										</li><li class="listitem">
											If the {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} triplet is set, files are expected to be on the default path before the logging configuration.
										</li><li class="listitem">
											If both triplets are set, files are transferred from local 
path from control node to specific path of the managed node.
										</li></ul></div></li><li class="listitem">
									<code class="literal">ca_cert</code>: Represents the path to CA certificate. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
								</li><li class="listitem">
									<code class="literal">cert</code>: Represents the path to the certificate. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
								</li><li class="listitem">
									<code class="literal">private_key</code>: Represents the path to private key. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
								</li><li class="listitem">
									<code class="literal">ca_cert_src</code>: Represents local CA certificate file path which is copied to the target host. If <code class="literal">ca_cert</code> is specified, it is copied to the location.
								</li><li class="listitem">
									<code class="literal">cert_src</code>: Represents the local certificate file path which is copied to the target host. If <code class="literal">cert</code> is specified, it is copied to the location.
								</li><li class="listitem">
									<code class="literal">private_key_src</code>: Represents the local key file path which is copied to the target host. If <code class="literal">private_key</code> is specified, it is copied to the location.
								</li><li class="listitem">
									<code class="literal">pki_authmode</code>: Accepts the authentication mode as <code class="literal">name</code> or <code class="literal">fingerprint</code>.
								</li><li class="listitem">
									<code class="literal">permitted_clients</code>: List of clients that will be allowed by the logging server to connect and send logs over TLS.
								</li><li class="listitem">
									<code class="literal">inputs</code>: List of logging input dictionary.
								</li><li class="listitem">
									<code class="literal">outputs</code>: List of logging output dictionary.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Optional: Verify playbook syntax.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9ubqm3c"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wa3w0xt"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li></ol></div></section></section><section class="section _additional-resources" id="additional_resources_2"><div class="titlepage"><div><div><h2 class="title">12.8. ADDITIONAL RESOURCES</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL System Roles</a>
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rhel-system-roles</code> package in <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.html</code>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/node/3050101">RHEL System Roles</a>
					</li><li class="listitem">
						<code class="literal">ansible-playbook(1)</code> man page.
					</li></ul></div></section></section><section class="chapter" id="configuring-the-systemd-journal-by-using-the-journald-RHEL-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 13. Configuring the systemd journal by using the journald RHEL System Role</h1></div></div></div><p>
			With the <code class="literal">journald</code> System Role you can automate the <code class="literal">systemd</code> journal, and configure persistent logging by using the Red Hat Ansible Automation Platform.
		</p><section class="section" id="variables-for-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">13.1. Variables for the journald RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">journald</code> System Role provides a set of variables for customizing the behavior of <code class="literal">journald</code> logging service. The role includes the following variables:
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="1aiza3q" id="rh-table--1aiza3q" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604740610432" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Role Variable</th><th id="idm140604740609344" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604740610432" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">journald_persistent</code>
							</p>
							 </td><td headers="idm140604740609344" data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Use this boolean variable to configure <code class="literal">journald</code> for storing log files on disk in the <code class="literal">/var/log/journal/</code> directory. When you set this variable to <code class="literal">true</code>, logs are stored on disk, otherwise, they are stored in volatile memory. The default value is <code class="literal">false</code>.
							</p>
							 </td></tr><tr><td headers="idm140604740610432" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">journald_max_disk_size</code>
							</p>
							 </td><td headers="idm140604740609344" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Use this variable to specify the maximum size, in megabytes, 
that journal files can occupy on disk. Refer to the default sizing 
calculation described in <code class="literal">journald.conf(5)</code> man page.
							</p>
							 </td></tr><tr><td headers="idm140604740610432" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">journald_max_files</code>
							</p>
							 </td><td headers="idm140604740609344" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Use this variable to specify the maximum number of journal files you want to keep while respecting the <code class="literal">journal_max_disk_size</code> setting for journal.
							</p>
							 </td></tr><tr><td headers="idm140604740610432" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">journald_max_file_size</code>
							</p>
							 </td><td headers="idm140604740609344" data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Use this variable to specify the maximum size, in megabytes, of a single journal file.
							</p>
							 </td></tr><tr><td headers="idm140604740610432" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">journald_per_user</code>
							</p>
							 </td><td headers="idm140604740609344" data-row="6" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Use this boolean variable to configure <code class="literal">journald</code> for keeping log data separate for each user. The default value is <code class="literal">true</code>
 and the unprivileged users can read system logs from their own user 
services. Note that per-user journal files are only available when the <code class="literal">journald_persistent</code> variable is set to <code class="literal">true</code>.
							</p>
							 </td></tr><tr><td headers="idm140604740610432" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">journald_compression</code>
							</p>
							 </td><td headers="idm140604740609344" data-row="7" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Use this boolean variable to apply compression to <code class="literal">journald</code> data objects that are larger than the default 512 bytes. The default value is <code class="literal">true</code>.
							</p>
							 </td></tr><tr><td headers="idm140604740610432" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">journald_sync_interval</code>
							</p>
							 </td><td headers="idm140604740609344" data-row="8" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Use this variable to specify the time, in minutes, after which <code class="literal">journald</code> synchronizes the currently used journal file to disk. By default, the role does not alter the current value.
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">journald.conf(5)</code> man page.
					</li></ul></div></section><section class="section" id="configuring-persistent-logging-by-using-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">13.2. Configuring persistent logging by using the journald System Role</h2></div></div></div><p>
				As a system administrator, you can configure persistent logging by using the <code class="literal">journald</code> System Role. The following example shows how to set up the <code class="literal">journald</code> System Role variables in a playbook to achieve the following goals:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Configuring persistent logging
					</li><li class="listitem">
						Specifying the maximum size of disk space for journal files
					</li><li class="listitem">
						Configuring <code class="literal">journald</code> to keep log data separate for each user
					</li><li class="listitem">
						Defining the synchronization interval
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to 
run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal">playbook.yml</code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--iz6kbmo"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- hosts: all
  vars:
    journald_persistent: true
    journald_max_disk_size: 2048
    journald_per_user: true
    journald_sync_interval: 1
  roles:
    - linux-system-roles.journald
---</pre></div></div><p class="simpara">
						As a result, the <code class="literal">journald</code> service 
stores your logs persistently on a disk to the maximum size of 2048 MB, 
and keeps log data separate for each user. The synchronization happens 
every minute.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--gux40vy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span> -i <span class="emphasis"><em>inventory_file</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ozgaal6"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div></section><section class="section" id="additional_resources_3"><div class="titlepage"><div><div><h2 class="title">13.3. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">journald.conf(5)</code> man page
					</li><li class="listitem">
						The <code class="literal">ansible-playbook(1)</code> man page
					</li></ul></div></section></section><section class="chapter" id="configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 14. Configuring secure communication by using the ssh and sshd RHEL System Roles</h1></div></div></div><p class="_abstract _abstract">
			As an administrator, you can use the <code class="literal">sshd</code> System Role to configure SSH servers and the <code class="literal">ssh</code>
 System Role to configure SSH clients consistently on any number of RHEL
 systems at the same time using the Ansible Core package.
		</p><section class="section" id="sshd-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">14.1. ssh Server System Role variables</h2></div></div></div><p class="_abstract _abstract">
				In an <code class="literal">sshd</code> System Role playbook, you 
can define the parameters for the SSH configuration file according to 
your preferences and limitations.
			</p><p>
				If you do not configure these variables, the System Role produces an <code class="literal">sshd_config</code> file that matches the RHEL defaults.
			</p><p>
				In all cases, Booleans correctly render as <code class="literal">yes</code> and <code class="literal">no</code> in <code class="literal">sshd</code> configuration. You can define multi-line configuration items using lists. For example:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zvn8iff"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">sshd_ListenAddress:
  - 0.0.0.0
  - '::'</pre></div></div><p>
				renders as:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--d4b8thj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">ListenAddress 0.0.0.0
ListenAddress ::</pre></div></div><div class="variablelist"><p class="title"><strong>Variables for the <code class="literal">sshd</code> System Role</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">sshd_enable</code></span></dt><dd>
							If set to <code class="literal">false</code>, the role is completely disabled. Defaults to <code class="literal">true</code>.
						</dd><dt><span class="term"><code class="literal">sshd_skip_defaults</code></span></dt><dd>
							If set to <code class="literal">true</code>, the System Role does
 not apply default values. Instead, you specify the complete set of 
configuration defaults by using either the <code class="literal">sshd</code> dictionary or <code class="literal">sshd<span class="emphasis"><em>_&lt;OptionName&gt;</em></span></code> variables. Defaults to <code class="literal">false</code>.
						</dd><dt><span class="term"><code class="literal">sshd_manage_service</code></span></dt><dd>
							If set to <code class="literal">false</code>, the service is not managed, which means it is not enabled on boot and does not start or reload. Defaults to <code class="literal">true</code> except when running inside a container or AIX, because the Ansible service module does not currently support <code class="literal">enabled</code> for AIX.
						</dd><dt><span class="term"><code class="literal">sshd_allow_reload</code></span></dt><dd>
							If set to <code class="literal">false</code>, <code class="literal">sshd</code>
 does not reload after a change of configuration. This can help with 
troubleshooting. To apply the changed configuration, reload <code class="literal">sshd</code> manually. Defaults to the same value as <code class="literal">sshd_manage_service</code> except on AIX, where <code class="literal">sshd_manage_service</code> defaults to <code class="literal">false</code> but <code class="literal">sshd_allow_reload</code> defaults to <code class="literal">true</code>.
						</dd><dt><span class="term"><code class="literal">sshd_install_service</code></span></dt><dd><p class="simpara">
							If set to <code class="literal">true</code>, the role installs service files for the <code class="literal">sshd</code> service. This overrides files provided in the operating system. Do not set to <code class="literal">true</code> unless you are configuring a second instance and you also change the <code class="literal">sshd_service</code> variable. Defaults to <code class="literal">false</code>.
						</p><p class="simpara">
							The role uses the files pointed by the following variables as templates:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qyipv88"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">sshd_service_template_service (default: templates/sshd.service.j2)
sshd_service_template_at_service (default: templates/sshd@.service.j2)
sshd_service_template_socket (default: templates/sshd.socket.j2)</pre></div></div></dd><dt><span class="term"><code class="literal">sshd_service</code></span></dt><dd>
							This variable changes the <code class="literal">sshd</code> service name, which is useful for configuring a second <code class="literal">sshd</code> service instance.
						</dd><dt><span class="term"><code class="literal">sshd</code></span></dt><dd><p class="simpara">
							A dictionary that contains configuration. For example:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--oj6os46"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">sshd:
  Compression: yes
  ListenAddress:
    - 0.0.0.0</pre></div></div><p class="simpara">
							The <code class="literal">sshd_config(5)</code> lists all options for the <code class="literal">sshd</code> dictionary.
						</p></dd><dt><span class="term"><code class="literal">sshd<span class="emphasis"><em>_&lt;OptionName&gt;</em></span></code></span></dt><dd><p class="simpara">
							You can define options by using simple variables consisting of the <code class="literal">sshd_</code> prefix and the option name instead of a dictionary. The simple variables override values in the <code class="literal">sshd</code> dictionary. For example:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--dk21frj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">sshd_Compression: no</pre></div></div><p class="simpara">
							The <code class="literal">sshd_config(5)</code> lists all options for <code class="literal">sshd</code>.
						</p></dd><dt><span class="term"><code class="literal">sshd_manage_firewall</code></span></dt><dd><p class="simpara">
							Set this variable to <code class="literal">true</code> if you are using a different port than the default port <code class="literal">22</code>. When set to <code class="literal">true</code>, the <code class="literal">sshd</code> role uses the <code class="literal">firewall</code> role to automatically manage port access.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">sshd_manage_firewall</code> variable can only add ports. It cannot remove ports. To remove ports, use the <code class="literal">firewall</code> System Role directly. For more information about managing ports by using the <code class="literal">firewall</code> System Role, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles#configuring-ports-using-system-roles_assembly_configuring-firewalld-using-system-roles">Configuring ports by using System Roles</a>.
							</p></div></div></dd><dt><span class="term"><code class="literal">sshd_manage_selinux</code></span></dt><dd><p class="simpara">
							Set this variable to <code class="literal">true</code> if you are using a different port than the default port <code class="literal">22</code>. When set to <code class="literal">true</code>, the <code class="literal">sshd</code> role uses the <code class="literal">selinux</code> role to automatically manage port access.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The <code class="literal">sshd_manage_selinux</code> variable can only add ports. It cannot remove ports. To remove ports, use the <code class="literal">selinux</code> System Role directly.
							</p></div></div></dd><dt><span class="term"><code class="literal">sshd_match</code> and <code class="literal">sshd_match_1</code> to <code class="literal">sshd_match_9</code></span></dt><dd>
							A list of dictionaries or just a dictionary for a Match section. 
Note that these variables do not override match blocks as defined in the
 <code class="literal">sshd</code> dictionary. All of the sources will be reflected in the resulting configuration file.
						</dd><dt><span class="term"><code class="literal">sshd_backup</code></span></dt><dd>
							When set to <code class="literal">false</code>, the original <code class="literal">sshd_config</code> file is not backed up. Default is <code class="literal">true</code>.
						</dd></dl></div><div class="formalpara"><p class="title"><strong>Secondary variables for the <code class="literal">sshd</code> System Role</strong></p><p>
					You can use these variables to override the defaults that correspond to each supported platform.
				</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">sshd_packages</code></span></dt><dd>
							You can override the default list of installed packages using this variable.
						</dd><dt><span class="term"><code class="literal">sshd_config_owner</code>, <code class="literal">sshd_config_group</code>, and <code class="literal">sshd_config_mode</code></span></dt><dd>
							You can set the ownership and permissions for the <code class="literal">openssh</code> configuration file that this role produces using these variables.
						</dd><dt><span class="term"><code class="literal">sshd_config_file</code></span></dt><dd>
							The path where this role saves the <code class="literal">openssh</code> server configuration produced.
						</dd><dt><span class="term"><code class="literal">sshd_config_namespace</code></span></dt><dd><p class="simpara">
							The default value of this variable is null, which means that the 
role defines the entire content of the configuration file including 
system defaults. Alternatively, you can use this variable to invoke this
 role from other roles or from multiple places in a single playbook on 
systems that do not support drop-in directory. The <code class="literal">sshd_skip_defaults</code> variable is ignored and no system defaults are used in this case.
						</p><p class="simpara">
							When this variable is set, the role places the configuration that
 you specify to configuration snippets in an existing configuration file
 under the given namespace. If your scenario requires applying the role 
several times, you need to select a different namespace for each 
application.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Limitations of the <code class="literal">openssh</code> 
configuration file still apply. For example, only the first option 
specified in a configuration file is effective for most of the 
configuration options.
							</p></div></div><p class="simpara">
							Technically, the role places snippets in "Match all" blocks, 
unless they contain other match blocks, to ensure they are applied 
regardless of the previous match blocks in the existing configuration 
file. This allows configuring any non-conflicting options from different
 roles invocations.
						</p></dd><dt><span class="term"><code class="literal">sshd_binary</code></span></dt><dd>
							The path to the <code class="literal">sshd</code> executable of <code class="literal">openssh</code>.
						</dd><dt><span class="term"><code class="literal">sshd_service</code></span></dt><dd>
							The name of the <code class="literal">sshd</code> service. By default, this variable contains the name of the <code class="literal">sshd</code> service that the target platform uses. You can also use it to set the name of the custom <code class="literal">sshd</code> service when the role uses the <code class="literal">sshd_install_service</code> variable.
						</dd><dt><span class="term"><code class="literal">sshd_verify_hostkeys</code></span></dt><dd>
							Defaults to <code class="literal">auto</code>. When set to <code class="literal">auto</code>,
 this lists all host keys that are present in the produced configuration
 file, and generates any paths that are not present. Additionally, 
permissions and file owners are set to default values. This is useful if
 the role is used in the deployment stage to verify the service is able 
to start on the first attempt. To disable this check, set this variable 
to an empty list <code class="literal">[]</code>.
						</dd><dt><span class="term"><code class="literal">sshd_hostkey_owner</code>, <code class="literal">sshd_hostkey_group</code>, <code class="literal">sshd_hostkey_mode</code></span></dt><dd>
							Use these variables to set the ownership and permissions for the host keys from <code class="literal">sshd_verify_hostkeys</code>.
						</dd><dt><span class="term"><code class="literal">sshd_sysconfig</code></span></dt><dd>
							On systems based on RHEL 8 and earlier versions, this variable configures additional details of the <code class="literal">sshd</code> service. If set to <code class="literal">true</code>, this role manages also the <code class="literal">/etc/sysconfig/sshd</code> configuration file based on the <code class="literal">sshd_sysconfig_override_crypto_policy</code> and <code class="literal">sshd_sysconfig_use_strong_rng</code> variables. Defaults to <code class="literal">false</code>.
						</dd><dt><span class="term"><code class="literal">sshd_sysconfig_override_crypto_policy</code></span></dt><dd><p class="simpara">
							In RHEL 8, setting it to <code class="literal">true</code> allows overriding the system-wide cryptographic policy by using the following configuration options in the <code class="literal">sshd</code> dictionary or in the <code class="literal">sshd<span class="emphasis"><em>_&lt;OptionName&gt;</em></span></code> format:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">Ciphers</code>
								</li><li class="listitem">
									<code class="literal">MACs</code>
								</li><li class="listitem">
									<code class="literal">GSSAPIKexAlgorithms</code>
								</li><li class="listitem">
									<code class="literal">GSSAPIKeyExchange</code> (FIPS-only)
								</li><li class="listitem">
									<code class="literal">KexAlgorithms</code>
								</li><li class="listitem">
									<code class="literal">HostKeyAlgorithms</code>
								</li><li class="listitem">
									<code class="literal">PubkeyAcceptedKeyTypes</code>
								</li><li class="listitem"><p class="simpara">
									<code class="literal">CASignatureAlgorithms</code>
								</p><p class="simpara">
									Defaults to <code class="literal">false</code>.
								</p><p class="simpara">
									In RHEL 9, this variable has no effect. Instead, you can 
override system-wide cryptographic policies by using the following 
configuration options in the <code class="literal">sshd</code> dictionary or in the <code class="literal">sshd<span class="emphasis"><em>_&lt;OptionName&gt;</em></span></code> format:
								</p></li><li class="listitem">
									<code class="literal">Ciphers</code>
								</li><li class="listitem">
									<code class="literal">MACs</code>
								</li><li class="listitem">
									<code class="literal">GSSAPIKexAlgorithms</code>
								</li><li class="listitem">
									<code class="literal">GSSAPIKeyExchange</code> (FIPS-only)
								</li><li class="listitem">
									<code class="literal">KexAlgorithms</code>
								</li><li class="listitem">
									<code class="literal">HostKeyAlgorithms</code>
								</li><li class="listitem">
									<code class="literal">PubkeyAcceptedAlgorithms</code>
								</li><li class="listitem">
									<code class="literal">HostbasedAcceptedAlgorithms</code>
								</li><li class="listitem">
									<code class="literal">CASignatureAlgorithms</code>
								</li><li class="listitem"><p class="simpara">
									<code class="literal">RequiredRSASize</code>
								</p><p class="simpara">
									If you enter these options into custom configuration files in the drop-in directory defined in the <code class="literal">sshd_config_file</code> variable, use a file name that lexicographically precedes the <code class="literal">/etc/ssh/sshd_config.d/50-redhat.conf</code> file that includes the cryptographic policies.
								</p></li></ul></div></dd><dt><span class="term"><code class="literal">sshd_sysconfig_use_strong_rng</code></span></dt><dd>
							On systems based on RHEL 8 and earlier versions, this variable can force <code class="literal">sshd</code> to reseed the <code class="literal">openssl</code> random number generator with the number of bytes given as the argument. The default is <code class="literal">0</code>, which disables this functionality. Do not turn this on if the system does not have a hardware random number generator.
						</dd></dl></div></section><section class="section" id="configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">14.2. Configuring OpenSSH servers using the sshd System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">sshd</code> System Role to configure multiple SSH servers by running an Ansible playbook.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can use the <code class="literal">sshd</code> System Role with 
other System Roles that change SSH and SSHD configuration, for example 
the Identity Management RHEL&nbsp;System&nbsp;Roles. To prevent the 
configuration from being overwritten, make sure that the <code class="literal">sshd</code> role uses namespaces (RHEL&nbsp;8 and earlier versions) or a drop-in directory (RHEL&nbsp;9).
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">sshd</code> System Role.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li></ul></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0-8.5 provided access to a separate Ansible repository that 
contains Ansible Engine 2.9 for automation based on Ansible. Ansible 
Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>, connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>, and many plugins and modules. For information about how to obtain and install Ansible Engine, see the <a class="link" href="https://access.redhat.com/articles/3174981">How to download and install Red Hat Ansible Engine</a> Knowledgebase article.
				</p><p>
					RHEL 8.6 and 9.0 have introduced Ansible Core (provided as the <code class="literal">ansible-core</code>
 package), which contains the Ansible command-line utilities, commands, 
and a small set of built-in Ansible plugins. RHEL provides this package 
through the AppStream repository, and it has a limited scope of support.
 For more information, see the <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a> Knowledgebase article.
				</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An inventory file which lists the managed nodes.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Copy the example playbook for the <code class="literal">sshd</code> System Role:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ij6rqgb"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cp /usr/share/doc/rhel-system-roles/sshd/example-root-login-playbook.yml <span class="emphasis"><em>path/custom-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Open the copied playbook by using a text editor, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nyj8ax2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>vim <span class="emphasis"><em>path/custom-playbook.yml</em></span></strong></span>

---
- hosts: all
  tasks:
  - name: Configure sshd to prevent root and password login except from particular subnet
    include_role:
      name: rhel-system-roles.sshd
    vars:
      sshd:
        # root login and password login is enabled only from a particular subnet
        PermitRootLogin: no
        PasswordAuthentication: no
        Match:
        - Condition: "Address 192.0.2.0/24"
          PermitRootLogin: yes
          PasswordAuthentication: yes</pre></div></div><p class="simpara">
						The playbook configures the managed node as an SSH server configured so that:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								password and <code class="literal">root</code> user login is disabled
							</li><li class="listitem">
								password and <code class="literal">root</code> user login is enabled only from the subnet <code class="literal">192.0.2.0/24</code>
							</li></ul></div><p class="simpara">
						You can modify the variables according to your preferences. For more details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/securing_networks/index#sshd-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles">sshd System Role variables</a>.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xu5mx0e"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>path/custom-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3vlabc7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>path/custom-playbook.yml</em></span></strong></span>

...

PLAY RECAP
**************************************************

localhost : ok=12 changed=2 unreachable=0 failed=0
skipped=10 rescued=0 ignored=0</pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the SSH server:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qw8kddm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>user1</em></span>@<span class="emphasis"><em>10.1.1.1</em></span></strong></span></pre></div></div><p class="simpara">
						Where:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal"><span class="emphasis"><em>user1</em></span></code> is a user on the SSH server.
							</li><li class="listitem">
								<code class="literal"><span class="emphasis"><em>10.1.1.1</em></span></code> is the IP address of the SSH server.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Check the contents of the <code class="literal">sshd_config</code> file on the SSH server:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3ou5w7x"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>cat /etc/ssh/sshd_config.d/00-ansible_system_role.conf</strong></span>
#
# Ansible managed
#
PasswordAuthentication no
PermitRootLogin no
Match Address 192.0.2.0/24
  PasswordAuthentication yes
  PermitRootLogin yes</pre></div></div></li><li class="listitem"><p class="simpara">
						Check that you can connect to the server as root from the <code class="literal">192.0.2.0/24</code> subnet:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Determine your IP address:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--lpl7kry"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>hostname -I</strong></span>
192.0.2.1</pre></div></div><p class="simpara">
								If the IP address is within the <code class="literal">192.0.2.1</code> - <code class="literal">192.0.2.254</code> range, you can connect to the server.
							</p></li><li class="listitem"><p class="simpara">
								Connect to the server as <code class="literal">root</code>:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--olra450"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>root@10.1.1.1</em></span></strong></span></pre></div></div></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/sshd/README.md</code> file.
					</li><li class="listitem">
						<code class="literal">ansible-playbook(1)</code> man page.
					</li></ul></div></section><section class="section" id="ref_ssh-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">14.3. ssh System Role variables</h2></div></div></div><p class="_abstract _abstract">
				In an <code class="literal">ssh</code> System Role playbook, you can
 define the parameters for the client SSH configuration file according 
to your preferences and limitations.
			</p><p>
				If you do not configure these variables, the System Role produces a global <code class="literal">ssh_config</code> file that matches the RHEL defaults.
			</p><p>
				In all cases, booleans correctly render as <code class="literal">yes</code> or <code class="literal">no</code> in <code class="literal">ssh</code> configuration. You can define multi-line configuration items using lists. For example:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--oc7eaww"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">LocalForward:
  - 22 localhost:2222
  - 403 localhost:4003</pre></div></div><p>
				renders as:
			</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6am6tsy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">LocalForward 22 localhost:2222
LocalForward 403 localhost:4003</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The configuration options are case sensitive.
				</p></div></div><div class="variablelist"><p class="title"><strong>Variables for the <code class="literal">ssh</code> System Role</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">ssh_user</code></span></dt><dd>
							You can define an existing user name for which the System Role 
modifies user-specific configuration. The user-specific configuration is
 saved in <code class="literal">~/.ssh/config</code> of the given user. The default value is null, which modifies global configuration for all users.
						</dd><dt><span class="term"><code class="literal">ssh_skip_defaults</code></span></dt><dd>
							Defaults to <code class="literal">auto</code>. If set to <code class="literal">auto</code>, the System Role writes the system-wide configuration file <code class="literal">/etc/ssh/ssh_config</code> and keeps the RHEL defaults defined there. Creating a drop-in configuration file, for example by defining the <code class="literal">ssh_drop_in_name</code> variable, automatically disables the <code class="literal">ssh_skip_defaults</code> variable.
						</dd><dt><span class="term"><code class="literal">ssh_drop_in_name</code></span></dt><dd><p class="simpara">
							Defines the name for the drop-in configuration file, which is 
placed in the system-wide drop-in directory. The name is used in the 
template <code class="literal">/etc/ssh/ssh_config.d/{ssh_drop_in_name}.conf</code>
 to reference the configuration file to be modified. If the system does 
not support drop-in directory, the default value is null. If the system 
supports drop-in directories, the default value is <code class="literal">00-ansible</code>.
						</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
								If the system does not support drop-in directories, setting this option will make the play fail.
							</p></div></div><p class="simpara">
							The suggested format is <code class="literal">NN-name</code>, where <code class="literal">NN</code> is a two-digit number used for ordering the configuration files and <code class="literal">name</code> is any descriptive name for the content or the owner of the file.
						</p></dd><dt><span class="term"><code class="literal">ssh</code></span></dt><dd>
							A dict that contains configuration options and their respective values.
						</dd><dt><span class="term"><code class="literal">ssh<span class="emphasis"><em>_OptionName</em></span></code></span></dt><dd>
							You can define options by using simple variables consisting of the <code class="literal">ssh_</code> prefix and the option name instead of a dict. The simple variables override values in the <code class="literal">ssh</code> dict.
						</dd><dt><span class="term"><code class="literal">ssh_additional_packages</code></span></dt><dd>
							This role automatically installs the <code class="literal">openssh</code> and <code class="literal">openssh-clients</code> packages, which are needed for the most common use cases. If you need to install additional packages, for example, <code class="literal">openssh-keysign</code> for host-based authentication, you can specify them in this variable.
						</dd><dt><span class="term"><code class="literal">ssh_config_file</code></span></dt><dd><p class="simpara">
							The path to which the role saves the configuration file produced. Default value:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									If the system has a drop-in directory, the default value is defined by the template <code class="literal">/etc/ssh/ssh_config.d/{ssh_drop_in_name}.conf</code>.
								</li><li class="listitem">
									If the system does not have a drop-in directory, the default value is <code class="literal">/etc/ssh/ssh_config</code>.
								</li><li class="listitem">
									if the <code class="literal">ssh_user</code> variable is defined, the default value is <code class="literal">~/.ssh/config</code>.
								</li></ul></div></dd><dt><span class="term"><code class="literal">ssh_config_owner</code>, <code class="literal">ssh_config_group</code>, <code class="literal">ssh_config_mode</code></span></dt><dd>
							The owner, group and modes of the created configuration file. By default, the owner of the file is <code class="literal">root:root</code>, and the mode is <code class="literal">0644</code>. If <code class="literal">ssh_user</code> is defined, the mode is <code class="literal">0600</code>, and the owner and group are derived from the user name specified in the <code class="literal">ssh_user</code> variable.
						</dd></dl></div></section><section class="section" id="proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">14.4. Configuring OpenSSH clients using the ssh System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">ssh</code> System Role to configure multiple SSH clients by running an Ansible playbook.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can use the <code class="literal">ssh</code> System Role with 
other System Roles that change SSH and SSHD configuration, for example 
the Identity Management RHEL&nbsp;System&nbsp;Roles. To prevent the 
configuration from being overwritten, make sure that the <code class="literal">ssh</code> role uses a drop-in directory (default from RHEL 8).
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">ssh</code> System Role.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li></ul></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0-8.5 provided access to a separate Ansible repository that 
contains Ansible Engine 2.9 for automation based on Ansible. Ansible 
Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>, connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>, and many plugins and modules. For information about how to obtain and install Ansible Engine, see the <a class="link" href="https://access.redhat.com/articles/3174981">How to download and install Red Hat Ansible Engine</a> Knowledgebase article.
				</p><p>
					RHEL 8.6 and 9.0 have introduced Ansible Core (provided as the <code class="literal">ansible-core</code>
 package), which contains the Ansible command-line utilities, commands, 
and a small set of built-in Ansible plugins. RHEL provides this package 
through the AppStream repository, and it has a limited scope of support.
 For more information, see the <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a> Knowledgebase article.
				</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An inventory file which lists the managed nodes.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--pgu0p2h"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- hosts: all
  tasks:
  - name: "Configure ssh clients"
    include_role:
      name: rhel-system-roles.ssh
    vars:
      ssh_user: root
      ssh:
        Compression: true
        GSSAPIAuthentication: no
        ControlMaster: auto
        ControlPath: ~/.ssh/.cm%C
        Host:
          - Condition: <span class="emphasis"><em>example</em></span>
            Hostname: <span class="emphasis"><em>example.com</em></span>
            User: <span class="emphasis"><em>user1</em></span>
      ssh_ForwardX11: no</pre></div></div><p class="simpara">
						This playbook configures the <code class="literal">root</code> user’s SSH client preferences on the managed nodes with the following configurations:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Compression is enabled.
							</li><li class="listitem">
								ControlMaster multiplexing is set to <code class="literal">auto</code>.
							</li><li class="listitem">
								The <code class="literal"><span class="emphasis"><em>example</em></span></code> alias for connecting to the <code class="literal"><span class="emphasis"><em>example.com</em></span></code> host is <code class="literal"><span class="emphasis"><em>user1</em></span></code>.
							</li><li class="listitem">
								The <code class="literal"><span class="emphasis"><em>example</em></span></code> host alias is created, which represents a connection to the <code class="literal"><span class="emphasis"><em>example.com</em></span></code> host the with <code class="literal"><span class="emphasis"><em>user1</em></span></code> user name.
							</li><li class="listitem">
								X11 forwarding is disabled.
							</li></ul></div><p class="simpara">
						Optionally, you can modify these variables according to your preferences. For more details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/securing_networks/index#ref_ssh-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles">ssh System Role variables</a>.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--oyvcmlp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>path/custom-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--d4gtkst"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>path/custom-playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the managed node has the correct configuration by 
opening the SSH configuration file in a text editor, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--brucx1h"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>vi ~root/.ssh/config</strong></span></pre></div></div><p class="simpara">
						After application of the example playbook shown above, the configuration file should have the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9mo5ndb"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># Ansible managed
Compression yes
ControlMaster auto
ControlPath ~/.ssh/.cm%C
ForwardX11 no
GSSAPIAuthentication no
Host example
  Hostname example.com
  User user1</pre></div></div></li></ul></div></section><section class="section" id="proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">14.5. Using the sshd System Role for non-exclusive configuration</h2></div></div></div><p class="_abstract _abstract">
				Normally, applying the <code class="literal">sshd</code> System Role
 overwrites the entire configuration. This may be problematic if you 
have previously adjusted the configuration, for example with a different
 System Role or playbook. To apply the <code class="literal">sshd</code>
 System Role for only selected configuration options while keeping other
 options in place, you can use the non-exclusive configuration.
			</p><p>
				In RHEL 8 and earlier, you can apply the non-exclusive configuration
 with a configuration snippet. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/automating_system_administration_by_using_rhel_system_roles/configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles">Using the SSH Server System Role for non-exclusive configuration</a> in RHEL 8 documentation.
			</p><p>
				In RHEL 9, you can apply the non-exclusive configuration by using 
files in a drop-in directory. The default configuration file is already 
placed in the drop-in directory as <code class="literal">/etc/ssh/sshd_config.d/00-ansible_system_role.conf</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">sshd</code> System Role.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> package is installed.
							</li><li class="listitem">
								An inventory file which lists the managed nodes.
							</li><li class="listitem">
								A playbook for a different RHEL&nbsp;System&nbsp;Role.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add a configuration snippet with the <code class="literal">sshd_config_file</code> variable to the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5ty6d5w"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- hosts: all
  tasks:
  - name: <span class="emphasis"><em>&lt;Configure sshd to accept some useful environment variables&gt;</em></span>
    include_role:
      name: rhel-system-roles.sshd
    vars:
      sshd_config_file: /etc/ssh/sshd_config.d/<span class="emphasis"><em>&lt;42-my-application&gt;</em></span>.conf
      sshd:
        # Environment variables to accept
        AcceptEnv:
          LANG
          LS_COLORS
          EDITOR</pre></div></div><p class="simpara">
						In the <code class="literal">sshd_config_file</code> variable, define the <code class="literal">.conf</code> file into which the <code class="literal">sshd</code> System Role writes the configuration options.
					</p><p class="simpara">
						Use a two-digit prefix, for example <code class="literal"><span class="emphasis"><em>42-</em></span></code> to specify the order in which the configuration files will be applied.
					</p><p class="simpara">
						When you apply the playbook to the inventory, the role adds the 
following configuration options to the file defined by the <code class="literal">sshd_config_file</code> variable.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--el1o93u"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed"># Ansible managed
#
AcceptEnv LANG LS_COLORS EDITOR</pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--37kn7td"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span> -i <span class="emphasis"><em>inventory_file</em></span></strong></span></pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/sshd/README.md</code> file.
					</li><li class="listitem">
						<code class="literal">ansible-playbook(1)</code> man page.
					</li></ul></div></section></section><section class="chapter" id="assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 15. Configuring VPN connections with IPsec by using the vpn RHEL System Role</h1></div></div></div><p class="_abstract _abstract">
			With the <code class="literal">vpn</code> System Role, you can 
configure VPN connections on RHEL systems by using Red Hat Ansible 
Automation Platform. You can use it to set up host-to-host, 
network-to-network, VPN Remote Access Server, and mesh configurations.
		</p><p>
			For host-to-host connections, the role sets up a VPN tunnel between each pair of hosts in the list of <code class="literal">vpn_connections</code>
 using the default parameters, including generating keys as needed. 
Alternatively, you can configure it to create an opportunistic mesh 
configuration between all hosts listed. The role assumes that the names 
of the hosts under <code class="literal">hosts</code> are the same as 
the names of the hosts used in the Ansible inventory, and that you can 
use those names to configure the tunnels.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				The <code class="literal">vpn</code> RHEL&nbsp;System&nbsp;Role currently supports only Libreswan, which is an IPsec implementation, as the VPN provider.
			</p></div></div><section class="section" id="proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role"><div class="titlepage"><div><div><h2 class="title">15.1. Creating a host-to-host VPN with IPsec using the vpn System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">vpn</code> System Role to 
configure host-to-host connections by running an Ansible playbook on the
 control node, which will configure all the managed nodes listed in an 
inventory file.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">vpn</code> System Role.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li></ul></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0-8.5 provided access to a separate Ansible repository that 
contains Ansible Engine 2.9 for automation based on Ansible. Ansible 
Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>, connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>, and many plugins and modules. For information about how to obtain and install Ansible Engine, see the <a class="link" href="https://access.redhat.com/articles/3174981">How to download and install Red Hat Ansible Engine</a> Knowledgebase article.
				</p><p>
					RHEL 8.6 and 9.0 have introduced Ansible Core (provided as the <code class="literal">ansible-core</code>
 package), which contains the Ansible command-line utilities, commands, 
and a small set of built-in Ansible plugins. RHEL provides this package 
through the AppStream repository, and it has a limited scope of support.
 For more information, see the <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a> Knowledgebase article.
				</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An inventory file which lists the managed nodes.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0n4z3my"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">- name: <span class="emphasis"><em>Host to host VPN</em></span>
  hosts: <span class="emphasis"><em>managed_node1</em></span>, <span class="emphasis"><em>managed_node2</em></span>
  roles:
    - rhel-system-roles.vpn
  vars:
    vpn_connections:
      - hosts:
          <span class="emphasis"><em>managed_node1</em></span>:
          <span class="emphasis"><em>managed_node2</em></span>:
    vpn_manage_firewall: true
    vpn_manage_selinux: true</pre></div></div><p class="simpara">
						This playbook configures the connection <code class="literal"><span class="emphasis"><em>managed_node1</em></span>-to-<span class="emphasis"><em>managed_node2</em></span></code> using pre-shared key authentication with keys auto-generated by the system role. Because <code class="literal">vpn_manage_firewall</code> and <code class="literal">vpn_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">vpn</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">vpn</code> role.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Configure connections from managed hosts to external 
hosts that are not listed in the inventory file by adding the following 
section to the <code class="literal">vpn_connections</code> list of hosts:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ppnqhnz"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">    vpn_connections:
      - hosts:
          <span class="emphasis"><em>managed_node1</em></span>:
          <span class="emphasis"><em>managed_node2</em></span>:
          <span class="strong strong"><strong><span class="emphasis"><em>external_node</em></span>:</strong></span>
            <span class="strong strong"><strong>hostname: <span class="emphasis"><em>192.0.2.2</em></span></strong></span></pre></div></div><p class="simpara">
						This configures two additional connections: <code class="literal"><span class="emphasis"><em>managed_node1</em></span>-to-<span class="emphasis"><em>external_node</em></span></code> and <code class="literal"><span class="emphasis"><em>managed_node2</em></span>-to-<span class="emphasis"><em>external_node</em></span></code>.
					</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The connections are configured only on the managed nodes and not on the external node.
				</p></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: You can specify multiple VPN connections for the managed nodes by using additional sections within <code class="literal">vpn_connections</code>, for example a control plane and a data plane:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--la75x21"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">- name: Multiple VPN
  hosts: <span class="emphasis"><em>managed_node1</em></span>, <span class="emphasis"><em>managed_node2</em></span>
  roles:
    - rhel-system-roles.vpn
  vars:
    vpn_connections:
      - name: <span class="emphasis"><em>control_plane_vpn</em></span>
        hosts:
          <span class="emphasis"><em>managed_node1</em></span>:
            hostname: 192.0.2.0 # IP for the control plane
          <span class="emphasis"><em>managed_node2</em></span>:
            hostname: 192.0.2.1
      - name: <span class="emphasis"><em>data_plane_vpn</em></span>
        hosts:
          <span class="emphasis"><em>managed_node1</em></span>:
            hostname: 10.0.0.1 # IP for the data plane
          <span class="emphasis"><em>managed_node2</em></span>:
            hostname: 10.0.0.2</pre></div></div></li><li class="listitem">
						Optional: You can modify the variables according to your preferences. For more details, see the <code class="literal">/usr/share/doc/rhel-system-roles/vpn/README.md</code> file.
					</li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2l8kkpd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>/path/to/file/playbook.yml</em></span> -i <span class="emphasis"><em>/path/to/file/inventory_file</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--tirr696"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>/path/to/file/inventory_file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the managed nodes, confirm that the connection is successfully loaded:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--a7he9oa"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ipsec status | grep <span class="emphasis"><em>connection.name</em></span></strong></span></pre></div></div><p class="simpara">
						Replace <span class="emphasis"><em>connection.name</em></span> with the name of the connection from this node, for example <code class="literal">managed_node1-to-managed_node2</code>.
					</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					By default, the role generates a descriptive name for each 
connection it creates from the perspective of each system. For example, 
when creating a connection between <code class="literal">managed_node1</code> and <code class="literal">managed_node2</code>, the descriptive name of this connection on <code class="literal">managed_node1</code> is <code class="literal">managed_node1-to-managed_node2</code> but on <code class="literal">managed_node2</code> the connection is named <code class="literal">managed_node2-to-managed_node1</code>.
				</p></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the managed nodes, confirm that the connection is successfully started:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--w5ozrbs"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ipsec trafficstatus | grep <span class="emphasis"><em>connection.name</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Optional: If a connection did not successfully load, manually add 
the connection by entering the following command. This will provide more
 specific information indicating why the connection failed to establish:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--je2g010"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ipsec auto --add <span class="emphasis"><em>connection.name</em></span></strong></span></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Any errors that may have occurred during the process of loading 
and starting the connection are reported in the logs, which can be found
 in <code class="literal">/var/log/pluto.log</code>. Because these logs 
are hard to parse, try to manually add the connection to obtain log 
messages from the standard output instead.
						</p></div></div></li></ol></div></section><section class="section" id="proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role"><div class="titlepage"><div><div><h2 class="title">15.2. Creating an opportunistic mesh VPN connection with IPsec by using the vpn System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">vpn</code> System Role to 
configure an opportunistic mesh VPN connection that uses certificates 
for authentication by running an Ansible playbook on the control node, 
which will configure all the managed nodes listed in an inventory file.
			</p><p>
				Authentication with certificates is configured by defining the <code class="literal">auth_method: cert</code> parameter in the playbook. The <code class="literal">vpn</code> System Role assumes that the IPsec Network Security Services (NSS) crypto library, which is defined in the <code class="literal">/etc/ipsec.d</code>
 directory, contains the necessary certificates. By default, the node 
name is used as the certificate nickname. In this example, this is <code class="literal">managed_node1</code>. You can define different certificate names by using the <code class="literal">cert_name</code> attribute in your inventory.
			</p><p>
				In the following example procedure, the control node, which is the 
system from which you will run the Ansible playbook, shares the same 
classless inter-domain routing (CIDR) number as both of the managed 
nodes (192.0.2.0/24) and has the IP address 192.0.2.7. Therefore, the 
control node falls under the private policy which is automatically 
created for CIDR 192.0.2.0/24.
			</p><p>
				To prevent SSH connection loss during the play, a clear policy for 
the control node is included in the list of policies. Note that there is
 also an item in the policies list where the CIDR is equal to default. 
This is because this playbook overrides the rule from the default policy
 to make it private instead of private-or-clear.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">vpn</code> System Role.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								On all the managed nodes, the NSS database in the <code class="literal">/etc/ipsec.d</code>
 directory contains all the certificates necessary for peer 
authentication. By default, the node name is used as the certificate 
nickname.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li></ul></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0-8.5 provided access to a separate Ansible repository that 
contains Ansible Engine 2.9 for automation based on Ansible. Ansible 
Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>, connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>, and many plugins and modules. For information about how to obtain and install Ansible Engine, see the <a class="link" href="https://access.redhat.com/articles/3174981">How to download and install Red Hat Ansible Engine</a> Knowledgebase article.
				</p><p>
					RHEL 8.6 and 9.0 have introduced Ansible Core (provided as the <code class="literal">ansible-core</code>
 package), which contains the Ansible command-line utilities, commands, 
and a small set of built-in Ansible plugins. RHEL provides this package 
through the AppStream repository, and it has a limited scope of support.
 For more information, see the <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a> Knowledgebase article.
				</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An inventory file which lists the managed nodes.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mbp8lko"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">- name: <span class="emphasis"><em>Mesh VPN</em></span>
  hosts: managed_node1, managed_node2, managed_node3
  roles:
    - rhel-system-roles.vpn
  vars:
    vpn_connections:
      - opportunistic: true
        auth_method: cert
        policies:
          - policy: private
            cidr: default
          - policy: private-or-clear
            cidr: 198.51.100.0/24
          - policy: private
            cidr: 192.0.2.0/24
          - policy: clear
            cidr: 192.0.2.7/32
    vpn_manage_firewall: true
    vpn_manage_selinux: true</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Because <code class="literal">vpn_manage_firewall</code> and <code class="literal">vpn_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">vpn</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">vpn</code> role.
						</p></div></div></li><li class="listitem">
						Optional: You can modify the variables according to your preferences. For more details, see the <code class="literal">/usr/share/doc/rhel-system-roles/vpn/README.md</code> file.
					</li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qer0qyi"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yrllj34"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div></section><section class="section _additional-resources" id="additional_resources_4"><div class="titlepage"><div><div><h2 class="title">15.3. ADDITIONAL RESOURCES</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						For details about the parameters used in the <code class="literal">vpn</code> System Role and additional information about the role, see the <code class="literal">/usr/share/doc/rhel-system-roles/vpn/README.md</code> file.
					</li><li class="listitem">
						For details about the <code class="literal">ansible-playbook</code> command, see the <code class="literal">ansible-playbook(1)</code> man page.
					</li></ul></div></section></section><section class="chapter" id="setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 16. Setting a custom cryptographic policy by using the crypto-policies RHEL System Role</h1></div></div></div><p class="_abstract _abstract">
			As an administrator, you can use the <code class="literal">crypto_policies</code>
 RHEL&nbsp;System&nbsp;Role to quickly and consistently configure custom
 cryptographic policies across many different systems using the Ansible 
Core package.
		</p><section class="section" id="crypto-policies-system-role-variables_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">16.1. crypto_policies System Role variables and facts</h2></div></div></div><p class="_abstract _abstract">
				In a <code class="literal">crypto_policies</code> System Role playbook, you can define the parameters for the <code class="literal">crypto_policies</code> configuration file according to your preferences and limitations.
			</p><p>
				If you do not configure any variables, the System Role does not configure the system and only reports the facts.
			</p><div class="variablelist"><p class="title"><strong>Selected variables for the <code class="literal">crypto_policies</code> System Role</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">crypto_policies_policy</code></span></dt><dd>
							Determines the cryptographic policy the System Role applies to 
the managed nodes. For details about the different crypto policies, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">System-wide cryptographic policies</a> .
						</dd><dt><span class="term"><code class="literal">crypto_policies_reload</code></span></dt><dd>
							If set to <code class="literal">yes</code>, the affected services, currently the <code class="literal">ipsec</code>, <code class="literal">bind</code>, and <code class="literal">sshd</code> services, reload after applying a crypto policy. Defaults to <code class="literal">yes</code>.
						</dd><dt><span class="term"><code class="literal">crypto_policies_reboot_ok</code></span></dt><dd>
							If set to <code class="literal">yes</code>, and a reboot is necessary after the System Role changes the crypto policy, it sets <code class="literal">crypto_policies_reboot_required</code> to <code class="literal">yes</code>. Defaults to <code class="literal">no</code>.
						</dd></dl></div><div class="variablelist"><p class="title"><strong>Facts set by the <code class="literal">crypto_policies</code> System Role</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">crypto_policies_active</code></span></dt><dd>
							Lists the currently selected policy.
						</dd><dt><span class="term"><code class="literal">crypto_policies_available_policies</code></span></dt><dd>
							Lists all available policies available on the system.
						</dd><dt><span class="term"><code class="literal">crypto_policies_available_subpolicies</code></span></dt><dd>
							Lists all available subpolicies available on the system.
						</dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening#creating-and-setting-a-custom-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies">Creating and setting a custom system-wide cryptographic policy</a>.
					</li></ul></div></section><section class="section" id="proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">16.2. Setting a custom cryptographic policy using the crypto_policies System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">crypto_policies</code> System Role to configure a large number of managed nodes consistently from a single control node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">crypto_policies</code> System Role.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a control node, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li></ul></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0-8.5 provided access to a separate Ansible repository that 
contains Ansible Engine 2.9 for automation based on Ansible. Ansible 
Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>, connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>, and many plugins and modules. For information about how to obtain and install Ansible Engine, see the <a class="link" href="https://access.redhat.com/articles/3174981">How to download and install Red Hat Ansible Engine</a> Knowledgebase article.
				</p><p>
					RHEL 8.6 and 9.0 have introduced Ansible Core (provided as the <code class="literal">ansible-core</code>
 package), which contains the Ansible command-line utilities, commands, 
and a small set of built-in Ansible plugins. RHEL provides this package 
through the AppStream repository, and it has a limited scope of support.
 For more information, see the <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a> Knowledgebase article.
				</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An inventory file which lists the managed nodes.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mnh63g7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- hosts: all
  tasks:
  - name: Configure crypto policies
    include_role:
      name: rhel-system-roles.crypto_policies
    vars:
      - crypto_policies_policy: <span class="emphasis"><em>FUTURE</em></span>
      - crypto_policies_reboot_ok: true</pre></div></div><p class="simpara">
						You can replace the <span class="emphasis"><em>FUTURE</em></span> value with your preferred crypto policy, for example: <code class="literal">DEFAULT</code>, <code class="literal">LEGACY</code>, and <code class="literal">FIPS:OSPP</code>.
					</p><p class="simpara">
						The <code class="literal">crypto_policies_reboot_ok: true</code> variable causes the system to reboot after the System Role changes the cryptographic policy.
					</p><p class="simpara">
						For more details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_security-hardening#crypto-policies-system-role-variables_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role">crypto_policies System Role variables and facts</a> .
					</p></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qpckmq7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--57dzl1i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the control node, create another playbook named, for example, <code class="literal"><span class="emphasis"><em>verify_playbook.yml</em></span></code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7wr7erh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">- hosts: all
  tasks:
 - name: Verify active crypto policy
   include_role:
     name: rhel-system-roles.crypto_policies

 - debug:
     var: crypto_policies_active</pre></div></div><p class="simpara">
						This playbook does not change any configurations on the system, only reports the active policy on the managed nodes.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook on the same inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--f5je15v"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>verify_playbook.yml</em></span></strong></span>

TASK [debug] **************************
ok: [host] =&gt; {
    "crypto_policies_active": "<span class="emphasis"><em>FUTURE</em></span>"
}</pre></div></div><p class="simpara">
						The <code class="literal">"crypto_policies_active":</code> variable shows the policy active on the managed node.
					</p></li></ol></div></section><section class="section _additional-resources" id="additional_resources_5"><div class="titlepage"><div><div><h2 class="title">16.3. ADDITIONAL RESOURCES</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.crypto_policies/README.md</code> file.
					</li><li class="listitem">
						<code class="literal">ansible-playbook(1)</code> man page.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL System Roles</a>.
					</li></ul></div></section></section><section class="chapter" id="configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 17. Configuring NBDE by using RHEL System Roles</h1></div></div></div><section class="section" id="introduction-to-the-clevis-and-tang-system-roles_configuring-nbde-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">17.1. Introduction to the nbde_client and nbde_server System Roles (Clevis and Tang)</h2></div></div></div><p class="_abstract _abstract">
				RHEL&nbsp;System&nbsp;Roles is a collection of Ansible roles and 
modules that provide a consistent configuration interface to remotely 
manage multiple RHEL systems.
			</p><p>
				You can use Ansible roles for automated deployments of Policy-Based Decryption (PBD) solutions using Clevis and Tang. The <code class="literal">rhel-system-roles</code> package contains these system roles, the related examples, and also the reference documentation.
			</p><p>
				The <code class="literal">nbde_client</code> System Role enables you to deploy multiple Clevis clients in an automated way. Note that the <code class="literal">nbde_client</code> role supports only Tang bindings, and you cannot use it for TPM2 bindings at the moment.
			</p><p>
				The <code class="literal">nbde_client</code> role requires volumes 
that are already encrypted using LUKS. This role supports to bind a 
LUKS-encrypted volume to one or more Network-Bound (NBDE) servers - Tang
 servers. You can either preserve the existing volume encryption with a 
passphrase or remove it. After removing the passphrase, you can unlock 
the volume only using NBDE. This is useful when a volume is initially 
encrypted using a temporary key or password that you should remove after
 you provision the system.
			</p><p>
				If you provide both a passphrase and a key file, the role uses what 
you have provided first. If it does not find any of these valid, it 
attempts to retrieve a passphrase from an existing binding.
			</p><p>
				PBD defines a binding as a mapping of a device to a slot. This means
 that you can have multiple bindings for the same device. The default 
slot is slot 1.
			</p><p>
				The <code class="literal">nbde_client</code> role provides also the <code class="literal">state</code> variable. Use the <code class="literal">present</code> value for either creating a new binding or updating an existing one. Contrary to a <code class="literal">clevis luks bind</code> command, you can use <code class="literal">state: present</code> also for overwriting an existing binding in its device slot. The <code class="literal">absent</code> value removes a specified binding.
			</p><p>
				Using the <code class="literal">nbde_client</code> System Role, you 
can deploy and manage a Tang server as part of an automated disk 
encryption solution. This role supports the following features:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Rotating Tang keys
					</li><li class="listitem">
						Deploying and backing up Tang keys
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For a detailed reference on Network-Bound Disk Encryption (NBDE) role variables, install the <code class="literal">rhel-system-roles</code> package, and see the <code class="literal">README.md</code> and <code class="literal">README.html</code> files in the <code class="literal">/usr/share/doc/rhel-system-roles/nbde_client/</code> and <code class="literal">/usr/share/doc/rhel-system-roles/nbde_server/</code> directories.
					</li><li class="listitem">
						For example system-roles playbooks, install the <code class="literal">rhel-system-roles</code> package, and see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_server/examples/</code> directories.
					</li><li class="listitem">
						For more information about RHEL&nbsp;System&nbsp;Roles, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL System Roles</a>.
					</li></ul></div></section><section class="section" id="using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">17.2. Using the nbde_server System Role for setting up multiple Tang servers</h2></div></div></div><p class="_abstract _abstract">
				Follow the steps to prepare and apply an Ansible playbook containing your Tang server settings.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">nbde_server</code> System Role.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a control node, which is a system from which Red Hat Ansible Core configures other systems.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li></ul></div></li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0-8.5 provided access to a separate Ansible repository that 
contains Ansible Engine 2.9 for automation based on Ansible. Ansible 
Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>, connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>, and many plugins and modules. For information about how to obtain and install Ansible Engine, see the <a class="link" href="https://access.redhat.com/articles/3174981">How to download and install Red Hat Ansible Engine</a> Knowledgebase article.
				</p><p>
					RHEL 8.6 and 9.0 have introduced Ansible Core (provided as the <code class="literal">ansible-core</code>
 package), which contains the Ansible command-line utilities, commands, 
and a small set of built-in Ansible plugins. RHEL provides this package 
through the AppStream repository, and it has a limited scope of support.
 For more information, see the <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a> Knowledgebase article.
				</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An inventory file which lists the managed nodes.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Prepare your playbook containing settings for Tang servers. You 
can either start from the scratch, or use one of the example playbooks 
from the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_server/examples/</code> directory.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jto5z8r"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cp /usr/share/ansible/roles/rhel-system-roles.nbde_server/examples/simple_deploy.yml <span class="emphasis"><em>./my-tang-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Edit the playbook in a text editor of your choice, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--rskosh9"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>vi <span class="emphasis"><em>my-tang-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Add the required parameters. The following example playbook ensures deploying of your Tang server and a key rotation:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ajn9bwq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: all

  vars:
    nbde_server_rotate_keys: yes
    nbde_server_manage_firewall: true
    nbde_server_manage_selinux: true

  roles:
    - rhel-system-roles.nbde_server</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Because <code class="literal">nbde_server_manage_firewall</code> and <code class="literal">nbde_server_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">nbde_server</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">nbde_server</code> role.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Apply the finished playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xbv86m7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory-file</em></span> <span class="emphasis"><em>my-tang-playbook.yml</em></span></strong></span></pre></div></div><p class="simpara">
						Where: * <code class="literal"><span class="emphasis"><em>inventory-file</em></span></code> is the inventory file. * <code class="literal"><span class="emphasis"><em>logging-playbook.yml</em></span></code> is the playbook you use.
					</p></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					To ensure that networking for a Tang pin is available during early boot by using the <code class="literal">grubby</code> tool on the systems where Clevis is installed:
				</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--40n9b23"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=ALL --args="rd.neednet=1"</strong></span></pre></div></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more information, install the <code class="literal">rhel-system-roles</code> package, and see the <code class="literal">/usr/share/doc/rhel-system-roles/nbde_server/</code> and <code class="literal">usr/share/ansible/roles/rhel-system-roles.nbde_server/</code> directories.
					</li></ul></div></section><section class="section" id="using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">17.3. Using the nbde_client System Role for setting up multiple Clevis clients</h2></div></div></div><p class="_abstract _abstract">
				Follow the steps to prepare and apply an Ansible playbook containing your Clevis client settings.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal">nbde_client</code> System Role supports only Tang bindings. This means that you cannot use it for TPM2 bindings at the moment.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>, which are systems you want to configure with the <code class="literal">nbde_client</code> System Role.
					</li><li class="listitem">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>, which is a system from which Red Hat Ansible Core configures other systems.
					</li><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						The <code class="literal">rhel-system-roles</code> package is installed on the system from which you want to run the playbook.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Prepare your playbook containing settings for Clevis clients. You 
can either start from the scratch, or use one of the example playbooks 
from the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_client/examples/</code> directory.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bbfs048"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cp /usr/share/ansible/roles/rhel-system-roles.nbde_client/examples/high_availability.yml <span class="emphasis"><em>./my-clevis-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Edit the playbook in a text editor of your choice, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--paluxib"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>vi <span class="emphasis"><em>my-clevis-playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Add the required parameters. The following example playbook 
configures Clevis clients for automated unlocking of two LUKS-encrypted 
volumes by when at least one of two Tang servers is available:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--utlukil"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: all

  vars:
    nbde_client_bindings:
      - device: /dev/rhel/root
        encryption_key_src: /etc/luks/keyfile
        servers:
          - http://server1.example.com
          - http://server2.example.com
      - device: /dev/rhel/swap
        encryption_key_src: /etc/luks/keyfile
        servers:
          - http://server1.example.com
          - http://server2.example.com

  roles:
    - rhel-system-roles.nbde_client</pre></div></div></li><li class="listitem"><p class="simpara">
						Apply the finished playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ghfvsjh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>host1</em></span>,<span class="emphasis"><em>host2</em></span>,<span class="emphasis"><em>host3</em></span> <span class="emphasis"><em>my-clevis-playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					To ensure that networking for a Tang pin is available during early boot by using the <code class="literal">grubby</code> tool on the system where Clevis is installed:
				</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--klevisn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>grubby --update-kernel=ALL --args="rd.neednet=1"</strong></span></pre></div></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For details about the parameters and additional information about the NBDE Client System Role, install the <code class="literal">rhel-system-roles</code> package, and see the <code class="literal">/usr/share/doc/rhel-system-roles/nbde_client/</code> and <code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_client/</code> directories.
					</li></ul></div></section></section><section class="chapter" id="requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 18. Requesting certificates using RHEL System Roles</h1></div></div></div><p class="_abstract _abstract">
			You can use the <code class="literal">certificate</code> System Role to issue and manage certificates.
		</p><p>
			This chapter covers the following topics:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#the-certificate-system-role_requesting-certificates-using-rhel-system-roles" title="18.1.&nbsp;The certificate System Role">The <code class="literal">certificate</code> System Role</a>
				</li><li class="listitem">
					<a class="link" href="#requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" title="18.2.&nbsp;Requesting a new self-signed certificate using the certificate System Role">Requesting a new self-signed certificate using the <code class="literal">certificate</code> System Role</a>
				</li><li class="listitem">
					<a class="link" href="#requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" title="18.3.&nbsp;Requesting a new certificate from IdM CA using the certificate System Role">Requesting a new certificate from IdM CA using the <code class="literal">certificate</code> System Role</a>
				</li></ul></div><section class="section" id="the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">18.1. The certificate System Role</h2></div></div></div><p class="_abstract _abstract">
				Using the <code class="literal">certificate</code> System Role, you can manage issuing and renewing TLS and SSL certificates using Ansible Core.
			</p><p>
				The role uses <code class="literal">certmonger</code> as the 
certificate provider, and currently supports issuing and renewing 
self-signed certificates and using the IdM integrated certificate 
authority (CA).
			</p><p>
				You can use the following variables in your Ansible playbook with the <code class="literal">certificate</code> System Role:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">certificate_wait</code></span></dt><dd>
							to specify if the task should wait for the certificate to be issued.
						</dd><dt><span class="term"><code class="literal">certificate_requests</code></span></dt><dd>
							to represent each certificate to be issued and its parameters.
						</dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL System Roles</a>
					</li></ul></div></section><section class="section" id="requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">18.2. Requesting a new self-signed certificate using the certificate System Role</h2></div></div></div><p class="_abstract _abstract">
				With the <code class="literal">certificate</code> System Role, you can use Ansible Core to issue self-signed certificates.
			</p><p>
				This process uses the <code class="literal">certmonger</code> provider and requests the certificate through the <code class="literal">getcert</code> command.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					By default, <code class="literal">certmonger</code> automatically tries to renew the certificate before it expires. You can disable this by setting the <code class="literal">auto_renew</code> parameter in the Ansible playbook to <code class="literal">no</code>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						<span class="emphasis"><em>Optional:</em></span> Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--lvfnfn2"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ *touch inventory.file*</pre></div></div></li><li class="listitem"><p class="simpara">
						Open your inventory file and define the hosts on which you want to request the certificate, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--z6cx6ok"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">[webserver]
server.idm.example.com</pre></div></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">request-certificate.yml</code>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set <code class="literal">hosts</code> to include the hosts on which you want to request the certificate, such as <code class="literal">webserver</code>.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">certificate_requests</code> variable to include the following:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Set the <code class="literal">name</code> parameter to the desired name of the certificate, such as <code class="literal">mycert</code>.
									</li><li class="listitem">
										Set the <code class="literal">dns</code> parameter to the domain to be included in the certificate, such as <code class="literal">*.example.com</code>.
									</li><li class="listitem">
										Set the <code class="literal">ca</code> parameter to <code class="literal">self-sign</code>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Set the <code class="literal">rhel-system-roles.certificate</code> role under <code class="literal">roles</code>.
							</p><p class="simpara">
								This is the playbook file for this example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--a2p7qj9"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">---
- hosts: webserver

  vars:
    certificate_requests:
      - name: mycert
        dns: "*.example.com"
        ca: self-sign

  roles:
    - rhel-system-roles.certificate</pre></div></div></li></ul></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--peq4yci"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ *ansible-playbook -i inventory.file request-certificate.yml*</pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file.
					</li><li class="listitem">
						See the <code class="literal">ansible-playbook(1)</code> man page.
					</li></ul></div></section><section class="section" id="requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">18.3. Requesting a new certificate from IdM CA using the certificate System Role</h2></div></div></div><p class="_abstract _abstract">
				With the <code class="literal">certificate</code> System Role, you can use <code class="literal">anible-core</code>
 to issue certificates while using an IdM server with an integrated 
certificate authority (CA). Therefore, you can efficiently and 
consistently manage the certificate trust chain for multiple systems 
when using IdM as the CA.
			</p><p>
				This process uses the <code class="literal">certmonger</code> provider and requests the certificate through the <code class="literal">getcert</code> command.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					By default, <code class="literal">certmonger</code> automatically tries to renew the certificate before it expires. You can disable this by setting the <code class="literal">auto_renew</code> parameter in the Ansible playbook to <code class="literal">no</code>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						<span class="emphasis"><em>Optional:</em></span> Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--n26doot"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ *touch inventory.file*</pre></div></div></li><li class="listitem"><p class="simpara">
						Open your inventory file and define the hosts on which you want to request the certificate, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--84obwff"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">[webserver]
server.idm.example.com</pre></div></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">request-certificate.yml</code>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set <code class="literal">hosts</code> to include the hosts on which you want to request the certificate, such as <code class="literal">webserver</code>.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">certificate_requests</code> variable to include the following:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Set the <code class="literal">name</code> parameter to the desired name of the certificate, such as <code class="literal">mycert</code>.
									</li><li class="listitem">
										Set the <code class="literal">dns</code> parameter to the domain to be included in the certificate, such as <code class="literal">www.example.com</code>.
									</li><li class="listitem">
										Set the <code class="literal">principal</code> parameter to specify the Kerberos principal, such as <code class="literal">HTTP/www.example.com@EXAMPLE.COM</code>.
									</li><li class="listitem">
										Set the <code class="literal">ca</code> parameter to <code class="literal">ipa</code>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Set the <code class="literal">rhel-system-roles.certificate</code> role under <code class="literal">roles</code>.
							</p><p class="simpara">
								This is the playbook file for this example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bni51jo"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">---
- hosts: webserver
  vars:
    certificate_requests:
      - name: mycert
        dns: www.example.com
        principal: HTTP/www.example.com@EXAMPLE.COM
        ca: ipa

  roles:
    - rhel-system-roles.certificate</pre></div></div></li></ul></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--eo8x5cx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ *ansible-playbook -i inventory.file request-certificate.yml*</pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file.
					</li><li class="listitem">
						See the <code class="literal">ansible-playbook(1)</code> man page.
					</li></ul></div></section><section class="section" id="specifying-commands-to-run-before-or-after-certificate-issuance-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">18.4. Specifying commands to run before or after certificate issuance using the certificate System Role</h2></div></div></div><p class="_abstract _abstract">
				With the <code class="literal">certificate</code> Role, you can use Ansible Core to execute a command before and after a certificate is issued or renewed.
			</p><p>
				In the following example, the administrator ensures stopping the <code class="literal">httpd</code> service before a self-signed certificate for <code class="literal">www.example.com</code> is issued or renewed, and restarting it afterwards.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					By default, <code class="literal">certmonger</code> automatically tries to renew the certificate before it expires. You can disable this by setting the <code class="literal">auto_renew</code> parameter in the Ansible playbook to <code class="literal">no</code>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						<span class="emphasis"><em>Optional:</em></span> Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--w3xgy2i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ *touch inventory.file*</pre></div></div></li><li class="listitem"><p class="simpara">
						Open your inventory file and define the hosts on which you want to request the certificate, for example:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ap4iyee"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">[webserver]
server.idm.example.com</pre></div></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">request-certificate.yml</code>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set <code class="literal">hosts</code> to include the hosts on which you want to request the certificate, such as <code class="literal">webserver</code>.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">certificate_requests</code> variable to include the following:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Set the <code class="literal">name</code> parameter to the desired name of the certificate, such as <code class="literal">mycert</code>.
									</li><li class="listitem">
										Set the <code class="literal">dns</code> parameter to the domain to be included in the certificate, such as <code class="literal">www.example.com</code>.
									</li><li class="listitem">
										Set the <code class="literal">ca</code> parameter to the CA you want to use to issue the certificate, such as <code class="literal">self-sign</code>.
									</li><li class="listitem">
										Set the <code class="literal">run_before</code> parameter to the command you want to execute before this certificate is issued or renewed, such as <code class="literal">systemctl stop httpd.service</code>.
									</li><li class="listitem">
										Set the <code class="literal">run_after</code> parameter to the command you want to execute after this certificate is issued or renewed, such as <code class="literal">systemctl start httpd.service</code>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Set the <code class="literal">rhel-system-roles.certificate</code> role under <code class="literal">roles</code>.
							</p><p class="simpara">
								This is the playbook file for this example:
							</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--hyv29oj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">---
- hosts: webserver
  vars:
    certificate_requests:
      - name: mycert
        dns: www.example.com
        ca: self-sign
        run_before: systemctl stop httpd.service
        run_after: systemctl start httpd.service

  roles:
    - rhel-system-roles.certificate</pre></div></div></li></ul></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xe89y3l"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">$ *ansible-playbook -i inventory.file request-certificate.yml*</pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file.
					</li><li class="listitem">
						See the <code class="literal">ansible-playbook(1)</code> man page.
					</li></ul></div></section></section><section class="chapter" id="configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 19. Configuring automatic crash dumps by using the kdump RHEL System Role</h1></div></div></div><p class="_abstract _abstract">
			To manage kdump using Ansible, you can use the <code class="literal">kdump</code> role, which is one of the RHEL&nbsp;System&nbsp;Roles available in RHEL&nbsp;9.
		</p><p>
			Using the <code class="literal">kdump</code> role enables you to specify where to save the contents of the system’s memory for later analysis.
		</p><p>
			For more information about RHEL&nbsp;System&nbsp;Roles and how to apply them, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Introduction to RHEL System Roles</a>.
		</p><section class="section" id="introduction-to-the-kdump-role_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">19.1. The kdump RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">kdump</code> System Role enables you to set basic kernel dump parameters on multiple systems.
			</p></section><section class="section" id="kdump-role-parameters_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">19.2. kdump role parameters</h2></div></div></div><p class="_abstract _abstract">
				The parameters used for the <code class="literal">kdump</code> RHEL&nbsp;System&nbsp;Roles are:
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="m68dxca" id="rh-table--m68dxca"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604740432064" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Role Variable</th><th id="idm140604740430976" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604740432064" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								kdump_path
							</p>
							 </td><td headers="idm140604740430976" data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								The path to which <code class="literal">vmcore</code> is written. If <code class="literal">kdump_target</code> is not null, path is relative to that dump target. Otherwise, it must be an absolute path in the root file system.
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The makedumpfile(8) man page.
					</li><li class="listitem">
						For details about the parameters used in <code class="literal">kdump</code> and additional information about the <code class="literal">kdump</code> System Role, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.tlog/README.md</code> file.
					</li></ul></div></section><section class="section" id="configuring-kdump-using-rhel-system-roles_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">19.3. Configuring kdump using RHEL System Roles</h2></div></div></div><p class="_abstract _abstract">
				You can set basic kernel dump parameters on multiple systems using the <code class="literal">kdump</code> System Role by running an Ansible playbook.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">kdump</code> role replaces the kdump configuration of the managed hosts entirely by replacing the <code class="literal">/etc/kdump.conf</code> file. Additionally, if the <code class="literal">kdump</code> role is applied, all previous <code class="literal">kdump</code> settings are also replaced, even if they are not specified by the role variables, by replacing the <code class="literal">/etc/sysconfig/kdump</code> file.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						You have an inventory file which lists the systems on which you want to deploy <code class="literal">kdump</code>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--n32dxa3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- hosts: kdump-test
  vars:
    kdump_path: /var/crash
  roles:
    - rhel-system-roles.kdump</pre></div></div></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yomqb2q"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--88g59pr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For a detailed reference on <code class="literal">kdump</code> role variables, see the README.md or README.html files in the /usr/share/doc/rhel-system-roles/kdump directory.
					</li><li class="listitem">
						See <a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter&nbsp;2.&nbsp;Preparing a control node and managed nodes to use RHEL&nbsp;System&nbsp;Roles">Preparing the control node and managed nodes to use RHEL System Roles</a>
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rhel-system-roles</code> package <code class="literal">/usr/share/ansible/roles/rhel-system-roles.kdump/README.html</code>
					</li></ul></div></section></section><section class="chapter" id="managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 20. Managing local storage using RHEL System Roles</h1></div></div></div><p class="_abstract _abstract">
			To manage LVM and local file systems (FS) using Ansible, you can use the <code class="literal">storage</code> role, which is one of the RHEL&nbsp;System&nbsp;Roles available in RHEL 9.
		</p><p>
			Using the <code class="literal">storage</code> role enables you to 
automate administration of file systems on disks and logical volumes on 
multiple machines and across all versions of RHEL starting with RHEL 
7.7.
		</p><p>
			For more information about RHEL&nbsp;System&nbsp;Roles and how to apply them, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Introduction to RHEL&nbsp;System&nbsp;Roles</a>.
		</p><section class="section" id="storage-role-intro_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.1. Introduction to the storage RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">storage</code> role can manage:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						File systems on disks which have not been partitioned
					</li><li class="listitem">
						Complete LVM volume groups including their logical volumes and file systems
					</li><li class="listitem">
						MD RAID volumes and their file systems
					</li></ul></div><p>
				With the <code class="literal">storage</code> role, you can perform the following tasks:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Create a file system
					</li><li class="listitem">
						Remove a file system
					</li><li class="listitem">
						Mount a file system
					</li><li class="listitem">
						Unmount a file system
					</li><li class="listitem">
						Create LVM volume groups
					</li><li class="listitem">
						Remove LVM volume groups
					</li><li class="listitem">
						Create logical volumes
					</li><li class="listitem">
						Remove logical volumes
					</li><li class="listitem">
						Create RAID volumes
					</li><li class="listitem">
						Remove RAID volumes
					</li><li class="listitem">
						Create LVM volume groups with RAID
					</li><li class="listitem">
						Remove LVM volume groups with RAID
					</li><li class="listitem">
						Create encrypted LVM volume groups
					</li><li class="listitem">
						Create LVM logical volumes with RAID
					</li></ul></div></section><section class="section" id="parameters-that-identify-a-storage-device-in-the-storage-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.2. Parameters that identify a storage device in the storage RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				Your <code class="literal">storage</code> role configuration affects only the file systems, volumes, and pools that you list in the following variables.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">storage_volumes</code></span></dt><dd><p class="simpara">
							List of file systems on all unpartitioned disks to be managed.
						</p><p class="simpara">
							<code class="literal">storage_volumes</code> can also include <code class="literal">raid</code> volumes.
						</p><p class="simpara">
							Partitions are currently unsupported.
						</p></dd><dt><span class="term"><code class="literal">storage_pools</code></span></dt><dd><p class="simpara">
							List of pools to be managed.
						</p><p class="simpara">
							Currently the only supported pool type is LVM. With LVM, pools 
represent volume groups (VGs). Under each pool there is a list of 
volumes to be managed by the role. With LVM, each volume corresponds to a
 logical volume (LV) with a file system.
						</p></dd></dl></div></section><section class="section" id="an-example-ansible-playbook-to-create-an-xfs-file-system_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.3. Example Ansible playbook to create an XFS file system on a block device</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> role to create an XFS file system on a block device using the default parameters.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">storage</code> role can create a file 
system only on an unpartitioned, whole disk or a logical volume (LV). It
 cannot create the file system on a partition.
				</p></div></div><div class="example" id="idm140604737407504"><p class="title">Example 20.1. A playbook that creates XFS on /dev/sdb</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--hj8kv2a"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: all
  vars:
    storage_volumes:
      - name: <span class="emphasis"><em><span class="replaceable replaceable">barefs</span></em></span>
        type: disk
        disks:
          - <span class="emphasis"><em><span class="replaceable replaceable">sdb</span></em></span>
        fs_type: xfs
  roles:
    - rhel-system-roles.storage</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The volume name (<code class="literal"><span class="emphasis"><em>barefs</em></span></code> in the example) is currently arbitrary. The <code class="literal">storage</code> role identifies the volume by the disk device listed under the <code class="literal">disks:</code> attribute.
						</li><li class="listitem">
							You can omit the <code class="literal">fs_type: xfs</code> line because XFS is the default file system in RHEL 9.
						</li><li class="listitem"><p class="simpara">
							To create the file system on an LV, provide the LVM setup under the <code class="literal">disks:</code> attribute, including the enclosing volume group. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_logical_volumes/managing-lvm-logical-volumes_configuring-and-managing-logical-volumes#an-example-playbook-to-manage-logical-volumes_managing-lvm-logical-volumes-using-rhel-system-roles">Example Ansible playbook to manage logical volumes</a>.
						</p><p class="simpara">
							Do not provide the path to the LV device.
						</p></li></ul></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal filename">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="an-example-ansible-playbook-to-persistently-mount-a-file-system_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.4. Example Ansible playbook to persistently mount a file system</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> role to immediately and persistently mount an XFS file system.
			</p><div class="example" id="idm140604737390000"><p class="title">Example 20.2. A playbook that mounts a file system on /dev/sdb to /mnt/data</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0ca45fp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: all
  vars:
    storage_volumes:
      - name: <span class="emphasis"><em><span class="replaceable replaceable">barefs</span></em></span>
        type: disk
        disks:
          - <span class="emphasis"><em><span class="replaceable replaceable">sdb</span></em></span>
        fs_type: <span class="emphasis"><em><span class="replaceable replaceable">xfs</span></em></span>
        mount_point: <span class="emphasis"><em><span class="replaceable replaceable">/mnt/data</span></em></span>
  roles:
    - rhel-system-roles.storage</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							This playbook adds the file system to the <code class="literal filename">/etc/fstab</code> file, and mounts the file system immediately.
						</li><li class="listitem">
							If the file system on the <code class="literal">/dev/sdb</code> device or the mount point directory do not exist, the playbook creates them.
						</li></ul></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal filename">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="an-example-playbook-to-manage-logical-volumes_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.5. Example Ansible playbook to manage logical volumes</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> role to create an LVM logical volume in a volume group.
			</p><div class="example" id="idm140604737687168"><p class="title">Example 20.3. A playbook that creates a mylv logical volume in the myvg volume group</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wtp1k8p"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">- hosts: all
  vars:
    storage_pools:
      - name: <span class="emphasis"><em><span class="replaceable replaceable">myvg</span></em></span>
        disks:
          - <span class="emphasis"><em><span class="replaceable replaceable">sda</span></em></span>
          - <span class="emphasis"><em><span class="replaceable replaceable">sdb</span></em></span>
          - <span class="emphasis"><em><span class="replaceable replaceable">sdc</span></em></span>
        volumes:
          - name: <span class="emphasis"><em><span class="replaceable replaceable">mylv</span></em></span>
            size: <span class="emphasis"><em><span class="replaceable replaceable">2G</span></em></span>
            fs_type: <span class="emphasis"><em><span class="replaceable replaceable">ext4</span></em></span>
            mount_point: <span class="emphasis"><em><span class="replaceable replaceable">/mnt/data</span></em></span>
  roles:
    - rhel-system-roles.storage</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The <code class="literal">myvg</code> volume group consists of the following disks:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal">/dev/sda</code>
								</li><li class="listitem">
									<code class="literal">/dev/sdb</code>
								</li><li class="listitem">
									<code class="literal">/dev/sdc</code>
								</li></ul></div></li><li class="listitem">
							If the <code class="literal">myvg</code> volume group already exists, the playbook adds the logical volume to the volume group.
						</li><li class="listitem">
							If the <code class="literal">myvg</code> volume group does not exist, the playbook creates it.
						</li><li class="listitem">
							The playbook creates an Ext4 file system on the <code class="literal">mylv</code> logical volume, and persistently mounts the file system at <code class="literal filename">/mnt</code>.
						</li></ul></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal filename">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="an-example-ansible-playbook-to-enable-online-block-discard_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.6. Example Ansible playbook to enable online block discard</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> role to mount an XFS file system with online block discard enabled.
			</p><div class="example" id="idm140604738713248"><p class="title">Example 20.4. A playbook that enables online block discard on /mnt/data/</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--l6aguis"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: all
  vars:
    storage_volumes:
      - name: <span class="emphasis"><em><span class="replaceable replaceable">barefs</span></em></span>
        type: disk
        disks:
          - <span class="emphasis"><em><span class="replaceable replaceable">sdb</span></em></span>
        fs_type: <span class="emphasis"><em><span class="replaceable replaceable">xfs</span></em></span>
        mount_point: <span class="emphasis"><em><span class="replaceable replaceable">/mnt/data</span></em></span>
        mount_options: discard
  roles:
    - rhel-system-roles.storage</pre></div></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_file_systems/managing-local-storage-using-rhel-system-roles_managing-file-systems#an-example-ansible-playbook-to-persistently-mount-a-file-system_managing-local-storage-using-rhel-system-roles">Example Ansible playbook to persistently mount a file system</a>
					</li><li class="listitem">
						The <code class="literal filename">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="an-example-playbook-to-create-mount-an-ext4-file-system_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.7. Example Ansible playbook to create and mount an Ext4 file system</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> role to create and mount an Ext4 file system.
			</p><div class="example" id="idm140604738699696"><p class="title">Example 20.5. A playbook that creates Ext4 on /dev/sdb and mounts it at /mnt/data</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--a9s4tp5"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: all
  vars:
    storage_volumes:
      - name: <span class="emphasis"><em><span class="replaceable replaceable">barefs</span></em></span>
        type: disk
        disks:
          - <span class="emphasis"><em><span class="replaceable replaceable">sdb</span></em></span>
        fs_type: ext4
        fs_label: <span class="emphasis"><em><span class="replaceable replaceable">label-name</span></em></span>
        mount_point: <span class="emphasis"><em><span class="replaceable replaceable">/mnt/data</span></em></span>
  roles:
    - rhel-system-roles.storage</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The playbook creates the file system on the <code class="literal">/dev/sdb</code> disk.
						</li><li class="listitem">
							The playbook persistently mounts the file system at the <code class="literal"><span class="emphasis"><em><span class="replaceable replaceable">/mnt/data</span></em></span></code> directory.
						</li><li class="listitem">
							The label of the file system is <code class="literal"><span class="emphasis"><em><span class="replaceable replaceable">label-name</span></em></span></code>.
						</li></ul></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal filename">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="an-example-ansible-playbook-to-create-mount-ext3-file-system_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.8. Example Ansible playbook to create and mount an ext3 file system</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> role to create and mount an Ext3 file system.
			</p><div class="example" id="idm140604737039248"><p class="title">Example 20.6. A playbook that creates Ext3 on /dev/sdb and mounts it at /mnt/data</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9nmuvme"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: all
  vars:
    storage_volumes:
      - name: <span class="emphasis"><em><span class="replaceable replaceable">barefs</span></em></span>
        type: disk
        disks:
          - <span class="emphasis"><em><span class="replaceable replaceable">sdb</span></em></span>
        fs_type: ext3
        fs_label: <span class="emphasis"><em><span class="replaceable replaceable">label-name</span></em></span>
        mount_point: <span class="emphasis"><em><span class="replaceable replaceable">/mnt/data</span></em></span>
  roles:
    - rhel-system-roles.storage</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The playbook creates the file system on the <code class="literal">/dev/sdb</code> disk.
						</li><li class="listitem">
							The playbook persistently mounts the file system at the <code class="literal"><span class="emphasis"><em><span class="replaceable replaceable">/mnt/data</span></em></span></code> directory.
						</li><li class="listitem">
							The label of the file system is <code class="literal"><span class="emphasis"><em><span class="replaceable replaceable">label-name</span></em></span></code>.
						</li></ul></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal filename">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="example-ansible-playbook-to-resize-an-existing-file-system-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.9. Example Ansible playbook to resize an existing Ext4 or Ext3 file system using the storage RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> role to resize an existing Ext4 or Ext3 file system on a block device.
			</p><div class="example" id="idm140604737020064"><p class="title">Example 20.7. A playbook that set up a single volume on a disk</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0je4bkj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Create a disk device mounted on <code class="literal">/opt/barefs</code>
- hosts: all
  vars:
    storage_volumes:
      - name: <span class="emphasis"><em><span class="replaceable replaceable">barefs</span></em></span>
        type: disk
        disks:
          - <span class="emphasis"><em><span class="replaceable replaceable">/dev/sdb</span></em></span>
        size: <span class="emphasis"><em><span class="replaceable replaceable">12 GiB</span></em></span>
        fs_type: ext4
        mount_point: <span class="emphasis"><em><span class="replaceable replaceable">/opt/barefs</span></em></span>
  roles:
    - rhel-system-roles.storage</pre></div></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						If the volume in the previous example already exists, to resize 
the volume, you need to run the same playbook, just with a different 
value for the parameter <code class="literal">size</code>. For example:
					</li></ul></div><div class="example" id="idm140604741205488"><p class="title">Example 20.8. A playbook that resizes ext4 on /dev/sdb</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5az4u79"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Create a disk device mounted on <code class="literal">/opt/barefs</code>
- hosts: all
  vars:
    storage_volumes:
      - name: <span class="emphasis"><em><span class="replaceable replaceable">barefs</span></em></span>
        type: disk
        disks:
          - <span class="emphasis"><em><span class="replaceable replaceable">/dev/sdb</span></em></span>
        size: <span class="emphasis"><em><span class="replaceable replaceable">10 GiB</span></em></span>
        fs_type: ext4
        mount_point: <span class="emphasis"><em><span class="replaceable replaceable">/opt/barefs</span></em></span>
  roles:
    - rhel-system-roles.storage</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The volume name (barefs in the example) is currently arbitrary. 
The Storage role identifies the volume by the disk device listed under 
the disks: attribute.
						</li></ul></div></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Using the <code class="literal">Resizing</code> action in other file systems can destroy the data on the device you are working on.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal filename">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="example-ansible-playbook-to-resize-an-existing-lvm-file-system-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.10. Example Ansible playbook to resize an existing file system on LVM using the storage RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> RHEL&nbsp;System&nbsp;Role to resize an LVM logical volume with a file system.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Using the <code class="literal">Resizing</code> action in other file systems can destroy the data on the device you are working on.
				</p></div></div><div class="example" id="idm140604741187248"><p class="title">Example 20.9. A playbook that resizes existing mylv1 and myvl2 logical volumes in the myvg volume group</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--674oebd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---

- hosts: all
   vars:
    storage_pools:
      - name: myvg
        disks:
          - /dev/sda
          - /dev/sdb
          - /dev/sdc
        volumes:
            - name: mylv1
              size: <span class="emphasis"><em><span class="replaceable replaceable">10 GiB</span></em></span>
              fs_type: ext4
              mount_point: <span class="emphasis"><em><span class="replaceable replaceable">/opt/mount1</span></em></span>
            - name: mylv2
              size: <span class="emphasis"><em><span class="replaceable replaceable">50 GiB</span></em></span>
              fs_type: ext4
              mount_point: <span class="emphasis"><em><span class="replaceable replaceable">/opt/mount2</span></em></span>

- name: Create LVM pool over three disks
  include_role:
    name: rhel-system-roles.storage</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							This playbook resizes the following existing file systems:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									The Ext4 file system on the <code class="literal">mylv1</code> volume, which is mounted at <code class="literal">/opt/mount1</code>, resizes to 10 GiB.
								</li><li class="listitem">
									The Ext4 file system on the <code class="literal">mylv2</code> volume, which is mounted at <code class="literal">/opt/mount2</code>, resizes to 50 GiB.
								</li></ul></div></li></ul></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal filename">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="example-ansible-playbook-to-create-a-swap-partition-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.11. Example Ansible playbook to create a swap volume using the storage RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code>
 role to create a swap volume, if it does not exist, or to modify the 
swap volume, if it already exist, on a block device using the default 
parameters.
			</p><div class="example" id="idm140604738428544"><p class="title">Example 20.10. A playbook that creates or modify an existing XFS on /dev/sdb</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--70n2uel"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Create a disk device with swap
- hosts: all
  vars:
    storage_volumes:
      - name: <span class="emphasis"><em><span class="replaceable replaceable">swap_fs</span></em></span>
        type: disk
        disks:
          - <span class="emphasis"><em><span class="replaceable replaceable">/dev/sdb</span></em></span>
	size: <span class="emphasis"><em><span class="replaceable replaceable">15 GiB</span></em></span>
        fs_type: swap
  roles:
    - rhel-system-roles.storage</pre></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The volume name (<code class="literal"><span class="emphasis"><em>swap_fs</em></span></code> in the example) is currently arbitrary. The <code class="literal">storage</code> role identifies the volume by the disk device listed under the <code class="literal">disks:</code> attribute.
						</li></ul></div></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal filename">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="configuring-a-raid-volume-using-the-storage-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.12. Configuring a RAID volume using the storage System Role</h2></div></div></div><p>
				With the <code class="literal">storage</code> System Role, you can 
configure a RAID volume on RHEL using Red Hat Ansible Automation 
Platform and Ansible-Core. Create an Ansible playbook with the 
parameters to configure a RAID volume to suit your requirements.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						You have an inventory file detailing the systems on which you want to deploy a RAID volume using the <code class="literal">storage</code> System Role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <span class="emphasis"><em>playbook.yml</em></span> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bpsc476"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout white-space-pre language-none codeblock codeblock--processed">---
- name: Configure the storage
  hosts: managed-node-01.example.com
  tasks:
  - name: Create a RAID on sdd, sde, sdf, and sdg
    include_role:
      name: rhel-system-roles.storage
    vars:
    storage_safe_mode: false
    storage_volumes:
      - name: data
        type: raid
        disks: [sdd, sde, sdf, sdg]
        raid_level: raid0
        raid_chunk_size: 32 KiB
        mount_point: /mnt/data
        state: present</pre></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
							Device names might change in certain circumstances, for example, 
when you add a new disk to a system. Therefore, to prevent data loss, do
 not use specific disk names in the playbook.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Optional: Verify the playbook syntax:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--scnzg1d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--jj03u3h"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory.file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL System Roles</a>
					</li></ul></div></section><section class="section" id="configuring-lvm-pool-with-raid-using-storage-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.13. Configuring an LVM pool with RAID using the storage RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				With the <code class="literal">storage</code> System Role, you can 
configure an LVM pool with RAID on RHEL using Red Hat Ansible Automation
 Platform. In this section you will learn how to set up an Ansible 
playbook with the available parameters to configure an LVM pool with 
RAID.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						You have an inventory file detailing the systems on which you want to configure an LVM pool with RAID using the <code class="literal">storage</code> System Role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--t5689z4"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">- hosts: all
  vars:
    storage_safe_mode: false
    storage_pools:
      - name: my_pool
        type: lvm
        disks: [sdh, sdi]
        raid_level: raid1
        volumes:
          - name: my_pool
            size: "1 GiB"
            mount_point: "/mnt/app/shared"
            fs_type: xfs
            state: present
  roles:
    - name: rhel-system-roles.storage</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							To create an LVM pool with RAID, you must specify the RAID type using the <code class="literal">raid_level</code> parameter.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Optional. Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--eed32qs"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--21s0oan"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory.file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file.
					</li></ul></div></section><section class="section" id="example-ansible-playbook-to-compress-and-deduplicate-a-vdo-volume-on-lvm-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.14. Example Ansible playbook to compress and deduplicate a VDO volume on LVM using the storage RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> RHEL&nbsp;System&nbsp;Role to enable compression and deduplication of Logical Volumes (LVM) using Virtual Data Optimizer (VDO).
			</p><div class="example" id="idm140604738358112"><p class="title">Example 20.11. A playbook that creates a mylv1 LVM VDO volume in the myvg volume group</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--j2ah42b"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Create LVM VDO volume under volume group 'myvg'
  hosts: all
  roles:
    -rhel-system-roles.storage
  vars:
    storage_pools:
     - name: myvg
       disks:
         - /dev/sdb
       volumes:
         - name: mylv1
           compression: true
           deduplication: true
           vdo_pool_size: 10 GiB
           size: 30 GiB
           mount_point: /mnt/app/shared</pre></div></div></div></div><p>
				In this example, the <code class="literal">compression</code> and <code class="literal">deduplication</code> pools are set to true, which specifies that the VDO is used. The following describes the usage of these parameters:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">deduplication</code> is used to deduplicate the duplicated data stored on the storage volume.
					</li><li class="listitem">
						The compression is used to compress the data stored on the storage volume, which results in more storage capacity.
					</li><li class="listitem">
						The vdo_pool_size specifies the actual size the volume takes on the device. The virtual size of VDO volume is set by the <code class="literal">size</code>
 parameter. NOTE: Because of the Storage role use of LVM VDO, only one 
volume per pool can use the compression and deduplication.
					</li></ul></div></section><section class="section" id="creating-a-luks2-encrypted-volume-using-the-storage-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.15. Creating a LUKS2 encrypted volume using the storage RHEL System Role</h2></div></div></div><p>
				You can use the <code class="literal">storage</code> role to create and configure a volume encrypted with LUKS by running an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more managed nodes, which are systems you want to configure with the <code class="literal">crypto_policies</code> System Role.
					</li><li class="listitem">
						An inventory file, which lists the managed nodes.
					</li><li class="listitem">
						Access and permissions to a control node, which is a system from 
which Red Hat Ansible Core configures other systems. On the control 
node, the <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
					</li></ul></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					RHEL 8.0-8.5 provided access to a separate Ansible repository that 
contains Ansible Engine 2.9 for automation based on Ansible. Ansible 
Engine contains command-line utilities such as <code class="literal">ansible</code>, <code class="literal">ansible-playbook</code>, connectors such as <code class="literal">docker</code> and <code class="literal">podman</code>, and many plugins and modules. For information about how to obtain and install Ansible Engine, see the <a class="link" href="https://access.redhat.com/articles/3174981">How to download and install Red Hat Ansible Engine</a> Knowledgebase article.
				</p><p>
					RHEL 8.6 and 9.0 have introduced Ansible Core (provided as the <code class="literal">ansible-core</code>
 package), which contains the Ansible command-line utilities, commands, 
and a small set of built-in Ansible plugins. RHEL provides this package 
through the AppStream repository, and it has a limited scope of support.
 For more information, see the <a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a> Knowledgebase article.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--09htv1y"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">- hosts: all
  vars:
    storage_volumes:
      - name: <span class="emphasis"><em>barefs</em></span>
        type: disk
        disks:
         <span class="emphasis"><em>- sdb</em></span>
        fs_type: xfs
        fs_label: <span class="emphasis"><em>label-name</em></span>
        mount_point: <span class="emphasis"><em>/mnt/data</em></span>
        encryption: true
        encryption_password: <span class="emphasis"><em>your-password</em></span>
  roles:
   - rhel-system-roles.storage</pre></div></div><p class="simpara">
						You can also add the other encryption parameters such as <code class="literal">encryption_key</code>, <code class="literal">encryption_cipher</code>, <code class="literal">encryption_key_size</code>, and <code class="literal">encryption_luks</code> version in the <span class="emphasis"><em>playbook.yml</em></span> file.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vh80bxs"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--iqog3hn"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory.file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						View the encryption status:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0tvs1bh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cryptsetup status <span class="emphasis"><em>sdb</em></span></strong></span>

/dev/mapper/<span class="emphasis"><em>sdb</em></span> is active and is in use.
type: LUKS2
cipher: aes-xts-plain64
keysize: 512 bits
key location: keyring
device: /dev/<span class="emphasis"><em>sdb</em></span>
[...]</pre></div></div></li><li class="listitem"><p class="simpara">
						Verify the created LUKS encrypted volume:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--755zova"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cryptsetup luksDump /dev/<span class="emphasis"><em>sdb</em></span></strong></span>

Version:       	2
Epoch:         	6
Metadata area: 	16384 [bytes]
Keyslots area: 	33521664 [bytes]
UUID:          	a4c6be82-7347-4a91-a8ad-9479b72c9426
Label:         	(no label)
Subsystem:     	(no subsystem)
Flags:       	allow-discards

Data segments:
  0: crypt
	offset: 33554432 [bytes]
	length: (whole device)
	cipher: aes-xts-plain64
	sector: 4096 [bytes]
[...]</pre></div></div></li><li class="listitem"><p class="simpara">
						View the <code class="literal">cryptsetup</code> parameters in the <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file, which the <code class="literal">storage</code> role supports:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mhlwxug"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat ~/playbook.yml</strong></span>

    - hosts: all
      vars:
        storage_volumes:
          - name: foo
            type: disk
            disks:
             - nvme0n1
            fs_type: xfs
            fs_label: label-name
            mount_point: /mnt/data
            encryption: true
            #encryption_password: passwdpasswd
            encryption_key: /home/passwd_key
            encryption_cipher: aes-xts-plain64
            encryption_key_size: 512
            encryption_luks_version: luks2

      roles:
       - rhel-system-roles.storage</pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_storage_devices/encrypting-block-devices-using-luks_managing-storage-devices">Encrypting block devices using LUKS</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li></ul></div></section><section class="section" id="example-ansible-playbook-to-express-pool-volume-sizes-as-percentage-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">20.16. Example Ansible playbook to express pool volume sizes as percentage using the storage RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> System Role to enable you to express Logical Manager Volumes (LVM) volume sizes as a percentage of the pool’s total size.
			</p><div class="example" id="idm140604737159376"><p class="title">Example 20.12. A playbook that express volume sizes as a percentage of the pool’s total size</p><div class="example-contents"><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3661uph"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Express volume sizes as a percentage of the pool's total size
  hosts: all
  roles
    - rhel-system-roles.storage
  vars:
    storage_pools:
    - name: myvg
      disks:
        - /dev/sdb
      volumes:
        - name: data
          size: 60%
          mount_point: /opt/mount/data
        - name: web
          size: 30%
          mount_point: /opt/mount/web
        - name: cache
          size: 10%
          mount_point: /opt/cache/mount</pre></div></div></div></div><p>
				This example specifies the size of LVM volumes as a percentage of 
the pool size, for example: "60%". Additionally, you can also specify 
the size of LVM volumes as a percentage of the pool size in a 
human-readable size of the file system, for example, "10g" or "50 GiB".
			</p></section><section class="section _additional-resources" id="additional_resources_6"><div class="titlepage"><div><div><h2 class="title">20.17. ADDITIONAL RESOURCES</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/</code>
					</li></ul></div></section></section><section class="chapter" id="configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 21. Configuring time synchronization by using the timesync RHEL System Role</h1></div></div></div><p>
			With the <code class="literal">timesync</code> 
RHEL&nbsp;System&nbsp;Role, you can manage time synchronization on 
multiple target machines on RHEL using Red Hat Ansible Automation 
Platform.
		</p><section class="section" id="the-timesync-system-role_configuring-time-synchronization-using-system-roles"><div class="titlepage"><div><div><h2 class="title">21.1. The timesync RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can manage time synchronization on multiple target machines using the <code class="literal">timesync</code> RHEL&nbsp;System&nbsp;Role.
			</p><p>
				The <code class="literal">timesync</code> role installs and 
configures an NTP or PTP implementation to operate as an NTP client or 
PTP replica in order to synchronize the system clock with NTP servers or
 grandmasters in PTP domains.
			</p><p>
				Note that using the <code class="literal">timesync</code> role also facilitates the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_basic_system_settings/index#migrating-to-chrony_using-chrony-to-configure-ntp">migration to chrony</a>,
 because you can use the same playbook on all versions of Red Hat 
Enterprise Linux starting with RHEL 6 regardless of whether the system 
uses <code class="literal">ntp</code> or <code class="literal">chrony</code> to implement the NTP protocol.
			</p></section><section class="section" id="applying-the-timesync-system-role-for-a-single-pool-of-servers_configuring-time-synchronization-using-system-roles"><div class="titlepage"><div><div><h2 class="title">21.2. Applying the timesync System Role for a single pool of servers</h2></div></div></div><p class="_abstract _abstract">
				The following example shows how to apply the <code class="literal">timesync</code> role in a situation with just one pool of servers.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">timesync</code> role replaces the 
configuration of the given or detected provider service on the managed 
host. Previous settings are lost, even if they are not specified in the 
role variables. The only preserved setting is the choice of provider if 
the <code class="literal">timesync_ntp_provider</code> variable is not defined.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						You have an inventory file which lists the systems on which you want to deploy <code class="literal">timesync</code> System Role.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--v6spoqu"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- hosts: timesync-test
  vars:
    timesync_ntp_servers:
      - hostname: 2.rhel.pool.ntp.org
        pool: yes
        iburst: yes
  roles:
    - rhel-system-roles.timesync</pre></div></div></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--s4hzjbx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--y288nbf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div></section><section class="section" id="applying-the-timesync-system-role-on-client-servers_configuring-time-synchronization-using-system-roles"><div class="titlepage"><div><div><h2 class="title">21.3. Applying the timesync System Role on client servers</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">timesync</code> role to enable
 Network Time Security (NTS) on NTP clients. Network Time Security (NTS)
 is an authentication mechanism specified for Network Time Protocol 
(NTP). It verifies that NTP packets exchanged between the server and 
client are not altered.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">timesync</code> role replaces the 
configuration of the given or detected provider service on the managed 
host. Previous settings are lost even if they are not specified in the 
role variables. The only preserved setting is the choice of provider if 
the <code class="literal">timesync_ntp_provider</code> variable is not defined.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You do not have to have Red Hat Ansible Automation Platform installed on the systems on which you want to deploy the <code class="literal">timesync</code> solution.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						You have an inventory file which lists the systems on which you want to deploy the <code class="literal">timesync</code> System Role.
					</li><li class="listitem">
						The <code class="literal">chrony</code> NTP provider version is 4.0 or later.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--k8c7bih"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- hosts: timesync-test
  vars:
    timesync_ntp_servers:
      - hostname: ptbtime1.ptb.de
        iburst: yes
        nts: yes
  roles:
    - rhel-system-roles.timesync</pre></div></div><p class="simpara">
						<code class="literal">ptbtime1.ptb.de</code> is an example of public server. You may want to use a different public server or your own server.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ved0e8x"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--uqj197m"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Perform a test on the client machine:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--kdxryv3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># chronyc -N authdata

Name/IP address         Mode KeyID Type KLen Last Atmp  NAK Cook CLen
=====================================================================
ptbtime1.ptb.de         NTS     1   15  256  157    0    0    8  100</pre></div></div></li><li class="listitem">
						Check that the number of reported cookies is larger than zero.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">chrony.conf(5)</code> man page
					</li></ul></div></section><section class="section" id="timesync-system-roles-variables_configuring-time-synchronization-using-system-roles"><div class="titlepage"><div><div><h2 class="title">21.4. timesync System Roles variables</h2></div></div></div><p class="_abstract _abstract">
				You can pass the following variable to the <code class="literal">timesync</code> role:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">timesync_ntp_servers</code>:
					</li></ul></div><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="xiwsg74" id="rh-table--xiwsg74" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604740351792" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Role variable settings</th><th id="idm140604740350704" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604740351792" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								hostname: host.example.com
							</p>
							 </td><td headers="idm140604740350704" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								Hostname or address of the server
							</p>
							 </td></tr><tr><td headers="idm140604740351792" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								minpoll: <span class="emphasis"><em>number</em></span>
							</p>
							 </td><td headers="idm140604740350704" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
								Minimum polling interval. Default: 6
							</p>
							 </td></tr><tr><td headers="idm140604740351792" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								maxpoll: <span class="emphasis"><em>number</em></span>
							</p>
							 </td><td headers="idm140604740350704" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								Maximum polling interval. Default: 10
							</p>
							 </td></tr><tr><td headers="idm140604740351792" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								iburst: yes
							</p>
							 </td><td headers="idm140604740350704" data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Flag enabling fast initial synchronization. Default: no
							</p>
							 </td></tr><tr><td headers="idm140604740351792" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								pool: yes
							</p>
							 </td><td headers="idm140604740350704" data-row="6" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Flag indicating that each resolved address of the hostname is a separate NTP server. Default: no
							</p>
							 </td></tr><tr><td headers="idm140604740351792" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								nts: yes
							</p>
							 </td><td headers="idm140604740350704" data-row="7" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Flag to enable Network Time Security (NTS). Default: no. Supported only with chrony &gt;= 4.0.
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For a detailed reference on <code class="literal">timesync</code> role variables, install the rhel-system-roles package, and see the README.md or README.html files in the <code class="literal">/usr/share/doc/rhel-system-roles/timesync</code> directory.
					</li></ul></div></section></section><section class="chapter" id="monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 22. Monitoring performance by using the metrics RHEL System Role</h1></div></div></div><p class="_abstract _abstract">
			As a system administrator, you can use the <code class="literal">metrics</code> RHEL&nbsp;System&nbsp;Role to monitor the performance of a system.
		</p><section class="section" id="introduction-to-the-metrics-role_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">22.1. Introduction to the metrics System Role</h2></div></div></div><p class="_abstract _abstract">
				RHEL&nbsp;System&nbsp;Roles is a collection of Ansible roles and 
modules that provide a consistent configuration interface to remotely 
manage multiple RHEL systems. The <code class="literal">metrics</code> 
System Role configures performance analysis services for the local 
system and, optionally, includes a list of remote systems to be 
monitored by the local system. The <code class="literal">metrics</code> System Role enables you to use <code class="literal">pcp</code> to monitor your systems performance without having to configure <code class="literal">pcp</code> separately, as the set-up and deployment of <code class="literal">pcp</code> is handled by the playbook.
			</p><div class="table" id="idm140604739657584"><p class="title">Table 22.1. metrics system role variables</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="pc7gajp" id="rh-table--pc7gajp" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th id="idm140604739651504" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Role variable</th><th id="idm140604739650416" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th><th id="idm140604739649328" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">Example usage</th></tr></thead><tbody><tr><td headers="idm140604739651504" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								metrics_monitored_hosts
							</p>
							 </td><td headers="idm140604739650416" data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								List of remote hosts to be analyzed by the target host. These 
hosts will have metrics recorded on the target host, so ensure enough 
disk space exists below <code class="literal">/var/log</code> for each host.
							</p>
							 </td><td headers="idm140604739649328" data-row="2" data-col="3" class="content--lg" valign="top" align="left"> <p>
								<code class="literal">metrics_monitored_hosts: ["<span class="emphasis"><em>webserver.example.com</em></span>", "<span class="emphasis"><em>database.example.com</em></span>"]</code>
							</p>
							 </td></tr><tr><td headers="idm140604739651504" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								metrics_retention_days
							</p>
							 </td><td headers="idm140604739650416" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Configures the number of days for performance data retention before deletion.
							</p>
							 </td><td headers="idm140604739649328" data-row="3" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">metrics_retention_days: 14</code>
							</p>
							 </td></tr><tr><td headers="idm140604739651504" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								metrics_graph_service
							</p>
							 </td><td headers="idm140604739650416" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								A boolean flag that enables the host to be set up with services for performance data visualization via <code class="literal">pcp</code> and <code class="literal">grafana</code>. Set to false by default.
							</p>
							 </td><td headers="idm140604739649328" data-row="4" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">metrics_graph_service: no</code>
							</p>
							 </td></tr><tr><td headers="idm140604739651504" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								metrics_query_service
							</p>
							 </td><td headers="idm140604739650416" data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								A boolean flag that enables the host to be set up with time series query services for querying recorded <code class="literal">pcp</code> metrics via <code class="literal">redis</code>. Set to false by default.
							</p>
							 </td><td headers="idm140604739649328" data-row="5" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">metrics_query_service: no</code>
							</p>
							 </td></tr><tr><td headers="idm140604739651504" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								metrics_provider
							</p>
							 </td><td headers="idm140604739650416" data-row="6" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Specifies which metrics collector to use to provide metrics. Currently, <code class="literal">pcp</code> is the only supported metrics provider.
							</p>
							 </td><td headers="idm140604739649328" data-row="6" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">metrics_provider: "pcp"</code>
							</p>
							 </td></tr><tr><td headers="idm140604739651504" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								metrics_manage_firewall
							</p>
							 </td><td headers="idm140604739650416" data-row="7" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Uses the <code class="literal">firewall</code> role to manage port access directly from the <code class="literal">metrics</code> role. Set to false by default.
							</p>
							 </td><td headers="idm140604739649328" data-row="7" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">metrics_manage_firewall: true</code>
							</p>
							 </td></tr><tr><td headers="idm140604739651504" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								metrics_manage_selinux
							</p>
							 </td><td headers="idm140604739650416" data-row="8" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Uses the <code class="literal">selinux</code> role to manage port access directly from the <code class="literal">metrics</code> role. Set to false by default.
							</p>
							 </td><td headers="idm140604739649328" data-row="8" data-col="3" class="content--md" valign="top" align="left"> <p>
								<code class="literal">metrics_manage_selinux: true</code>
							</p>
							 </td></tr></tbody></table></rh-table></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					For details about the parameters used in <code class="literal">metrics_connections</code> and additional information about the <code class="literal">metrics</code> System Role, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md</code> file.
				</p></div></div></section><section class="section" id="using-the-metrics-role-to-monitor-your-local-system-with-visualization_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">22.2. Using the metrics System Role to monitor your local system with visualization</h2></div></div></div><p class="_abstract _abstract">
				This procedure describes how to use the <code class="literal">metrics</code> RHEL&nbsp;System&nbsp;Role to monitor your local system while simultaneously provisioning data visualization via <code class="literal">Grafana</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the machine you want to monitor.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Configure <code class="literal">localhost</code> in the <code class="literal">/etc/ansible/hosts</code> Ansible inventory by adding the following content to the inventory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--84alsr8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">localhost ansible_connection=local</pre></div></div></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8xdvggt"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- name: Manage metrics
  hosts: localhost
  vars:
    metrics_graph_service: yes
    metrics_manage_firewall: true
    metrics_manage_selinux: true
  roles:
    - rhel-system-roles.metrics</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--24363cj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>name_of_your_playbook</em></span>.yml</strong></span></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Because the <code class="literal">metrics_graph_service</code> boolean is set to <code class="literal">value="yes"</code>, <code class="literal">Grafana</code> is automatically installed and provisioned with <code class="literal">pcp</code> added as a data source. Because <code class="literal">metrics_manage_firewall</code> and <code class="literal">metrics_manage_selinux</code> are both set to <code class="literal">true</code>, the metrics role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> system roles to manage the ports used by the metrics role.
						</p></div></div></li><li class="listitem">
						To view visualization of the metrics being collected on your machine, access the <code class="literal">grafana</code> web interface as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/monitoring_and_managing_system_status_and_performance/index#accessing-the-grafana-web-ui_setting-up-graphical-representation-of-pcp-metrics">Accessing the Grafana web UI</a>.
					</li></ol></div></section><section class="section" id="using-the-metrics-role-to-monitor-a-fleet-of-machines-remotely_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">22.3. Using the metrics System Role to set up a fleet of individual systems to monitor themselves</h2></div></div></div><p class="_abstract _abstract">
				This procedure describes how to use the <code class="literal">metrics</code> System Role to set up a fleet of machines to monitor themselves.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the machine you want to use to run the playbook.
					</li><li class="listitem">
						You have the SSH connection established.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the name or IP address of the machines you want to monitor via the playbook to the <code class="literal">/etc/ansible/hosts</code> Ansible inventory file under an identifying group name enclosed in brackets:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vhavb80"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">[remotes]
<span class="emphasis"><em>webserver.example.com</em></span>
<span class="emphasis"><em>database.example.com</em></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--v33lpz8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: remotes
  vars:
    metrics_retention_days: 0
    metrics_manage_firewall: true
    metrics_manage_selinux: true
  roles:
    - rhel-system-roles.metrics</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Because <code class="literal">metrics_manage_firewall</code> and <code class="literal">metrics_manage_selinux</code> are both set to <code class="literal">true</code>, the metrics role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">metrics</code> role.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wq11fm8"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>name_of_your_playbook</em></span>.yml -k</strong></span></pre></div></div><p class="simpara">
						Where the <code class="literal">-k</code> prompt for password to connect to remote system.
					</p></li></ol></div></section><section class="section" id="using-the-metrics-role-to-monitor-a-fleet-of-machines-centrally-via-your-local-machine_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">22.4. Using the metrics System Role to monitor a fleet of machines centrally via your local machine</h2></div></div></div><p class="_abstract _abstract">
				This procedure describes how to use the <code class="literal">metrics</code>
 System Role to set up your local machine to centrally monitor a fleet 
of machines while also provisioning visualization of the data via <code class="literal">grafana</code> and querying of the data via <code class="literal">redis</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the machine you want to use to run the playbook.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an Ansible playbook with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0pspmxm"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: localhost
  vars:
    metrics_graph_service: yes
    metrics_query_service: yes
    metrics_retention_days: 10
    metrics_monitored_hosts: ["<span class="emphasis"><em>database.example.com</em></span>", "<span class="emphasis"><em>webserver.example.com</em></span>"]
    metrics_manage_firewall: yes
    metrics_manage_selinux: yes
  roles:
    - rhel-system-roles.metrics</pre></div></div></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8477ixq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># ansible-playbook <span class="emphasis"><em>name_of_your_playbook</em></span>.yml</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Because the <code class="literal">metrics_graph_service</code> and <code class="literal">metrics_query_service</code> booleans are set to <code class="literal">value="yes"</code>, <code class="literal">grafana</code> is automatically installed and provisioned with <code class="literal">pcp</code> added as a data source with the <code class="literal">pcp</code> data recording indexed into <code class="literal">redis</code>, allowing the <code class="literal">pcp</code> querying language to be used for complex querying of the data. Because <code class="literal">metrics_manage_firewall</code> and <code class="literal">metrics_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">metrics</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">metrics</code> role.
						</p></div></div></li><li class="listitem">
						To view a graphical representation of the metrics being collected 
centrally by your machine and to query the data, access the <code class="literal">grafana</code> web interface as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/monitoring_and_managing_system_status_and_performance/index#accessing-the-grafana-web-ui_setting-up-graphical-representation-of-pcp-metrics">Accessing the Grafana web UI</a>.
					</li></ol></div></section><section class="section" id="setting-up-authentication-while-monitoring-a-system-using-the-metrics-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">22.5. Setting up authentication while monitoring a system using the metrics System Role</h2></div></div></div><p class="_abstract _abstract">
				PCP supports the <code class="literal">scram-sha-256</code> authentication mechanism through the Simple Authentication Security Layer (SASL) framework. The <code class="literal">metrics</code> RHEL&nbsp;System&nbsp;Role automates the steps to setup authentication using the <code class="literal">scram-sha-256</code> authentication mechanism. This procedure describes how to setup authentication using the <code class="literal">metrics</code> RHEL&nbsp;System&nbsp;Role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the machine you want to use to run the playbook.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Include the following variables in the Ansible playbook you want to setup authentication for:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ao873xp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
  vars:
    metrics_username: <span class="emphasis"><em>your_username</em></span>
    metrics_password: <span class="emphasis"><em>your_password</em></span>
    metrics_manage_firewall: true
    metrics_manage_selinux: true</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Because <code class="literal">metrics_manage_firewall</code> and <code class="literal">metrics_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">metrics</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">metrics</code> role.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5r6dsfl"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>name_of_your_playbook</em></span>.yml</strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify the <code class="literal">sasl</code> configuration:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yca48qf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># pminfo -f -h "pcp://<span class="emphasis"><em>ip_adress</em></span>?username=<span class="emphasis"><em>your_username</em></span>" disk.dev.read
Password:
disk.dev.read
inst [0 or "sda"] value 19540</pre></div></div><p class="simpara">
						<span class="emphasis"><em>ip_adress</em></span> should be replaced by the IP address of the host.
					</p></li></ul></div></section><section class="section" id="using-the-metrics-system-role-to-configure-and-enable-metrics-collection-for-sql-server_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">22.6. Using the metrics System Role to configure and enable metrics collection for SQL Server</h2></div></div></div><p class="_abstract _abstract">
				This procedure describes how to use the <code class="literal">metrics</code> RHEL&nbsp;System&nbsp;Role to automate the configuration and enabling of metrics collection for Microsoft SQL Server via <code class="literal">pcp</code> on your local system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the machine you want to monitor.
					</li><li class="listitem">
						You have installed Microsoft SQL Server for Red&nbsp;Hat 
Enterprise&nbsp;Linux and established a 'trusted' connection to an SQL 
server. See <a class="link" href="https://docs.microsoft.com/en-us/sql/linux/quickstart-install-connect-red-hat?view=sql-server-ver15">Install SQL Server and create a database on Red Hat</a>.
					</li><li class="listitem">
						You have installed the Microsoft ODBC driver for SQL Server for Red&nbsp;Hat Enterprise&nbsp;Linux. See <a class="link" href="https://docs.microsoft.com/en-us/sql/connect/odbc/linux-mac/installing-the-microsoft-odbc-driver-for-sql-server?view=sql-server-ver15#redhat17">Red Hat Enterprise Server and Oracle Linux</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Configure <code class="literal">localhost</code> in the <code class="literal">/etc/ansible/hosts</code> Ansible inventory by adding the following content to the inventory:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--k8yg5qu"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">localhost ansible_connection=local</pre></div></div></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook that contains the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--j4i6pk9"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">---
- hosts: localhost
  vars:
   metrics_from_mssql: true
   metrics_manage_firewall: true
   metrics_manage_selinux: true
  roles:
   - role: rhel-system-roles.metrics</pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Because <code class="literal">metrics_manage_firewall</code> and <code class="literal">metrics_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">metrics</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">metrics</code> role.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--5a6abrf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>name_of_your_playbook</em></span>.yml</strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Use the <code class="literal">pcp</code> command to verify that SQL Server PMDA agent (mssql) is loaded and running:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yk640y0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># pcp
platform: Linux rhel82-2.local 4.18.0-167.el8.x86_64 #1 SMP Sun Dec 15 01:24:23 UTC 2019 x86_64
 hardware: 2 cpus, 1 disk, 1 node, 2770MB RAM
 timezone: PDT+7
 services: pmcd pmproxy
     pmcd: Version 5.0.2-1, 12 agents, 4 clients
     pmda: root pmcd proc pmproxy xfs linux nfsclient mmv kvm <span class="strong strong"><strong>mssql</strong></span>
           jbd2 dm
 pmlogger: primary logger: /var/log/pcp/pmlogger/rhel82-2.local/20200326.16.31
     pmie: primary engine: /var/log/pcp/pmie/rhel82-2.local/pmie.log</pre></div></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://www.redhat.com/en/blog/performance-co-pilot-microsoft-sql-server-rhel-82">For more information about using Performance Co-Pilot for Microsoft SQL Server, see this Red Hat Developers Blog post.</a>
					</li></ul></div></section></section><section class="chapter" id="configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 23. Configuring a system for session recording using the tlog RHEL System Role</h1></div></div></div><p class="_abstract _abstract">
			With the <code class="literal">tlog</code> 
RHEL&nbsp;System&nbsp;Role, you can configure a system for terminal 
session recording on RHEL using Red Hat Ansible Automation Platform.
		</p><section class="section" id="the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">23.1. The tlog System Role</h2></div></div></div><p class="_abstract _abstract">
				You can configure a RHEL system for terminal session recording on RHEL using the <code class="literal">tlog</code> RHEL&nbsp;System&nbsp;Role.
			</p><p>
				You can configure the recording to take place per user or user group by means of the <code class="literal">SSSD</code> service.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more details on session recording in RHEL, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/recording_sessions/index">Recording Sessions</a>.
					</li></ul></div></section><section class="section" id="components-and-parameters-of-the-tlog-system-roles_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">23.2. Components and parameters of the tlog System Role</h2></div></div></div><p class="_abstract _abstract">
				The Session Recording solution has the following components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">tlog</code> utility
					</li><li class="listitem">
						System Security Services Daemon (SSSD)
					</li><li class="listitem">
						Optional: The web console interface
					</li></ul></div><p>
				The parameters used for the <code class="literal">tlog</code> RHEL&nbsp;System&nbsp;Role are:
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="x9afvoi" id="rh-table--x9afvoi"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604738168000" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Role Variable</th><th id="idm140604738166912" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604738168000" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								tlog_use_sssd (default: yes)
							</p>
							 </td><td headers="idm140604738166912" data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Configure session recording with SSSD, the preferred way of managing recorded users or groups
							</p>
							 </td></tr><tr><td headers="idm140604738168000" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								tlog_scope_sssd (default: none)
							</p>
							 </td><td headers="idm140604738166912" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Configure SSSD recording scope - all / some / none
							</p>
							 </td></tr><tr><td headers="idm140604738168000" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								tlog_users_sssd (default: [])
							</p>
							 </td><td headers="idm140604738166912" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								YAML list of users to be recorded
							</p>
							 </td></tr><tr><td headers="idm140604738168000" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								tlog_groups_sssd (default: [])
							</p>
							 </td><td headers="idm140604738166912" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
								YAML list of groups to be recorded
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						For details about the parameters used in <code class="literal">tlog</code> and additional information about the <code class="literal">tlog</code> System Role, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.tlog/README.md</code> file.
					</li></ul></div></section><section class="section" id="deploying-the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">23.3. Deploying the tlog RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				Follow these steps to prepare and apply an Ansible playbook to 
configure a RHEL system to log session recording data to the systemd 
journal.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have set SSH keys for access from the control node to the target system where the <code class="literal">tlog</code> System Role will be configured.
					</li><li class="listitem">
						You have at least one system that you want to configure the <code class="literal">tlog</code> System Role.
					</li><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						The <code class="literal">rhel-system-roles</code> package is installed on the control machine.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yv1s78i"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Deploy session recording
  hosts: all
  vars:
    tlog_scope_sssd: some
    tlog_users_sssd:
      - recorded-user

  roles:
    - rhel-system-roles.tlog</pre></div></div><p class="simpara">
						Where,
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<code class="literal">tlog_scope_sssd</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">some</code> specifies you want to record only certain users and groups, not <code class="literal">all</code> or <code class="literal">none</code>.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<code class="literal">tlog_users_sssd</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">recorded-user</code> specifies the user 
you want to record a session from. Note that this does not add the user 
for you. You must set the user by yourself.
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Optionally, verify the playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zgo87mp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ne5a4ud"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>IP_Address</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span> -v</pre></div></div></li></ol></div><p>
				As a result, the playbook installs the <code class="literal">tlog</code> RHEL System Role on the system you specified. The role includes <code class="literal">tlog-rec-session</code>,
 a terminal session I/O logging program, that acts as the login shell 
for a user. It also creates an SSSD configuration drop file that can be 
used by the users and groups that you define. SSSD parses and reads 
these users and groups, and replaces their user shell with <code class="literal">tlog-rec-session</code>. Additionally, if the <code class="literal">cockpit</code> package is installed on the system, the playbook also installs the <code class="literal">cockpit-session-recording</code> package, which is a <code class="literal">Cockpit</code> module that allows you to view and play recordings in the web console interface.
			</p><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					To verify that the SSSD configuration drop file is created in the system, perform the following steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the folder where the SSSD configuration drop file is created:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--uxtkdu1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cd /etc/sssd/conf.d</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Check the file content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vapm3qi"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat /etc/sssd/conf.d/sssd-session-recording.conf</strong></span></pre></div></div></li></ol></div><p>
				You can see that the file contains the parameters you set in the playbook.
			</p></section><section class="section" id="deploying-the-tlog-rhel-system-role-for-excluding-lists-of-groups-or-users_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">23.4. Deploying the tlog RHEL System Role for excluding lists of groups or users</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">tlog</code> System Role to support the SSSD session recording configuration options <code class="literal">exclude_users</code> and <code class="literal">exclude_groups</code>.
 Follow these steps to prepare and apply an Ansible playbook to 
configure a RHEL system to exclude users or groups from having their 
sessions recorded and logged in the systemd journal.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have set SSH keys for access from the control node to the target system on which you want to configure the <code class="literal">tlog</code> System Role.
					</li><li class="listitem">
						You have at least one system on which you want to configure the <code class="literal">tlog</code> System Role.
					</li><li class="listitem">
						The Ansible Core package is installed on the control machine.
					</li><li class="listitem">
						The <code class="literal">rhel-system-roles</code> package is installed on the control machine.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zr6yzr3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- name: Deploy session recording excluding users and groups
  hosts: all
  vars:
    tlog_scope_sssd: all
    tlog_exclude_users_sssd:
      - jeff
      - james
    tlog_exclude_groups_sssd:
      - admins

  roles:
    - rhel-system-roles.tlog</pre></div></div><p class="simpara">
						Where,
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								<code class="literal">tlog_scope_sssd</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">all</code>: specifies that you want to record all users and groups.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<code class="literal">tlog_exclude_users_sssd</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										user names: specifies the user names of the users you want to exclude from the session recording.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<code class="literal">tlog_exclude_groups_sssd</code>:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<code class="literal">admins</code> specifies the group you want to exclude from the session recording.
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Optionally, verify the playbook syntax;
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--j3tm72a"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mi7gf3b"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>IP_Address</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span> -v</pre></div></div></li></ol></div><p>
				As a result, the playbook installs the <code class="literal">tlog</code> RHEL System Role on the system you specified. The role includes <code class="literal">tlog-rec-session</code>, a terminal session I/O logging program, that acts as the login shell for a user. It also creates an <code class="literal">/etc/sssd/conf.d/sssd-session-recording.conf</code>
 SSSD configuration drop file that can be used by users and groups 
except those that you defined as excluded. SSSD parses and reads these 
users and groups, and replaces their user shell with <code class="literal">tlog-rec-session</code>. Additionally, if the <code class="literal">cockpit</code> package is installed on the system, the playbook also installs the <code class="literal">cockpit-session-recording</code> package, which is a <code class="literal">Cockpit</code> module that allows you to view and play recordings in the web console interface.
			</p><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					To verify that the SSSD configuration drop file is created in the system, perform the following steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the folder where the SSSD configuration drop file is created:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--w1xxbid"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cd /etc/sssd/conf.d</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Check the file content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--g96yw7d"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>cat sssd-session-recording.conf</strong></span></pre></div></div></li></ol></div><p>
				You can see that the file contains the parameters you set in the playbook.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">/usr/share/doc/rhel-system-roles/tlog/</code> and <code class="literal">/usr/share/ansible/roles/rhel-system-roles.tlog/</code> directories.
					</li><li class="listitem">
						The <a class="link" href="#recording-a-session-using-the-deployed-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" title="23.5.&nbsp;Recording a session using the deployed tlog System Role in the CLI">Recording a session using the deployed Terminal Session Recording System Role in the CLI</a>.
					</li></ul></div></section><section class="section" id="recording-a-session-using-the-deployed-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">23.5. Recording a session using the deployed tlog System Role in the CLI</h2></div></div></div><p class="_abstract _abstract">
				After you have deployed the <code class="literal">tlog</code> System
 Role in the system you have specified, you are able to record a user 
terminal session using the command-line interface (CLI).
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have deployed the <code class="literal">tlog</code> System Role in the target system.
					</li><li class="listitem">
						The SSSD configuration drop file was created in the <code class="literal">/etc/sssd/conf.d</code> directory. See <a class="link" href="#deploying-the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" title="23.3.&nbsp;Deploying the tlog RHEL&nbsp;System&nbsp;Role">Deploying the Terminal Session Recording RHEL&nbsp;System&nbsp;Role</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a user and assign a password for this user:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2ltq8nq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>useradd <span class="emphasis"><em>recorded-user</em></span></strong></span>
# <span class="strong strong"><strong>passwd <span class="emphasis"><em>recorded-user</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Log in to the system as the user you just created:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--s4rntoy"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ssh recorded-user@localhost</strong></span></pre></div></div></li><li class="listitem">
						Type "yes" when the system prompts you to type yes or no to authenticate.
					</li><li class="listitem"><p class="simpara">
						Insert the <span class="emphasis"><em>recorded-user’s</em></span> password.
					</p><p class="simpara">
						The system displays a message about your session being recorded.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9hruzc6"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">ATTENTION! Your session is being recorded!</pre></div></div></li><li class="listitem"><p class="simpara">
						After you have finished recording the session, type:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--fr37kr5"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>exit</strong></span></pre></div></div><p class="simpara">
						The system logs out from the user and closes the connection with the localhost.
					</p></li></ol></div><p>
				As a result, the user session is recorded, stored and you can play it using a journal.
			</p><div class="formalpara"><p class="title"><strong>Verification steps</strong></p><p>
					To view your recorded session in the journal, do the following steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the command below:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vzzdua0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>journalctl -o verbose -r</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Search for the <code class="literal">MESSAGE</code> field of the <code class="literal">tlog-rec</code> recorded journal entry.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--oha4oje"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>journalctl -xel _EXE=/usr/bin/tlog-rec-session</strong></span></pre></div></div></li></ol></div></section><section class="section" id="watching-a-user-recorded-session-using-the-cli_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">23.6. Watching a recorded session using the CLI</h2></div></div></div><p class="_abstract _abstract">
				You can play a user session recording from a journal using the command-line interface (CLI).
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have recorded a user session. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#recording-a-session-using-the-deployed-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles">Recording a session using the deployed tlog System Role in the CLI</a> .
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the CLI terminal, play the user session recording:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--c5fp303"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>journalctl -o verbose -r</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Search for the <code class="literal">tlog</code> recording:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6gxwtje"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">$ <span class="strong strong"><strong>/tlog-rec</strong></span></pre></div></div><p class="simpara">
						You can see details such as:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The username for the user session recording
							</li><li class="listitem">
								The <code class="literal">out_txt</code> field, a raw output encode of the recorded session
							</li><li class="listitem">
								The identifier number TLOG_REC=<span class="emphasis"><em>ID_number</em></span>
							</li></ul></div></li><li class="listitem">
						Copy the identifier number TLOG_REC=<span class="emphasis"><em>ID_number</em></span>.
					</li><li class="listitem"><p class="simpara">
						Playback the recording using the identifier number TLOG_REC=<span class="emphasis"><em>ID_number</em></span>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ooq0oqf"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>tlog-play -r journal -M TLOG_REC=<span class="emphasis"><em>ID_number</em></span></strong></span></pre></div></div></li></ol></div><p>
				As a result, you can see the user session recording terminal output being played back.
			</p></section></section><section class="chapter" id="configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 24. Configuring a high-availability cluster by using the ha_cluster RHEL System Role</h1></div></div></div><p>
			With the <code class="literal">ha_cluster</code> System Role, you can
 configure and manage a high-availability cluster that uses the 
Pacemaker high availability cluster resource manager.
		</p><section class="section" id="ha-system-role-variables_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.1. ha_cluster System Role variables</h2></div></div></div><p class="_abstract _abstract">
				In an <code class="literal">ha_cluster</code> System Role playbook, 
you define the variables for a high availability cluster according to 
the requirements of your cluster deployment.
			</p><p>
				The variables you can set for an <code class="literal">ha_cluster</code> System Role are as follows.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_enable_repos</code></span></dt><dd>
							A boolean flag that enables the repositories containing the packages that are needed by the <code class="literal">ha_cluster</code> System Role. When this variable is set to <code class="literal">true</code>,
 the default value, you have active subscription coverage for RHEL and 
the RHEL High Availability Add-On on the systems that you will use as 
your cluster members or the System Role will fail.
						</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall</code></span></dt><dd><p class="simpara">
							(RHEL 9.2 and later) A boolean flag that determines whether the <code class="literal">ha_cluster</code> System Role manages the firewall. When <code class="literal">ha_cluster_manage_firewall</code> is set to <code class="literal">true</code>, the firewall high availability service and the <code class="literal">fence-virt</code> port are enabled. When <code class="literal">ha_cluster_manage_firewall</code> is set to <code class="literal">false</code>, the <code class="literal">ha_cluster</code> System Role does not manage the firewall. If your system is running the <code class="literal">firewalld</code> service, you must set the parameter to <code class="literal">true</code> in your playbook.
						</p><p class="simpara">
							You can use the <code class="literal">ha_cluster_manage_firewall</code> parameter to add ports, but you cannot use the parameter to remove ports. To remove ports, use the <code class="literal">firewall</code> System Role directly.
						</p><p class="simpara">
							As of RHEL 9.2, the firewall is no longer configured by default, because it is configured only when <code class="literal">ha_cluster_manage_firewall</code> is set to <code class="literal">true</code>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux</code></span></dt><dd><p class="simpara">
							(RHEL 9.2 and later) A boolean flag that determines whether the <code class="literal">ha_cluster</code> System Role manages the ports belonging to the firewall high availability service using the <code class="literal">selinux</code> System Role. When <code class="literal">ha_cluster_manage_selinux</code> is set to <code class="literal">true</code>, the ports belonging to the firewall high availability service are associated with the SELinux port type <code class="literal">cluster_port_t</code>. When <code class="literal">ha_cluster_manage_selinux</code> is set to <code class="literal">false</code>, the <code class="literal">ha_cluster</code> System Role does not manage SELinux.
						</p><p class="simpara">
							If your system is running the <code class="literal">selinux</code> service, you must set this parameter to <code class="literal">true</code>
 in your playbook. Firewall configuration is a prerequisite for managing
 SELinux. If the firewall is not installed, the managing SELinux policy 
is skipped.
						</p><p class="simpara">
							You can use the <code class="literal">ha_cluster_manage_selinux</code> parameter to add policy, but you cannot use the parameter to remove policy. To remove policy, use the <code class="literal">selinux</code> System Role directly.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_cluster_present</code></span></dt><dd><p class="simpara">
							A boolean flag which, if set to <code class="literal">true</code>,
 determines that HA cluster will be configured on the hosts according to
 the variables passed to the role. Any cluster configuration not 
specified in the role and not supported by the role will be lost.
						</p><p class="simpara">
							If <code class="literal">ha_cluster_cluster_present</code> is set to <code class="literal">false</code>, all HA cluster configuration will be removed from the target hosts.
						</p><p class="simpara">
							The default value of this variable is <code class="literal">true</code>.
						</p><p class="simpara">
							The following example playbook removes all cluster configuration on <code class="literal">node1</code> and <code class="literal">node2</code>
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--02m662m"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: node1 node2
  vars:
    ha_cluster_cluster_present: false

  roles:
    - rhel-system-roles.ha_cluster</pre></div></div></dd><dt><span class="term"><code class="literal">ha_cluster_start_on_boot</code></span></dt><dd>
							A boolean flag that determines whether cluster services will be 
configured to start on boot. The default value of this variable is <code class="literal">true</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_fence_agent_packages</code></span></dt><dd>
							List of fence agent packages to install. The default value of this variable is <code class="literal">fence-agents-all</code>, <code class="literal">fence-virt</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_extra_packages</code></span></dt><dd><p class="simpara">
							List of additional packages to be installed. The default value of this variable is no packages.
						</p><p class="simpara">
							This variable can be used to install additional packages not 
installed automatically by the role, for example custom resource agents.
						</p><p class="simpara">
							It is possible to specify fence agents as members of this list. However, <code class="literal">ha_cluster_fence_agent_packages</code> is the recommended role variable to use for specifying fence agents, so that its default value is overridden.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password</code></span></dt><dd>
							A string value that specifies the password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster. It is recommended that you vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>. There is no default password value, and this variable must be specified.
						</dd><dt><span class="term"><code class="literal">ha_cluster_corosync_key_src</code></span></dt><dd><p class="simpara">
							The path to Corosync <code class="literal">authkey</code> file, 
which is the authentication and encryption key for Corosync 
communication. It is highly recommended that you have a unique <code class="literal">authkey</code> value for each cluster. The key should be 256 bytes of random data.
						</p><p class="simpara">
							If you specify a key for this variable, it is recommended that you vault encrypt the key, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p><p class="simpara">
							If no key is specified, a key already present on the nodes will 
be used. If nodes do not have the same key, a key from one node will be 
distributed to other nodes so that all nodes have the same key. If no 
node has a key, a new key will be generated and distributed to the 
nodes.
						</p><p class="simpara">
							If this variable is set, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this key.
						</p><p class="simpara">
							The default value of this variable is null.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_pacemaker_key_src</code></span></dt><dd><p class="simpara">
							The path to the Pacemaker <code class="literal">authkey</code> 
file, which is the authentication and encryption key for Pacemaker 
communication. It is highly recommended that you have a unique <code class="literal">authkey</code> value for each cluster. The key should be 256 bytes of random data.
						</p><p class="simpara">
							If you specify a key for this variable, it is recommended that you vault encrypt the key, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p><p class="simpara">
							If no key is specified, a key already present on the nodes will 
be used. If nodes do not have the same key, a key from one node will be 
distributed to other nodes so that all nodes have the same key. If no 
node has a key, a new key will be generated and distributed to the 
nodes.
						</p><p class="simpara">
							If this variable is set, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this key.
						</p><p class="simpara">
							The default value of this variable is null.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_fence_virt_key_src</code></span></dt><dd><p class="simpara">
							The path to the <code class="literal">fence-virt</code> or <code class="literal">fence-xvm</code> pre-shared key file, which is the location of the authentication key for the <code class="literal">fence-virt</code> or <code class="literal">fence-xvm</code> fence agent.
						</p><p class="simpara">
							If you specify a key for this variable, it is recommended that you vault encrypt the key, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p><p class="simpara">
							If no key is specified, a key already present on the nodes will 
be used. If nodes do not have the same key, a key from one node will be 
distributed to other nodes so that all nodes have the same key. If no 
node has a key, a new key will be generated and distributed to the 
nodes. If the <code class="literal">ha_cluster</code> System Role 
generates a new key in this fashion, you should copy the key to your 
nodes' hypervisor to ensure that fencing works.
						</p><p class="simpara">
							If this variable is set, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this key.
						</p><p class="simpara">
							The default value of this variable is null.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_pcsd_public_key_srcr</code>, <code class="literal">ha_cluster_pcsd_private_key_src</code></span></dt><dd><p class="simpara">
							The path to the <code class="literal">pcsd</code> TLS certificate
 and private key. If this is not specified, a certificate-key pair 
already present on the nodes will be used. If a certificate-key pair is 
not present, a random new one will be generated.
						</p><p class="simpara">
							If you specify a private key value for this variable, it is recommended that you vault encrypt the key, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p><p class="simpara">
							If these variables are set, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this certificate-key pair.
						</p><p class="simpara">
							The default value of these variables is null.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_pcsd_certificates</code></span></dt><dd><p class="simpara">
							(RHEL 9.2 and later) Creates a <code class="literal">pcsd</code> private key and certificate using the <code class="literal">certificate</code> System Role.
						</p><p class="simpara">
							If your system is not configured with a <code class="literal">pcsd</code> private key and certificate, you can create them in one of two ways:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Set the <code class="literal">ha_cluster_pcsd_certificates</code> variable. When you set the <code class="literal">ha_cluster_pcsd_certificates</code> variable, the <code class="literal">certificate</code> System Role is used internally and it creates the private key and certificate for <code class="literal">pcsd</code> as defined.
								</li><li class="listitem">
									Do not set the <code class="literal">ha_cluster_pcsd_public_key_src</code>, <code class="literal">ha_cluster_pcsd_private_key_src</code>, or the <code class="literal">ha_cluster_pcsd_certificates</code> variables. If you do not set any of these variables, the <code class="literal">ha_cluster</code> System Role will create <code class="literal">pcsd</code> certificates by means of <code class="literal">pcsd</code> itself. The value of <code class="literal">ha_cluster_pcsd_certificates</code> is set to the value of the variable <code class="literal">certificate_requests</code> as specified in the <code class="literal">certificate</code> System Role. For more information about the <code class="literal">certificate</code> System Role, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL System Roles</a>.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The following operational considerations apply to the use of the <code class="literal">ha_cluster_pcsd_certificate</code> variable:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Unless you are using IPA and joining the systems to an IPA domain, the <code class="literal">certificate</code>
 System Role creates self-signed certificates. In this case, you must 
explicitly configure trust settings outside of the context of RHEL 
System Roles. System Roles do not support configuring trust settings.
								</li><li class="listitem">
									When you set the <code class="literal">ha_cluster_pcsd_certificates</code> variable, do not set the <code class="literal">ha_cluster_pcsd_public_key_src</code> and <code class="literal">ha_cluster_pcsd_private_key_src</code> variables.
								</li><li class="listitem">
									When you set the <code class="literal">ha_cluster_pcsd_certificates</code> variable, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this certificate - key pair.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The default value of this variable is <code class="literal">[]</code>.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> System Role playbook that creates TLS certificates and key files in a high availability cluster, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Creating pcsd TLS certificates and key files for a high availability cluster</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_regenerate_keys</code></span></dt><dd>
							A boolean flag which, when set to <code class="literal">true</code>,
 determines that pre-shared keys and TLS certificates will be 
regenerated. For more information about when keys and certificates will 
be regenerated, see the descriptions of the <code class="literal">ha_cluster_corosync_key_src</code>, <code class="literal">ha_cluster_pacemaker_key_src</code>, <code class="literal">ha_cluster_fence_virt_key_src</code>, <code class="literal">ha_cluster_pcsd_public_key_src</code>, and <code class="literal">ha_cluster_pcsd_private_key_src</code> variables.
						</dd><dt><span class="term"><!--Empty--></span></dt><dd>
							The default value of this variable is <code class="literal">false</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_pcs_permission_list</code></span></dt><dd><p class="simpara">
							Configures permissions to manage a cluster using <code class="literal">pcsd</code>. The items you configure with this variable are as follows:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">type</code> - <code class="literal">user</code> or <code class="literal">group</code>
								</li><li class="listitem">
									<code class="literal">name</code> - user or group name
								</li><li class="listitem"><p class="simpara">
									<code class="literal">allow_list</code> - Allowed actions for the specified user or group:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">read</code> - View cluster status and settings
										</li><li class="listitem">
											<code class="literal">write</code> - Modify cluster settings except permissions and ACLs
										</li><li class="listitem">
											<code class="literal">grant</code> - Modify cluster permissions and ACLs
										</li><li class="listitem">
											<code class="literal">full</code> - Unrestricted access to a cluster including adding and removing nodes and access to keys and certificates
										</li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the <code class="literal">ha_cluster_pcs_permission_list</code> variable and its default values are as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--iwhvpg1"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_pcs_permission_list:
  - type: group
    name: hacluster
    allow_list:
      - grant
      - read
      - write</pre></div></div></dd><dt><span class="term"><code class="literal">ha_cluster_cluster_name</code></span></dt><dd>
							The name of the cluster. This is a string value with a default of <code class="literal">my-cluster</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_transport</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) Sets the cluster transport method. The items you configure with this variable are as follows:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">type</code> (optional) - Transport type: <code class="literal">knet</code>, <code class="literal">udp</code>, or <code class="literal">udpu</code>. The <code class="literal">udp</code> and <code class="literal">udpu</code> transport types support only one link. Encryption is always disabled for <code class="literal">udp</code> and <code class="literal">udpu</code>. Defaults to <code class="literal">knet</code> if not specified.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - List of name-value dictionaries with transport options.
								</li><li class="listitem">
									<code class="literal">links</code> (optional) - List of list of
 name-value dictionaries. Each list of name-value dictionaries holds 
options for one Corosync link. It is recommended that you set the <code class="literal">linknumber</code>
 value for each link. Otherwise, the first list of dictionaries is 
assigned by default to the first link, the second one to the second 
link, and so on.
								</li><li class="listitem">
									<code class="literal">compression</code> (optional) - List of name-value dictionaries configuring transport compression. Supported only with the <code class="literal">knet</code> transport type.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">crypto</code> (optional) - List of 
name-value dictionaries configuring transport encryption. By default, 
encryption is enabled. Supported only with the <code class="literal">knet</code> transport type.
								</p><p class="simpara">
									For a list of allowed options, see the <code class="literal">pcs -h cluster setup</code> help page or the <code class="literal">setup</code> description in the <code class="literal">cluster</code> section of the <code class="literal">pcs</code>(8) man page. For more detailed descriptions, see the <code class="literal">corosync.conf</code>(5) man page.
								</p><p class="simpara">
									The structure of the <code class="literal">ha_cluster_transport</code> variable is as follows:
								</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1sg827h"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_transport:
  type: knet
  options:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value
  links:
    -
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value
    -
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value
  compression:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value
  crypto:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value</pre></div></div><p class="simpara">
									For an example <code class="literal">ha_cluster</code> System Role playbook that configures a transport method, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring Corosync values in a high availability cluster</a>.
								</p></li></ul></div></dd><dt><span class="term"><code class="literal">ha_cluster_totem</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) Configures Corosync totem. For a list of allowed options, see the <code class="literal">pcs -h cluster setup</code> help page or the <code class="literal">setup</code> description in the <code class="literal">cluster</code> section of the <code class="literal">pcs</code>(8) man page. For a more detailed description, see the <code class="literal">corosync.conf</code>(5) man page.
						</p><p class="simpara">
							The structure of the <code class="literal">ha_cluster_totem</code> variable is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ke5f10r"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_totem:
  options:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value</pre></div></div><p class="simpara">
							For an example <code class="literal">ha_cluster</code> System Role playbook that configures a Corosync totem, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring Corosync values in a high availability cluster</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_quorum</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) Configures cluster quorum. You can configure the following items for cluster quorum:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">options</code> (optional) - List of name-value dictionaries configuring quorum. Allowed options are: <code class="literal">auto_tie_breaker</code>, <code class="literal">last_man_standing</code>, <code class="literal">last_man_standing_window</code>, and <code class="literal">wait_for_all</code>. For information about quorum options, see the <code class="literal">votequorum</code>(5) man page.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">device</code> (optional) - (RHEL 9.2 and later) Configures the cluster to use a quorum device. By default, no quorum device is used.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">model</code> (mandatory) - Specifies a quorum device model. Only <code class="literal">net</code> is supported
										</li><li class="listitem"><p class="simpara">
											<code class="literal">model_options</code> (optional) - List of name-value dictionaries configuring the specified quorum device model. For model <code class="literal">net</code>, you must specify <code class="literal">host</code> and <code class="literal">algorithm</code> options.
										</p><p class="simpara">
											Use the <code class="literal">pcs-address</code> option to set a custom <code class="literal">pcsd</code> address and port to connect to the <code class="literal">qnetd</code> host. If you do not specify this option, the role connects to the default <code class="literal">pcsd</code> port on the <code class="literal">host</code>.
										</p></li><li class="listitem">
											<code class="literal">generic_options</code> (optional) - List of name-value dictionaries setting quorum device options that are not model specific.
										</li><li class="listitem"><p class="simpara">
											<code class="literal">heuristics_options</code> (optional) - List of name-value dictionaries configuring quorum device heuristics.
										</p><p class="simpara">
											For information about quorum device options, see the <code class="literal">corosync-qdevice</code>(8) man page. The generic options are <code class="literal">sync_timeout</code> and <code class="literal">timeout</code>. For model <code class="literal">net</code> options see the <code class="literal">quorum.device.net</code> section. For heuristics options, see the <code class="literal">quorum.device.heuristics</code> section.
										</p><p class="simpara">
											To regenerate a quorum device TLS certificate, set the <code class="literal">ha_cluster_regenerate_keys</code> variable to <code class="literal">true</code>.
										</p></li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the <code class="literal">ha_cluster_quorum</code> variable is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--7epvz8t"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_quorum:
  options:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value
  device:
    model: string
    model_options:
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value
    generic_options:
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value
    heuristics_options:
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value</pre></div></div><p class="simpara">
							For an example <code class="literal">ha_cluster</code> System Role playbook that configures cluster quorum, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring Corosync values in a high availability cluster</a>. For an example <code class="literal">ha_cluster</code> System Role playbook that configures a cluster using a quorum device, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster using a quorum device</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_sbd_enabled</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) A boolean flag which determines whether the 
cluster can use the SBD node fencing mechanism. The default value of 
this variable is <code class="literal">false</code>.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> System Role playbook that enables SBD, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-sbd_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with SBD node fencing</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_sbd_options</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) List of name-value dictionaries specifying SBD options. Supported options are:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">delay-start</code> - defaults to <code class="literal">no</code>
								</li><li class="listitem">
									<code class="literal">startmode</code> - defaults to <code class="literal">always</code>
								</li><li class="listitem">
									<code class="literal">timeout-action</code> - defaults to <code class="literal">flush,reboot</code>
								</li><li class="listitem"><p class="simpara">
									<code class="literal">watchdog-timeout</code> - defaults to <code class="literal">5</code>
								</p><p class="simpara">
									For information about these options, see the <code class="literal">Configuration via environment</code> section of the <code class="literal">sbd</code>(8) man page.
								</p></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							For an example <code class="literal">ha_cluster</code> System Role playbook that configures SBD options, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-sbd_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with SBD node fencing</a>.
						</p><p class="simpara">
							When using SBD, you can optionally configure watchdog and SBD 
devices for each node in an inventory. For information about configuring
 watchdog and SBD devices in an inventory file, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Specifying an inventory for the ha_cluster System Role</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_cluster_properties</code></span></dt><dd><p class="simpara">
							List of sets of cluster properties for Pacemaker cluster-wide 
configuration. Only one set of cluster properties is supported.
						</p><p class="simpara">
							The structure of a set of cluster properties is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ac6m3la"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_cluster_properties:
  - attrs:
      - name: property1_name
        value: property1_value
      - name: property2_name
        value: property2_value</pre></div></div><p class="simpara">
							By default, no properties are set.
						</p><p class="simpara">
							The following example playbook configures a cluster consisting of <code class="literal">node1</code> and <code class="literal">node2</code> and sets the <code class="literal">stonith-enabled</code> and <code class="literal">no-quorum-policy</code> cluster properties.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--mlqb2op"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: node1 node2
  vars:
    ha_cluster_cluster_name: my-new-cluster
    ha_cluster_hacluster_password: password
    ha_cluster_cluster_properties:
      - attrs:
          - name: stonith-enabled
            value: 'true'
          - name: no-quorum-policy
            value: stop

  roles:
    - rhel-system-roles.ha_cluster</pre></div></div></dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives</code></span></dt><dd><p class="simpara">
							This variable defines pacemaker resources configured by the 
System Role, including stonith resources, including stonith resources. 
You can configure the following items for each resource:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">id</code> (mandatory) - ID of a resource.
								</li><li class="listitem">
									<code class="literal">agent</code> (mandatory) - Name of a resource or stonith agent, for example <code class="literal">ocf:pacemaker:Dummy</code> or <code class="literal">stonith:fence_xvm</code>. It is mandatory to specify <code class="literal">stonith:</code> for stonith agents. For resource agents, it is possible to use a short name, such as <code class="literal">Dummy</code>, instead of <code class="literal">ocf:pacemaker:Dummy</code>.
 However, if several agents with the same short name are installed, the 
role will fail as it will be unable to decide which agent should be 
used. Therefore, it is recommended that you use full names when 
specifying a resource agent.
								</li><li class="listitem">
									<code class="literal">instance_attrs</code> (optional) - List 
of sets of the resource’s instance attributes. Currently, only one set 
is supported. The exact names and values of attributes, as well as 
whether they are mandatory or not, depend on the resource or stonith 
agent.
								</li><li class="listitem">
									<code class="literal">meta_attrs</code> (optional) - List of sets of the resource’s meta attributes. Currently, only one set is supported.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">operations</code> (optional) - List of the resource’s operations.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">action</code> (mandatory) - Operation action as defined by pacemaker and the resource or stonith agent.
										</li><li class="listitem">
											<code class="literal">attrs</code> (mandatory) - Operation options, at least one option must be specified.
										</li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the resource definition that you configure with the <code class="literal">ha_cluster</code> System Role is as follows.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wnyo40e"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">  - id: resource-id
    agent: resource-agent
    instance_attrs:
      - attrs:
          - name: attribute1_name
            value: attribute1_value
          - name: attribute2_name
            value: attribute2_value
    meta_attrs:
      - attrs:
          - name: meta_attribute1_name
            value: meta_attribute1_value
          - name: meta_attribute2_name
            value: meta_attribute2_value
    operations:
      - action: operation1-action
        attrs:
          - name: operation1_attribute1_name
            value: operation1_attribute1_value
          - name: operation1_attribute2_name
            value: operation1_attribute2_value
      - action: operation2-action
        attrs:
          - name: operation2_attribute1_name
            value: operation2_attribute1_value
          - name: operation2_attribute2_name
            value: operation2_attribute2_value</pre></div></div><p class="simpara">
							By default, no resources are defined.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> System Role playbook that includes resource configuration, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with fencing and resources</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_resource_groups</code></span></dt><dd><p class="simpara">
							This variable defines pacemaker resource groups configured by the
 System Role. You can configure the following items for each resource 
group:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">id</code> (mandatory) - ID of a group.
								</li><li class="listitem">
									<code class="literal">resources</code> (mandatory) - List of the group’s resources. Each resource is referenced by its ID and the resources must be defined in the <code class="literal">ha_cluster_resource_primitives</code> variable. At least one resource must be listed.
								</li><li class="listitem">
									<code class="literal">meta_attrs</code> (optional) - List of sets of the group’s meta attributes. Currently, only one set is supported.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the resource group definition that you configure with the <code class="literal">ha_cluster</code> System Role is as follows.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2uku4y4"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_resource_groups:
  - id: group-id
    resource_ids:
      - resource1-id
      - resource2-id
    meta_attrs:
      - attrs:
          - name: group_meta_attribute1_name
            value: group_meta_attribute1_value
          - name: group_meta_attribute2_name
            value: group_meta_attribute2_value</pre></div></div><p class="simpara">
							By default, no resource groups are defined.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> System Role playbook that includes resource group configuration, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with fencing and resources</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_resource_clones</code></span></dt><dd><p class="simpara">
							This variable defines pacemaker resource clones configured by the
 System Role. You can configure the following items for a resource 
clone:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">resource_id</code> (mandatory) - Resource to be cloned. The resource must be defined in the <code class="literal">ha_cluster_resource_primitives</code> variable or the <code class="literal">ha_cluster_resource_groups</code> variable.
								</li><li class="listitem">
									<code class="literal">promotable</code> (optional) - Indicates whether the resource clone to be created is a promotable clone, indicated as <code class="literal">true</code> or <code class="literal">false</code>.
								</li><li class="listitem">
									<code class="literal">id</code> (optional) - Custom ID of the 
clone. If no ID is specified, it will be generated. A warning will be 
displayed if this option is not supported by the cluster.
								</li><li class="listitem">
									<code class="literal">meta_attrs</code> (optional) - List of sets of the clone’s meta attributes. Currently, only one set is supported.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the resource clone definition that you configure with the <code class="literal">ha_cluster</code> System Role is as follows.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9u53mbk"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_resource_clones:
  - resource_id: resource-to-be-cloned
    promotable: true
    id: custom-clone-id
    meta_attrs:
      - attrs:
          - name: clone_meta_attribute1_name
            value: clone_meta_attribute1_value
          - name: clone_meta_attribute2_name
            value: clone_meta_attribute2_value</pre></div></div><p class="simpara">
							By default, no resource clones are defined.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> System Role playbook that includes resource clone configuration, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with fencing and resources</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_constraints_location</code></span></dt><dd><p class="simpara">
							This variable defines resource location constraints. Resource 
location constraints indicate which nodes a resource can run on. You can
 specify a resources specified by a resource ID or by a pattern, which 
can match more than one resource. You can specify a node by a node name 
or by a rule.
						</p><p class="simpara">
							You can configure the following items for a resource location constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">resource</code> (mandatory) - Specification of a resource the constraint applies to.
								</li><li class="listitem">
									<code class="literal">node</code> (mandatory) - Name of a node the resource should prefer or avoid.
								</li><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the constraint. If not specified, it will be autogenerated.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">options</code> (optional) - List of name-value dictionaries.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
											<code class="literal">score</code> - Sets the weight of the constraint.
										</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
													A positive <code class="literal">score</code> value means the resource prefers running on the node.
												</li><li class="listitem">
													A negative <code class="literal">score</code> value means the resource should avoid running on the node.
												</li><li class="listitem">
													A <code class="literal">score</code> value of <code class="literal">-INFINITY</code> means the resource must avoid running on the node.
												</li><li class="listitem">
													If <code class="literal">score</code> is not specified, the score value defaults to <code class="literal">INFINITY</code>.
												</li></ul></div></li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							By default no resource location constraints are defined.
						</p><p class="simpara">
							The structure of a resource location constraint specifying a resource ID and node name is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--bu9l1tx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_location:
  - resource:
      id: resource-id
    node: node-name
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre></div></div><p class="simpara">
							The items that you configure for a resource location constraint 
that specifies a resource pattern are the same items that you configure 
for a resource location constraint that specifies a resource ID, with 
the exception of the resource specification itself. The item that you 
specify for the resource specification is as follows:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">pattern</code> (mandatory) - POSIX extended regular expression resource IDs are matched against.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource location constraint specifying a resource pattern and node name is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6x2rf6j"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_location:
  - resource:
      pattern: resource-pattern
    node: node-name
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: resource-discovery
        value: resource-discovery-value</pre></div></div><p class="simpara">
							You can configure the following items for a resource location constraint that specifies a resource ID and a rule:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource</code> (mandatory) - Specification of a resource the constraint applies to.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">role</code> (optional) - The resource role to which the constraint is limited: <code class="literal">Started</code>, <code class="literal">Unpromoted</code>, <code class="literal">Promoted</code>.
										</li></ul></div></li><li class="listitem">
									<code class="literal">rule</code> (mandatory) - Constraint rule written using <code class="literal">pcs</code> syntax. For further information, see the <code class="literal">constraint location</code> section of the <code class="literal">pcs</code>(8) man page.
								</li><li class="listitem">
									Other items to specify have the same meaning as for a resource constraint that does not specify a rule.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource location constraint that specifies a resource ID and a rule is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2ahlli7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_location:
  - resource:
      id: resource-id
      role: resource-role
    rule: rule-string
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: resource-discovery
        value: resource-discovery-value</pre></div></div><p class="simpara">
							The items that you configure for a resource location constraint 
that specifies a resource pattern and a rule are the same items that you
 configure for a resource location constraint that specifies a resource 
ID and a rule, with the exception of the resource specification itself. 
The item that you specify for the resource specification is as follows:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">pattern</code> (mandatory) - POSIX extended regular expression resource IDs are matched against.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource location constraint that specifies a resource pattern and a rule is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--8n9v4tj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_location:
  - resource:
      pattern: resource-pattern
      role: resource-role
    rule: rule-string
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: resource-discovery
        value: resource-discovery-value</pre></div></div><p class="simpara">
							For an example <code class="literal">ha_cluster</code> system role playbook that creates a cluster with resource constraints, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with resource constraints</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_constraints_colocation</code></span></dt><dd><p class="simpara">
							This variable defines resource colocation constraints. Resource 
colocation constraints indicate that the location of one resource 
depends on the location of another one. There are two types of 
colocation constraints: a simple colocation constraint for two 
resources, and a set colocation constraint for multiple resources.
						</p><p class="simpara">
							You can configure the following items for a simple resource colocation constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_follower</code> (mandatory) - A resource that should be located relative to <code class="literal">resource_leader</code>.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">role</code> (optional) - The resource role to which the constraint is limited: <code class="literal">Started</code>, <code class="literal">Unpromoted</code>, <code class="literal">Promoted</code>.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									<code class="literal">resource_leader</code> (mandatory) - The cluster will decide where to put this resource first and then decide where to put <code class="literal">resource_follower</code>.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">role</code> (optional) - The resource role to which the constraint is limited: <code class="literal">Started</code>, <code class="literal">Unpromoted</code>, <code class="literal">Promoted</code>.
										</li></ul></div></li><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the constraint. If not specified, it will be autogenerated.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">options</code> (optional) - List of name-value dictionaries.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
											<code class="literal">score</code> - Sets the weight of the constraint.
										</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
													Positive <code class="literal">score</code> values indicate the resources should run on the same node.
												</li><li class="listitem">
													Negative <code class="literal">score</code> values indicate the resources should run on different nodes.
												</li><li class="listitem">
													A <code class="literal">score</code> value of <code class="literal">+INFINITY</code> indicates the resources must run on the same node.
												</li><li class="listitem">
													A <code class="literal">score</code> value of <code class="literal">-INFINITY</code> indicates the resources must run on different nodes.
												</li><li class="listitem">
													If <code class="literal">score</code> is not specified, the score value defaults to <code class="literal">INFINITY</code>.
												</li></ul></div></li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							By default no resource colocation constraints are defined.
						</p><p class="simpara">
							The structure of a simple resource colocation constraint is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6ttuw7r"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_colocation:
  - resource_follower:
      id: resource-id1
      role: resource-role1
    resource_leader:
      id: resource-id2
      role: resource-role2
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre></div></div><p class="simpara">
							You can configure the following items for a resource set colocation constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_sets</code> (mandatory) - List of resource sets.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">resource_ids</code> (mandatory) - List of resources in a set.
										</li><li class="listitem">
											<code class="literal">options</code> (optional) - List of name-value dictionaries fine-tuning how resources in the sets are treated by the constraint.
										</li></ul></div></li><li class="listitem">
									<code class="literal">id</code> (optional) - Same values as for a simple colocation constraint.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - Same values as for a simple colocation constraint.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource set colocation constraint is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ukwr5ka"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_colocation:
  - resource_sets:
      - resource_ids:
          - resource-id1
          - resource-id2
        options:
          - name: option-name
            value: option-value
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre></div></div><p class="simpara">
							For an example <code class="literal">ha_cluster</code> system role playbook that creates a cluster with resource constraints, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with resource constraints</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_constraints_order</code></span></dt><dd><p class="simpara">
							This variable defines resource order constraints. Resource order 
constraints indicate the order in which certain resource actions should 
occur. There are two types of resource order constraints: a simple order
 constraint for two resources, and a set order constraint for multiple 
resources.
						</p><p class="simpara">
							You can configure the following items for a simple resource order constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_first</code> (mandatory) - Resource that the <code class="literal">resource_then</code> resource depends on.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">action</code> (optional) - The action that must complete before an action can be initiated for the <code class="literal">resource_then</code> resource. Allowed values: <code class="literal">start</code>, <code class="literal">stop</code>, <code class="literal">promote</code>, <code class="literal">demote</code>.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									<code class="literal">resource_then</code> (mandatory) - The dependent resource.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">action</code> (optional) - The action that the resource can execute only after the action on the <code class="literal">resource_first</code> resource has completed. Allowed values: <code class="literal">start</code>, <code class="literal">stop</code>, <code class="literal">promote</code>, <code class="literal">demote</code>.
										</li></ul></div></li><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the constraint. If not specified, it will be autogenerated.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - List of name-value dictionaries.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							By default no resource order constraints are defined.
						</p><p class="simpara">
							The structure of a simple resource order constraint is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--9r0hm2j"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_order:
  - resource_first:
      id: resource-id1
      action: resource-action1
    resource_then:
      id: resource-id2
      action: resource-action2
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre></div></div><p class="simpara">
							You can configure the following items for a resource set order constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_sets</code> (mandatory) - List of resource sets.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">resource_ids</code> (mandatory) - List of resources in a set.
										</li><li class="listitem">
											<code class="literal">options</code> (optional) - List of name-value dictionaries fine-tuning how resources in the sets are treated by the constraint.
										</li></ul></div></li><li class="listitem">
									<code class="literal">id</code> (optional) - Same values as for a simple order constraint.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - Same values as for a simple order constraint.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource set order constraint is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--p4pwwzj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_order:
  - resource_sets:
      - resource_ids:
          - resource-id1
          - resource-id2
        options:
          - name: option-name
            value: option-value
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre></div></div><p class="simpara">
							For an example <code class="literal">ha_cluster</code> system role playbook that creates a cluster with resource constraints, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with resource constraints</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_constraints_ticket</code></span></dt><dd><p class="simpara">
							This variable defines resource ticket constraints. Resource 
ticket constraints indicate the resources that depend on a certain 
ticket. There are two types of resource ticket constraints: a simple 
ticket constraint for one resource, and a ticket order constraint for 
multiple resources.
						</p><p class="simpara">
							You can configure the following items for a simple resource ticket constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource</code> (mandatory) - Specification of a resource the constraint applies to.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">role</code> (optional) - The resource role to which the constraint is limited: <code class="literal">Started</code>, <code class="literal">Unpromoted</code>, <code class="literal">Promoted</code>.
										</li></ul></div></li><li class="listitem">
									<code class="literal">ticket</code> (mandatory) - Name of a ticket the resource depends on.
								</li><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the constraint. If not specified, it will be autogenerated.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">options</code> (optional) - List of name-value dictionaries.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">loss-policy</code> (optional) - Action to perform on the resource if the ticket is revoked.
										</li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							By default no resource ticket constraints are defined.
						</p><p class="simpara">
							The structure of a simple resource ticket constraint is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--wquv9tj"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_ticket:
  - resource:
      id: resource-id
      role: resource-role
    ticket: ticket-name
    id: constraint-id
    options:
      - name: loss-policy
        value: loss-policy-value
      - name: option-name
        value: option-value</pre></div></div><p class="simpara">
							You can configure the following items for a resource set ticket constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_sets</code> (mandatory) - List of resource sets.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">resource_ids</code> (mandatory) - List of resources in a set.
										</li><li class="listitem">
											<code class="literal">options</code> (optional) - List of name-value dictionaries fine-tuning how resources in the sets are treated by the constraint.
										</li></ul></div></li><li class="listitem">
									<code class="literal">ticket</code> (mandatory) - Same value as for a simple ticket constraint.
								</li><li class="listitem">
									<code class="literal">id</code> (optional) - Same value as for a simple ticket constraint.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - Same values as for a simple ticket constraint.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource set ticket constraint is as follows:
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ga9tnm0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">ha_cluster_constraints_ticket:
  - resource_sets:
      - resource_ids:
          - resource-id1
          - resource-id2
        options:
          - name: option-name
            value: option-value
    ticket: ticket-name
    id: constraint-id
    options:
      - name: option-name
        value: option-value</pre></div></div><p class="simpara">
							For an example <code class="literal">ha_cluster</code> system role playbook that creates a cluster with resource constraints, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with resource constraints</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_qnetd</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) This variable configures a <code class="literal">qnetd</code> host which can then serve as an external quorum device for clusters.
						</p><p class="simpara">
							You can configure the following items for a <code class="literal">qnetd</code> host:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">present</code> (optional) - If <code class="literal">true</code>, configure a <code class="literal">qnetd</code> instance on the host. If <code class="literal">false</code>, remove <code class="literal">qnetd</code> configuration from the host. The default value is <code class="literal">false</code>. If you set this <code class="literal">true</code>, you must set <code class="literal">ha_cluster_cluster_present</code> to <code class="literal">false</code>.
								</li><li class="listitem">
									<code class="literal">start_on_boot</code> (optional) - Configures whether the <code class="literal">qnetd</code> instance should start automatically on boot. The default value is <code class="literal">true</code>.
								</li><li class="listitem">
									<code class="literal">regenerate_keys</code> (optional) - Set this variable to <code class="literal">true</code> to regenerate the <code class="literal">qnetd</code> TLS certificate. If you regenerate the certificate, you must either re-run the role for each cluster to connect it to the <code class="literal">qnetd</code> host again or run <code class="literal">pcs</code> manually.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							You cannot run <code class="literal">qnetd</code> on a cluster node because fencing would disrupt <code class="literal">qnetd</code> operation.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> System Role playbook that configures a cluster using a quorum device, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a cluster using a quorum device</a>.
						</p></dd></dl></div></section><section class="section" id="ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.2. Specifying an inventory for the ha_cluster System Role</h2></div></div></div><p class="_abstract _abstract">
				When configuring an HA cluster using the <code class="literal">ha_cluster</code> System Role playbook, you configure the names and addresses of the nodes for the cluster in an inventory.
			</p><section class="section" id="configuring_node_names_and_addresses_in_an_inventory"><div class="titlepage"><div><div><h3 class="title">24.2.1. Configuring node names and addresses in an inventory</h3></div></div></div><p>
					For each node in an inventory, you can optionally specify the following items:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">node_name</code> - the name of a node in a cluster.
						</li><li class="listitem">
							<code class="literal">pcs_address</code> - an address used by <code class="literal">pcs</code> to communicate with the node. It can be a name, FQDN or an IP address and it can include a port number.
						</li><li class="listitem">
							<code class="literal">corosync_addresses</code> - list of 
addresses used by Corosync. All nodes which form a particular cluster 
must have the same number of addresses and the order of the addresses 
matters.
						</li></ul></div><p>
					The following example shows an inventory with targets <code class="literal">node1</code> and <code class="literal">node2</code>. <code class="literal">node1</code> and <code class="literal">node2</code>
 must be either fully qualified domain names or must otherwise be able 
to connect to the nodes as when, for example, the names are resolvable 
through the <code class="literal">/etc/hosts</code> file.
				</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--l72y78m"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">all:
  hosts:
    node1:
      ha_cluster:
        node_name: node-A
        pcs_address: node1-address
        corosync_addresses:
          - 192.168.1.11
          - 192.168.2.11
    node2:
      ha_cluster:
        node_name: node-B
        pcs_address: node2-address:2224
        corosync_addresses:
          - 192.168.1.12
          - 192.168.2.12</pre></div></div></section><section class="section" id="configuring_watchdog_and_sbd_devices_in_an_inventory_rhel_9_1_and_later"><div class="titlepage"><div><div><h3 class="title">24.2.2. Configuring watchdog and SBD devices in an inventory (RHEL 9.1 and later)</h3></div></div></div><p>
					When using SBD, you can optionally configure watchdog and SBD 
devices for each node in an inventory. Even though all SBD devices must 
be shared to and accesible from all nodes, each node can use different 
names for the devices. Watchdog devices can be different for each node 
as well. For information about the SBD variables you can set in a system
 role playbook, see the entries for <code class="literal">ha_cluster_sbd_enabled</code> and <code class="literal">ha_cluster_sbd_options</code> in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles#ha-system-role-variables_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><code class="literal">ha_cluster</code> System Role variables</a>.
				</p><p>
					For each node in an inventory, you can optionally specify the following items:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">sbd_watchdog</code> - Watchdog device to be used by SBD. Defaults to <code class="literal">/dev/watchdog</code> if not set.
						</li><li class="listitem">
							<code class="literal">sbd_devices</code> - Devices to use for exchanging SBD messages and for monitoring. Defaults to empty list if not set.
						</li></ul></div><p>
					The following example shows an inventory that configures watchdog and SBD devices for targets <code class="literal">node1</code> and <code class="literal">node2</code>.
				</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--3ajs56s"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">all:
  hosts:
    node1:
      ha_cluster:
        sbd_watchdog: /dev/watchdog2
        sbd_devices:
          - /dev/vdx
          - /dev/vdy
    node2:
      ha_cluster:
        sbd_watchdog: /dev/watchdog1
        sbd_devices:
          - /dev/vdw
          - /dev/vdz</pre></div></div></section></section><section class="section" id="configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.3. Creating pcsd TLS certificates and key files for a high availability cluster (RHEL 9.2 and later)</h2></div></div></div><p>
				You can use the <code class="literal">ha_cluster</code> System Role to create TLS certificates and key files in a high availability cluster. When you run this playbook, the <code class="literal">ha_cluster</code> System Role uses the <code class="literal">certificate</code> System Role internally to manage TLS certificates.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">ansible-core</code> and the <code class="literal">rhel-system-roles</code> packages are installed on the node from which you want to run the playbook.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You do not need to have <code class="literal">ansible-core</code> installed on the cluster member nodes.
						</p></div></div></li><li class="listitem">
						The systems that you will use as your cluster members have active 
subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> System Role replaces 
any existing cluster configuration on the specified nodes. Any settings 
not specified in the role will be lost.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Create an inventory file specifying the nodes in the cluster, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Specifying an inventory for the ha_cluster System Role</a>.
					</li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">new-cluster.yml</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When creating your playbook file for production, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p></div></div><p class="simpara">
						The following example playbook file configures a cluster running the <code class="literal">firewalld</code> and <code class="literal">selinux</code> services and creates a self-signed <code class="literal">pcsd</code> certificate and private key files in <code class="literal">/var/lib/pcsd</code>. The <code class="literal">pcsd</code> certificate has the file name <code class="literal">FILENAME.crt</code> and the key file is named <code class="literal">FILENAME.key</code>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--6i3lzn9"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: node1 node2
  vars:
    ha_cluster_cluster_name: my-new-cluster
    ha_cluster_hacluster_password: password
    ha_cluster_manage_firewall: true
    ha_cluster_manage_selinux: true
    ha_cluster_pcsd_certificates:
      - name: FILENAME
        common_name: "{{ ansible_hostname }}"
        ca: self-sign
  roles:
    - linux-system-roles.ha_cluster</pre></div></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook, specifying the path to the inventory file <span class="emphasis"><em>inventory</em></span> you created in Step 1.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ahncsei"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory</em></span> new-cluster.yml</strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL System Roles</a>
					</li></ul></div></section><section class="section" id="configuring-no-resource-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.4. Configuring a high availability cluster running no resources</h2></div></div></div><p class="_abstract _abstract">
				The following procedure uses the <code class="literal">ha_cluster</code> System Role, to create a high availability cluster with no fencing configured and which runs no resources.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have <code class="literal">ansible-core</code> installed on the node from which you want to run the playbook.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You do not need to have <code class="literal">ansible-core</code> installed on the cluster member nodes.
						</p></div></div></li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active 
subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> System Role replaces 
any existing cluster configuration on the specified nodes. Any settings 
not specified in the role will be lost.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Create an inventory file specifying the nodes in the cluster, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Specifying an inventory for the ha_cluster System Role</a>.
					</li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">new-cluster.yml</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When creating your playbook file for production, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p></div></div><p class="simpara">
						The following example playbook file configures a cluster running the <code class="literal">firewalld</code> and <code class="literal">selinux</code> services with no fencing configured and which runs no resources.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--gyquufx"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: node1 node2
  vars:
    ha_cluster_cluster_name: my-new-cluster
    ha_cluster_hacluster_password: password
    ha_cluster_manage_firewall: true
    ha_cluster_manage_selinux: true

  roles:
    - rhel-system-roles.ha_cluster</pre></div></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook, specifying the path to the inventory file <span class="emphasis"><em>inventory</em></span> you created in Step 1.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--vidpc6v"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory</em></span> new-cluster.yml</strong></span></pre></div></div></li></ol></div></section><section class="section" id="configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.5. Configuring a high availability cluster with fencing and resources</h2></div></div></div><p class="_abstract _abstract">
				The following procedure uses the <code class="literal">ha_cluster</code>
 System Role to create a high availability cluster that includes a 
fencing device, cluster resources, resource groups, and a cloned 
resource.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have <code class="literal">ansible-core</code> installed on the node from which you want to run the playbook.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You do not need to have <code class="literal">ansible-core</code> installed on the cluster member nodes.
						</p></div></div></li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active 
subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> System Role replaces 
any existing cluster configuration on the specified nodes. Any settings 
not specified in the role will be lost.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Create an inventory file specifying the nodes in the cluster, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Specifying an inventory for the ha_cluster System Role</a>.
					</li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">new-cluster.yml</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When creating your playbook file for production, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p></div></div><p class="simpara">
						The following example playbook file configures a cluster running the <code class="literal">firewalld</code> and <code class="literal">selinux</code>
 services. The cluster includes fencing, several resources, and a 
resource group. It also includes a resource clone for the resource 
group.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--caggovq"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: node1 node2
  vars:
    ha_cluster_cluster_name: my-new-cluster
    ha_cluster_hacluster_password: password
    ha_cluster_manage_firewall: true
    ha_cluster_manage_selinux: true
    ha_cluster_resource_primitives:
      - id: xvm-fencing
        agent: 'stonith:fence_xvm'
        instance_attrs:
          - attrs:
              - name: pcmk_host_list
                value: node1 node2
      - id: simple-resource
        agent: 'ocf:pacemaker:Dummy'
      - id: resource-with-options
        agent: 'ocf:pacemaker:Dummy'
        instance_attrs:
          - attrs:
              - name: fake
                value: fake-value
              - name: passwd
                value: passwd-value
        meta_attrs:
          - attrs:
              - name: target-role
                value: Started
              - name: is-managed
                value: 'true'
        operations:
          - action: start
            attrs:
              - name: timeout
                value: '30s'
          - action: monitor
            attrs:
              - name: timeout
                value: '5'
              - name: interval
                value: '1min'
      - id: dummy-1
        agent: 'ocf:pacemaker:Dummy'
      - id: dummy-2
        agent: 'ocf:pacemaker:Dummy'
      - id: dummy-3
        agent: 'ocf:pacemaker:Dummy'
      - id: simple-clone
        agent: 'ocf:pacemaker:Dummy'
      - id: clone-with-options
        agent: 'ocf:pacemaker:Dummy'
    ha_cluster_resource_groups:
      - id: simple-group
        resource_ids:
          - dummy-1
          - dummy-2
        meta_attrs:
          - attrs:
              - name: target-role
                value: Started
              - name: is-managed
                value: 'true'
      - id: cloned-group
        resource_ids:
          - dummy-3
    ha_cluster_resource_clones:
      - resource_id: simple-clone
      - resource_id: clone-with-options
        promotable: yes
        id: custom-clone-id
        meta_attrs:
          - attrs:
              - name: clone-max
                value: '2'
              - name: clone-node-max
                value: '1'
      - resource_id: cloned-group
        promotable: yes

  roles:
    - rhel-system-roles.ha_cluster</pre></div></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook, specifying the path to the inventory file <span class="emphasis"><em>inventory</em></span> you created in Step 1.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--kkqtnnk"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory</em></span> new-cluster.yml</strong></span></pre></div></div></li></ol></div></section><section class="section" id="configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.6. Configuring a high availability cluster with resource constraints</h2></div></div></div><p class="_abstract _abstract">
				The following procedure uses the <code class="literal">ha_cluster</code>
 system role to create a high availability cluster that includes 
resource location constraints, resource colocation constraints, resource
 order constraints, and resource ticket constraints.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have <code class="literal">ansible-core</code> installed on the node from which you want to run the playbook.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You do not need to have <code class="literal">ansible-core</code> installed on the cluster member nodes.
						</p></div></div></li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active 
subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> system role replaces 
any existing cluster configuration on the specified nodes. Any settings 
not specified in the role will be lost.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Create an inventory file specifying the nodes in the cluster, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Specifying an inventory for the ha_cluster System Role</a>.
					</li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">new-cluster.yml</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When creating your playbook file for production, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p></div></div><p class="simpara">
						The following example playbook file configures a cluster running the <code class="literal">firewalld</code> and <code class="literal">selinux</code>
 services. The cluster includes resource location constraints, resource 
colocation constraints, resource order constraints, and resource ticket 
constraints.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0p480d0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: node1 node2
  vars:
    ha_cluster_cluster_name: my-new-cluster
    ha_cluster_hacluster_password: password
    ha_cluster_manage_firewall: true
    ha_cluster_manage_selinux: true
    # In order to use constraints, we need resources the constraints will apply
    # to.
    ha_cluster_resource_primitives:
      - id: xvm-fencing
        agent: 'stonith:fence_xvm'
        instance_attrs:
          - attrs:
              - name: pcmk_host_list
                value: node1 node2
      - id: dummy-1
        agent: 'ocf:pacemaker:Dummy'
      - id: dummy-2
        agent: 'ocf:pacemaker:Dummy'
      - id: dummy-3
        agent: 'ocf:pacemaker:Dummy'
      - id: dummy-4
        agent: 'ocf:pacemaker:Dummy'
      - id: dummy-5
        agent: 'ocf:pacemaker:Dummy'
      - id: dummy-6
        agent: 'ocf:pacemaker:Dummy'
    # location constraints
    ha_cluster_constraints_location:
      # resource ID and node name
      - resource:
          id: dummy-1
        node: node1
        options:
          - name: score
            value: 20
      # resource pattern and node name
      - resource:
          pattern: dummy-\d+
        node: node1
        options:
          - name: score
            value: 10
      # resource ID and rule
      - resource:
          id: dummy-2
        rule: '#uname eq node2 and date in_range 2022-01-01 to 2022-02-28'
      # resource pattern and rule
      - resource:
          pattern: dummy-\d+
        rule: node-type eq weekend and date-spec weekdays=6-7
    # colocation constraints
    ha_cluster_constraints_colocation:
      # simple constraint
      - resource_leader:
          id: dummy-3
        resource_follower:
          id: dummy-4
        options:
          - name: score
            value: -5
      # set constraint
      - resource_sets:
          - resource_ids:
              - dummy-1
              - dummy-2
          - resource_ids:
              - dummy-5
              - dummy-6
            options:
              - name: sequential
                value: "false"
        options:
          - name: score
            value: 20
    # order constraints
    ha_cluster_constraints_order:
      # simple constraint
      - resource_first:
          id: dummy-1
        resource_then:
          id: dummy-6
        options:
          - name: symmetrical
            value: "false"
      # set constraint
      - resource_sets:
          - resource_ids:
              - dummy-1
              - dummy-2
            options:
              - name: require-all
                value: "false"
              - name: sequential
                value: "false"
          - resource_ids:
              - dummy-3
          - resource_ids:
              - dummy-4
              - dummy-5
            options:
              - name: sequential
                value: "false"
    # ticket constraints
    ha_cluster_constraints_ticket:
      # simple constraint
      - resource:
          id: dummy-1
        ticket: ticket1
        options:
          - name: loss-policy
            value: stop
      # set constraint
      - resource_sets:
          - resource_ids:
              - dummy-3
              - dummy-4
              - dummy-5
        ticket: ticket2
        options:
          - name: loss-policy
            value: fence

  roles:
    - linux-system-roles.ha_cluster</pre></div></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook, specifying the path to the inventory file <span class="emphasis"><em>inventory</em></span> you created in Step 1.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nyu5bnr"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory</em></span> new-cluster.yml</strong></span></pre></div></div></li></ol></div></section><section class="section" id="configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.7. Configuring Corosync values in a high availability cluster</h2></div></div></div><p class="_abstract _abstract">
				(RHEL 9.1 and later) The following procedure uses the <code class="literal">ha_cluster</code> System Role to create a high availability cluster that configures Corosync values.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have <code class="literal">ansible-core</code> installed on the node from which you want to run the playbook.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You do not need to have <code class="literal">ansible-core</code> installed on the cluster member nodes.
						</p></div></div></li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active 
subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> System Role replaces 
any existing cluster configuration on the specified nodes. Any settings 
not specified in the role will be lost.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Create an inventory file specifying the nodes in the cluster, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Specifying an inventory for the ha_cluster System Role</a>.
					</li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">new-cluster.yml</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When creating your playbook file for production, Vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p></div></div><p class="simpara">
						The following example playbook file configures a cluster running the <code class="literal">firewalld</code> and <code class="literal">selinux</code> services that configures Corosync properties.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--xr4gg4j"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: node1 node2
  vars:
    ha_cluster_cluster_name: my-new-cluster
    ha_cluster_hacluster_password: password
    ha_cluster_manage_firewall: true
    ha_cluster_manage_selinux: true
    ha_cluster_transport:
      type: knet
      options:
        - name: ip_version
          value: ipv4-6
        - name: link_mode
          value: active
      links:
        -
          - name: linknumber
            value: 1
          - name: link_priority
            value: 5
        -
          - name: linknumber
            value: 0
          - name: link_priority
            value: 10
      compression:
        - name: level
          value: 5
        - name: model
          value: zlib
      crypto:
        - name: cipher
          value: none
        - name: hash
          value: none
    ha_cluster_totem:
      options:
        - name: block_unlisted_ips
          value: 'yes'
        - name: send_join
          value: 0
    ha_cluster_quorum:
      options:
        - name: auto_tie_breaker
          value: 1
        - name: wait_for_all
          value: 1

  roles:
    - linux-system-roles.ha_cluster</pre></div></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook, specifying the path to the inventory file <span class="emphasis"><em>inventory</em></span> you created in Step 1.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--b9rz5bh"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory</em></span> new-cluster.yml</strong></span></pre></div></div></li></ol></div></section><section class="section" id="configuring-ha-cluster-with-sbd_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.8. Configuring a high availability cluster with SBD node fencing</h2></div></div></div><p class="_abstract _abstract">
				(RHEL 9.1 and later) The following procedure uses the <code class="literal">ha_cluster</code> System Role to create a high availability cluster that uses SBD node fencing.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have <code class="literal">ansible-core</code> installed on the node from which you want to run the playbook.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You do not need to have <code class="literal">ansible-core</code> installed on the cluster member nodes.
						</p></div></div></li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active 
subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> System Role replaces 
any existing cluster configuration on the specified nodes. Any settings 
not specified in the role will be lost.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Create an inventory file specifying the nodes in the cluster, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Specifying an inventory for the ha_cluster System Role</a>. You can optionally configure watchdog and SBD devices for each node in the cluster in an inventory file.
					</li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">new-cluster.yml</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When creating your playbook file for production, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p></div></div><p class="simpara">
						The following example playbook file configures a cluster running the <code class="literal">firewalld</code> and <code class="literal">selinux</code> services that uses SBD fencing.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1rqoj2b"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: node1 node2
  vars:
    ha_cluster_cluster_name: my-new-cluster
    ha_cluster_hacluster_password: password
    ha_cluster_manage_firewall: true
    ha_cluster_manage_selinux: true
    ha_cluster_sbd_enabled: yes
    ha_cluster_sbd_options:
      - name: delay-start
        value: 'no'
      - name: startmode
        value: always
      - name: timeout-action
        value: 'flush,reboot'
      - name: watchdog-timeout
        value: 5

  roles:
    - linux-system-roles.ha_cluster</pre></div></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook, specifying the path to the inventory file <span class="emphasis"><em>inventory</em></span> you created in Step 1.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--yrwgpk3"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory</em></span> new-cluster.yml</strong></span></pre></div></div></li></ol></div></section><section class="section" id="configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.9. Configuring a high availability cluster using a quorum device (RHEL 9.2 and later)</h2></div></div></div><p>
				To configure a high availability cluster with a separate quorum device by using the <code class="literal">ha_cluster</code>
 System Role, first set up the quorum device. After setting up the 
quorum device, you can use the device in any number of clusters.
			</p><section class="section" id="configuring_a_quorum_device"><div class="titlepage"><div><div><h3 class="title">24.9.1. Configuring a quorum device</h3></div></div></div><p>
					To configure a quorum device using the <code class="literal">ha_cluster</code> System Role, follow these steps. Note that you cannot run a quorum device on a cluster node.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The <code class="literal">ansible-core</code> and the <code class="literal">rhel-system-roles</code> packages are installed on the node from which you want to run the playbook.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You do not need to have <code class="literal">ansible-core</code> installed on the cluster member nodes.
							</p></div></div></li><li class="listitem">
							The system that you will use to run the quorum device has active 
subscription coverage for RHEL and the RHEL High Availability Add-On.
						</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						The <code class="literal">ha_cluster</code> System Role replaces 
any existing cluster configuration on the specified nodes. Any settings 
not specified in the role will be lost.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">qdev-playbook.yml</code>.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When creating your playbook file for production, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
							</p></div></div><p class="simpara">
							The following example playbook file configures a quorum device on a system running the <code class="literal">firewalld</code> and <code class="literal">selinux</code> services.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--y1p76mv"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: nodeQ
  vars:
    ha_cluster_cluster_present: false
    ha_cluster_hacluster_password: password
    ha_cluster_manage_firewall: true
    ha_cluster_manage_selinux: true
    ha_cluster_qnetd:
      present: true

  roles:
    - linux-system-roles.ha_cluster</pre></div></div></li><li class="listitem">
							Save the file.
						</li><li class="listitem"><p class="simpara">
							Run the playbook, specifying the host node for the quorum device.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--t5msgxp"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i nodeQ, qdev-playbook.yml</strong></span></pre></div></div></li></ol></div></section><section class="section" id="configuring_a_cluster_to_use_a_quorum_device"><div class="titlepage"><div><div><h3 class="title">24.9.2. Configuring a cluster to use a quorum device</h3></div></div></div><p>
					To configure a cluster to use a quorum device, follow these steps.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							You have <code class="literal">ansible-core</code> installed on the node from which you want to run the playbook.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You do not need to have <code class="literal">ansible-core</code> installed on the cluster member nodes.
							</p></div></div></li><li class="listitem">
							You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
						</li><li class="listitem">
							The systems that you will use as your cluster members have active
 subscription coverage for RHEL and the RHEL High Availability Add-On.
						</li><li class="listitem">
							You have configured a quorum device.
						</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						The <code class="literal">ha_cluster</code> system role replaces 
any existing cluster configuration on the specified nodes. Any settings 
not specified in the role will be lost.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create an inventory file specifying the nodes in the cluster, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Specifying an inventory for the ha_cluster System Role</a>.
						</li><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">new-cluster.yml</code>.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								When creating your playbook file for production, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
							</p></div></div><p class="simpara">
							The following example playbook file configures a cluster running the <code class="literal">firewalld</code> and <code class="literal">selinux</code> services that uses a quorum device.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--geki3cd"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: node1 node2
  vars:
    ha_cluster_cluster_name: my-new-cluster
    ha_cluster_hacluster_password: password
    ha_cluster_manage_firewall: true
    ha_cluster_manage_selinux: true
    ha_cluster_quorum:
      device:
        model: net
        model_options:
          - name: host
            value: nodeQ
          - name: algorithm
            value: lms

  roles:
    - linux-system-roles.ha_cluster</pre></div></div></li><li class="listitem">
							Save the file.
						</li><li class="listitem"><p class="simpara">
							Run the playbook, specifying the path to the inventory file <span class="emphasis"><em>inventory</em></span> you created in Step 1.
						</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--g9sz3he"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory</em></span> new-cluster.yml</strong></span></pre></div></div></li></ol></div></section></section><section class="section" id="configuring-http-ha-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">24.10. Configuring an Apache HTTP server in a high availability cluster with the ha_cluster System Role</h2></div></div></div><p class="_abstract _abstract">
				This procedure configures an active/passive Apache HTTP server in a 
two-node Red Hat Enterprise Linux High Availability Add-On cluster using
 the <code class="literal">ha_cluster</code> System Role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have <code class="literal">ansible-core</code> installed on the node from which you want to run the playbook.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You do not need to have <code class="literal">ansible-core</code> installed on the cluster member nodes.
						</p></div></div></li><li class="listitem">
						You have the <code class="literal">rhel-system-roles</code> package installed on the system from which you want to run the playbook.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active 
subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						Your system includes a public virtual IP address, required for Apache.
					</li><li class="listitem">
						Your system includes shared storage for the nodes in the cluster, 
using iSCSI, Fibre Channel, or other shared network block device.
					</li><li class="listitem">
						You have configured an LVM logical volume with an XFS file system, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_high_availability_clusters/assembly_configuring-active-passive-http-server-in-a-cluster-configuring-and-managing-high-availability-clusters#proc_configuring-lvm-volume-with-ext4-file-system-configuring-ha-http">Configuring an LVM volume with an XFS file system in a Pacemaker cluster</a>.
					</li><li class="listitem">
						You have configured an Apache HTTP server, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_high_availability_clusters/assembly_configuring-active-passive-http-server-in-a-cluster-configuring-and-managing-high-availability-clusters#proc_configuring-apache-http-web-server-configuring-ha-http">Configuring an Apache HTTP Server</a>.
					</li><li class="listitem">
						Your system includes an APC power switch that will be used to fence the cluster nodes.
					</li></ul></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> System Role replaces 
any existing cluster configuration on the specified nodes. Any settings 
not specified in the role will be lost.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Create an inventory file specifying the nodes in the cluster, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Specifying an inventory for the ha_cluster System Role</a>.
					</li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">http-cluster.yml</code>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When creating your playbook file for production, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p></div></div><p class="simpara">
						The following example playbook file configures a 
previously-created Apache HTTP server in an active/passive two-node HA 
cluster running the <code class="literal">firewalld</code> and <code class="literal">selinux</code> services.
					</p><p class="simpara">
						This example uses an APC power switch with a host name of <code class="literal">zapc.example.com</code>.
 If the cluster does not use any other fence agents, you can optionally 
list only the fence agents your cluster requires when defining the <code class="literal">ha_cluster_fence_agent_packages</code> variable, as in this example.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--f1pmf93"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><button title="Expand" class="codeblock__expand">Expand</button><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">- hosts: z1.example.com z2.example.com
  roles:
    - rhel-system-roles.ha_cluster
  vars:
    ha_cluster_hacluster_password: password
    ha_cluster_cluster_name: my_cluster
    ha_cluster_manage_firewall: true
    ha_cluster_manage_selinux: true
    ha_cluster_fence_agent_packages:
      - fence-agents-apc-snmp
    ha_cluster_resource_primitives:
      - id: myapc
        agent: stonith:fence_apc_snmp
        instance_attrs:
          - attrs:
              - name: ipaddr
                value: zapc.example.com
              - name: pcmk_host_map
                value: z1.example.com:1;z2.example.com:2
              - name: login
                value: apc
              - name: passwd
                value: apc
      - id: my_lvm
        agent: ocf:heartbeat:LVM-activate
        instance_attrs:
          - attrs:
              - name: vgname
                value: my_vg
              - name: vg_access_mode
                value: system_id
      - id: my_fs
        agent: Filesystem
        instance_attrs:
          - attrs:
              - name: device
                value: /dev/my_vg/my_lv
              - name: directory
                value: /var/www
              - name: fstype
                value: xfs
      - id: VirtualIP
        agent: IPaddr2
        instance_attrs:
          - attrs:
              - name: ip
                value: 198.51.100.3
              - name: cidr_netmask
                value: 24
      - id: Website
        agent: apache
        instance_attrs:
          - attrs:
              - name: configfile
                value: /etc/httpd/conf/httpd.conf
              - name: statusurl
                value: http://127.0.0.1/server-status
    ha_cluster_resource_groups:
      - id: apachegroup
        resource_ids:
          - my_lvm
          - my_fs
          - VirtualIP
          - Website</pre></div></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook, specifying the path to the inventory file <span class="emphasis"><em>inventory</em></span> you created in Step 1.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--q7e0hj7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory</em></span> http-cluster.yml</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						When you use the <code class="literal">apache</code> resource agent to manage Apache, it does not use <code class="literal">systemd</code>. Because of this, you must edit the <code class="literal">logrotate</code> script supplied with Apache so that it does not use <code class="literal">systemctl</code> to reload Apache.
					</p><p class="simpara">
						Remove the following line in the <code class="literal">/etc/logrotate.d/httpd</code> file on each node in the cluster.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--arlcrdg"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">/bin/systemctl reload httpd.service &gt; /dev/null 2&gt;/dev/null || true</pre></div></div><p class="simpara">
						Replace the line you removed with the following three lines, specifying <code class="literal">/var/run/httpd-<span class="emphasis"><em>website</em></span>.pid</code> as the PID file path where <span class="emphasis"><em>website</em></span> is the name of the Apache resource. In this example, the Apache resource name is <code class="literal">Website</code>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--nqq05ob"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">/usr/bin/test -f /var/run/httpd-Website.pid &gt;/dev/null 2&gt;/dev/null &amp;&amp;
/usr/bin/ps -q $(/usr/bin/cat /var/run/httpd-Website.pid) &gt;/dev/null 2&gt;/dev/null &amp;&amp;
/usr/sbin/httpd -f /etc/httpd/conf/httpd.conf -c "PidFile /var/run/httpd-Website.pid" -k graceful &gt; /dev/null 2&gt;/dev/null || true</pre></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification steps</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						From one of the nodes in the cluster, check the status of the 
cluster. Note that all four resources are running on the same node, <code class="literal">z1.example.com</code>.
					</p><p class="simpara">
						If you find that the resources you configured are not running, you can run the <code class="literal command">pcs resource debug-start <span class="emphasis"><em>resource</em></span></code> command to test the resource configuration.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--qsto62v"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">[root@z1 ~]# <span class="strong strong"><strong>pcs status</strong></span>
Cluster name: my_cluster
Last updated: Wed Jul 31 16:38:51 2013
Last change: Wed Jul 31 16:42:14 2013 via crm_attribute on z1.example.com
Stack: corosync
Current DC: z2.example.com (2) - partition with quorum
Version: 1.1.10-5.el7-9abe687
2 Nodes configured
6 Resources configured

Online: [ z1.example.com z2.example.com ]

Full list of resources:
 myapc  (stonith:fence_apc_snmp):       Started z1.example.com
 Resource Group: apachegroup
     my_lvm     (ocf::heartbeat:LVM-activate):   Started z1.example.com
     my_fs      (ocf::heartbeat:Filesystem):    Started z1.example.com
     VirtualIP  (ocf::heartbeat:IPaddr2):       Started z1.example.com
     Website    (ocf::heartbeat:apache):        Started z1.example.com</pre></div></div></li><li class="listitem"><p class="simpara">
						Once the cluster is up and running, you can point a browser to the IP address you defined as the <code class="literal">IPaddr2</code> resource to view the sample display, consisting of the simple word "Hello".
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--uewb4s7"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">Hello</pre></div></div></li><li class="listitem"><p class="simpara">
						To test whether the resource group running on <code class="literal">z1.example.com</code> fails over to node <code class="literal">z2.example.com</code>, put node <code class="literal">z1.example.com</code> in <code class="literal">standby</code> mode, after which the node will no longer be able to host resources.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--0cmox8n"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">[root@z1 ~]# <span class="strong strong"><strong>pcs node standby z1.example.com</strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						After putting node <code class="literal">z1</code> in <code class="literal">standby</code> mode, check the cluster status from one of the nodes in the cluster. Note that the resources should now all be running on <code class="literal">z2</code>.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--2v63242"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">[root@z1 ~]# <span class="strong strong"><strong>pcs status</strong></span>
Cluster name: my_cluster
Last updated: Wed Jul 31 17:16:17 2013
Last change: Wed Jul 31 17:18:34 2013 via crm_attribute on z1.example.com
Stack: corosync
Current DC: z2.example.com (2) - partition with quorum
Version: 1.1.10-5.el7-9abe687
2 Nodes configured
6 Resources configured

Node z1.example.com (1): standby
Online: [ z2.example.com ]

Full list of resources:

 myapc  (stonith:fence_apc_snmp):       Started z1.example.com
 Resource Group: apachegroup
     my_lvm     (ocf::heartbeat:LVM-activate):   Started z2.example.com
     my_fs      (ocf::heartbeat:Filesystem):    Started z2.example.com
     VirtualIP  (ocf::heartbeat:IPaddr2):       Started z2.example.com
     Website    (ocf::heartbeat:apache):        Started z2.example.com</pre></div></div><p class="simpara">
						The web site at the defined IP address should still display, without interruption.
					</p></li><li class="listitem"><p class="simpara">
						To remove <code class="literal">z1</code> from <code class="literal">standby</code> mode, enter the following command.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--eobra5c"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="literallayout language-none codeblock codeblock--processed">[root@z1 ~]# <span class="strong strong"><strong>pcs node unstandby z1.example.com</strong></span></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Removing a node from <code class="literal">standby</code> mode does not in itself cause the resources to fail back over to that node. This will depend on the <code class="literal">resource-stickiness</code> value for the resources. For information about the <code class="literal">resource-stickiness</code> meta attribute, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_high_availability_clusters/assembly_determining-which-node-a-resource-runs-on-configuring-and-managing-high-availability-clusters#proc_setting-resource-stickiness-determining-which-node-a-resource-runs-on">Configuring a resource to prefer its current node</a>.
						</p></div></div></li></ol></div></section><section class="section _additional-resources" id="additional_resources_7"><div class="titlepage"><div><div><h2 class="title">24.11. ADDITIONAL RESOURCES</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL System Roles</a>.
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rhel-system-roles</code> package in <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.html</code>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/node/3050101">RHEL&nbsp;System&nbsp;Roles</a> KB article
					</li><li class="listitem">
						The <code class="literal">ansible-playbook(1)</code> man page.
					</li></ul></div></section></section><section class="chapter" id="assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 25. Installing and configuring web console with the cockpit RHEL System Role</h1></div></div></div><p class="_abstract _abstract">
			With the <code class="literal">cockpit</code> RHEL System Role, you can install and configure the web console in your system.
		</p><section class="section" id="con_the-cockpit-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">25.1. The cockpit System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">cockpit</code> System Role to automatically deploy and enable the web console and thus be able to manage your RHEL systems from a web browser.
			</p></section><section class="section" id="ref_variables-for-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">25.2. Variables for the cockpit RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				The parameters used for the <code class="literal">cockpit</code> RHEL System Roles are:
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="salsmmo" id="rh-table--salsmmo" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604736769680" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Role Variable</th><th id="idm140604736768592" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604736769680" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								cockpit_packages: (default: default)
							</p>
							 </td><td headers="idm140604736768592" data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Sets one of the predefined package sets: default, minimal, or full.
							</p>
							 <p>
								* cockpit_packages: (default: default) - most common pages and on-demand install UI
							</p>
							 <p>
								* cockpit_packages: (default: minimal) - just the Overview, 
Terminal, Logs, Accounts, and Metrics pages; minimal dependencies
							</p>
							 <p>
								* cockpit_packages: (default: full) - all available pages
							</p>
							 <p>
								Optionally, specify your own selection of cockpit packages you want to install.
							</p>
							 </td></tr><tr><td headers="idm140604736769680" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								cockpit_enabled: (default:true)
							</p>
							 </td><td headers="idm140604736768592" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Configures if the web console web server is enabled to start automatically at boot
							</p>
							 </td></tr><tr><td headers="idm140604736769680" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								cockpit_started: (default:true)
							</p>
							 </td><td headers="idm140604736768592" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
								Configures if the web console should be started
							</p>
							 </td></tr><tr><td headers="idm140604736769680" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								cockpit_config: (default: nothing)
							</p>
							 </td><td headers="idm140604736768592" data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								You can apply settings in the <code class="literal">/etc/cockpit/cockpit.conf</code> file. NOTE: The previous settings file will be lost.
							</p>
							 </td></tr><tr><td headers="idm140604736769680" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								cockpit_port: (default: 9090)
							</p>
							 </td><td headers="idm140604736768592" data-row="6" data-col="2" class="content--lg" valign="top" align="left"> <p>
								The web console runs on port 9090 by default. You can change the port using this option.
							</p>
							 </td></tr><tr><td headers="idm140604736769680" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								cockpit_manage_firewall: (default: false)
							</p>
							 </td><td headers="idm140604736768592" data-row="7" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Allows the <code class="literal">cockpit</code> role to control the <code class="literal">firewall</code>
 role to add ports. It cannot be used for removing ports. If you want to
 remove ports, you will need to use the firewall system role directly.
							</p>
							 </td></tr><tr><td headers="idm140604736769680" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								cockpit_manage_selinux: (default: false)
							</p>
							 </td><td headers="idm140604736768592" data-row="8" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Allows the <code class="literal">cockpit</code> role to configure SELinux using the <code class="literal">selinux</code>
 role. The default SELinux policy does not allow Cockpit to listen on 
anything other than port 9090. If you change the port, set this option 
to <code class="literal">true</code> so that the <code class="literal">selinux</code> role can set the correct port permissions (<code class="literal">websm_port_t</code>).
							</p>
							 </td></tr><tr><td headers="idm140604736769680" data-row="9" data-col="1" class="content--md" valign="top" align="left"> <p>
								cockpit_certificates: (default: nothing)
							</p>
							 </td><td headers="idm140604736768592" data-row="9" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Allows the <code class="literal">cockpit</code> role to generate new certificates using the <code class="literal">certificate</code> role. The value of <code class="literal">cockpit_certificates</code> is passed on to the <code class="literal">certificate_requests</code> variable of the <code class="literal">certificate</code> role. This role is called internally by the <code class="literal">cockpit</code> role and it generates the private key and certificate.
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.cockpit/README.md</code> file.
					</li><li class="listitem">
						The <a class="link" href="https://cockpit-project.org/guide/latest/cockpit.conf.5.html">Cockpit configuration file</a> man page.
					</li></ul></div></section><section class="section" id="proc_installing-the-web-console-by-using-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">25.3. Installing the web console by using the cockpit RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">cockpit</code> System Role to install and enable the RHEL web console.
			</p><p>
				By default, the RHEL web console uses a self-signed certificate. For
 security reasons, you can specify a certificate that was issued by a 
trusted certificate authority instead.
			</p><p>
				In this example, you use the <code class="literal">cockpit</code> System Role to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Install the RHEL web console.
					</li><li class="listitem">
						Allow the web console to manage <code class="literal">firewalld</code>.
					</li><li class="listitem">
						Set the web console to use a certificate from the <code class="literal">ipa</code> trusted certificate authority instead of using a self-signed certificate.
					</li><li class="listitem">
						Set the web console to use a custom port 9050.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You do not have to call the <code class="literal">firewall</code> or <code class="literal">certificate</code> System Roles in the playbook to manage the Firewall or create the certificate. The <code class="literal">cockpit</code> System Role calls them automatically as needed.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li><li class="listitem">
								An inventory file exists that lists the managed nodes.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal"><span class="emphasis"><em>playbook.yml</em></span></code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--1032u4g"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- hosts: all
  tasks:
    - name: Install RHEL web console
      include_role:
        name: rhel-system-roles.cockpit
      vars:
        cockpit_packages: default
        #cockpit_packages: minimal
        #cockpit_packages: full
        cockpit_port:9050
        cockpit_manage_selinux: true
        cockpit_manage_firewall: true
        cockpit_certificates:
          - name: /etc/cockpit/ws-certs.d/01-certificate
            dns: ['localhost', 'www.example.com']
            ca: ipa
            group: cockpit-ws</pre></div></div></li><li class="listitem"><p class="simpara">
						Optional: Verify the playbook syntax:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--npn7aw0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>playbook.yml</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--hkckpzl"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>/path/to/file/playbook.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_systems_using_the_rhel_8_web_console/getting-started-with-the-rhel-8-web-console_system-management-using-the-rhel-8-web-console#installing-the-web-console_getting-started-with-the-rhel-8-web-console">Installing and enabling the web console</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL System Roles</a>.
					</li></ul></div></section></section><section class="chapter" id="managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 26. Managing containers by using the podman RHEL System Role</h1></div></div></div><p class="_abstract _abstract">
			With the <code class="literal">podman</code> RHEL&nbsp;System&nbsp;Role, you can manage Podman configuration, containers, and <code class="literal">systemd</code> services which run Podman containers.
		</p><section class="section" id="the-podman-system-role_managing-containers-by-using-the-podman-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">26.1. The podman RHEL System Role</h2></div></div></div><p>
				You can use the <code class="literal">podman</code> RHEL&nbsp;System&nbsp;Role to manage Podman configuration, containers, and systemd services which run Podman containers.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#installing-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Installing RHEL System Roles</a>
					</li><li class="listitem">
						For details about the parameters used in <code class="literal">podman</code> and additional information about the <code class="literal">podman</code> RHEL&nbsp;System&nbsp;Role, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.podman/README.md</code> file.
					</li></ul></div></section><section class="section" id="variables-for-the-podman-rhel-system-role_managing-containers-by-using-the-podman-rhel-system-role"><div class="titlepage"><div><div><h2 class="title">26.2. Variables for the podman RHEL System Role</h2></div></div></div><p>
				The parameters used for the <code class="literal">podman</code> RHEL&nbsp;System&nbsp;Role are:
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="ncjcuh2" id="rh-table--ncjcuh2" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604738489712" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Variable</th><th id="idm140604738488624" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604738489712" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_kube_spec</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="2" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Describes a podman pod and corresponding systemd unit to manage.
							</p>
							 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										<code class="literal">state</code>: (default: <code class="literal">created</code>) - denotes an operation to be executed with <code class="literal">systemd</code> services and pods:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												<code class="literal">created</code>: create the pods and <code class="literal">systemd</code> service, but do not run them
											</li><li class="listitem">
												<code class="literal">started</code>: create the pods and <code class="literal">systemd</code> services and start them
											</li><li class="listitem">
												<code class="literal">absent</code>: remove the pods and <code class="literal">systemd</code> services
											</li></ul></div></li><li class="listitem"><p class="simpara">
										<code class="literal">run_as_user</code>: (default: <code class="literal">podman_run_as_user</code>) - a per-pod user. If not specified, root is used.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The user must already exist.
										</p></div></div></li><li class="listitem"><p class="simpara">
										<code class="literal">run_as_group</code> (default: <code class="literal">podman_run_as_group</code>) - a per-pod group. If not specified, root is used.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											The group must already exist.
										</p></div></div></li><li class="listitem">
										<code class="literal">systemd_unit_scope</code> (default: <code class="literal">podman_systemd_unit_scope</code>) - scope to use for the <code class="literal">systemd</code> unit. If not specified, <code class="literal">system</code> is used for root containers and <code class="literal">user</code> for user containers.
									</li><li class="listitem"><p class="simpara">
										<code class="literal">kube_file_src</code> - name of a Kubernetes YAML file on the controller node which will be copied to <code class="literal">kube_file</code> on the managed node
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											Do not specify the <code class="literal">kube_file_src</code> variable if you specify <code class="literal">kube_file_content</code> variable. The <code class="literal">kube_file_content</code> takes precedence over <code class="literal">kube_file_src</code>.
										</p></div></div></li><li class="listitem"><p class="simpara">
										<code class="literal">kube_file_content</code> - string in Kubernetes YAML format or a dict in Kubernetes YAML format. It specifies the contents of <code class="literal">kube_file</code> on the managed node.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											Do not specify the <code class="literal">kube_file_content</code> variable if you specify <code class="literal">kube_file_src</code> variable. The <code class="literal">kube_file_content</code> takes precedence over <code class="literal">kube_file_src</code>.
										</p></div></div></li><li class="listitem"><p class="simpara">
										<code class="literal">kube_file</code> - a name of a file on 
the managed node that contains the Kubernetes specification of the 
container or pod. You typically do not have to specify the <code class="literal">kube_file</code> variable unless you need to copy the <code class="literal">kube_file</code> file to the managed node outside of the role. If you specify either <code class="literal">kube_file_src</code> or <code class="literal">kube_file_content</code>, you do not have to specify this.
									</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
											It is highly recommended to omit <code class="literal">kube_file</code> and instead specify either <code class="literal">kube_file_src</code> or <code class="literal">kube_file_content</code> and let the role manage the file path and name.
										</p></div></div><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												The file basename will be the metadata.name value from the K8s yaml, with a <code class="literal">.yml</code> suffix appended to it.
											</li><li class="listitem">
												The directory is <code class="literal">/etc/containers/ansible-kubernetes.d</code> for system services.
											</li><li class="listitem">
												The directory is <code class="literal">$HOME/.config/containers/ansible-kubernetes.d</code> for user services.
											</li><li class="listitem">
												This will be copied to the file <code class="literal">/etc/containers/ansible-kubernetes.d/<span class="emphasis"><em>&lt;application_name&gt;</em></span>.yml</code> on the managed node.
											</li></ul></div></li></ul></div>
							 </td></tr><tr><td headers="idm140604738489712" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_create_host_directories</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								If true, the role ensures host directories specified in host mounts in <code class="literal">volumes.hostPath</code> specifications in the Kubernetes YAML given in <code class="literal">podman_kube_specs</code>. The default value is false.
							</p>
							 <div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Directories must be specified as absolute paths (for root 
containers), or paths relative to the home directory (for non-root 
containers), in order for the role to manage them. Anything else is 
ignored.
								</p></div></div>
							 <p>
								The role applies its default ownership or permissions to the 
directories. If you need to set ownership or permissions, see <code class="literal">podman_host_directories</code>.
							</p>
							 </td></tr><tr><td headers="idm140604738489712" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_host_directories</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								It is a dict. If using <code class="literal">podman_create_host_directories</code>
 to tell the role to create host directories for volume mounts, and you 
need to specify permissions or ownership that apply to these created 
host directories, use <code class="literal">podman_host_directories</code>.
 Each key is the absolute path of the host directory to manage. The 
value is in the format of the parameters to the file module. If you do 
not specify a value, the role will use its built-in default values. If 
you want to specify a value to be used for all host directories, use the
 special key <code class="literal">DEFAULT</code>.
							</p>
							 </td></tr><tr><td headers="idm140604738489712" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_firewall</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								It is a list of dict. Specifies ports that you want the role to 
manage in the firewall. This uses the same format as used by the 
firewall RHEL System Role.
							</p>
							 </td></tr><tr><td headers="idm140604738489712" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_selinux_ports</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="6" data-col="2" class="content--lg" valign="top" align="left"> <p>
								It is a list of dict. Specifies ports that you want the role to 
manage the SELinux policy for ports used by the role. This uses the same
 format as used by the selinux RHEL System Role.
							</p>
							 </td></tr><tr><td headers="idm140604738489712" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_run_as_user</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="7" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Specifies the name of the user to use for all rootless containers. You can also specify per-container username with <code class="literal">run_as_user</code> in <code class="literal">podman_kube_specs</code>.
							</p>
							 <div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The user must already exist.
								</p></div></div>
							 </td></tr><tr><td headers="idm140604738489712" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_run_as_group</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="8" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Specifies the name of the group to use for all rootless 
containers. You can also specify a per-container group name with <code class="literal">run_as_group</code> in <code class="literal">podman_kube_specs</code>.
							</p>
							 <div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The group must already exist.
								</p></div></div>
							 </td></tr><tr><td headers="idm140604738489712" data-row="9" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_systemd_unit_scope</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="9" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Defines the <code class="literal">systemd</code> scope to use by default for all <code class="literal">systemd</code> units. You can also specify per-container scope with <code class="literal">systemd_unit_scope</code> in <code class="literal">podman_kube_specs</code>. By default, rootless containers use <code class="literal">user</code> and root containers use <code class="literal">system</code>.
							</p>
							 </td></tr><tr><td headers="idm140604738489712" data-row="10" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_containers_conf</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="10" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Defines the <code class="literal">containers.conf(5)</code> settings as a dict. The setting is provided in a drop-in file in the <code class="literal">containers.conf.d</code> directory. If running as root (see <code class="literal">podman_run_as_user</code>), the <code class="literal">system</code> settings are managed. Otherwise, the <code class="literal">user</code> settings are managed. See the <code class="literal">containers.conf</code> man page for the directory locations.
							</p>
							 </td></tr><tr><td headers="idm140604738489712" data-row="11" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_registries_conf</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="11" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Defines the <code class="literal">containers-registries.conf(5)</code> settings as a dict. The setting is provided in a drop-in file in the <code class="literal">registries.conf.d</code> directory. If running as root (see <code class="literal">podman_run_as_user</code>), the <code class="literal">system</code> settings are managed. Otherwise, the <code class="literal">user</code> settings are managed. See the <code class="literal">registries.conf</code> man page for the directory locations.
							</p>
							 </td></tr><tr><td headers="idm140604738489712" data-row="12" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_storage_conf</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="12" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Defines the <code class="literal">containers-storage.conf(5)</code> settings as a dict. If running as root (see <code class="literal">podman_run_as_user</code>), the <code class="literal">system</code> settings are managed. Otherwise, the <code class="literal">user</code> settings are managed. See the <code class="literal">storage.conf</code> man page for the directory locations.
							</p>
							 </td></tr><tr><td headers="idm140604738489712" data-row="13" data-col="1" class="content--md" valign="top" align="left"> <p>
								<code class="literal">podman_policy_json</code>
							</p>
							 </td><td headers="idm140604738488624" data-row="13" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Defines the <code class="literal">containers-policy.conf(5)</code> settings as a dict. If running as root (see <code class="literal">podman_run_as_user</code>), the <code class="literal">system</code> settings are managed. Otherwise, the <code class="literal">user</code> settings are managed. See the <code class="literal">policy.json</code> man page for the directory locations.
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#installing-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Installing RHEL&nbsp;System&nbsp;Roles</a>
					</li><li class="listitem">
						For details about the parameters used in <code class="literal">podman</code> and additional information about the <code class="literal">podman</code> RHEL&nbsp;System&nbsp;Role, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.podman/README.md</code> file.
					</li></ul></div></section><section class="section _additional-resources" id="additional_resources_8"><div class="titlepage"><div><div><h2 class="title">26.3. ADDITIONAL RESOURCES</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						For details about the parameters used in <code class="literal">podman</code> and additional information about the <code class="literal">podman</code> RHEL&nbsp;System&nbsp;Role, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.podman/README.md</code> file.
					</li><li class="listitem">
						For details about the <code class="literal">ansible-playbook</code> command, see the <code class="literal">ansible-playbook(1)</code> man page.
					</li></ul></div></section></section><section class="chapter" id="integrating-rhel-systems-directly-with-ad-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h1 class="title">Chapter 27. Integrating RHEL systems directly with AD using RHEL System Roles</h1></div></div></div><p>
			With the <code class="literal">ad_integration</code> System Role, you
 can automate a direct integration of a RHEL system with Active 
Directory (AD) using Red Hat Ansible Automation Platform.
		</p><p>
			This chapter covers the following topics:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#the-ad-integration-system-role_integrating-rhel-systems-directly-with-ad-using-rhel-system-roles" title="27.1.&nbsp;The ad_integration System Role">The <code class="literal">ad_integration</code> System Role</a>
				</li><li class="listitem">
					<a class="link" href="#variables-for-the-ad-integration-rhel-system-role_integrating-rhel-systems-directly-with-ad-using-rhel-system-roles" title="27.2.&nbsp;Variables for the ad_integration RHEL System Role">Variables for the ad_integration RHEL System Role</a>
				</li><li class="listitem">
					<a class="link" href="#connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-directly-with-ad-using-rhel-system-roles" title="27.3.&nbsp;Connecting a RHEL system directly to AD using the ad_integration System Role">Connecting a RHEL system directly to AD using the <code class="literal">ad_integration</code> System Role</a>
				</li></ul></div><section class="section" id="the-ad-integration-system-role_integrating-rhel-systems-directly-with-ad-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">27.1. The ad_integration System Role</h2></div></div></div><p>
				Using the <code class="literal">ad_integration</code> System Role, you can directly connect a RHEL system to Active Directory (AD).
			</p><p>
				The role uses the following components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						SSSD to interact with the central identity and authentication source
					</li><li class="listitem">
						<code class="literal">realmd</code> to detect available AD domains
 and configure the underlying RHEL system services, in this case SSSD, 
to connect to the selected AD domain
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The <code class="literal">ad_integration</code> role is for 
deployments using direct AD integration without an Identity Management 
(IdM) environment. For IdM environments, use the <code class="literal">ansible-freeipa</code> roles.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/integrating_rhel_systems_directly_with_windows_active_directory/connecting-rhel-systems-directly-to-ad-using-sssd_integrating-rhel-systems-directly-with-active-directory">Connecting RHEL systems directly to AD using SSSD</a>.
					</li></ul></div></section><section class="section" id="variables-for-the-ad-integration-rhel-system-role_integrating-rhel-systems-directly-with-ad-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">27.2. Variables for the ad_integration RHEL System Role</h2></div></div></div><p class="_abstract _abstract">
				The <code class="literal">ad_integration</code> RHEL System Role uses the following parameters:
			</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="rv8za88" id="rh-table--rv8za88" style="--rh-table--scrollbar--width: 0px;"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th id="idm140604737740592" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Role Variable</th><th id="idm140604737739504" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Description</th></tr></thead><tbody><tr><td headers="idm140604737740592" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
								ad_integration_realm
							</p>
							 </td><td headers="idm140604737739504" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
								Active Directory realm, or domain name to join.
							</p>
							 </td></tr><tr><td headers="idm140604737740592" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
								ad_integration_password
							</p>
							 </td><td headers="idm140604737739504" data-row="3" data-col="2" class="content--lg" valign="top" align="left"> <p>
								The password of the user used to authenticate with when joining 
the machine to the realm. Do not use plain text. Instead, use Ansible 
Vault to encrypt the value.
							</p>
							 </td></tr><tr><td headers="idm140604737740592" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
								ad_integration_manage_crypto_policies
							</p>
							 </td><td headers="idm140604737739504" data-row="4" data-col="2" class="content--lg" valign="top" align="left"> <p>
								If <code class="literal">true</code>, the <code class="literal">ad_integration</code> role will use <code class="literal">fedora.linux_system_roles.crypto_policies</code> as needed.
							</p>
							 <p>
								Default: <code class="literal">false</code>
							</p>
							 </td></tr><tr><td headers="idm140604737740592" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
								ad_integration_allow_rc4_crypto
							</p>
							 </td><td headers="idm140604737739504" data-row="5" data-col="2" class="content--lg" valign="top" align="left"> <p>
								If <code class="literal">true</code>, the <code class="literal">ad_integration</code> role will set the crypto policy to allow RC4 encryption.
							</p>
							 <p>
								Providing this variable automatically sets <code class="literal">ad_integration_manage_crypto_policies</code> to <code class="literal">true</code>.
							</p>
							 <p>
								Default: <code class="literal">false</code>
							</p>
							 </td></tr><tr><td headers="idm140604737740592" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
								ad_integration_timesync_source
							</p>
							 </td><td headers="idm140604737739504" data-row="6" data-col="2" class="content--lg" valign="top" align="left"> <p>
								Hostname or IP address of time source to synchronize the system clock with. Providing this variable automatically sets <code class="literal">ad_integration_manage_timesync</code> to <code class="literal">true</code>.
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md</code> file.
					</li></ul></div></section><section class="section" id="connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-directly-with-ad-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">27.3. Connecting a RHEL system directly to AD using the ad_integration System Role</h2></div></div></div><p>
				You can use the <code class="literal">ad_integration</code> System Role to configure a direct integration between a RHEL system and an AD domain by running an Ansible playbook.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Starting with RHEL8, RHEL no longer supports RC4 encryption by 
default. If it is not possible to enable AES in the AD domain, you must 
enable the <code class="literal">AD-SUPPORT</code> crypto policy and allow RC4 encryption in the playbook.
				</p></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Time between the RHEL server and AD must be synchronized. You can ensure this by using the <code class="literal">timesync</code> System Role in the playbook.
				</p></div></div><p>
				In this example, the RHEL system joins the <code class="literal">domain.example.com</code> AD domain, using the AD <code class="literal">Administrator</code> user and the password for this user stored in the Ansible vault. The playbook also sets the <code class="literal">AD-SUPPORT</code> crypto policy and allows RC4 encryption. To ensure time synchronization between the RHEL system and AD, the playbook sets the <code class="literal">adserver.domain.example.com</code> server as the <code class="literal">timesync</code> source.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access and permissions to one or more <span class="emphasis"><em>managed nodes</em></span>.
					</li><li class="listitem"><p class="simpara">
						Access and permissions to a <span class="emphasis"><em>control node</em></span>.
					</p><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">ansible-core</code> and <code class="literal">rhel-system-roles</code> packages are installed.
							</li><li class="listitem">
								An inventory file which lists the managed nodes.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The following ports on the AD domain controllers are open and accessible from the RHEL server:
					</p><div class="table" id="idm140604738313408"><p class="title">Table 27.1. Ports Required for Direct Integration of Linux Systems into AD Using the ad_integration System Role</p><rh-table class="table-contents rh-table--processed" pfelement="" type="content" data-id="taw2yff" id="rh-table--taw2yff" style="--rh-table--scrollbar--width: 0px;"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--><col style="width: 25%; " class="col_2"><!--Empty--><col style="width: 25%; " class="col_3"><!--Empty--><col style="width: 25%; " class="col_4"><!--Empty--></colgroup><thead><tr><th id="idm140604738306176" scope="col" data-row="1" data-col="1" class="content--sm" valign="top" align="left">Source Port</th><th id="idm140604738305088" scope="col" data-row="1" data-col="2" class="content--sm" valign="top" align="left">Destination Port</th><th id="idm140604738304000" scope="col" data-row="1" data-col="3" class="content--sm" valign="top" align="left">Protocol</th><th id="idm140604738302912" scope="col" data-row="1" data-col="4" class="content--sm" valign="top" align="left">Service</th></tr></thead><tbody><tr><td headers="idm140604738306176" data-row="2" data-col="1" class="content--md" valign="top" align="left"> <p>
										1024:65535
									</p>
									 </td><td headers="idm140604738305088" data-row="2" data-col="2" class="content--md" valign="top" align="left"> <p>
										53
									</p>
									 </td><td headers="idm140604738304000" data-row="2" data-col="3" class="content--md" valign="top" align="left"> <p>
										UDP and TCP
									</p>
									 </td><td headers="idm140604738302912" data-row="2" data-col="4" class="content--md" valign="top" align="left"> <p>
										DNS
									</p>
									 </td></tr><tr><td headers="idm140604738306176" data-row="3" data-col="1" class="content--md" valign="top" align="left"> <p>
										1024:65535
									</p>
									 </td><td headers="idm140604738305088" data-row="3" data-col="2" class="content--md" valign="top" align="left"> <p>
										389
									</p>
									 </td><td headers="idm140604738304000" data-row="3" data-col="3" class="content--md" valign="top" align="left"> <p>
										UDP and TCP
									</p>
									 </td><td headers="idm140604738302912" data-row="3" data-col="4" class="content--md" valign="top" align="left"> <p>
										LDAP
									</p>
									 </td></tr><tr><td headers="idm140604738306176" data-row="4" data-col="1" class="content--md" valign="top" align="left"> <p>
										1024:65535
									</p>
									 </td><td headers="idm140604738305088" data-row="4" data-col="2" class="content--md" valign="top" align="left"> <p>
										636
									</p>
									 </td><td headers="idm140604738304000" data-row="4" data-col="3" class="content--md" valign="top" align="left"> <p>
										TCP
									</p>
									 </td><td headers="idm140604738302912" data-row="4" data-col="4" class="content--md" valign="top" align="left"> <p>
										LDAPS
									</p>
									 </td></tr><tr><td headers="idm140604738306176" data-row="5" data-col="1" class="content--md" valign="top" align="left"> <p>
										1024:65535
									</p>
									 </td><td headers="idm140604738305088" data-row="5" data-col="2" class="content--md" valign="top" align="left"> <p>
										88
									</p>
									 </td><td headers="idm140604738304000" data-row="5" data-col="3" class="content--md" valign="top" align="left"> <p>
										UDP and TCP
									</p>
									 </td><td headers="idm140604738302912" data-row="5" data-col="4" class="content--md" valign="top" align="left"> <p>
										Kerberos
									</p>
									 </td></tr><tr><td headers="idm140604738306176" data-row="6" data-col="1" class="content--md" valign="top" align="left"> <p>
										1024:65535
									</p>
									 </td><td headers="idm140604738305088" data-row="6" data-col="2" class="content--md" valign="top" align="left"> <p>
										464
									</p>
									 </td><td headers="idm140604738304000" data-row="6" data-col="3" class="content--md" valign="top" align="left"> <p>
										UDP and TCP
									</p>
									 </td><td headers="idm140604738302912" data-row="6" data-col="4" class="content--md" valign="top" align="left"> <p>
										Kerberos change/set password (<code class="literal">kadmin</code>)
									</p>
									 </td></tr><tr><td headers="idm140604738306176" data-row="7" data-col="1" class="content--md" valign="top" align="left"> <p>
										1024:65535
									</p>
									 </td><td headers="idm140604738305088" data-row="7" data-col="2" class="content--md" valign="top" align="left"> <p>
										3268
									</p>
									 </td><td headers="idm140604738304000" data-row="7" data-col="3" class="content--md" valign="top" align="left"> <p>
										TCP
									</p>
									 </td><td headers="idm140604738302912" data-row="7" data-col="4" class="content--md" valign="top" align="left"> <p>
										LDAP Global Catalog
									</p>
									 </td></tr><tr><td headers="idm140604738306176" data-row="8" data-col="1" class="content--md" valign="top" align="left"> <p>
										1024:65535
									</p>
									 </td><td headers="idm140604738305088" data-row="8" data-col="2" class="content--md" valign="top" align="left"> <p>
										3269
									</p>
									 </td><td headers="idm140604738304000" data-row="8" data-col="3" class="content--md" valign="top" align="left"> <p>
										TCP
									</p>
									 </td><td headers="idm140604738302912" data-row="8" data-col="4" class="content--md" valign="top" align="left"> <p>
										LDAP Global Catalog SSL/TLS
									</p>
									 </td></tr><tr><td headers="idm140604738306176" data-row="9" data-col="1" class="content--md" valign="top" align="left"> <p>
										1024:65535
									</p>
									 </td><td headers="idm140604738305088" data-row="9" data-col="2" class="content--md" valign="top" align="left"> <p>
										123
									</p>
									 </td><td headers="idm140604738304000" data-row="9" data-col="3" class="content--md" valign="top" align="left"> <p>
										UDP
									</p>
									 </td><td headers="idm140604738302912" data-row="9" data-col="4" class="content--md" valign="top" align="left"> <p>
										NTP/Chrony (Optional)
									</p>
									 </td></tr><tr><td headers="idm140604738306176" data-row="10" data-col="1" class="content--md" valign="top" align="left"> <p>
										1024:65535
									</p>
									 </td><td headers="idm140604738305088" data-row="10" data-col="2" class="content--md" valign="top" align="left"> <p>
										323
									</p>
									 </td><td headers="idm140604738304000" data-row="10" data-col="3" class="content--md" valign="top" align="left"> <p>
										UDP
									</p>
									 </td><td headers="idm140604738302912" data-row="10" data-col="4" class="content--md" valign="top" align="left"> <p>
										NTP/Chrony (Optional)
									</p>
									 </td></tr></tbody></table></rh-table></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal">ad_integration.yml</code> file with the following content:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--kv9sfq0"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen white-space-pre language-none codeblock codeblock--processed">---
- hosts: all
  vars:
    ad_integration_realm: "domain.example.com"
    ad_integration_password: !vault | <span class="strong strong"><strong><span class="emphasis"><em>vault encrypted password</em></span></strong></span>
    ad_integration_manage_crypto_policies: true
    ad_integration_allow_rc4_crypto: true
    ad_integration_timesync_source: "adserver.domain.example.com"
  roles:
    - linux-system-roles.ad_integration
---</pre></div></div></li><li class="listitem"><p class="simpara">
						Optional: Verify playbook syntax.
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--zqxw23x"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook --syntax-check <span class="emphasis"><em>ad_integration.yml</em></span> -i <span class="emphasis"><em>inventory_file</em></span></strong></span></pre></div></div></li><li class="listitem"><p class="simpara">
						Run the playbook on your inventory file:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--ocolgms"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed"># <span class="strong strong"><strong>ansible-playbook -i <span class="emphasis"><em>inventory_file</em></span> <span class="emphasis"><em>/path/to/file/ad_integration.yml</em></span></strong></span></pre></div></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display an AD user details, such as the <code class="literal">administrator</code> user:
					</p><div class="codeblock__wrapper" data-plain-code-block-id="codeblock--plain--x8nf63g"><pfe-clipboard title="Copy" copy-from="property" class="codeblock__copy PFElement" copied-duration="3" role="button" tabindex="0" pfelement="" type="content"><span slot="text">Copy</span><span slot="text--success">Copied!</span></pfe-clipboard><div class="codeblock__inner-wrapper" tabindex="0"><pre class="screen language-none codeblock codeblock--processed">getent passwd administrator@ad.example.com
administrator@ad.example.com:*:1450400500:1450400513:Administrator:/home/administrator@ad.example.com:/bin/bash</pre></div></div></li></ul></div></section><section class="section" id="additional_resources_9"><div class="titlepage"><div><div><h2 class="title">27.4. Additional resources</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md</code> file.
					</li><li class="listitem">
						<code class="literal">man ansible-playbook(1)</code>
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140604752031664"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2023 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat
 under a Creative Commons Attribution–Share Alike 3.0 Unported license 
("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>.
 In accordance with CC-BY-SA, if you distribute this document or an 
adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to 
enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest
 extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat 
logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are 
trademarks of Red Hat, Inc., registered in the United States and other 
countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of 
Joyent. Red Hat is not formally related to or endorsed by the official 
Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack 
logo are either registered trademarks/service marks or 
trademarks/service marks of the OpenStack Foundation, in the United 
States and other countries and are used with the OpenStack Foundation's 
permission. We are not affiliated with, endorsed or sponsored by the 
OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div>


  <nav class="pvof-doc__book-nav">
  <ol class="book-nav__list">
              </ol>
</nav>


          </div>
              </div>
              <div id="comments-footer" class="book-comments">
          

  

        </div>
          </div>
  </article>
<meta itemscope="" itemref="md1">



    </div>
      <!-- CP_PRIMER_FOOTER -->            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto affix-top" href="#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com/">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path class="rh-logo-hat" d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"></path>
                      <path class="rh-logo-band" d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"></path>
                      <path class="rh-logo-type" d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"></path>
                  </svg>
                </a>
              </div>

              <div role="navigation" aria-label="quick">
                  <h3>Quick Links</h3>
                  <ul>
                      <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                      <li><a class="manage-subscriptions" href="https://access.redhat.com/management">Subscriptions</a></li>
                      <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                      <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                      <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="help">
                  <h3>Help</h3>
                  <ul>
                      <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                      <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                      <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="site">
                  <h3>Site Info</h3>
                  <ul>
                      <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                      <li><a class="browser-support-policy" href="https://www.redhat.com/en/about/browser-support">Browser Support Policy</a></li>
                      <li><a class="accessibility" href="https://www.redhat.com/en/about/digital-accessibility">Accessibility</a></li>
                      <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                      <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="other">
                  <h3>Related Sites</h3>
                  <ul>
                      <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                      <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                      <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                      <li><a href="https://cloud.redhat.com/" class="cloud-com">cloud.redhat.com</a></li>
                  </ul>
              </div>

              <div role="navigation" aria-label="about">
                  <h3>About</h3>
                  <ul>
                      <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                      <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                      <li><a href="http://jobs.redhat.com/" class="about-jobs">Red Hat Jobs</a></li>
                  </ul>
              </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a href="https://status.redhat.com/" class="status-page-widget">
                        <span class="status-description">All systems operational</span>
                        <span class="status-dot shape-circle shape-dash-lime"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2023 Red Hat, Inc.</div>

                        <div role="navigation" aria-label="legal" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://www.redhat.com/en/about/terms-use" class="terms-of-use">Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                                <li><a id="teconsent" consent="0,1,2"><a role="link" id="icon-id01404100634530595" tabindex="0" aria-haspopup="dialog" aria-label="Cookie Preferences, opens a dedicated popup modal window" class="truste_cursor_pointer" lang="en">Cookie preferences</a></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                        <img src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/rh-summit-red-a.svg" alt="Red Hat Summit"> <span class="offscreen">Red Hat Summit</span>
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHat" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>                        
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- TrustArc -->
    <div id="consent_blackbar"></div> 
    <!--googleon: all-->
</div>
<!-- /CP_PRIMER_FOOTER -->


  </div>

    
  

<script>_satellite["_runScript2"](function(event, target, Promise) {
window._sdi=window._sdi||{},window._sdi.addEventHandler=window.addEventListener?function(e,i,t){e.addEventListener(i,t,!1)}:function(e,i,t){e.attachEvent("on"+i,t)},window._sdi.addEventHandler(window,"message",(function(e){var i={},t=0;(-1!==e.origin.indexOf("loop=1")||e.srcElement&&e.srcElement.playerOptions&&1==e.srcElement.playerOptions.loop)&&(t=1);var a=0;if(e.srcElement&&e.srcElement.playerOptions&&1==e.srcElement.playerOptions.autoplay&&(a=1),e.origin.match(/youtube\.com/)&&"undefined"!=typeof JSON&&!t&&!a){i=JSON.parse(e.data);var n=window._sdi.yt.videos;if("infoDelivery"==i.event){var d,o={};for(var r in i.info.videoData&&((o=n[d=i.info.videoData.video_id]||{}).info=i.info,o.id=i.id,n[d]=o),window._sdi.yt.videos){(c=window._sdi.yt.videos[r]).id==i.id&&(o=c)}var s=window._sdi.yt.sc||{};o.info&&(Math.abs(i.info.currentTime-o.info.currentTime)>1.5&&!0===s.track&&(s.s().Media.stop(o.info.videoData.title,o.info.currentTime),"paused"!=o.state&&s.s().Media.play(o.info.videoData.title,i.info.currentTime)),o.info.currentTime=i.info.currentTime),2==i.info.playerState&&(s.s().Media.stop(o.info.videoData.title,o.info.currentTime),o.state="paused"),1==i.info.playerState&&(o.started?!0===s.track&&s.s().Media.play(o.info.videoData.title,o.info.currentTime):(o.started=!0,!0===s.track&&(s.s().Media.open(o.info.videoData.title,o.info.duration,"youtube"),s.s().Media.play(o.info.videoData.title,o.info.currentTime))),o.state="playing"),3==i.info.playerState&&o.started&&(!0===s.track&&s.s().Media.stop(o.info.videoData.title,o.info.currentTime),o.state="paused"),0===i.info.playerState&&(!0===s.track&&(s.s().Media.stop(o.info.videoData.title,o.info.currentTime),s.s().Media.close(o.info.videoData.title)),o.state="completed")}else if("onStateChange"==i.event){for(var r in window._sdi.yt.videos){var c;(c=window._sdi.yt.videos[r]).id==i.id&&(o=c)}s=window._sdi.yt.sc||{};1==i.info&&(o.started?!0===s.track&&s.s().Media.play(o.info.videoData.title,o.info.currentTime):(o.started=!0,!0===s.track&&(s.s().Media.open(o.info.videoData.title,o.info.duration,"youtube"),"paused"!=o.state&&s.s().Media.play(o.info.videoData.title,i.info.currentTime))),o.state="playing"),2==i.info&&(!0===s.track&&s.s().Media.stop(o.info.videoData.title,o.info.currentTime),o.state="paused"),3==i.info&&o.started&&(!0===s.track&&s.s().Media.stop(o.info.videoData.title,o.info.currentTime),o.state="paused"),0===i.info&&(!0===s.track&&(s.s().Media.stop(o.info.videoData.title,o.info.currentTime),s.s().Media.close(o.info.videoData.title)),o.state="completed")}}})),window._sdi.loadScript=function(e,i){var t=document.createElement("script");t.type="text/javascript",i&&"function"==typeof i&&(t.readyState?t.onreadystatechange=function(){"loaded"!==t.readyState&&"complete"!==t.readyState||(t.onreadystatechange=null,i())}:t.onload=function(){i()}),t.src=e,document.getElementsByTagName("head")[0].appendChild(t)},window._sdi.yt={stages:{},players:{},sc:{track:!0,s:function(){return window.s}},init:function(){for(var e=document.getElementsByTagName("script"),i=!1,t=(window._sdi.yt.videos,0);t<e.length;t++){(e[t].src||"").match(/youtube\.com\/iframe_api/)&&(i=!0)}!1===i?window._sdi.loadScript("//www.youtube.com/iframe_api",(function(){window._sdi.yt.ready("api")})):window._sdi.yt.ready("api")},ready:function(e){window._sdi.yt.stages[e]=!0,window._sdi.yt.stages.dom&&window._sdi.yt.stages.api&&window._sdi.yt.checkIframes()},checkIframes:function(){var e=window._sdi.yt.videos,i=1e3,t=0;document.querySelectorAll("iframe[src*=youtube][data-sdiyt]").forEach((a=>{if("true"==a.dataset.sdiyt)return!1;if(-1!=a.src.indexOf("loop=1"))var n=null;else{var d;n=a.src.match(/h?t?t?p?s?\:?\/\/www\.youtube(-nocookie)?\.com\/embed\/([\w-]{11})(?:\?.*)?/)}if(n){d=n.length>2?n[2]:"",a.id||(a.id=d+t,t++);var o=!1;if(a.src.match(/enablejsapi=1/)||(a.src+=(a.src.indexOf("?")>-1?"&":"?")+"enablejsapi=1",o=!0),o){var r=a.cloneNode(!0);r.src=a.src,r.id=a.id,a.replaceWith(r)}else"undefined"!=typeof YT&&void 0!==YT.get?(ready=!0,e[d]={},(!YT.get(a.id)||void 0===YT.get(a.id).v&&void 0!==YT.get(a.id).v.videoId)&&(e[d].player=new YT.Player(a.id,{events:{onReady:function(){},onStateChange:function(){},videoId:a.id}})),a.setAttribute("data-sdiyt","true")):i=100}})),setTimeout((function(){window._sdi.yt.checkIframes()}),i)},videos:{}},void 0!==window._sdi&&void 0!==window._sdi.addEventHandler&&window._sdi.addEventHandler(window,"load",(function(){document.querySelectorAll('iframe[src*="youtube"]').length>=1?(window._sdi.yt.init(),window._sdi.yt.ready("dom")):window._sdi.ytinterval=setInterval((function(){document.querySelectorAll('iframe[src*="youtube"]').length>=1&&(window._sdi.yt.init(),window._sdi.yt.ready("dom"),clearInterval(window._sdi.ytinterval))}),500)}));
});</script><script>_satellite["_runScript3"](function(event, target, Promise) {
var dataLayerName="appEventData",reservedAttributes=["event"],internalDomains=[],downloadExtensions=["doc","docx","eps","jpg","png","svg","xls","ppt","pptx","pdf","xlsx","tab","csv","zip","txt","vsd","vxd","xml","js","css","rar","exe","wma","mov","avi","wmv","mp3","wav","m4v"],parseAttributes=function(t){var e={};for(var n in t.dataset)if("analytics"===n.substr(0,9)){var a=n.replace("analytics","");e[a[0]?a[0].toLocaleLowerCase()+a.slice(1):""]=t.dataset[n]}return e},addAttributes=function(t,e){return isJavascript(t)&&(e.isJavascript=!0),isDownload(t)&&(e.isDownload=!0),isCrossPropertyDomain(t)&&(e.isCrossPropertyDomain=!0,e.linkTypeName="cross property link"),isCta(t)&&(e.isCta=!0,e.linkTypeName="cta link"),isExitLink(t)&&(e.isExitLink=!0,e.linkTypeName="exit link"),isFooter(t)&&(e.isFooter=!0),isInternalCampaign(t)&&(e.isInternalCampaign=!0),isPromoSection(t)&&(e.isPromoSection=!0),isSearchContainer(t)&&(e.isSearchContainer=!0),e.targetHost=getHostName(t.href),e.internalCampaign=window._sdi.util.getQueryParam("icid",t.href)||window._sdi.util.getQueryParam("intcmp",t.href),e},getLinkText=function(t){return t.getAttribute("data-analytics-text")||t.getAttribute("sObjectId")||t.getAttribute("s-object-id")||t.getAttribute("sObjectID")||t.getAttribute("data-s-object-id")||t.innerText&&""!==t.innerText.trim()&&t.innerText.trim()||t.textContent&&""!==t.textContent.trim()&&t.textContent.trim()||t.querySelector("[alt]")&&t.querySelector("[alt]").getAttribute("alt")||t.querySelector("[title]")&&t.querySelector("[title]").getAttribute("title")||t.getAttribute("aria-label")||t.href||"unknown"},getRegions=function(t,e){if(e=e||[],!t)return e;var n=t.closest("[data-analytics-region]");return n?(e.push(n.dataset.analyticsRegion),e=getRegions(n.parentElement,e)):e},removeReservedAttributes=function(t){return reservedAttributes.forEach((function(e){delete t[e]})),t},redactEmail=function(t){return t.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,6}/gi,"email_address_redacted")},buildDataObject=function(t,e,n){return n=n||getRegions(t),{event:buildEventName(t,e,n),linkInfo:Object.assign({href:t.href,regions:n.reverse().join("|"),text:redactEmail(getLinkText(t))},removeReservedAttributes(e))}},buildEventName=function(t,e,n){if(e.event)return e.event;var a={};if(n=n||getRegions(t))for(var i=0;i<n.length;i++)if(a[n[i]])return a[n[i]];return"Master Link Clicked"},findRootElement=function(t){if(t)return t.closest("a, [data-analytics-event]")},isJavascript=function(t){return new RegExp("^javascript:","i").test(t.href)},isDownload=function(t){return new RegExp(".("+downloadExtensions.join("|")+")$","i").test(t.href)},isInternalDomain=function(t){return new RegExp(internalDomains.join("|"),"i").test(t.href)},isExitLink=function(t){return!!t.href&&!new RegExp(_satellite.getVar("exitExclusionArray").join("|"),"i").test(t.href)},isCrossPropertyDomain=function(t){return document.location.hostname!==getHostName(t.href)&&"access.cdn.redhat.com"!==getHostName(t.href)&&new RegExp(_satellite.getVar("redHatDomains").join("|"),"i").test(getHostName(t.href))},isCta=function(t){return!(!t.classList.contains("cta-primary")&&"primary"!=t.getAttribute("data-rh-cta-type")&&"primary"!=t.getAttribute("data-ux-cta-type"))},isTab=function(t){return!!(t.classList.contains('[data-toggle="tab"]')||t.classList.contains("pfe-accordion-header")||t.classList.contains('[role="tab"]')||t.classList.contains("ux-vtab-nav-link")||t.classList.contains("ux-tile-nav-link")||t.classList.contains("btn-brick")||t.classList.contains("ux-htab-nav-link")||t.classList.contains("ux-horizontal-tab-nav-link")||t.classList.contains("ux-oss-hub-filter-type-text")||t.classList.contains("ux-htabb-nav-link")||"tab"==t.getAttribute("data-toggle")||"PFE-ACCORDION-HEADER"==t.tagName||"tab"==t.getAttribute("role"))},isFooter=function(t){return el=t.closest("footer"),"undefined"!=typeof el&&null!=el},isInternalCampaign=function(t){return(""!=window._sdi.util.getQueryParam("icid",t.href)||""!=window._sdi.util.getQueryParam("intcmp",t.href))&&(linkRole=t.getAttribute("role")||"",_satellite.logger.log("isInternalCampaign: linkRole:",linkRole),"tab"!==linkRole||void 0)},isPromoSection=function(t){return el=t.closest("div.band-hero"),"undefined"!=typeof el&&null!=el},isSearchContainer=function(t){return _satellite.logger.log("isSearchContainer ran"),el=t.closest("div.cp-sidebar")||t.closest("div.cp-search-results"),_satellite.logger.log("isSearchContainer el",el),_satellite.logger.log("isSearchContainer return","undefined"!=typeof el&&null!=el&&document.location.href.indexOf("search")>-1),"undefined"!=typeof el&&null!=el&&document.location.href.indexOf("search")>-1},getHostName=function(e){return t=document.createElement("a"),t.href=e,t.hostname},pushEvent=function(t){window.appEventData=window.appEventData||[],console.info("Pushing to the dataLayer",t);var e=window[dataLayerName];Array.isArray(e)&&e.push(t)};window.analyticsHelper=window.analyticsHelper||{},window.analyticsHelper.parseCustomEvent=function(t,e,n){_satellite.logger.log("target:",t);var a=parseAttributes(t),i=null,r=getRegions(t);if(e)i=e.closest("[data-analytics-region]");else{var s=t.getRootNode();s&&s.host&&(i=t.getRootNode().host.closest("[data-analytics-region]"))}i&&(r=r.concat(getRegions(i))),"expand"===n&&r.includes("mega menu")&&(a.event="Mega Menu Expanded"),"expand"===n&&r.includes("site-switcher")&&(a.event="Site Switcher Expanded"),"true"!==a.istab&&"true"!==a.isTab||(a.event="Tab Link Clicked",tabHref=t.getAttribute("href")||getLinkText(t)||"",tabHref=tabHref.trim(),a.tabHref=tabHref),_satellite.logger.log("attributes",a),_satellite.logger.log("event type",n),_satellite.logger.log("regions",r),a=addAttributes(t,a);var o=buildDataObject(t,a,r);o.event&&pushEvent(o)};var clickHandler=function(t){if(!(t.target&&t.target.tagName&&t.target.tagName.indexOf("-")>0)){var e=findRootElement(t.target);if(e){var n=parseAttributes(e);isTab(e)&&(n.event="Tab Link Clicked",tabHref=e.getAttribute("href")||getLinkText(e)||"",tabHref=tabHref.trim(),n.tabHref=tabHref),n=addAttributes(e,n);var a=buildDataObject(e,n);a.event&&pushEvent(a)}}};document.addEventListener("click",clickHandler,!0),document.addEventListener("pfe-tabs:shown-tab",(function(t){if(window.analyticsHelper&&"function"==typeof window.analyticsHelper.parseCustomEvent){var e=t.target.closest("pfe-content-set")||t.target.closest("pfe-tabs"),n=null;if(e){if("PFE-CONTENT-SET"===e.tagName){var a=t.detail.tab.querySelector("slot");if(a)(n=e.getSlot(a.getAttribute("name")))&&(n=e.getSlot(t.detail.tab.querySelector("slot").getAttribute("name"))[0])}else n=t.detail.tab;n?(n.setAttribute("data-analytics-isTab","true"),_satellite.logger.info("Called pfe-tabs:shown-tab:parseCustomEvent clicked"),window.analyticsHelper.parseCustomEvent(n,e,"clicked")):console.warn("Wasn't able to find the tabTextWrapper")}else console.warn("Wasn't able to find the componentParent")}})),document.addEventListener("pfe-accordion:change",(function(t){if(window.analyticsHelper&&"function"==typeof window.analyticsHelper.parseCustomEvent){var e=t.target.closest("pfe-content-set")||t.target.closest("pfe-accordion");if(t.detail.expanded){var n="PFE-ACCORDION-HEADER"===t.target.tagName?t.target:t.path[0];if(e&&"PFE-CONTENT-SET"===e.tagName){var a=n.querySelector("slot");if(a){var i=e.getSlot(a.getAttribute("name"));i&&i[0]&&(n=i[0])}}n&&n.setAttribute("data-analytics-isTab","true"),_satellite.logger.info("Called pfe-accordion:change:parseCustomEvent expand"),window.analyticsHelper.parseCustomEvent(n,e,"expand")}}})),document.addEventListener("pfe-shadow-dom-event",(function(t){window.analyticsHelper&&"function"==typeof window.analyticsHelper.parseCustomEvent&&window.analyticsHelper.parseCustomEvent(t.detail.target,t.detail.parentComponent,"click")})),document.addEventListener("pfe-navigation:expanded-item",(function(t){window.analyticsHelper&&"function"==typeof window.analyticsHelper.parseCustomEvent&&window.analyticsHelper.parseCustomEvent(t.detail.toggle,t.target,"expand")}));
});</script><div id="ZN_bCxD2jjWRr4bfVQ"></div><script type="text/javascript" src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/Untitled.js"></script><script src="Automating%20system%20administration%20by%20using%20RHEL%20System%20Roles%20Red%20Hat%20Enterprise%20Linux%209%20Red%20Hat%20Customer%20Portal_files/CoreModule.js" defer="defer"></script><script>_satellite["_runScript4"](function(event, target, Promise) {
_satellite.getVar("eloqua_Tag");
});</script><script>_satellite["_runScript5"](function(event, target, Promise) {
var body=document.body,html=document.documentElement,pageHeight=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight),viewportHeight=window.innerHeight,initialPercent=viewportHeight/pageHeight,maxInterval=0;initialPercent=initialPercent>1?100:Math.round(100*initialPercent);var maxScroll=Math.floor(initialPercent);_satellite.cookie.set("sat_ppv",maxScroll,{domain:".redhat.com"});var ticking=!1,s=window.scrollY;document.addEventListener("scroll",(()=>{ticking||(window.requestAnimationFrame((()=>{var t=document.body,e=document.documentElement;s=window.scrollY;var i=Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight),o=window.innerHeight,l=s/(i-o)*100;l>maxScroll&&(maxScroll=Math.floor(l)),_satellite.cookie.set("sat_ppv",maxScroll,{domain:".redhat.com"}),ticking=!1})),ticking=!0)}),{passive:!0});
});</script><script>
if("yes"==_satellite.getVar("tagsAllowedFunc")){var profileID=_satellite.getVar("profileID")||"";if(profileID)try{!function(e){!function(t,n,i,a,o){var c,l,r,f,s;for((o=t[a]=t[a]||{})._q=[],l=0,r=(c=["initialize","identify","updateOptions","pageLoad"]).length;l<r;++l)!function(e){o[e]=o[e]||function(){o._q[e===c[0]?"unshift":"push"]([e].concat([].slice.call(arguments,0)))}}(c[l]);(f=n.createElement(i)).async=!0,f.src="https://cdn.pendo.io/agent/static/"+e+"/pendo.js",(s=n.getElementsByTagName(i)[0]).parentNode.insertBefore(f,s)}(window,document,"script","pendo"),setTimeout((function(){"undefined"!=typeof pendo&&pendo.initialize({visitor:{id:_satellite.getVar("profileID"),internal:"",lang:""},account:{id:_satellite.getVar("accountID"),account_number:_satellite.getVar("accountID")}})}),2e3)}("f210c485-387f-43ad-4eee-f55bab22507f")}catch(e){}}
</script></body></html>